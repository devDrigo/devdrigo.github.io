/*
 * frames-runtime-html5
 * 
 * Version: 4.6.33-0b2026f2 (2022-09-13)
 * Copyright 2022 MORPHIS - https://www.morphis-tech.com/
 */

Frames = {version:'4.6.33', revision:'0b2026f2'};

function LZ(e){return(e<0||9<e?"":"0")+e}function _isInteger(e){var t;for(t=0;t<e.length;t++)if(-1=="1234567890".indexOf(e.charAt(t)))return!1;return!0}function _getInt(e,t,i,a){var s;for(s=a;i<=s;s--){var r=e.substring(t,t+s);if(r.length<i)return null;if(_isInteger(r))return r}return null}function getDateFromFormat(e,t,i){e+="",t+="";for(var a,s,r,n=0,o=0,l="",d="",u=new Date,c=u.getFullYear(),p=u.getMonth()+1,m=u.getDate(),h=0,f=0,g=0,_="",v=-1!=e.indexOf(":");o<t.length;){for(l=t.charAt(o),d="";t.charAt(o)==l&&o<t.length;)d+=t.charAt(o++);if("yyyy"==d||"yy"==d||"y"==d){if("yyyy"==d&&(s=a=4),"yy"==d&&(s=a=2),"y"==d&&(a=2,s=4),c=_getInt(e,n,a,s),Frames.isUndef(c)){if(i)return null;c=""}n+=c.length,2==c.length&&(c=70<c?c-0+1900:c-0+2e3)}else if("MMM"==d||"NNN"==d){for(r=p=0;r<Frames.FormatDate.MONTH_NAMES.length;r++){var b=Frames.FormatDate.MONTH_NAMES[r];if(e.substring(n,n+b.length).toLowerCase()==b.toLowerCase()&&("MMM"==d||"NNN"==d&&11<r)){12<(p=r+1)&&(p-=12),n+=b.length;break}}if(Frames.isUndef(p)||p<1){if(i)return null;p="1"}else if(12<p){if(i)return null;p="12"}}else if("EE"==d||"E"==d)for(r=0;r<Frames.FormatDate.DAY_NAMES.length;r++){var F=Frames.FormatDate.DAY_NAMES[r];if(e.substring(n,n+F.length).toLowerCase()==F.toLowerCase()){n+=F.length;break}}else if("MM"==d||"M"==d){if(p=_getInt(e,n,d.length,2),Frames.isUndef(p)||p<1){if(i)return null;p="1"}else if(12<p){if(i)return null;p="12"}n+=p.length}else if("dd"==d||"d"==d){if(m=_getInt(e,n,d.length,2),Frames.isUndef(m)||m<1){if(i)return null;m="1"}else if(31<m){if(i)return null;m="31"}n+=m.length}else if("hh"==d||"h"==d){if(h=_getInt(e,n,d.length,2),Frames.isUndef(h)||h<1||12<h){if(n+=v?1:0,h=0,i)return null;continue}n+=h.length}else if("HH"==d||"H"==d){if(h=_getInt(e,n,d.length,2),Frames.isUndef(h)||h<0||23<h){if(n+=v?1:0,h=0,i)return null;continue}n+=h.length}else if("KK"==d||"K"==d){if(h=_getInt(e,n,d.length,2),Frames.isUndef(h)||h<0||11<h){if(n+=v?1:0,h=0,i)return null;continue}n+=h.length}else if("kk"==d||"k"==d){if(h=_getInt(e,n,d.length,2),Frames.isUndef(h)||h<1||24<h){if(n+=v?1:0,h=0,i)return null;continue}n+=h.length,h--}else if("mm"==d||"m"==d){if(f=_getInt(e,n,d.length,2),Frames.isUndef(f)||f<0||59<f){if(n+=v?1:0,f=0,i)return null;continue}n+=f.length}else if("ss"==d||"s"==d){if(g=_getInt(e,n,d.length,2),Frames.isUndef(g)||g<0||59<g){if(n+=v?1:0,f=0,i)return null;continue}n+=g.length}else if("a"==d){if("am"==e.substring(n,n+2).toLowerCase())_="AM";else{if("pm"!=e.substring(n,n+2).toLowerCase()){_="AM",n+=1;continue}_="PM"}n+=2}else{if(e.substring(n,n+d.length)!=d)continue;n+=d.length}}if(n!=e.length&&i)return null;if(u.getFullYear()===c&&u.getMonth()===p-1||/d/.test(t)||(m=1),2==p)if(c%4==0&&c%100!=0||c%400==0){if(29<m){if(i)return null;m="29"}}else if(28<m){if(i)return null;m="28"}if((4==p||6==p||9==p||11==p)&&30<m){if(i)return null;m="30"}if(h<12&&"PM"==_)h=h-0+12;else if(11<h&&"AM"==_)h-=12;else if(23<h){if(i)return null;h=0}return new Date(c,p-1,m,h,f,g).getTime()}function isDate(e,t){return 0!==getDateFromFormat(e,t)}function compareDates(e,t,i,a){var s=getDateFromFormat(e,t),r=getDateFromFormat(i,a);return 0===s||0===r?-1:r<s?1:0}function formatDate(e,t){t+="";var i="",a=0,s="",r="",n=e.getFullYear()+"",o=e.getMonth()+1,l=e.getDate(),d=e.getDay(),u=e.getHours(),c=e.getMinutes(),p=e.getSeconds(),m={};for(n.length<4&&(n=""+(n-0+1900)),m.y=""+n,m.yyyy=n,m.yy=n.substring(2,4),m.M=o,m.MM=LZ(o),m.MMM=Frames.FormatDate.MONTH_NAMES[o-1],m.NNN=Frames.FormatDate.MONTH_NAMES[o+11],m.d=l,m.dd=LZ(l),m.E=Frames.FormatDate.DAY_NAMES[d+7],m.EE=Frames.FormatDate.DAY_NAMES[d],m.H=u,m.HH=LZ(u),m.h=0===u?12:12<u?u-12:u,m.hh=LZ(m.h),m.K=11<u?u-12:u,m.k=u+1,m.KK=LZ(m.K),m.kk=LZ(m.k),m.a=11<u?"PM":"AM",m.m=c,m.mm=LZ(c),m.s=p,m.ss=LZ(p);a<t.length;){for(s=t.charAt(a),r="";t.charAt(a)==s&&a<t.length;)r+=t.charAt(a++);Frames.isUndef(m[r])?i+=r:i+=m[r]}return i}function parseDate(e){var t=2==arguments.length&&arguments[1];generalFormats=["y-M-d","MMM d, y","MMM d,y","y-MMM-d","d-MMM-y","MMM d"],monthFirst=["M/d/y","M-d-y","M.d.y","MMM-d","M/d","M-d"],dateFirst=["d/M/y","d-M-y","d.M.y","d-MMM","d/M","d-M"];var i,a=["generalFormats",t?"dateFirst":"monthFirst",t?"monthFirst":"dateFirst"],s=null;for(i=0;i<a.length;i++){var r,n=window[a[i]];for(r=0;r<n.length;r++)if(0!==(s=getDateFromFormat(e,n[r])))return new Date(s)}return null}(function($){Frames={version:window.Frames?window.Frames.version:"@VERSION",revision:window.Frames?window.Frames.revision:"@REVISION",_TYPES_:{},_PLUGS_:null,_UUID_:1,PLUGIN_WIDGET:"widget",banner:function(){var e=Frames.Logger._getConsole();"function"==typeof e.log&&(e.log(Array(41).join("~")),e.log("Frames",Frames.version,"("+Frames.revision+")"),e.log("Workspace App",Frames.Config.get("APP_NAME","N/A"),Frames.Config.get("APP_VERSION","N/A")),e.log(Array(41).join("~")))},toString:function(){return"Frames"},isDebugMode:function(){return!1},get:function(e,t,i,a){var s=Frames.Application.task.id;Frames.isUndef(t)||"object"!=typeof t?"string"==typeof t&&(s=t):s=t.id;var r=Frames.Application.task.view.id;if("object"==typeof i?r=i.id:"string"==typeof i&&(r=i),!(t=Frames.Application._TASKS_[s]))return null;if(!(i=t._VIEWS_.get(r)))return null;var n=Frames.Application.getMainTask().id===s?null:$("#"+s),o=i._OBJS_[e];if(o)a=o;else{var l=i.container();if(Frames.isUndef(a))a=i.modal?$("#"+e.replace(/\$/g,"\\$")+"[data-widget]",l):$("#"+e.replace(/\$/g,"\\$")+"[data-widget]",n);else if(l)if(0===$(l).find("#"+a.attr("id")).length)return null;-1!=e.indexOf("$")&&(e=e.replace(/\$/g,""),a.attr("id",e)),o=Frames.create(e,a,i),a=Frames.isUndef(o)?null:o}return a},create:function(d,e,u,c,p){var m;return Frames.isUndef(c)&&(c=u),e.each(function(e){var t=d,i=$(this);0<e&&(t+=Frames.uuid(),i.attr("id",t)),Frames.isUndef(i.attr("id"))&&i.attr("id",t);var a=i.data("widget"),s=Frames.gettype(a);if(s){0;var r,n=new s(i,p);for(r in i.data())n.props(r,String(i.data(r)));var o=i.children("label");if(!Frames.isUndef(o[0]))for(r in o.data())n.props("label"+r,String(o.data(r)));n.init(u),0===e&&(m=n),n.id=t,c._OBJS_[t]=n;var l=Frames.getplugs(Frames.PLUGIN_WIDGET);for(l.reset();l&&l.hasNext();)l.next().register(n);n._initUserEvents()}else 0===e&&(m=null)}),m},remove:function(e,t,i){var a;"object"==typeof e&&(i||(i=e.view),t||(t=e.task),e=(a=e).id);var s=Frames.Application.task.id;"object"==typeof t?s=t.id:"string"==typeof t&&(s=t);var r=Frames.Application.task.view.id;"object"==typeof i?r=i.id:"string"==typeof i&&(r=i),t=t||Frames.Application._TASKS_[s],i=i||t._VIEWS_.get(r),Frames.isUndef(a)&&!Frames.isUndef(i)&&(a=i._OBJS_[e]),delete i._OBJS_[e]},_destroy_plugins:function(e){var t=Frames.getplugs(Frames.PLUGIN_WIDGET);for(t.reset();t&&t.hasNext();)t.next().unregister(e)},regtype:function(e,t){Frames._TYPES_[e]=t},gettype:function(e){return Frames._TYPES_[e]},gettypes:function(){return Frames._TYPES_},regplug:function(e,t,i){Frames.isUndef(Frames._PLUGS_)&&(Frames._PLUGS_=new Frames.HashMap);var a=Frames._PLUGS_.get(i);Frames.isUndef(a)&&(a=new Frames.HashMap,Frames._PLUGS_.put(i,a)),a.put(e,t)},getplugs:function(e){return Frames._PLUGS_.get(e)},get_widget:function(e){var t=e.data("widget");if(!Frames.isEmpty(t)){var i=Frames.gettype(t);if(!Frames.isUndef(i)){var a=i.prototype.widgetcls.apply({elem:e});if(!Frames.isEmpty(a))return e.data(this.get_fullname(a))}}},get_fullname:function(e){return"ui-"+e},get_frames:function(e){var t=Frames.get_widget(e);if(!Frames.isUndef(t)){if($.isFunction(t.input))return t.input().data("frames");if(!Frames.isUndef(t.element))return t.element.data("frames")}},get_cnt:function(e,t){return Frames.isUndef(t)&&(Frames.Application.isWorkspaceView(e.view.id)||(t=e.view.container())),t},elems:function(e,t){return Frames.isUndef(t)&&(t=Frames.get_cnt(e,t)),$("div,button,fieldset,ul",t).filter("[data-widget]")},elems_finder:function(e,t){Frames.isUndef(t)&&(t=Frames.get_cnt(e,t)),Frames.isUndef(t)&&(t=$("body")),t=t.jquery?t:$(t);var i=Frames._elems_finder_recursive(e,t);return $(i)},_elems_finder_recursive:function(e,t){var i=[];if(!Frames.isVisible(t,e))return i;var a,s=t.children();for(a=0;a<s.length;a++){var r=s.eq(a),n=r.data("widget");if(Frames.isUndef(n)){var o=Frames._elems_finder_recursive(e,r);0<o.length&&(i=i.concat(o))}else if("object"!=typeof r.data("frames")&&i.push(r.get(0)),-1!=n.indexOf("panel")){if("tabpanel"==n){if(!Frames.isVisible(r,e))continue;var l=r.children(".ui-tabpage:first");0===l.length&&(l=r.children("div:first")),r=l}var d=Frames._elems_finder_recursive(e,r);0<d.length&&(i=i.concat(d))}else if(0<r.children(".ui-widget").length){var u=Frames._elems_finder_recursive(e,r);0<u.length&&(i=i.concat(u))}}return i},ready:function(e){Frames.isUndef(Frames._ready)&&(Frames._ready=jQuery.Callbacks("once memory")),1==arguments.length?Frames._ready.add(e):Frames._ready.fire()},init:function(e,t){Frames.ready(function(){Frames._init(e,t)})},_init:function(e,t){Frames.Log.timeEnd("VIEW_GET"),Frames.browser=$.browsercss._data;var i=Frames.Application.task,a=i.view;if(i.blocks(e),$(this).trigger("afterblockinit",i),!a.initialized){var s;if(Frames.Log.time("INIT_CONTROLS",!0),t)for(s in t)t.hasOwnProperty(s)&&Frames.get(t[s]);else Frames._findAndCreate(i);a.initialized=!0,$(a).triggerHandler("initialized"),Frames.Log.timeEnd("INIT_CONTROLS")}},isVisible:function(e,t){var i="none"!=e.css("display")&&("visible"==e.css("visibility")||"inherit"==e.css("visibility"));if(!i&&!Frames.isUndef(t)&&!Frames.isUndef(e.data("widget"))){var a,s=e.data("block"),r=e.data("member");Frames.isUndef(s)||Frames.isUndef(r)||(a=Frames.find(t.control,"blockCtrl",s),Frames.isUndef(a)||(a=Frames.find(a[0],"item",r),!Frames.isUndef(a)&&a[0].properties&&Frames.isTrue(Frames.Model.attr(a[0].properties[0],"Visible"))&&(i=!0)));var n=t.get(s);if(!Frames.isUndef(n)&&(a=n._ctrinf,!Frames.isUndef(a)&&(a=Frames.findExp(a,"item[@name="+r+"]"),!Frames.isUndef(a)&&a[0].properties))){var o=Frames.Model.attr(a[0].properties[0],"Visible");Frames.isTrue(o)&&(i=!0)}}return i},_findAndCreate:function(o,e,t){var l=!1,d=Frames.isTrue(t),u=Frames.elems_finder(o,e);return(d?u.threadedEach:u.each).apply(u,[function(e){if(!d){if(!Frames.isTrue(Frames.Application.options.designer)&&!Frames.isVisible($(this),o)){0;var t=$(this).data("block"),i=$(this).data("member");return void(Frames.isUndef(t)||Frames.isUndef(i)||o._NOBJS_.put(t+"."+i,{elem:$(this),view:o.view.id}))}0}l=!0;var a=$(this).attr("id"),s=!1;Frames.isEmpty(a)&&(a=Frames.uuid(),$(this).attr("id",a),s=!0);var r=Frames.get(a,void 0,void 0,s?$(this):void 0),n=o.view;Frames.isTrue(n.initialized)&&Frames.isTrue(Frames.Application.options.designer)&&!Frames.isUndef(r)&&0===r.elem.parents(".ui-designer-include").length&&r.design&&r.design(!0),d&&e==u.length-1&&Frames._currentItemAndFocus()}]),l},repaint:function(e,t){var i=Frames.Application.task;Frames.Log.time("REINIT_CONTROLS",!0),Frames._findAndCreate(i,e,!i.isLoading()&&t),i.isLoading()||Frames._currentItemAndFocus(),Frames.Log.timeEnd("REINIT_CONTROLS")},wait:function(e,t){$(this).triggerHandler("wait"),e||(e=_(Frames.Locale.messages.PLEASE_WAIT)),e||(e=""),Frames.isUndef(t)&&(t=1e3),Frames._block_timeout&&clearTimeout(Frames._block_timeout),Frames.isUndef(Frames._block_msg)&&(Frames._block_msg=Frames.StatusBar.message()),Frames.StatusBar.message(e),0===t?$.blockUI({overlayCSS:Frames.Loader.OVERLAY,css:Frames.Loader.BOX,message:$.validator.format(Frames.Loader.PREFIX,e||""),baseZ:9999}):Frames._block_timeout=setTimeout(function(){$.blockUI({overlayCSS:Frames.Loader.OVERLAY,css:Frames.Loader.BOX,message:$.validator.format(Frames.Loader.PREFIX,e||""),baseZ:9999})},t)},waitEnd:function(){Frames.StatusBar.message(Frames._block_msg),clearTimeout(Frames._block_timeout),delete Frames._block_timeout,delete Frames._block_msg,$.unblockUI(),$(this).triggerHandler("waitend")},waiting:function(){return!Frames.isUndef(Frames._block_timeout)},_currentItemAndFocus:function(e,t){if(!Frames.inDesignMode){if(t=!!Frames.isUndef(t),e||(e=Frames.Application.task),t){var i=Frames.isUndef(e.block)?null:e.block.item,a=Frames.Model.attr(e.control,"block"),s=Frames.Model.attr(e.control,"item");if(!e.block||e.block.name!=a||!i||i.member!=s){var r=e.get(a);if(r&&(i=r.get(s)))return e.block=r,e.block.item=i,void Frames.focus()}}var n=$(document.activeElement);n.parent().is(".ui-widget")||n.is(".ui-widget")||Frames.focus()}},isFocused:function(e){var t=e.input()||e.elem,i=document.activeElement;return t[0]===i},focus:function(e,t){if($.isFunction(Frames.focus.callback)){var i=Frames.focus.callback;delete Frames.focus.callback,i(e,t)}else{e||(e=Frames.Application.task);var a=Frames.isUndef(e.block)?null:e.block.item;Frames._focus(e,a,t)}},_focus:function(e,i,a){i&&Frames.later(function(){if(Frames.FocusManager.disabled=!0,Frames.FocusManager._temporaryBringToTop(i),Frames.isFocused(i)||i.focus(),a&&!1===Frames.isTrue(i.props("Valid"))){var e=i.props("ValidationMessage");Frames.isEmpty(e)||Frames.Validation.showError(i,e)}if(!Frames.isUndef(i.block)){var t=i.input();if(t&&t[0])i.block._itemOnFocusChange({target:t}),t.is(":visible")&&(t.select(),"textarea"==i.widgetcls()&&Frames.Config.getbool("SELECT_TEXTAREA_ON_FOCUS",!0)&&t[0].setSelectionRange(0,0))}delete Frames.FocusManager.disabled})},validate:function(e,t){return!(!Frames.isUndef(e)||(e=Frames.Application.current(),!Frames.isUndef(e)))||(Frames.isUndef(t)?Frames.Validation.validate(e):Frames.isUndef(t.props)||!Frames.isTrue(t.props("Navigable"))?Frames.Validation.validateFormat(e):Frames.Validation.validateFocusChange(e,t)===t)},isCurr:function(e){return Frames.Application.current()==e},isTrue:function(e,t){return void 0===e?void 0!==t&&Frames.isTrue(t):"boolean"==typeof e?e:"string"==typeof e&&("true"==e.toLowerCase()||"yes"==e.toLowerCase()||"1"==e)||"number"==typeof e&&1==e},isFalse:function(e){return null!=e&&("boolean"==typeof e?!e:"false"===e.toLowerCase()||"no"===e.toLowerCase()||"0"===e||0===e)},isUndef:function(e){return null==e},isEmpty:function(e){return!!Frames.isUndef(e)||("string"==typeof e?""===$.trim(e):$.isArray(e)?0===e.length:e.constructor==Object&&$.isEmptyObject(e))},uuid:function(){return"frames"+Frames._UUID_++},css:function(e,t){var i={},a=e.attr("style");if(Frames.isUndef(a))return i;var s,r=new Frames.HashMap,n=a.split(";");for(s=0;s<n.length;s++){var o=n[s].split(":");r.put($.trim(o[0].toLowerCase()),$.trim(o[1]))}var l=r.get("height");if(!Frames.isUndef(l)){var d=l.substring(String(parseInt(l,10)).length);l=e.outerHeight(),i.height=l+d}return l=r.get("width"),Frames.isUndef(l)||(i.width=l),l=r.get("font-family"),Frames.isUndef(l)||(i.fontFamily=l),l=r.get("font-size"),Frames.isUndef(l)||(i.fontSize=l),Frames.isTrue(t)&&(l=r.get("top"),Frames.isUndef(l)||(i.top=l),l=r.get("left"),Frames.isUndef(l)||(i.left=l),l=r.get("bottom"),Frames.isUndef(l)||(i.bottom=l),l=r.get("right"),Frames.isUndef(l)||(i.right=l),l=r.get("margin-top"),Frames.isUndef(l)||(i.marginTop=l),l=r.get("margin-left"),Frames.isUndef(l)||(i.marginLeft=l),l=r.get("margin-right"),Frames.isUndef(l)||(i.marginRight=l),l=r.get("margin-bottom"),Frames.isUndef(l)||(i.marginBottom=l),l=r.get("padding-left"),Frames.isUndef(l)||(i.paddingLeft=l),l=r.get("padding-right"),Frames.isUndef(l)||(i.paddingRight=l)),i},time:function(){return(new Date).getTime()},deferred:function(e){0<arguments.length?(Frames.isUndef(Frames._DEFERRED_)&&(Frames._DEFERRED_=[]),Frames._DEFERRED_.push(e)):Frames.isUndef(Frames._DEFERRED_)||(Frames._deferring=!0,Frames.deferred(function(){Frames._DEFERRED_=[],delete Frames._deferring}),$.threadedEach(Frames._DEFERRED_,function(){"function"==typeof this&&this()}))},findExp:function(e,t){return Frames.Model.findExp(e,t)},findTxt:function(e,t,i,a){return Frames.Model.findTxt(e,t,i,a)},find:function(e,t,i,a){return Frames.Model.find(e,t,i,a)},findSingle:function(e,t,i,a){return Frames.Model.findSingle(e,t,i,a)},loadcss:function(r){$.isArray(r)||(r=[r]),$(document.body).css("opacity",0);var n=0,o=$('<div style="display: none" />').appendTo(document.body);$.each(r,function(e,t){var i,a,s=Frames.addversiontourl(t);$('<link rel="stylesheet" type="text/css" href="'+s+'" >').appendTo("head"),i=s,(a=document.createElement("img")).onerror=function(){++n===r.length&&(o.remove(),$(document.body).css("opacity",1))},o.append(a),a.src=i})},loadjs:function(e,t,i,a){$.isArray(e)||(e=[e]),this._loadjs(e,t,i,a)},_scripts:[],_loadjs:function(e,t,i,a){var s={urls:e,callback:t,error:i};if(a&&a.immediate?this._scripts.unshift(s):this._scripts.push(s),!(1<this._scripts.length)){var r=this;!function a(){if(0<(s=r._scripts[0]).urls.length){var e=Frames.addversiontourl(s.urls.shift());$.cachedScript(e).done(function(e){a()}).fail(function(e,t,i){"function"!=typeof s.error||!0===s.error()?a():r._scripts=[]})}else{r._scripts.shift();var t=0!=r._scripts.length;s.callback&&s.callback(),t&&a()}}()}},translate:function(e,i){var a;if(-1!=e.indexOf("@")){var t=e.split("@");e=t[0],a=t[1],i=!1}$(e).each(function(){var e=$(this),t=a?e.attr(a):e.html();Frames.isUndef(t)||Frames.isUndef(t.indexOf)||0===t.indexOf("{")&&(t=_(t.substring(1,t.length-1)),Frames.isTrue(i)?(e.before(t),e.remove()):a?e.attr(a,t):e.html(t))})},addversiontourl:function(e,t){return t||(t=Frames.Config.get("APP_VERSION",Frames.version)),0<=e.indexOf("?v")||(0<=e.indexOf("?")?e+="&v="+t:e+="?v="+t),e},_fixUrl:function(e){return"/"===e.substr(-1)?e.substr(0,e.length-1):e},isAbsoluteUrl:function(e){return!Frames.isEmpty(e)&&("/"==e[0]||/^http[s]?:\/\//i.test(e)||/^data:image\/.*;base64.*/.test(e))},parseUrl:function(e,r){return function(e){if(e&&-1!=e.indexOf("$lang")&&(e=e.replace("$lang",Frames.Locale.lang)),e&&-1!=e.indexOf("$ulang")&&(e=e.replace("$ulang",Frames.Locale.ulang)),e&&-1!=e.indexOf("$webroot")){var t=Frames._fixUrl(Frames.Config.get("ROOT_URL","."));return e.replace("$webroot",t)}if(e&&-1!=e.indexOf("$runtime")){var i=Frames.Config.get("RUNTIME_URL","runtime");return e.replace("$runtime",i)}if(e&&-1!=e.indexOf("$appsroot")){var a=Frames.Config.get("APPS_ROOT",".");return e.replace("$appsroot",a)}if(e&&-1!=e.indexOf("$appname")){var s=Frames.Config.get("APP_NAME",".");return e.replace("$appname",s)}return Frames.isAbsoluteUrl(e)?e:Frames.isEmpty(r)?e:r+"/"+e}(e)},loadapp:function(e,i){var r=this,t=Frames._fixUrl(Frames.Config.get("ROOT_URL","."))+"/app",n=t+"/"+e;Frames.Config.set("APPS_ROOT",t),Frames.Config.set("APP_ROOT",n);var o=Frames.Config.get("APP_CSS_URL"),l=Frames.Config.getbool("APP_CSS_APPEND",!0);$.getJSON(n+"/package.json?t="+(new Date).getTime(),function(s){if(s.frames){var e=s;(s=e.frames).version=e.version}Frames.Config.set("APP_CONFIG",s);var t=Frames.Config.get("LOCALE");Frames.Config.set("APP_NLS_ROOT",$.isArray(s.nls)?s.nls[0]:void 0),Frames.Config.set("APP_VERSION",s.version);Frames.Locale.init(t,function(){var e=["$runtime/css/frames"+(Frames.Locale.formats.IS_RTL?"-rtl":"")+".min.css"],a=function(){!function(e){if(l||Frames.isEmpty(o)){if(s){var t=s.stylesheets;Frames.Locale.formats.IS_RTL&&s["stylesheets-rtl"]&&(t=s["stylesheets-rtl"]),t=e.concat(t),$.isArray(t)&&(t=$.map(t,function(e){return Frames.parseUrl(e,n)}),Frames.isEmpty(o)||t.push(o),Frames.loadcss(t))}}else{var i=e.concat([o]);i=$.map(i,function(e){return Frames.parseUrl(e)}),Frames.loadcss(i)}}(e),$.isFunction(i)&&i()};if(s&&s.scripts){var t=$.map(s.scripts,function(e){return Frames.parseUrl(e,n)});Frames.loadjs(t,function(){if(s.widgets&&0<s.widgets.length){var t=s.widgets.slice(0),i=function(){var e=t.shift();r.loadwidget(Frames.parseUrl(e,n),function(){0<t.length?i():a()})};i()}else a()})}else a()})})},loadwidget:function(a,s){$.getJSON(Frames.addversiontourl(a+"/widget.json"),function(e){if(e&&e.scripts){if(e.stylesheets){var t=e.stylesheets;Frames.Locale.formats.IS_RTL&&e["stylesheets-rtl"]&&(t=e["stylesheets-rtl"]),$.isArray(t)&&(t=$.map(t,function(e){return Frames.parseUrl(e,a)}),Frames.loadcss(t))}if(e.scripts&&$.isArray(e.scripts)){var i=$.map(e.scripts,function(e){return Frames.parseUrl(e,a)});Frames.loadjs(i,function(){$.isFunction(s)&&s()})}else $.isFunction(s)&&s()}})},camelcase:function(e){return e=1<e.length?e.substring(0,1).toUpperCase()+e.substring(1,e.lenght).toLowerCase():e.toUpperCase()},humanize_shortcut:function(e){return $.map(e.split("+"),function(e){return e=-1!==e.indexOf("_")?$.map(e.split("_"),Frames.camelcase).join(""):Frames.camelcase(e)}).join("+")},getqs:function(e){var t,i={},a=e||document.location.href,s=a.indexOf("?");if(-1!==s){var r=a.slice(s+1);if(!Frames.isEmpty(r))for(var n=r.split("&"),o=0;o<n.length;o++)i[(t=n[o].split("="))[0]]=t.length<=2?t[1]||"true":t.slice(1).join("=")}return i},arianotify:function(e){Frames.Workspace&&Frames.Workspace.arianotify&&Frames.Workspace.arianotify(e)},later:function(e){var t=window.requestAnimationFrame;return t||(t=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,t){return window.setTimeout(e,0)}),t(e)},cancelLater:function(e){var t=window.cancelAnimationFrame;t||(t=window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout),t(e)},Loader:{OVERLAY:{backgroundColor:"#fff",opacity:.6,cursor:"default"},BOX:{border:"none",padding:"0",backgroundColor:"transparent",opacity:1,color:"#000",cursor:"default"},PREFIX:'<div class="ui-loader fa fa-spinner fa-pulse"></div><div class="ui-loader-text"></div>'}},window.onerror=function(e,t,i,a){var s="The error was handled by Frames error handler.\n\nError description: \t"+e+"\nPage address: \t"+t+"\nLine number: \t"+i;return Frames.Log.error(s),Frames.waitEnd(),!0},Frames._preventBrowserShortcuts=function(e){Frames.inDesignMode||Frames._ignoreShortcuts(e)||(Frames.Config.haskeys(e)?(e.preventDefault(),Frames._preventBrowserSpecialShortcuts(e,!0)):Frames._preventBrowserSpecialShortcuts(e,!1))},Frames._ignoreShortcuts=function(e){var t=Frames.Keys.string(e);return-1!=["DOWN","UP","RIGHT","LEFT","TAB","SHIFT+TAB"].indexOf(t)},Frames._preventBrowserSpecialShortcuts=function(e,t){if(Frames.isUndef(e))return!1;var i=Frames.Keys.SPECIALEVT[e.keyCode],a=Frames.isUndef(i)?void 0:i.evt;Frames.isUndef(a)||t==i.prevented||(t=!(i.prevented=t),document[a]=function(){return t},window[a]=function(){return t})},document.addEventListener("keyup",function(e){Frames._preventBrowserShortcuts(e)},!0),document.addEventListener("keydown",function(e){Frames._preventBrowserShortcuts(e)},!0),document.addEventListener("click",function(e){2!=e.button&&Frames.Application.trigger("cancelpopups",{event:e})},!0)})(jQuery),function(){var r=this,$=this.jQuery;$.extend({threadedEach:function(e,t,i){i=$.extend({wait:0,after:null},i);var a=0,s=function(){setTimeout(function(){$.isFunction(t)&&a<(e.size&&e.size()||e.length)?(e instanceof $?t.apply($(e).eq(a),[a]):t.apply(e[a],[a]),a++,s()):$.isFunction(i.after)&&i.after.apply(r)},i.wait)};return($.isArray(e)||e instanceof $)&&s(),e}}),$.fn.extend({threadedEach:function(e,t){return $.threadedEach(this,e,t)}})}(),function($){var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};$.extend({escapeHtml:function(e,t){var i=t||a;return String(e).replace(/[&<>"'\/]/g,function(e){return i[e]})},decodeHtml:function(e){return $("<div/>").html(e).text()},encodeJSON:function(e,t){switch(typeof e){case"string":e=e.replace(/"/g,'"').replace(/\\/g,"\\\\");break;case"number":break;case"object":$.isPlainObject(e)||(e="");break;default:e=""}return e}})}(jQuery),function($){$.cachedScript=function(e,t){return t=$.extend(t||{},{dataType:"script",cache:!0,url:e}),$.ajax(t)}}(jQuery),function(){var e;function n(){return void 0===e&&(e=Frames.Config.getclass("FRAMES_MODEL_CLASS",Frames.Model.SOAP)),e}Frames.Model={create:function(e,t,i){return n().create(e,t,i)},find:function(e,t,i,a){var s=Frames.Log.time("JSON_FIND",!0);if(Frames.isUndef(e))return Frames.Log.timeEnd("JSON_FIND",s),null;var r=n().find(e,t,i,a);return Frames.Log.timeEnd("JSON_FIND",s),r},findSingle:function(e,t,i,a){return n().findSingle(e,t,i,a)},findExp:function(e,t){var i=Frames.Log.time("JSON_FIND",!0);if(Frames.isUndef(e))return Frames.Log.timeEnd("JSON_FIND",i),null;var a=n().findExp(e,t);return Frames.Log.timeEnd("JSON_FIND",i),a},findTxt:function(e,t,i,a){var s=n().find(e,t,i,a);return Frames.Model.text(s)},text:function(e){return n().text(e)},value:function(e){return n().value(e)},name:function(e){return n().name(e)},append:function(e,t,i){n().append(e,t,i)},attr:function(e,t,i){if(2===arguments.length)return n().attr(e,t);3===arguments.length&&n().attr(e,t,i)},children:function(e,t){return n().children(e,t)},hasChildren:function(e){return n().hasChildren(e)},keys:function(e){return n().keys(e)},encode:function(e,t){return n().encode(e,t)},createBlock:function(e){return Frames.Model.create("block",void 0,{name:e})},createRecord:function(e){return Frames.Model.create("record",void 0,Frames.isUndef(e)?null:{id:e})},createItem:function(e,t){return Frames.Model.create("item",t,{name:e})},createAlert:function(e,t){var i=Frames.Model.create("alert",void 0,{name:e}),a=Frames.Model.create("selected",t);return Frames.Model.append(i,a),i}}}(),Frames.Model.SOAP={create:function(e,t,i){var a,s=new SOAPObject(e);if(i)for(a in i){var r=i[a];s.attr(a,r)}return null===t&&Frames.isTrue(Frames.Application._supportnulls)?s.attr("isnull","true"):t&&s.val(Frames.Model.encode(t)),s},find:function(e,t,i,a){var s=null;if(Frames.Application._json_indexing){var r,n=e[t];if(Frames.isUndef(n))return Frames.Log.timeEnd("JSON_FIND",idx),s;if(Frames.isUndef(n._indexed)||Frames.isTrue(a))for(n._indexed={},r=0;r<n.length;r++){var o=n[r],l=o.attr("name");n._indexed[l]=o}if(!Frames.isUndef(i)&&!Frames.isUndef(n._indexed)){var d=n._indexed[i];Frames.isUndef(d)||(s=[d])}}else s=e[t]?e.find(t+"[@name="+i+"]"):s;return s},findSingle:function(e,t,i,a){if(a=a||"@name",e&&e[t]){var s,r=e[t];for(s=r.length-1;0<=s;s--)if(r[s][a]===i)return r[s]}return null},findExp:function(e,t){return e.find(t)},text:function(e){return e?Array.isArray(e)?e[0].Text:e.Text:null},value:function(e){return e?e.val():null},name:function(e){return e?e.name:null},append:function(e,t,i){Frames.isUndef(e)&&Frames.isUndef(t)||e.appendChild(t)},attr:function(e,i,t){var a;if(2===arguments.length)return e instanceof SOAPObject?$.each(e.attributes,function(e,t){if(t.name==i)return a=t.value,!1}):a=e.attr(i),a;3===arguments.length&&e.attr(i,t)},children:function(e){return e.children},hasChildren:function(e){return e.hasChildren()},keys:function(e){var t=Object.getOwnPropertyNames(e);return $.map(t,function(e){return 0===e.indexOf("@")?e.substring(1):void 0})},encode:function(e,t){switch(typeof e){case"string":e=e.replace(/\&/g,"&amp;").replace(/</g,"&lt;"),t&&(e=(e=e.replace(/\"/g,"&quot;")).replace(/(?:\r\n|\r|\n)/g,"&#10;"));break;case"number":e=String(e);break;case"object":e=$.isPlainObject(e)?Frames.Model.encode(JSON.stringify(e),!0):"";break;default:e=""}return e}},Frames.Model.JSON={create:function(e,t,i){var a,s={};if(s.__name__=e,i)for(a in i){var r=i[a];s["@"+a]=r}return null===t&&Frames.isTrue(Frames.Application._supportnulls)?s.isnull=!0:t&&(s.value=t),s},find:function(e,t,i,a){var s=null;if(Frames.Application._json_indexing){var r,n=e[t];if(Frames.isUndef(n))return Frames.Log.timeEnd("JSON_FIND",idx),s;if(Frames.isUndef(n._indexed)||Frames.isTrue(a))for(n._indexed={},r=0;r<n.length;r++){var o=n[r],l=o.attr("name");n._indexed[l]=o}if(!Frames.isUndef(i)&&!Frames.isUndef(n._indexed)){var d=n._indexed[i];Frames.isUndef(d)||(s=[d])}}else s=e[t]?this.findExp(e,t+"[@name="+i+"]"):s;return s},findSingle:function(e,t,i,a){if(a=a||"@name",e&&e[t]){var s,r=e[t];for(s=r.length-1;0<=s;s--)if(r[s][a]===i)return r[s]}return null},findExp:function(e,t){for(var i,a=null,s=e,r=0,n=t.split("/"),o=n.length-1;r<=o;r++)if(i=n[r],r==o){var l=i.match(/\[(.+)=/);if(Frames.isUndef(l))a=Array.isArray(s)?s[0][i]:s[i];else{s=s[i.match(/(.*)\[/)[1]];var d=0;if(!Frames.isUndef(s))for(;d<s.length;d++){var u=s[d],c=u[l[1]];if(void 0!==c){var p=i.match(/\[.*=(.+)\]/);(Frames.isUndef(p)||p[1]===c)&&(Frames.isUndef()&&(a=[]),a.push(u))}}}}else if(s=s[i],Frames.isUndef(s))break;return a},text:function(e){return e?Array.isArray(e)?e[0].value:e.value:null},value:function(e){return e?e.value:null},name:function(e){return e?e.__name__||void 0:null},append:function(e,t,i){if(!Frames.isUndef(e)||!Frames.isUndef(t)){var a=i||t.__name__;Frames.isUndef(e[a])&&(e[a]=[]),e[a].push(t),t.hasOwnProperty("__name__")&&delete t.__name__}},attr:function(e,t,i){if(!Frames.isUndef(e)&&!Frames.isEmpty(t))return 2===arguments.length?e["@"+t]:void(3===arguments.length&&(e["@"+t]=i))},children:function(e,t){var i={};return $.each(e,function(e,t){($.isPlainObject(t)||$.isArray(t))&&(i[e]=t)}),t&&(i=$.map(i,function(e,t){return e})),i},hasChildren:function(e){var i=!1;return $.each(e,function(e,t){if($.isPlainObject(t)||$.isArray(t))return!(i=!0)}),i},keys:function(e){return Object.getOwnPropertyNames(e)},encode:function(e,t){return e=$.encodeJSON(e,t)}},function($,o){o.Locale={init:function(i,a){var s=o.Config.get("RUNTIME_URL","runtime"),r=s+"/js/frames/locale",e=o.Config.get("APP_NAME"),t=o.Config.get("APP_ROOT","app");if(void 0!==e){var n=o.Config.get("APP_NLS_ROOT","nls");r=o.parseUrl(n,t)}$.getJSON(o.addversiontourl(r+"/config.json"),function(e){if(o.Locale._default_locale=e.default,o.Locale._accepted_locales=e.locales,i=o.Locale.accepted(i),o.Locale.lang=i,o.Locale.ulang=i,o.Config.set("LOCALE",i),!o.isUndef(i)&&-1!=i.indexOf("-")){var t=i.split("-");o.Locale.ulang=t[0]+"-"+t[1].toUpperCase()}o.Locale._after_config(s,r,i,a)})},accepted:function(e){if(e=e?e.toLowerCase():o.Locale._default_locale,-1==$.inArray(e,o.Locale._accepted_locales)){var t=e.split("-");e=-1!=$.inArray(t[0],o.Locale._accepted_locales)?t[0]:o.Locale._default_locale}return e},_after_config_callback:function(e){$("html").attr("lang",e).attr("dir",o.Locale.formats.IS_RTL?"rtl":"ltr")},_after_config:function(e,t,i,a){var s=a;a=function(){$.isFunction(s)&&s(),o.Locale._after_config_callback(i),o.Application.trigger("locale",{lang:i})},"en"!=i?($.datepicker.setDefaults($.datepicker.regional[o.Locale.ulang]),o.loadjs([t+"/"+i+"/calculator.js",t+"/"+i+"/validation.js",t+"/"+i+"/messages.js",t+"/"+i+"/formats.js"],a)):o.isEmpty(i)?$.isFunction(a)&&a():($.datepicker.setDefaults($.datepicker.regional[""]),o.loadjs([t+"/"+i+"/messages.js",t+"/"+i+"/formats.js"],a))},get:function(e){var t=o.Locale.messages[e];if(o.isUndef(t))t=e;else{var i=$.makeArray(arguments);i.shift(),t=$.validator.format.apply($.validator,[t,i])}return t},messages:{INIT:"initializing",TASK_NOT_FOUND:"task '%s' not found!",VIEW_NOT_FOUND:"view '%s' not found!",VIEW_NOT_RETURNED:"no view returned from server!",APPLICATION_MESSAGE:"Application Message",NO_MESSAGE_RETURNED:"no message returned from server!",SESSION_TIMEOUT:"Your session has expired. Please login again to continue."},formats:{DECIMAL_SEPARATOR:".",GROUP_SEPARATOR:",",CURRENCY_SYMBOL:"$",DATE_FORMAT:"dd/MM/yyyy",TIME_FORMAT:"hh:mm a",INTEGER_FORMAT:"##########",NUMBER_FORMAT:"##########D###############",CURRENCY_FORMAT:"L#G###G###G###D###############",INTEGER_FORMAT_VALIDATOR:"^([^09#GD\\.,]*)([\\$L09#G]*)([^09#G,\\.]*)$",NUMBER_FORMAT_VALIDATOR:"^([^09#GD\\.,]*)([09#G,]*)([D\\.]{0,1})([09#]*)([^09#G,\\.]*)$",DEFAULT_CALENDAR:"gregorian",CALENDARS:["gregorian"],IS_RTL:!1,DATE_IS_RTL:!0}},_=o.Locale.get}(jQuery,Frames),function($,c){c.Dialog=$.inherit({},{ICON_ERROR:"ui-icon-alert",ICON_DEFAULT:"ui-icon-highlight",container:function(e){var t=(e=e||{}).container||(c.Application._container?c.Application._container.parent():void 0);return void 0===t&&(t=$(document.body)),t},show:function(e,t,i,a){c.isUndef(a)&&((a={})[_(c.Locale.messages.OK)]=function(){c.Dialog.close(this),c.focus()}),"string"==typeof e&&(e=e.replace(/[ ]+/g,"&#160;")),c.Template.transform('<div><div title="{{=data.title}}"><p><span class="ui-icon {{=data.icon}}" style="float:left; margin:0 7px 50px 0;"></span><span class="ui-message">{{=data.message}}</span></p></div></div>',{title:e,message:t,icon:i}).dialog({modal:!0,resizable:!1,autoResize:!0,width:"auto",closeOnEscape:!1,open:function(e,t){$(".ui-dialog-titlebar-close",t.dialog).hide()},buttons:a})},_resizable_fn:function(){return!!c.Config.getbool("POPUP_RESIZE")},open:function(e,t,i){var u=c.Dialog.container(i),a={appendTo:u,modal:!0,resizable:this._resizable_fn(),autoOpen:!1,autoResize:!0,width:"auto",closeOnEscape:!0,title:e,closeText:c.Locale.get("BUTTON_CLOSE"),create:function(e,t){$(this).data("taskId",c.Application.task.id),$(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").on("click",function(e){c.Application.valexec("WHEN-WINDOW-CLOSED")}),c.Locale.formats.IS_RTL?$(".ui-dialog-title").css("margin-left",10):$(".ui-dialog-title").css("margin-right",10)},open:function(e,t){var i=$(this).closest(".ui-dialog"),a=c.Application.getTask($(this).data("taskId")),s=a.control.windowCtrl&&a.control.windowCtrl[0],r=!1;s&&s.properties&&s.properties[0]&&(r="true"==c.Model.attr(s.properties[0],"CloseButton")),r?$(".ui-dialog-titlebar-close",i).show():$(".ui-dialog-titlebar-close",i).hide(),$(this).show(),c.repaint(t.dialog),$(a.view).triggerHandler("initialized"),i.draggable({containment:u});var n=$(".ui-view-window",i).css("z-index",i.css("z-index"));if(c.Dialog._resizable_fn()){var o=n[0];if(!c.isUndef(o)){var l=n[0].style.width;c.isEmpty(l)||"100%"===l||(i.css("width",l),n.find("> .ui-panel").css("width","100%"),n.css("width","100%"))}}var d=$(this);if(c.Dialog.center(d),"ie9"!=$.browsercss()[1]){$(window).on("resize",function(){if(d.parent().height()>u.height()){var e=d.parent().height()-.9*u.height(),t=$(".ui-view-window",this).height()-e;$(".ui-view-window",this).css("height",t)}c.Dialog.center(d)}),c.Dialog._resizable_fn()&&d.parent().resizable({resize:function(){c.isEmpty(l)||(n.parent().css("width","100%"),n.find("> .ui-panel").css("width","100%"))},stop:function(){c.Dialog.center(d)}})}},beforeClose:function(e,t){var i=c.Dialog.container(t);if(27==e.which){if(!$(e.target).closest(".ui-dialog").find(".ui-dialog-titlebar-close").is(":visible"))return!1;c.Application.valexec("WHEN-WINDOW-CLOSED")}i.find(".ui-widget-overlay").last().css("z-index","")}};c.isUndef(i)||$.extend(a,i);var s=$('<div><div title=""></div></div>');return c.isEmpty(t)||s.html(t),s.dialog(a),s},load:function(e,t,i,a){var s=this,r=c.Dialog.open(e,void 0,a),n=c.Application.isLovView(t);return r.load(t,function(e,t){r.prepend('<span class="ui-helper-hidden-accessible" aria-hidden="true"><input type="text"/></span>'),n||r.dialog("open"),i(e,t),s.center(r),n||"ie9"==$.browsercss()[1]&&$(this).dialog("option","width",$(this).dialog().width())}),r},close:function(e){$(window).off("resize",this._resize_handler),$(e).dialog("close").dialog("destroy").remove()},center:function(e){var t=c.Dialog.container();e.dialog("option","position",{my:"center",at:"center",of:t})}}),$.extend($.expr[":"],{xtabbable:$.noop}),$.ui.dialog.prototype.open=function(){if(!this._isOpen){var e=this,t=e.options,i=e.uiDialog;return e._size(),e._position(t.position),e._createOverlay(),i.show(t.show),e.moveToTop(!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),t.modal&&i.bind("keydown.ui-dialog",function(e){if(e.keyCode===$.ui.keyCode.TAB){var t=$(":xtabbable",this),i=t.filter(":first"),a=t.filter(":last");return e.target!==a[0]||e.shiftKey?e.target===i[0]&&e.shiftKey?(a.focus(1),!1):void 0:(i.focus(1),!1)}}),$(e.element.find(":xtabbable").get().concat(i.find(".ui-dialog-buttonpane :xtabbable").get().concat(i.get()))).eq(0).focus(),e._isOpen=!0,this.opener=$($.ui.safeActiveElement(this.document[0])),e._trigger("open"),e}}}(jQuery,Frames),function($,u){u.ToolBar=$.inherit({},{init:function(e){u.ToolBar._elem=e,$("button, a",e).each(function(){var e=$(this);e.hasClass("btn")&&e.button()}).on("click",function(){if($(this).hasClass("ui-state-disabled"))return!1;var e=$(this).data("action");if(u.isUndef(e))return u.ToolBar.execbtn($(this)),!1;u.Application.valexec(e)}),u.Application.on("refresh",u.ToolBar.refresh),u.ToolBar.refresh()},paging:function(){return u.isUndef(u.Application.task.block)||u.isUndef(u.Application.task.block.paging)?null:u.Application.task.block.paging},execbtn:function(e){var t=u.ToolBar.paging();if(!u.isUndef(t)){if(e.hasClass("ui-state-disabled"))return;var i=e.data("page");if(!u.isUndef(i))switch(i){case"first":t.first();break;case"prev":t.previous();break;case"next":t.next();break;case"last":t.last()}}},refresh:function(){if(!u.isUndef(u.ToolBar._elem)){var e=u.ToolBar._elem;if(u.inDesignMode)e.find("button").addClass("ui-state-disabled");else{e.find("button").removeClass("ui-state-disabled");var t={paging:u.ToolBar.pagingRules(e),workspace:u.ToolBar.workspaceRules(e)};u.ToolBar.customRules!==$.noop?u.ToolBar.customRules(e,t):u.Application.trigger("toolbarrefresh",t)}}},pagingRules:function(e){e.find(".paging button,.paging a").addClass("ui-state-disabled");var t=u.ToolBar.paging(),i={};if(!u.isUndef(t)){var a=u.Application.task!=u.Application.mainTask,s={canGotoFirst:a&&0!==t.size&&1<t.number,canGotoLast:a&&0!==t.size&&t.number!=t.pages,canGotoPrev:a&&0!==t.size&&1<t.number,canGotoNext:a&&0!==t.size&&t.number<t.pages};0<e.find("[data-page]").length&&(s.canGotoFirst&&e.find("[data-page=first]").removeClass("ui-state-disabled"),s.canGotoLast&&e.find("[data-page=last]").removeClass("ui-state-disabled"),s.canGotoNext&&e.find("[data-page=next]").removeClass("ui-state-disabled"),s.canGotoPrev&&e.find("[data-page=prev]").removeClass("ui-state-disabled")),i=s}return i},workspaceRules:function(e){e.find(".general button, .general a").addClass("ui-state-disabled"),e.find("#tb-csearch").hide();var t,i=0;if(!u.isUndef(u.Application._TASKS_))for(t in u.Application._TASKS_)i++;if(!(i<=1)){var a={},s=!1,r=u.Application.task,n=r.get("TOOLBAR");if(u.isUndef(n)||(s=u.isTrue(n.get("IMPRIMIR"))),n=r.block,!u.isUndef(n)){var o=n.props("blockMode");(a={canAdd:u.isTrue(n.props("AllowInsert"))&&"SEARCH"!==o&&"READ"!==o,canDelete:u.isTrue(n.props("AllowDelete"))&&"SEARCH"!==o&&"READ"!==o,canCopy:u.isTrue(n.props("AllowInsert"))&&"SEARCH"!==o&&"READ"!==o,canSave:!0,canPrint:s,canClear:"READ"!==n.props("blockMode"),canSearch:u.isTrue(n.props("AllowSearch")),canFilter:u.isTrue(n.props("AllowSearch"))&&"SEARCH"!==o,canGoNext:!0,canGoPrev:!0,canExit:!0,canHelp:!0}).canSearch&&e.find("#tb-search").removeClass("ui-state-disabled"),a.canClear&&e.find("#tb-record-clear").removeClass("ui-state-disabled"),a.canClear&&e.find("#tb-block-clear").removeClass("ui-state-disabled"),a.canSave&&e.find("#tb-record-save").removeClass("ui-state-disabled"),a.canAdd&&e.find("#tb-record-add").removeClass("ui-state-disabled"),a.canDelete&&e.find("#tb-record-remove").removeClass("ui-state-disabled"),a.canPrint&&e.find("#tb-print").removeClass("ui-state-disabled"),a.canGoNext&&e.find("#tb-record-next").removeClass("ui-state-disabled"),a.canGoPrev&&e.find("#tb-record-prev").removeClass("ui-state-disabled"),a.canGoNext&&e.find("#tb-block-next").removeClass("ui-state-disabled"),a.canGoPrev&&e.find("#tb-block-prev").removeClass("ui-state-disabled"),a.canExit&&e.find("#tb-exit").removeClass("ui-state-disabled"),a.canHelp&&e.find("#tb-help").removeClass("ui-state-disabled")}if(!u.isUndef(u.Application.task.block)&&!u.isUndef(u.Application.task.block._props)&&!u.isUndef(u.Application.task.block._props.blockMode)){var l="",d="";"SEARCH"==u.Application.task.block._props.blockMode?(l="icon-filter",d="EXECUTE_QUERY",e.find("#tb-csearch").removeClass("ui-state-disabled").show()):(l="icon-search",d="SEARCH"),e.find("#tb-search").removeClass("ui-state-disabled").data("action",d).find("i").removeClass("icon-search icon-filter").addClass(l)}return a}},customRules:$.noop})}(jQuery,Frames),function($,i){i.StatusBar=$.inherit({},{init:function(e){i.Locale.formats.IS_RTL&&e.children(".row-fluid").each(function(){var e=$(this),t=e.children();e.append(t.get().reverse())}),i.Application.on("taskclose",i.StatusBar.reset),i.StatusBar._elem=e,i.StatusBar._msgEl=e.find(".msg"),i.StatusBar._recEl=e.find(".rec"),i.StatusBar._ctxEl=e.find(".ctx"),i.StatusBar._infEl=e.find(".inf"),i.StatusBar.message("...")},isInitialized:function(){return!i.isUndef(i.StatusBar._elem)},reset:function(){i.StatusBar.message(""),i.StatusBar.context(""),i.StatusBar.info(""),i.StatusBar.record("")},_text:function(e,t){i.isUndef(e)||((i.isUndef(t)||i.isEmpty(t))&&(t="&#160;"),e.html(t))},message:function(e){if(0===arguments.length)return i.isUndef(i.StatusBar._msgEl)?"":i.StatusBar._msgEl.text();i.StatusBar._text(i.StatusBar._msgEl,e)},context:function(e){i.StatusBar._text(i.StatusBar._ctxEl,e)},info:function(e){i.StatusBar._text(i.StatusBar._infEl,e)},record:function(e){i.StatusBar._text(i.StatusBar._recEl,e)}})}(jQuery,Frames),function($,u){u.Logger=$.inherit({__constructor:function(e,t){this._objOrName=e.toString(),this._level=u.isUndef(t)?u.Logger.LEVEL_DEBUG:t},toString:function(){return"Frames.Logger"},debug:function(){this.__log__(u.Logger.LEVEL_DEBUG,arguments)},info:function(){this.__log__(u.Logger.LEVEL_INFO,arguments)},error:function(){this.__log__(u.Logger.LEVEL_ERROR,arguments)},getLevelName:function(e){switch(e){case u.Logger.LEVEL_DEBUG:return"DEBUG";case u.Logger.LEVEL_INFO:return"INFO";case u.Logger.LEVEL_ERROR:return"ERROR";default:return"UNKNOWN"}},time:function(e,t,i,a){var s=u.Logger._getConsole();if(u.isTrue(t)){if(null===u.Logger._MONITOR_){var r=new u.HashMap,n=r.clear;r.clear=function(){var a=this,s=[];$.each(["GET_MODEL","GET_MODEL_BLOCK"],function(e,t){var i=a.get(t);i&&s.push(i)}),n.apply(this,arguments),$.each(s,function(e,t){t.clear=!0,a.put(t.name,t)})},u.Logger._MONITOR_=r}var o=u.Logger._MONITOR_.get(e);return!u.isUndef(o)&&o.clear&&(u.Logger._MONITOR_.remove(e),o=void 0),u.isUndef(o)?(u.Logger._MONITOR_.put(e,{name:e,tname:a,start:u.isUndef(i)?u.time():i,end:null,count:1,times:[]}),0):(o.count++,o.times.push({start:u.time(),end:null,name:a}),o.times.length)}u.isUndef(i)&&void 0!==s&&void 0!==s.time&&s.time(this._objOrName+": "+e)},timeEnd:function(e,t){var i=u.Logger._getConsole(),a=u.isUndef(u.Logger._MONITOR_)?null:u.Logger._MONITOR_.get(e);if(u.isUndef(a))void 0!==i&&void 0!==i.timeEnd&&i.timeEnd(this._objOrName+": "+e);else if(1==a.count)a.end=u.time();else try{a.times[t-1]||(t=a.times.length),a.times[t-1].end=u.time()}catch(e){}},timeAdd:function(e,t){this.time(e,!0,t),this.timeEnd(e)},timeRemove:function(e){u.Logger._MONITOR_.remove(e)},__log__:function(){var e=u.Logger._getConsole(),t=arguments[0];if(this._level>=t){var i=arguments[1],a=Array.prototype.slice.apply(i,[1]);if(i=(i=["[%s] %s - "+i[0],this.getLevelName(t),this._objOrName]).concat(a),void 0!==e)try{switch(t){case u.Logger.LEVEL_DEBUG:void 0!==e.debug&&e.debug.apply(e,i);break;case u.Logger.LEVEL_INFO:void 0!==e.info&&e.info.apply(e,i);break;case u.Logger.LEVEL_ERROR:void 0!==e.error&&e.error.apply(e,i);break;default:void 0!==e.log&&e.log.apply(e,i)}}catch(e){}}}},{_MONITOR_:null,_getConsole:function(){return window.console},monitor:function(){return u.Logger._MONITOR_},gmonitors:function(){var e={},t=u.Logger._MONITOR_;if(!u.isUndef(t)&&0<t.size())for(t.reset();t.hasNext();){var i=t.next(),a=-1;if(1==i.count)a=u.isUndef(i.end)?-1:i.end-i.start,e[i.name]={time:$.isNumeric(a)&&0<=a?a:0,count:i.count};else{var s;for(s=0;s<i.times.length;s++){var r=i.times[s];a+=r.end-r.start}e[i.name]={time:$.isNumeric(a)&&0<=a?a:0,count:i.count}}}return e},pmonitors:function(e){var t=u.Logger._MONITOR_;if(!u.isUndef(t)&&0<t.size())for(t.reset();t.hasNext();){var i=[],a=t.next(),s=u.isUndef(a.end)?-1:a.end-a.start,r=e&&void 0!==a.tname;if(1<a.count){var n,o=a.tname?a.tname:"1 of "+a.count;for(!0===r&&i.push(" >> "+o+" = "+s+"ms"),n=0;n<a.times.length;n++){var l=a.times[n],d=l.end-l.start;s+=d,o=l.name?l.name:n+2+" of "+a.count,!0===r&&5<d&&i.push(" >> "+o+" = "+d+"ms")}}!0===r&&0<i.length&&i.length}},LEVEL_NONE:0,LEVEL_DEBUG:3,LEVEL_INFO:2,LEVEL_ERROR:1}),u.Log=new u.Logger(u)}(jQuery,Frames),function($,O){O.Service=$.inherit({logger:new O.Logger("Frames.Service"),__constructor:function(e,t){this.successCallback=e,this.errorCallback=t,this._executing=!1},toString:function(){return"Frames.Service"},executing:function(){return this._executing},getTestUrl:function(){return O.Config.getbool("USE_STATUS_ENDPOINT",!1)?O.Service.SERVICE_URL.substring(0,O.Service.SERVICE_URL.indexOf("message/"))+"status":O.Service.SERVICE_URL.substring(0,O.Service.SERVICE_URL.length-1)+".wsdl"},_get_request:function(e,t,i,a,s,r,n,o){var l=new SOAPObject("MessageRequest");l.ns=new SOAPClient.Namespace("tns",O.Config.get("MESSAGE_NS","urn:schemas:morphis:message"));var d=new SOAPObject("header"),u=new SOAPObject("control"),c=new SOAPObject("action"),p=new SOAPObject("body");if(l.appendChild(d),d.appendChild(u),u.appendChild(c),l.appendChild(p),u.attr("isSuspended","false").attr("modal","false").attr("isChanged","false"),!O.isUndef(t)&&(u.attr("task",t.id),O.isUndef(t.block)||O.isUndef(t.block.item)||u.attr("item",t.block.item.member).attr("block",t.block.name),!O.isUndef(t.view))){var m=t.view.controlInfo();O.Model.hasChildren(m)&&O.Model.append(u,m)}if(r=!!O.isUndef(r)||O.isTrue(r),$.isPlainObject(e)){var h,f=e;for(h in e=f.name,f.params){var g=f.params[h],_=new SOAPObject("parameter");$.isFunction(g)||(_.attr("datatype",g.type).attr("value",g.value).attr("name",g.name),c.appendChild(_))}}var v=O.Logger.monitor();if(!O.isUndef(v)&&0<v.size()){var b=["CLIENT="+$.browsercss()[1]];for(v.reset();v.hasNext();){var F=v.next(),y=-1;if(1==F.count)y=O.isUndef(F.end)?-1:F.end-F.start,b.push(F.name+"="+y);else{var w;for(w=0;w<F.times.length;w++){var C=F.times[w];y+=C.end-C.start}b.push(F.name+"="+y),b.push(F.name+"_COUNT="+F.count)}}v.clear();var x=new SOAPObject("monitorInfo");if(x.attr("data",b.join(";")),!O.isUndef(t)){var k=t.request.attr("reqId");O.isUndef(k)||x.attr("reqId",k)}u.appendChild(x)}var T,E,A=O.Config.getaction_name(e),D=!1,I=!1,S=!1;(O.isUndef(A)||(O.isUndef(A.taskValidation)||(D=O.isTrue(A.taskValidation)),O.isUndef(A.validateNewRow)||(I=O.isTrue(A.validateNewRow)),O.isUndef(A.recordValidation)||(S=O.isTrue(A.recordValidation))),c.attr("validateNewRow",I).attr("taskValidation",D).attr("recordValidation",S).attr("validation",r).attr("kind",O.isUndef(n)?"Action":n).attr("name",e),s&&c.attr("item",s),a&&c.attr("block",a),o)&&(O.Application.options.wsmode&&((T=new SOAPObject("parameter")).attr("name","MODE"),T.attr("value",O.Application.options.wsmode),c.appendChild(T)),O.Application.options.wstask&&((T=new SOAPObject("parameter")).attr("name","START_TASK"),T.attr("value",O.Application.options.wstask),c.appendChild(T)));if(void 0!==i&&i.hasChildren())for(E=0;E<i.children.length;E++)p.appendChild(i.children[E]);return l},execute:function(e,t,i,a,s,r,n){if(this._executing)return!1;this._executing=!0,this.logger.time("SERVICE"),O._service=O.time();try{var o=this._get_request(e,t,i,a,s,r,n),l=new SOAPRequest(O.Service.SERVICE_ACTION,o);l.addNamespace("xs","http://www.w3.org/2001/XMLSchema"),l.addNamespace("xsi","http://www.w3.org/2001/XMLSchema-instance"),$.support.cors=!0,SOAPClient.Proxy=O.Service.SERVICE_URL,l=this.processRequest(l),SOAPClient.SendRequest(l,$.proxy(this.processResponse,this),$.proxy(this.processError,this))}catch(e){this.processError("",e.message)}},processRequest:function(e){return e},parseResponse:function(e){return $.xmlToJSON(e)},processResponse:function(e,t,i){this.logger.timeAdd("SERVICE",O._service),delete O._service,this._executing=!1,this.logger.time("MESSAGE",!0);var a=$.xmlToJSON(e||"<bogus />");this.logger.timeEnd("MESSAGE"),$.isFunction(this.successCallback)&&this.successCallback(a&&a.Body?a.Body[0].MessageResponse[0]:void 0)},processError:function(e,t,i){this.logger.timeAdd("SERVICE",O._service),delete O._service,this._executing=!1,$.isFunction(this.errorCallback)&&this.errorCallback(t)}},{SERVICE_URL:"/services/message/",SERVICE_ACTION:'""'})}(jQuery,Frames),function($){Frames.ServiceMVC=$.inherit(Frames.Service,{__constructor:function(e,t){Frames.Service.prototype.__constructor.apply(this,[e,t]);var i={"morphis/frames/workspace/ViewWorkspaceWindow":!0,"morphis/frames/workspace/ViewLoginSimple":!0,"morphis/frames/workspace/EditDialog":!0,"morphis/frames/workspace/EditorDialog":!0,"morphis/frames/workspace/LOVDialog":!0};Frames.View.mapView;Frames.View.mapView=function(e){return i[e]?"views/"+e+".html":Frames.ServiceMVC.getServicePath()+"/App/GetView?view="+e},this._viewCache=Frames.Config.getbool("VIEW_CACHE")},toString:function(){return"Frames.ServiceMVC"},getTestUrl:function(){},execute:function(e,t,i,a,s,r,n){if(this._executing)return!1;this._executing=!0,this.logger.time("SERVICE"),Frames._service=Frames.time();try{var o;if($.isPlainObject(e))o=e.name;else o=e;var l="MV:INITAPP"==o,d=0<=o.indexOf("/")||0<=o.indexOf("."),u=0<=o.indexOf("http:"),c=this._get_request(e,t,i,a,s,r,n,l);0,$.support.cors=!0;var p=null;if(d){p=u?o:Frames.ServiceMVC.getServicePath()+o,ajaxType=u?"GET":"POST";$.ajax({type:ajaxType,url:p,data:null,contentType:"application/json; charset=utf-8",success:$.proxy(this.processContentResponse,this),error:$.proxy(this.processError,this)})}else{p=Frames.Service.SERVICE_URL,o=o.replace(/:/g,"$"),l||(p=p+"/"+o),ajaxType="POST";var m=this.processRequest(c);$.ajax({type:ajaxType,url:p,dataType:"xml",processData:!1,data:m,success:$.proxy(this.processResponse,this),error:$.proxy(this.processError,this)})}}catch(e){this.logger.timeAdd("SERVICE",Frames._service),delete Frames._service,$.isFunction(this.errorCallback)&&this.errorCallback(e.message)}},processRequest:function(e){return e.toString()},processContentResponse:function(e,t,i){var a=i.responseText,s=Frames.Application.task;s._container.children().remove(),s._container.append(a),Frames.waitEnd()},parseResponse:function(e){return $.xmlToJSON(e)},processResponse:function(e,t,i){if(this.logger.timeAdd("SERVICE",Frames._service),delete Frames._service,this._executing=!1,this.logger.time("MESSAGE",!0),!this._viewCache&&null!==Frames.Application.task){var a=Frames.Application.task.view;null===a||Frames.Application.isWorkspaceView(a.id)||null===Frames.Application.task.getView(a.id)||Frames.Application.task.closeView(a)}if(Frames.isUndef(i)||this.isXmlResponse(i)){var s=$.xmlToJSON(e);this.logger.timeEnd("MESSAGE"),$.isFunction(this.successCallback)&&this.successCallback(s)}else this.showTaskHtml(e),this.logger.timeEnd("MESSAGE")},processMessageResponse:function(e,t,i){Frames.Application._service.processResponse(e,t,i)},processCloseMessageResponse:function(e,t,i){Frames.Application.task.view.hide(),Frames.Application._service.processResponse(e,t,i)},isHtmlResponse:function(e){var t=e.getResponseHeader("Content-Type");return null!==t&&0<=t.indexOf("html")},isXmlResponse:function(e){return"<?xml"===e.responseText.substring(0,"<?xml".length)},showTaskHtml:function(e){var t=Frames.Application.task;null===t&&this.showHtml(t._container,e)},showHtml:function(e,t){e.children().remove(),e.append(t)}},{getServicePath:function(){var e=Frames.Service.SERVICE_URL,t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""}})}(jQuery),function($,O){O.JSONService=$.inherit({logger:new O.Logger("Frames.Service"),__constructor:function(e,t){this.successCallback=e,this.errorCallback=t,this._executing=!1,this.SERVICE_URL=O.JSONService.SERVICE_URL},toString:function(){return"Frames.JSONService"},executing:function(){return this._executing},getTestUrl:function(){return O.Config.getbool("USE_STATUS_ENDPOINT",!0)?O.Service.SERVICE_URL.substring(0,O.Service.SERVICE_URL.indexOf("message/"))+"status":O.Service.SERVICE_URL.substring(0,O.Service.SERVICE_URL.length-1)+".wsdl"},_get_request:function(e,t,i,a,s,r,n,o){var l={},d={},u={},c={};if(l.header=[],l.header.push(d),d.control=[],d.control.push(u),u.action=[],u.action.push(c),u["@isSuspended"]="false",u["@modal"]="false",u["@isChanged"]="false",!O.isUndef(t)&&(u["@task"]=t.id,O.isUndef(t.block)||O.isUndef(t.block.item)||(u["@item"]=t.block.item.member,u["@block"]=t.block.name),!O.isUndef(t.view))){var p=t.view.controlInfo();O.Model.hasChildren(p)&&O.Model.append(u,p)}if(r=!!O.isUndef(r)||O.isTrue(r),$.isPlainObject(e)){var m,h=e;e=h.name;var f=[];for(m in h.params){var g=h.params[m];if(!$.isFunction(g)){var _={};_["@datatype"]=g.type,_["@value"]=g.value,_["@name"]=g.name,f.push(_)}}c.parameter=f}var v=O.Logger.monitor();if(!O.isUndef(v)&&0<v.size()){var b=["CLIENT="+$.browsercss()[1]];for(v.reset();v.hasNext();){var F=v.next(),y=-1;if(1==F.count)y=O.isUndef(F.end)?-1:F.end-F.start,b.push(F.name+"="+y);else{var w;for(w=0;w<F.times.length;w++){var C=F.times[w];y+=C.end-C.start}b.push(F.name+"="+y),b.push(F.name+"_COUNT="+F.count)}}v.clear();var x={};if(x["@data"]=b.join(";"),!O.isUndef(t)){var k=t.request["@reqId"];O.isUndef(k)||(x["@reqId"]=k)}u.monitorInfo=[x]}var T,E=O.Config.getaction_name(e),A=!1,D=!1,I=!1;(O.isUndef(E)||(O.isUndef(E.taskValidation)||(A=O.isTrue(E.taskValidation)),O.isUndef(E.validateNewRow)||(D=O.isTrue(E.validateNewRow)),O.isUndef(E.recordValidation)||(I=O.isTrue(E.recordValidation))),c["@validateNewRow"]=D,c["@taskValidation"]=A,c["@recordValidation"]=I,c["@validation"]=r,c["@kind"]=O.isUndef(n)?"Action":n,c["@name"]=e,s&&(c["@item"]=s),a&&(c["@block"]=a),o)&&(O.isUndef(c.parameter)&&(c.parameter=[]),O.Application.options.wsmode&&((T={"@name":"MODE"})["@value"]=O.Application.options.wsmode,c.parameter.push(T)),O.Application.options.wstask&&((T={"@name":"START_TASK"})["@value"]=O.Application.options.wstask,c.parameter.push(T)));if(!O.isUndef(i)&&O.Model.hasChildren(i)){l.body=[];var S=O.Model.children(i);l.body.push(S)}return l},execute:function(e,t,i,a,s,r,n){if(this._executing)return!1;this._executing=!0,this.logger.time("SERVICE"),O._service=O.time();try{var o=this._get_request(e,t,i,a,s,r,n),l=this.processRequest(o);0,$.support.cors=!0,$.ajax({type:"POST",url:this.SERVICE_URL,dataType:"json",mimeType:O.JSONService.SERVICE_CONTENTTYPE,data:l,success:$.proxy(this.processResponse,this),error:$.proxy(this.processError,this),contentType:O.JSONService.SERVICE_CONTENTTYPE+"; charset="+O.JSONService.SERVICE_CHARSET})}catch(e){this.processError("",e.message)}},processRequest:function(e){return JSON.stringify(e)},parseResponse:function(e){return e},processResponse:function(e,t,i){this.logger.timeAdd("SERVICE",O._service),delete O._service,this._executing=!1,this.logger.time("MESSAGE",!0);var a={header:[{control:e.header[0].control}],body:e.body};var s=a;this.logger.timeEnd("MESSAGE"),$.isFunction(this.successCallback)&&this.successCallback(s)},processError:function(e,t,i){this.logger.timeAdd("SERVICE",O._service),delete O._service,this._executing=!1,$.isFunction(this.errorCallback)&&this.errorCallback(t)}},{SERVICE_URL:"/rest-services/message",SERVICE_CONTENTTYPE:"application/json",SERVICE_CHARSET:"utf-8"})}(jQuery,Frames),$.isFunction($.isNaN)||($.isNaN=function(e){return!$.isNumeric(e)}),$.isFunction($.isNumeric)||($.isNumeric=function(e){return!$.isNaN(e)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){var i;if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),s=a.length>>>0;if(0===s)return-1;var r=+t||0;if(Math.abs(r)===1/0&&(r=0),s<=r)return-1;for(i=Math.max(0<=r?r:s-Math.abs(r),0);i<s;){if(i in a&&a[i]===e)return i;i++}return-1}),Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},function($){Frames.HashMap=$.inherit({__constructor:function(e){this.clear()},put:function(e,t){null!=t&&(void 0!==this._map[e]&&null!==this._map[e]||(this._keys[this._keys.length]=e),this._map[e]=t)},remove:function(e){var t=-1;if("number"==typeof e?0<=e&&e<this._keys.length&&(t=e):t=this.indexOf(e),-1===t)return!1;var i=this._keys[t];return delete this._map[i],this._keys.splice(t,1),!0},get:function(e){return"number"==typeof e?0<=e&&e<this._keys.length?this.get(this._keys[e]):null:this._map[e]},clear:function(){this._map={},this._keys=[],this.reset()},size:function(){return this._keys.length},indexOf:function(e){var t;for(t=0,len=this._keys.length;t<len;t++){if(this._keys[t]===e)return t;if(this.get(this._keys[t])===e)return t}return-1},hasKey:function(e){return!(null===this.get(e)||void 0===this.get(e))},hasValue:function(e){var t;for(t=0,len=this._keys.length;t<len;t++)if(this.get(this._keys[t])===e)return!0;return!1},find:function(e){var t;for(t=0,len=this._keys.length;t<len;t++){var i=this.get(this._keys[t]);if(e(this._keys[t],i))return i}return null},values:function(){var e,t=[];for(e=0,len=this._keys.length;e<len;e++)t[e]=this.get(this._keys[e]);return t},keys:function(){return this._keys},reset:function(){this._position=-1},hasNext:function(){return this._position<this._keys.length-1},next:function(){var e=this._keys[++this._position];return this.get(e)}})}(jQuery),function($){Frames.Keys=$.inherit({},{code:function(e){return e.keyCode?e.keyCode:e.which?e.which:0},string:function(e){var t="",i=Frames.Keys.code(e);return Frames.Keys.ctrl(e)&&17!=i&&(t+=Frames.Keys.KCODES[17]+"+"),Frames.Keys.shift(e)&&16!=i&&(t+=Frames.Keys.KCODES[16]+"+"),Frames.Keys.alt(e)&&18!=i&&(t+=Frames.Keys.KCODES[18]+"+"),t+=Frames.Keys.KCODES[i]},cancel:function(e){e.cancelBubble=!0,e.returnValue=!1,e.preventDefault(),e.stopPropagation(),e.keyCode=0},alt:function(e){return e.altKey?e.altKey:!0&e.modifiers},shift:function(e){return e.shiftKey?e.shiftKey:!0&e.modifiers},ctrl:function(e){return e.ctrlKey?e.ctrlKey:!0&e.modifiers},KCODES:["","","","","","","","","BACK","TAB","","","","ENTER","","","SHIFT","CTRL","ALT","PAUSE","CapsLock","","","","","","","27","","","","","SPACE","PAGE_UP","PAGE_DOWN","END","HOME","LEFT","UP","RIGHT","DOWN","","","","","INSERT","DELETE","HELP","0","1","2","3","4","5","6","7","8","9","","","","","","","","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","LWin","","RWin","","","0","1","2","3","4","5","6","7","8","9","Multiply","Add","","Subtract","Decimal","Divide","F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","","","","","","","","","","","","","","","","","",""],SPECIALEVT:{112:{evt:"onhelp",prevented:!1}}})}(jQuery),function(){var t=Big;Big=function(e){if(e instanceof Big)return e;"string"==typeof e&&(e=$.trim(e)),t.call(this,e)},Big.prototype=new t(0),Big.prototype.toFormat=function(e){var t,i,a="",s=".";Frames.isUndef(e)||"object"!=typeof e||(Frames.isUndef(e.groupSeparator)||(a=e.groupSeparator),Frames.isUndef(e.nrGroupSeparator)||(t=e.nrGroupSeparator),Frames.isUndef(e.decimalSeparator)||(s=e.decimalSeparator),Frames.isUndef(e.decimalPlaces)||(i=e.decimalPlaces));var r=new RegExp("\\B(?=(\\d{3})"+(t?"{0,"+t+"}":"+")+"(?!\\d))(?!$)(?!^)","g"),n=this.toFixed(i).split(".");return n[0]=n[0].replace(r,a),n.join(s)},Big.prototype.pad=function(e,t){return Frames.isUndef(e)||Frames.isUndef(t)?e:e.length<t?this.pad("0".concat(e),t):e}}(),function($){RegExp.escape=function(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},Frames.Format={_FORMAT_:void 0,_formatters:{},_validators:{},register:function(e,t){Frames.isUndef(Frames.Format._FORMAT_)&&(Frames.Format._FORMAT_=new Frames.HashMap),Frames.Format._FORMAT_.put(e,t)},get:function(e){Frames.isUndef(Frames.Format._FORMAT_)&&(Frames.Format._FORMAT_=new Frames.HashMap);var t=Frames.Format._FORMAT_.get(e);return Frames.isUndef(t)&&(t=Frames["Format"+e]),t},_getFormatter:function(e,t){var i,a=e;("String"==e&&(a=e+(t||"")),void 0===this._formatters[a])&&(void 0!==e&&(i=Frames.Config.getclass(e.toUpperCase()+"_DEFAULT_FORMATTER",Frames.Format.get(e))),this._formatters[a]=void 0!==i?new i(t):null);return this._formatters[a]},_getValidatorRegExp:function(e){if(e=e||"String",void 0===this._validators[e]){var t=Frames.Locale.formats[e.toUpperCase()+"_FORMAT_VALIDATOR"];this._validators[e]=void 0!==t?new RegExp(t):null}return this._validators[e]},getAlignment:function(e,t,i){var a=this._getFormatter(i||"String");if(a)return a.getAlignment(e,t)},formatFromCanonical:function(e,t,i){if(0===$.trim(e).length)return"";var a=this._getFormatter(i||"String",t);return a&&this.isValidFormat(t,i)?a.formatFromCanonical(e,t):e},toValueFromCanonical:function(e,t){var i=this._getFormatter(t||"String");return i?i.toValueFromCanonical(e):e},message:function(e,t,i){var a=this._getFormatter(i||"String",t);return a?a.message(e,t,i||"String"):Frames.Locale.messages.VALIDATION_FORMAT.replace("%s","{0}")},formatToCanonical:function(e,t,i){if(0===$.trim(e).length)return"";var a=this._getFormatter(i||"String",t);return a&&this.isValidFormat(t,i||"String")?a.formatToCanonical(e,t):e},format:function(e,t,i,a){if(Frames.isUndef(e)||0===e.length)return e;var s=this._getFormatter(i||"String",t);return s&&this.isValidFormat(t,i||"String")?s.format(e,t,a):e},unformat:function(e,t,i){if(Frames.isUndef(e)||0===e.length)return e;var a=this._getFormatter(i||"String",t);return a&&this.isValidFormat(t,i||"String")?a.unformat(e,t):e},test:function(e,t,i){if(Frames.isUndef(e)||0===e.length)return!0;var a=this._getFormatter(i||"String",t);return!(!a||!this.isValidFormat(t,i||"String"))&&a.test(e,t)},convertFormat:function(e,t){var i=this._getFormatter(t||"String",e);return i?i.convertFormat(e):e},convertFormatLocalized:function(e,t){var i=this._getFormatter(t||"String",e);return i?$.isFunction(i.convertFormatLocalized)?i.convertFormatLocalized(e):i.convertFormat(e):e},isValidFormat:function(e,t){var i=this._getFormatter(t||"String",e);if(i&&$.isFunction(i.isValidFormat))return i.isValidFormat(e);var a=this._getValidatorRegExp(t||"String");return!a||a.test(e)},toValue:function(e,t,i){var a=this._getFormatter(i||"String",t);if(a)return a.toValue(e,t)},equals:function(e,t,i,a){var s=this._getFormatter(a||"String",i);return!!s&&s.equals(e,t,i)},rules:function(e,t){var i=this._getFormatter(t||"String",e);return i&&$.isFunction(i.rules)?i.rules(e):{}}}}(jQuery),function($){Frames.FormatNumber=$.inherit({__constructor:function(){},_getDefaultFormat:function(){return Frames.Locale.formats.NUMBER_FORMAT},message:function(e,t,i){return Frames.Locale.messages.VALIDATION_FORMAT.replace("%s","{0}")},convertFormatLocalized:function(e){return this.convertFormat(e,!0)},convertFormat:function(e,t){if(Frames.isUndef(e))return e;if(e=(e=(e=(e=(e=e.replace(/fm/gi,"")).replace(/\./g,"D")).replace(/,/g,"G")).replace(/G/gi,Frames.Locale.formats.GROUP_SEPARATOR)).replace(/D/gi,Frames.Locale.formats.DECIMAL_SEPARATOR),!0!==t){var i=e.split(Frames.Locale.formats.DECIMAL_SEPARATOR);1<i.length?(/^0[0#9]*?$/g.test(i[0])&&(i[0]=i[0].replace(/[9#]/g,"0")),e=i[0]+Frames.Locale.formats.DECIMAL_SEPARATOR+i[1].replace(/9/g,"0")):/^0[0#9]*?$/g.test(i[0])&&(e=i[0].replace(/[9#]/g,"0"))}return e=(e=e.replace(/L/gi,"")).replace(/$/g,"")},_objValue:function(e){try{return new Big(e)}catch(e){return}},toValueFromCanonical:function(e){return this._objValue(e)},formatFromCanonical:function(e,t){if(Frames.isUndef(t)&&(t=this._getDefaultFormat()),e=$.trim(e),!this.test(e,t,!0))return e;-1<e.indexOf(Frames.Locale.formats.CURRENCY_SYMBOL)&&(e=e.replace(Frames.Locale.formats.CURRENCY_SYMBOL,""));var i=this.toValueFromCanonical(e);return this.format(i,t,!1,!0)},formatToCanonical:function(e,t){if(e instanceof Big&&(e=e.toFixed().replace(/\./,Frames.Locale.formats.DECIMAL_SEPARATOR)),e=$.trim(e),!this.test(e,t))return e;e=this._clean(e,t);var i=this._objValue(e);if(Frames.isUndef(i))return"";var a={decimalSeparator:Frames.Config.get("NUMBER_CANONICAL_DECIMAL",".")};return i.toFormat(a)},format:function(e,t,i,a){var s;if(Frames.isEmpty(t)&&(t=this._getDefaultFormat()),e instanceof Big)s=e;else if("string"==typeof e&&(e=this._clean(e,t)),s=this._objValue(e),Frames.isUndef(s))return e;t=(t=(t=t.replace(/fm/gi,"")).replace(/\./g,"D")).replace(/,/g,"G");var r=this._getFormatPrefix(t),n=this._getFormatSuffix(t),o=t.match(/G/gi),l=o?o.length:void 0,d=o?Frames.Locale.formats.GROUP_SEPARATOR:"",u=t.match(/D/gi)?Frames.Locale.formats.DECIMAL_SEPARATOR:"",c=0,p=0,m=t.replace(r,"").replace(n,"");if((_=m.split(/D/gi))&&1<_.length&&(c=_[1].length,p=_[1].replace(/#/g,"").length),Frames.isTrue(a)){var h=_[0].length,f=s.toFixed(0).length;h<f&&(l=parseInt(f/3))}var g={groupSeparator:d,decimalSeparator:u,nrGroupSeparator:l,decimalPlaces:c};e=s.toFormat(g);var _;u=t.match(/D/gi)?Frames.Locale.formats.DECIMAL_SEPARATOR:"";if((_=t.split(/D/gi))&&1<_.length&&""==_[0].length&&0<e.indexOf(u)&&(e=e.replace(/^(0)/g,"")),p!==c){var v=e.match(/\d*$/);if(v){var b=v[0].length,F=v[0].match(/0*$/);if(F){var y=b-F[0].length;p=y<p?p:y}}g.decimalPlaces=p,e=s.toFormat(g)}return t.match(/^0+/g)&&(minLength=m.match(/^[0-9]+/g)[0].length,e=s.pad(e,minLength)),Frames.isEmpty(r)||(e=r.concat(e)),Frames.isEmpty(n)||(e=e.concat(n)),0===e.toUpperCase().indexOf("L")?e=e.replace(/^L/,Frames.Locale.formats.CURRENCY_SYMBOL):t.toUpperCase().lastIndexOf("L")+1===t.length&&(e=e.replace(/L$/,Frames.Locale.formats.CURRENCY_SYMBOL)),e},unformat:function(e,t){if(Frames.isUndef(t)&&(t=this._getDefaultFormat()),Frames.isUndef(e))return e;e=(e=e.split(Frames.Locale.formats.GROUP_SEPARATOR).join("")).split(Frames.Locale.formats.CURRENCY_SYMBOL).join(""),e=this._cleanPrefix(e,t),e=this._cleanSuffix(e,t);var i=this.toValue(e,t);i instanceof Big&&(e=i.toFixed().replace(/\./,Frames.Locale.formats.DECIMAL_SEPARATOR));var a=t.match(/D/gi)?Frames.Locale.formats.DECIMAL_SEPARATOR:"",s=t.split(/D/gi);return s&&1<s.length&&""==s[0].length&&e&&0==e.indexOf(a)&&(e="0"+e),e},_getFormatPrefix:function(e){return e.match(/^([^09#GD\.,]*)/g)[0]},_getFormatSuffix:function(e){return e.match(/([^09#G\.,]*$)/g)[0]},_cleanPrefix:function(e,t){var i=this._getFormatPrefix(t);return Frames.isEmpty(i)||(e=e.replace(new RegExp(i),"")),e},_cleanSuffix:function(e,t){var i=this._getFormatSuffix(t);return Frames.isEmpty(i)||(e=e.replace(new RegExp(i+"$"),"")),e},_clean:function(e,t,i){if(Frames.isUndef(t)&&(t=this._getDefaultFormat()),Frames.isUndef(e))return e;"string"!=typeof e&&(e=String(e));var a=new RegExp(Frames.Locale.formats.GROUP_SEPARATOR.replace(/\./,"\\.")+"([0-9])"),s=e.split(a).join("");return i&&"."!=Frames.Locale.formats.DECIMAL_SEPARATOR&&(s=s.split(".").join("x")),s=(s=s.replace(Frames.Locale.formats.DECIMAL_SEPARATOR,".")).split(Frames.Locale.formats.CURRENCY_SYMBOL).join(""),s=this._cleanPrefix(s,t),s=this._cleanSuffix(s,t)},validFormatValue:function(e,t){if(Frames.isUndef(t))return!0;t=this.convertFormat(t);var i=String(e),a=t.match(/D/gi)?".":"",s=t.split(/D/gi);if(s&&1<s.length&&""===s[0].length&&0<i.indexOf(a)&&(i=i.replace(/^(0)/g,"")),t=(t=(t=(t=(t=(t=(t=t.replace(/G/gi,Frames.Locale.formats.GROUP_SEPARATOR)).split(Frames.Locale.formats.GROUP_SEPARATOR).join("")).split(Frames.Locale.formats.CURRENCY_SYMBOL).join("")).replace(/D/gi,Frames.Locale.formats.DECIMAL_SEPARATOR)).replace(Frames.Locale.formats.DECIMAL_SEPARATOR,".")).replace(/L/gi,"")).replace(/$/g,""),/^[90#]*(\.[90#]+)?$/g.test(t)){var r=t.split("."),n=i.split(".");if(n[0]=n[0].replace(/^[-+]/,""),r[0].length<n[0].length)return!1;if(1<r.length&&1<n.length)return r[1].length>=n[1].length;if(r.length<n.length)return!1}return!0},test:function(e,t,i){return e instanceof Big||"number"==typeof e||(Frames.isUndef(t)||t==this._getDefaultFormat()?(e=this._clean(e,t),void 0!==this._objValue(e)):!(!Frames.isTrue(i)&&!/[$L]/gi.test(t)&&/[$L]/gi.test(e))&&(s=i?(a=e,this.toValue(a)):(a=this.unformat(e,t),this.toValue(e,t,!0)),e=this._clean(a,t),a=this._objValue(e),s=this._objValue(s),!(!$.isNumeric(s)||Frames.isUndef(a)||!s.eq(a))&&!(!Frames.isTrue(i)&&!this.validFormatValue(s,t))));var a,s},toValue:function(e,t,i){if(Frames.isUndef(t)&&(t=this._getDefaultFormat()),!Frames.isUndef(e)){var a=this._clean(e,t,i);return this._objValue(a)}},equals:function(e,t,i){return(e=this.format(e,i))===(t=this.format(t,i))},getAlignment:function(e,t){return"right"},rules:function(e,t){return{range:!0,numeric:!0,length:!0,format:!0}}})}(jQuery),function($){Frames.FormatInteger=$.inherit({__constructor:function(){},_getDefaultFormat:function(){return Frames.Locale.formats.INTEGER_FORMAT},message:function(e,t,i){return Frames.Locale.messages.VALIDATION_FORMAT.replace("%s","{0}")},convertFormat:function(e){return Frames.isUndef(e)?e:e=(e=(e=(e=(e=e.replace(/fm/gi,"")).replace(/\./g,"D")).replace(/,/g,"G")).replace(/G/gi,Frames.Locale.formats.GROUP_SEPARATOR)).replace(/D/gi,Frames.Locale.formats.DECIMAL_SEPARATOR)},_convertFormat:function(e){return Frames.isUndef(e)||(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/fm/gi,"")).replace(/\./g,"D")).replace(/,/g,"G")).replace(/G/gi,Frames.Locale.formats.GROUP_SEPARATOR)).replace(/D/gi,Frames.Locale.formats.DECIMAL_SEPARATOR)).replace(/9/g,"#")).replace(/L/gi,"")).replace(/$/g,""),/^0[09#]*?$/g.test(e)&&(e=e.replace(/[#9]/g,"0"))),e},_objValue:function(e){return Frames.FormatNumber.prototype._objValue(e)},toValueFromCanonical:function(e){return this._objValue(e)},formatFromCanonical:function(e,t){if(Frames.isEmpty(t)&&(t=this._getDefaultFormat()),e=$.trim(e),!this.test(e,t))return e;var i=this.toValueFromCanonical(e);return this.format(i,t)},formatToCanonical:function(e,t){if(e=$.trim(e),!this.test(e,t))return e;e=this._clean(e,t);var i=this._objValue(e);if(Frames.isUndef(i))return"";return i.toFormat({decimalPlaces:0})},format:function(e,t,i){var a;if(Frames.isEmpty(t)&&(t=this._getDefaultFormat()),e instanceof Big)a=e;else if("string"==typeof e&&(e=this._clean(e,t)),a=this._objValue(e),Frames.isUndef(a))return e;var s=(t=(t=(t=t.replace(/fm/gi,"")).replace(/\./g,"D")).replace(/,/g,"G")).match(/^0+/g),r=s?s[0].length:0,n=t.match(/G/gi),o={groupSeparator:n?Frames.Locale.formats.GROUP_SEPARATOR:"",decimalSeparator:t.match(/D/gi)?Frames.Locale.formats.DECIMAL_SEPARATOR:"",nrGroupSeparator:n?n.length:void 0,decimalPlaces:0};e=a.toFormat(o);var l=Frames.FormatNumber.prototype._getFormatPrefix(t),d=Frames.FormatNumber.prototype._getFormatSuffix(t),u=t.replace(l,"").replace(d,"");return s&&(r=u.match(/^[0-9]+/g)[0].length,e=a.pad(e,r)),Frames.isEmpty(l)||(e=l.concat(e)),Frames.isEmpty(d)||(e=e.concat(d)),0===e.toUpperCase().indexOf("L")?e=e.replace(/^L/,Frames.Locale.formats.CURRENCY_SYMBOL):t.toUpperCase().lastIndexOf("L")+1===t.length&&(e=e.replace(/L$/,Frames.Locale.formats.CURRENCY_SYMBOL)),e},unformat:Frames.FormatNumber.prototype.unformat,_clean:Frames.FormatNumber.prototype._clean,_cleanSuffix:Frames.FormatNumber.prototype._cleanSuffix,_cleanPrefix:Frames.FormatNumber.prototype._cleanPrefix,_getFormatPrefix:Frames.FormatNumber.prototype._getFormatPrefix,_getFormatSuffix:Frames.FormatNumber.prototype._getFormatSuffix,rules:Frames.FormatNumber.prototype.rules,test:Frames.FormatNumber.prototype.test,validFormatValue:Frames.FormatNumber.prototype.validFormatValue,equals:Frames.FormatNumber.prototype.equals,toValue:function(e,t,i){var a=Frames.FormatNumber.prototype.toValue.apply(this,arguments);return Frames.isTrue(i)||void 0===a||(a=a.toFormat({decimalPlaces:0})),a},getAlignment:Frames.FormatNumber.prototype.getAlignment})}(jQuery),function($){Frames.FormatString=$.inherit({__constructor:function(e){void 0!==(this._format=e)&&(this._type="String",/^(FM)?\d+$/i.test(e)?(this._formatter=Frames.Format._getFormatter("Integer",e),this._type="Integer"):Frames.FormatTime.isTimeFormat(e)&&(this._formatter=Frames.Format._getFormatter("Time",e),this._type="Time"))},message:function(){return Frames.isUndef(this._formatter)?Frames.Locale.messages.VALIDATION_FORMAT.replace("%s",this._format):this._formatter.message.apply(this._formatter,arguments)},convertFormat:function(){return Frames.isUndef(this._formatter)?arguments[0]:this._formatter.convertFormat.apply(this._formatter,arguments)},convertFormatLocalized:function(e){return"Integer"==this._type?e:Frames.isUndef(this._formatter)||!$.isFunction(this._formatter.convertFormatLocalized)?this.convertFormat.apply(this,arguments):this._formatter.convertFormatLocalized.apply(this._formatter,arguments)},toValueFromCanonical:function(){return Frames.isUndef(this._formatter)?arguments[0]:this._formatter.toValueFromCanonical.apply(this._formatter,arguments)},format:function(e,t){return Frames.isUndef(this._formatter)?e:("Integer"==this._type&&(t=t.replace(/9/g,"0")),this._formatter.format.apply(this._formatter,[e,t]))},unformat:function(){return Frames.isUndef(this._formatter)?arguments[0]:this._formatter.unformat.apply(this._formatter,arguments)},validFormatValue:function(){return Frames.isUndef(this._formatter)?arguments[0]:this._formatter.validFormatValue.apply(this._formatter,arguments)},toValue:function(){return Frames.isUndef(this._formatter)?arguments[0]:this._formatter.toValue.apply(this._formatter,arguments)},_objValue:function(){return Frames.isUndef(this._formatter)?arguments[0]:this._formatter._objValue.apply(this._formatter,arguments)},test:function(e,t){if(Frames.isUndef(this._formatter)){if(Frames.isUndef(t))return!0;for(var i="[A-Za-z]{#REP#}",a="[0-9]{#REP#}",s=".{#REP#}",r=new RegExp("^[A-Z]+$"),n=["d","m","y","s","n"],o="",l=0,d=0,u=0,c="^",p=0,m=0;m<t.length;m++){var h="";"X"==(o=t[m])?(h="a",u+=1):$.isNumeric(o)?(h="d",l+=1):r.test(o)?-1<$.inArray(o.toLowerCase(),n)?(h="a",u+=1):(h="s",d+=1):(h="f",p+=1),0<d&&"s"!=h&&(c+=i.replace("#REP#",d),d=0),0<l&&"d"!=h&&(c+=a.replace("#REP#",l),l=0),0<u&&"a"!=h&&(c+=s.replace("#REP#",u),u=0),"f"==h&&0<p&&(c+=o,p=0)}return 0<d&&(c+=i.replace("#REP#",d)),0<l&&(c+=a.replace("#REP#",l)),0<u&&(c+=s.replace("#REP#",u)),"f"==h&&0<p&&(c+=o,p=0),c+="$",new RegExp(c).test(e)}var f=this._formatter.test.apply(this._formatter,arguments);return f&&"Integer"==this._type&&/^\d+$/.test(t)&&(f=this.format(e,t.replace(/9/g,"0"))==e),f},formatFromCanonical:function(e,t,i){return 0===$.trim(e).length?"":this.test(e,t)?Frames.isUndef(this._formatter)||"Integer"==this._type?e:this._formatter.formatFromCanonical.apply(this._formatter,arguments):e},formatToCanonical:function(e,t,i){return 0===$.trim(e).length?"":this.test(e,t)?Frames.isUndef(this._formatter)||"Integer"==this._type?e:this._formatter.formatToCanonical.apply(this._formatter,arguments):e},equals:function(e,t,i){return Frames.isUndef(this._formatter)?(Frames.isUndef(e)?e:String(e))===(Frames.isUndef(t)?t:String(t)):this._formatter.equals.apply(this._formatter,arguments)},getAlignment:function(e,t){if(t!==e&&"ltr"==t)return"right"},rules:function(e){var t={length:!0};return Frames.isUndef(e)||(t.format=!0),t}})}(jQuery),function($){Frames.FormatDate=$.inherit({__constructor:function(){Frames.FormatDate.MONTH_NAMES=$.datepicker._defaults.monthNames.concat($.datepicker._defaults.monthNamesShort),Frames.FormatDate.DAY_NAMES=$.datepicker._defaults.dayNames.concat($.datepicker._defaults.dayNamesShort)},_getDefaultFormat:function(){return Frames.Locale.formats.DATE_FORMAT},message:function(e,t,i){return Frames.Locale.messages.VALIDATION_FORMAT.replace("%s","{0}")},convertFormat:function(e){if(Frames.isEmpty(e))return e;var t=this._uniteFormat(this._convertFormat(e));return t?t.toUpperCase():e},_convertFormat:function(e){if(!Frames.isEmpty(e)&&!$.isPlainObject(e)&&(e=this._separateFormat(e.toUpperCase()),Frames.isEmpty(e.dateValue)||(e.dateValue=e.dateValue.replace(/(Y|R)/g,"y").replace(/MON/g,"NNN").replace(/MONTH/g,"MMM").replace(/DAy/g,"EE").replace(/Dy/g,"E").replace(/(D|J)/g,"d")),!Frames.isEmpty(e.timeValue))){var t=e.timeValue.replace(/(P.M.|A.M.|PM|AM|A)/g,"a").replace(/(H|J)/g,"h").replace(/hh12/g,"hh").replace(/hh24/g,"HH").replace(/(MI)/g,"mm").replace(/(M|N)/g,"m").replace(/S/g,"s");if(Frames.Locale.formats.IS_RTL){var i=t.match(/\s*a$/g);!Frames.isUndef(i)&&0<i.length&&(t=(i=i[0]).split("").reverse().join("")+t.replace(i,""))}e.timeValue=t}return e},_convert:function(e,t){return t=this._convertFormat(t),e=this._convertValue(e,t),$.isPlainObject(e)&&$.isPlainObject(t)&&(Frames.isEmpty(t.dateValue)||Frames.isEmpty(e.dateValue)?(t.isDateFirst=void 0,t.dateValue=void 0,Frames.isEmpty(e.dateValue)||(e.timeValue=e.timeValue||e.dateValue),e.dateValue=void 0):($.isNumeric(e.dateValue)&&(t.dateValue=t.dateValue.replace(/(NNN|MMM)/g,"MM")),this._is2DigitsYear(e.dateValue,t.dateValue)&&(t.dateValue=t.dateValue.replace("yyyy","yy"))),Frames.isEmpty(e.timeValue)||Frames.isEmpty(t.timeValue)?(t.isDateFirst=void 0,e.timeValue=t.timeValue=void 0):-1!==t.timeValue.indexOf("a")&&-1===t.timeValue.indexOf("H")&&-1===e.timeValue.search(/AM|A.M.|PM|P.M./gi)&&(t.timeValue.match(/^a/)?e.timeValue="AM "+e.timeValue:t.timeValue.match(/a$/)&&(e.timeValue+=" AM"))),{value:e,format:t}},_convertValue:function(e,t){return Frames.isEmpty(e)||$.isPlainObject(e)||(e=this._separateValue(e,t)),e},_normalize:function(e){return e.replace(Frames.FormatDate._getNormalizeRegExp(),function(e,t,i){return 0===t||t===i.length-1?e:""})},_valueToDate:function(e,t,i){if(e instanceof Date)return e;var a,s=this._uniteFormat(t);if((Frames.isEmpty(t)||/(DAY|DY|E)/gi.test(s))&&(t=this._getDefaultFormat()),!Frames.isEmpty(e)){var r=this._convert(e,t),n=this._uniteValue(r.value,r.format),o=this._getTryDates(r.value,r.format);if(Frames.isUndef(o))return;for(var l=0;l<o.length;l++){var d=this._uniteFormat(o[l]);if(a=this._parseDate(n,d,!0),!Frames.isUndef(a)){/dd/gi.test(d)||(a=new Date(a.setDate(1)));break}}}return a},_is2DigitsYear:function(e,t){var i=$.isNumeric(this._normalize(e)),a=this._normalize(t);return i&&6===e.length&&-1!==a.indexOf("MM")&&-1!==a.indexOf("dd")&&-1!==a.indexOf("yy")||!i&&7===e.length&&-1!==a.indexOf("NNN")&&-1!==a.indexOf("dd")&&-1!==a.indexOf("yy")},_getTryDates:function(e,t){var i,a,s,r,n;if(!Frames.isEmpty(t.dateValue)){if(a=[],r=this._getPartsPositionsDate(t.dateValue),$.isNumeric(e.dateValue))a.push($.map(r,function(e){return Array("y"==e?5:3).join(e)}).join(""),$.map(r,function(e){return Array(3).join(e)}).join(""));else{n=this._getSeparatorDate(e.dateValue),3!==e.dateValue.split(n).length&&(r=$.map(r,function(e){return-1!==t.dateValue.indexOf(e)?e:void 0}));var o="M";-1!==r.indexOf("N")&&(o="N",a.push($.map(r,function(e){return e==o?"NNN":Array(3).join(e)}).join(n),$.map(r,function(e){return e==o?"NNN":Array("y"==e?5:3).join(e)}).join(n))),a.push($.map(r,function(e){return e==o?"M":Array("y"==e?5:3).join(e)}).join(n),$.map(r,function(e){return e==o?"M":Array(3).join(e)}).join(n),$.map(r,function(e){return e==o?"MM":Array("y"==e?5:3).join(e)}).join(n),$.map(r,function(e){return e==o?"MM":Array(3).join(e)}).join(n),$.map(r,function(e){return e==o?"MMM":Array("y"==e?5:3).join(e)}).join(n),$.map(r,function(e){return e==o?"MMM":Array(3).join(e)}).join(n))}a=$.map(a,function(e){return{dateValue:e,timeValue:void 0}})}if(!Frames.isEmpty(t.timeValue)){s=[],r=this._getPartsPositionsTime(t.timeValue),n=this._getSeparatorTime(e.timeValue);var l=-1!==t.timeValue.search(/^a/)?"left":-1!==t.timeValue.search(/a$/)?"right":void 0;s.push($.map(r,function(e){return Array(3).join(e)}).join(n),$.map(r,function(e,t){return Array(2==t?2:3).join(e)}).join(n),$.map(r,function(e,t){return Array(1==t?2:3).join(e)}).join(n),$.map(r,function(e,t){return Array(0==t?3:2).join(e)}).join(n),$.map(r,function(e,t){return 2!=t?Array(3).join(e):void 0}).join(n),$.map(r,function(e,t){return 0==t?Array(3).join(e):void 0}).join(n),$.map(r,function(e,t){return Array(0==t?2:3).join(e)}).join(n),$.map(r,function(e,t){return Array(1==t?3:2).join(e)}).join(n),$.map(r,function(e,t){return Array(2==t?3:2).join(e)}).join(n),$.map(r,function(e){return Array(2).join(e)}).join(n),$.map(r,function(e,t){return 2!=t?Array(2).join(e):void 0}).join(n),$.map(r,function(e,t){return 0==t?Array(2).join(e):void 0}).join(n)),s=$.map(s,function(e){return Frames.isEmpty(e)?void 0:{dateValue:void 0,timeValue:l&&-1!==e.toLowerCase().indexOf("h")?"left"===l?"a "+e:e+" a":e}})}if(Frames.isEmpty(a)||Frames.isEmpty(s))i=a||s;else{i=[];for(var d=0,u=0;u<a.length;u++)for(var c=0;c<s.length;c++)i[d]={dateValue:a[u].dateValue,timeValue:s[c].timeValue,isDateFirst:t.isDateFirst},d++}return i},_separateFormat:function(e){if("string"!=typeof e)return e;var t,i,a,s=0;return-1!==(s=-1===(s=(e=e.replace(/\s+/g," ")).search(/((\b\w+:)|(^(AM|PM|A.M.|P.M.|A|a)))/))?e.search(/(H12|H24|J|K|k|H|h|MI|m|S|s|AM|PM|A.M.|P.M.)/):s)?0!==s?(a=!0,t=e.substring(0,s).trim(),i=e.substring(s).trim()):-1!==(s=e.search(/\b\w+[\/\.\-]/))?0!==s&&(a=!1,i=e.substring(0,s).trim(),t=e.substring(s).trim()):i=e:t=e,{dateValue:t,timeValue:i,isDateFirst:a}},_separateValue:function(e,t){if("string"!=typeof e)return e;var i,a;e=e.replace(/\s+/g," ");var s=0;return/^[0-9]+$/.test(e)?void 0!==t.isDateFirst?((t={dateValue:t.dateValue.replace(/\W/g,""),timeValue:t.timeValue.replace(/\W/g,""),isDateFirst:t.isDateFirst}).isDateFirst?e.length===t.dateValue.length?i=e:a=e.length===t.timeValue.length?e:(s=t.dateValue.length,i=e.substring(0,s).trim(),e.substring(s).trim()):e.length===t.timeValue.length?a=e:i=e.length===t.dateValue.length?e:(s=t.timeValue.length,a=e.substring(0,s).trim(),e.substring(s).trim()),{dateValue:i,timeValue:a}):Frames.isEmpty(t.dateValue)?{dateValue:void 0,timeValue:e}:{dateValue:e,timeValue:void 0}:(-1!==(s=e.search(/\s/))&&void 0!==t.isDateFirst?a=t.isDateFirst?(i=e.substring(0,s).trim(),e.substring(s).trim()):(i=e.substring(s).trim(),e.substring(0,s).trim()):-1!==(s=-1===(s=e.search(/(\s|^)[0-9]+([aApP:\s]|$)/))?e.search(/(AM|PM|A.M.|P.M.)/):s)?0!==s?(i=e.substring(0,s).trim(),a=e.substring(s).trim()):-1!==(s=e.search(/\b\w+[/-]/))?0!==s&&(a=e.substring(0,s).trim(),i=e.substring(s).trim()):a=e:i=e,{dateValue:i,timeValue:a})},_uniteDate:function(e,t){if("string"==typeof e)return e;var i=e.dateValue,a=e.timeValue;return Frames.isEmpty(i)||Frames.isEmpty(a)?i||a:(t=Frames.Locale.formats.IS_RTL?!t:t)?i+" "+a:a+" "+i},_uniteValue:function(e,t){var i=void 0===t.isDateFirst||t.isDateFirst;return this._uniteDate(e,i)},_uniteFormat:function(e){var t=void 0===e.isDateFirst||e.isDateFirst;return this._uniteDate(e,t)},_getSeparatorDate:function(e){var t="";return-1!=e.indexOf("/")?t="/":-1!=e.indexOf("-")?t="-":-1!=e.indexOf(".")&&(t="."),t},_getSeparatorTime:function(e){var t="";return-1!=e.indexOf(":")&&(t=":"),t},_getPartsPositionsDate:function(e){var s=e.toLowerCase().replace(/n/g,"N").replace(/m/g,"M"),r=(Frames.Locale.formats.DATE_FORMAT||"dd/MM/yy").toLowerCase().replace(/n/g,"N").replace(/m/g,"M"),t=["M","N","d","y"];return(t=$.map(t,function(e){return-1!==s.indexOf(e)?e:void 0})).sort(function(e,t){var i=s.indexOf(e),a=s.indexOf(t);return-1===i&&(i=r.indexOf(e)),-1===a&&(a=r.indexOf(t)),i-a})},_getPartsPositionsTime:function(e){var s=e,r=Frames.Locale.formats.TIME_FORMAT||"hh:mm a",t=["H","h","K","k","m","s"];return(t=$.map(t,function(e){return-1!==s.indexOf(e)?e:void 0})).sort(function(e,t){var i=s.indexOf(e),a=s.indexOf(t);return-1===i&&(i=r.indexOf(e)),-1===a&&(a=r.indexOf(t)),i-a})},_parseDate:function(e,t,i){var a=getDateFromFormat(e,t,i);return null===a?null:new Date(a)},toValueFromCanonical:function(e){var t=Frames.Config.get("DATE_CANONICAL_FORMAT","MM/dd/yyyy hh:mm:ss");return this.toValue(e,t)},formatFromCanonical:function(e,t,i){var a=Frames.Config.get("DATE_CANONICAL_FORMAT","MM/dd/yyyy hh:mm:ss");return!0===i||this.test(e,a,!0)?this._format(e,a,t):e},formatToCanonical:function(e,t){var i=Frames.Config.get("DATE_CANONICAL_FORMAT","MM/dd/yyyy hh:mm:ss");return this.test(e,t)?this._format(e,t,i):e},format:function(e,t,i){return this._format(e,t,t,i||!1)||e},unformat:function(e){return e},equal:function(e,t,i,a){var s=this.format(e,i,a||!1),r=this.format(t,i,a||!1);return this._normalize(s).toUpperCase()==this._normalize(r).toUpperCase()},equals:function(e,t,i){return this.equal(e,t,i)},test:function(e,t,i){if(e instanceof Date)return!0;var a,s=this._uniteFormat(t);if((Frames.isEmpty(t)||/(DAY|DY|E)/gi.test(s))&&(t=this._getDefaultFormat()),!Frames.isEmpty(e)){var r=i?this.formatFromCanonical(e,t,!0):e;if(Frames.isUndef(r))return!1;var n=this._convert(r,t),o=this._getTryDates(n.value,n.format);if(Frames.isUndef(o))return!1;for(var l=0;l<o.length;l++){var d=o[l];if(a=this._format(n.value,d,n.format,!0),!Frames.isUndef(a))break}}return!Frames.isUndef(a)&&this.equal(a,e,n.format,!0)},_format:function(e,t,i,a){if(Frames.isEmpty(e))return e;Frames.isEmpty(t)&&(t=Frames.Locale.formats.DATE_FORMAT),Frames.isEmpty(i)&&(i=Frames.Locale.formats.DATE_FORMAT);var s=e instanceof Date?e:this._valueToDate(e,t,a);return i=this._uniteFormat(this._convertFormat(i)),Frames.isUndef(s)?void 0:formatDate(s,i)},toValue:function(e,t){return this._valueToDate(e,t,!0)},getAlignment:function(e,t){if(t!==e&&"ltr"==t)return"right"},rules:function(e,t){return{format:!0,range:!0}}},{_getNormalizeRegExp:function(){if(!Frames.FormatDate._normalizeRegExp){var e="\"'---:,'/:\\s".split("").sort().join("");Frames.FormatDate._normalizeRegExp=new RegExp("["+e+"]","gi")}return Frames.FormatDate._normalizeRegExp}})}(jQuery),function($){Frames.FormatTime=$.inherit(Frames.FormatDate,{message:function(e,t,i){return Frames.Locale.messages.VALIDATION_TIME_FORMAT.replace("%s","{0}")},toValue:function(e,t){return this.formatFromCanonical(e,t)},toValueFromCanonical:function(e){return e},formatFromCanonical:function(e,t){return this.format(e,t)},formatToCanonical:function(e,t){return this.format(e,t)},equals:function(e,t,i){return(e=this.format(e,i))===(t=this.format(t,i))},_format:function(e,t,i,a){"string"==typeof e&&(e=$.trim(e));var s=this._convert(e,t);if(Frames.isEmpty(s.value.timeValue)||Frames.isEmpty(s.format.timeValue))return"";if(!Frames.isUndef(t)&&!isNaN(e)&&Number.isInteger(+e)){var r=s.format.timeValue.toLowerCase();0!==r.indexOf("hh:")&&0!==r.indexOf("kk:")||(1!==e.length&&3!==e.length||(e="0"+e),2===e.length&&(-1!==r.indexOf(":mm")&&(e+="00"),-1!==r.indexOf(":ss")&&(e+="00")))}return i=this._convertFormat(i),Frames.FormatDate.prototype._format.call(this,{dateValue:void 0,timeValue:s.value.timeValue},{dateValue:void 0,timeValue:s.format.timeValue},{dateValue:void 0,timeValue:i.timeValue},a)},test:function(e,t,i){if(e instanceof Date)return!0;var a=this._convert(e,t);return!Frames.isEmpty(a.value.timeValue)&&!Frames.isEmpty(a.format.timeValue)&&Frames.FormatDate.prototype.test.call(this,{dateValue:void 0,timeValue:a.value.timeValue},{dateValue:void 0,timeValue:a.format.timeValue},i)}},{isTimeFormat:function(e){return!Frames.isUndef(e)&&"string"==typeof e&&/HH[24]*:[mi]+/gi.test(e)}})}(jQuery),function($){Frames.FormatCurrency=$.inherit(Frames.FormatNumber,{_getDefaultFormat:function(){return Frames.Locale.formats.CURRENCY_FORMAT||Frames.Locale.formats.NUMBER_FORMAT}})}(jQuery),function($){Frames.Debug=$.inherit({},{init:function(){var e=Frames.Config.get("RUNTIME_URL",".");Frames.Debug.tmpl_url=e+"/js/frames/html/debug.tmpl.html",Frames.Debug.templates={}},monitors:function(){!0!==Frames.Debug._dialog&&Frames.Template.get(Frames.Debug.tmpl_url+"#debug-monitors-template",function(e){Frames.Debug.templates.monitors=e;var t=Frames.Application.current();if(!Frames.isUndef(t)){var i=[{name:"CLIENT",value:Frames.browser.name+" "+Frames.browser.version}],a=Frames.Logger._MONITOR_;if(!Frames.isUndef(a)&&0<a.size())for(a.reset();a.hasNext();){var s=[],r=a.next(),n=Frames.isUndef(r.end)?-1:r.end-r.start,o=void 0!==r.tname;if(1<r.count){var l,d=r.tname?r.tname:"1 of "+r.count;for(!0===o&&s.push({name:r.name+" - "+d,value:n}),l=0;l<r.times.length;l++){var u=r.times[l],c=u.end-u.start;n+=c,d=u.name?u.name:l+2+" of "+r.count,!0===o&&s.push({name:r.name+" - "+d,value:c})}}i.push({name:r.name+(1<r.count?" ("+r.count+")":""),value:n}),!0===o&&0<s.length&&(i=i.concat(s))}i=i.sort(function(e,t){return e.name.localeCompare(t.name)});var p=Frames.Debug.templates.monitors({id:Frames.uuid(),name:"Monitors"}),m=$(p).dialog({appendTo:Frames.Dialog.container(),modal:!0,resizable:!1,autoOpen:!1,autoResize:!0,width:"auto",closeOnEscape:!0,open:function(){Frames.Debug._dialog=!0,h.resizeCanvas()},close:function(){Frames.Debug._dialog=!1}}),h=new Slick.Grid($(".table-properties",m),i,[{id:"col1",name:"Name",field:"name",width:50},{id:"col2",name:"Time (ms)",field:"value",width:50,sortable:!0}],{forceFitColumns:!0});m.dialog("open")}})},properties:function(){Frames.Template.get(Frames.Debug.tmpl_url+"#debug-item-properties-template",function(e){Frames.Debug.templates.properties=e;var t=Frames.Application.current();if(!Frames.isUndef(t)){var i=t.props(),a=t.block?t.block.props():{},s=$.extend({},a,i),r=[];$.each(s,function(e,t){var i=Frames.Debug._parsePropertyName(e);Frames.isUndef(i)||r.push({name:i,value:t})}),r=r.sort(function(e,t){return e.name.localeCompare(t.name)});var n=Frames.Debug.templates.properties({id:Frames.uuid(),name:t.label()}),o=$(n).dialog({appendTo:Frames.Dialog.container(),modal:!0,resizable:!1,autoOpen:!1,autoResize:!0,width:"auto",closeOnEscape:!0,open:function(){l.resizeCanvas()}}),l=new Slick.Grid($(".table-properties",o),r,[{id:"col1",name:_("ITEM_PROPERTIES_NAME"),field:"name",width:50},{id:"col2",name:_("ITEM_PROPERTIES_VALUE"),field:"value",width:50}],{forceFitColumns:!0});o.dialog("open")}})},_parsePropertyName:function(e){var t="ITEM_PROPERTY_"+e.toUpperCase(),i=_(t);if(-1!=$.inArray(e,["autoskip","block","type","AllowDelete","enabled","AllowInsert","name","maxlength","MultiRecord","NextItem","member","PreviousItem","AllowSearch","required","serverStatus","AllowSort","AllowUpdate"]))return i==t?e:i},message:function(){Frames.Template.get(Frames.Debug.tmpl_url+"#debug-message-template",function(e){Frames.Debug.templates.message=e;var t=Frames.Debug.templates.message({id:Frames.uuid()}),i=$(t).dialog({appendTo:Frames.Dialog.container(),modal:!0,resizable:!1,autoOpen:!0,autoResize:!0,width:"auto",closeOnEscape:!0,open:function(){}}),a=$("textarea",i);$("button",i).on("click",function(){Frames.Debug.execstring(a.val()),i.dialog("close")})})},execstring:function(e){e=e.replace(/{task}/gi,Frames.Application.task.id),Frames.Application._service.processResponse(e)},execmsg:function(e){$.ajax({url:e,processData:!1,success:function(e,t,i){Frames.Application._service.processResponse(i.responseText)}})},format:function(e){for(var t="",i=(e=(e=e.replace(/<\?.+\?>/,"")).replace(/(>)(<)(\/*)/g,"$1\n$2$3").replace(/ *(.*) +\n/g,"$1\n").replace(/(<.+>)(.+\n)/g,"$1\n$2")).split("\n"),a=0,s="other",r={"single->single":0,"single->closing":-1,"single->opening":0,"single->other":0,"closing->single":0,"closing->closing":-1,"closing->opening":0,"closing->other":0,"opening->single":1,"opening->closing":0,"opening->opening":1,"opening->other":1,"other->single":0,"other->closing":-1,"other->opening":0,"other->other":0},n=0;n<i.length;n++){var o=i[n],l=Boolean(o.match(/<.+\/>/)),d=Boolean(o.match(/<\/.+>/)),u=Boolean(o.match(/<[^!].*>/)),c=l?"single":d?"closing":u?"opening":"other",p=s+"->"+c;s=c;var m="";a+=r[p];for(var h=0;h<a;h++)m+="    ";t+=m+o+(n==i.length-1?"":"\n")}return t}})}(jQuery),function($){Frames.Query={parse:function(e){e=$.trim(e);var t=null,i=null,a=[];if(Frames.isEmpty(e))return{criteria:t,modifier:i,values:a};if(0===e.indexOf("#")){var s=/#([a-zA-Z]+)\s(.*)/.exec(e);if(s&&0<s.length)switch(t=s[1].toUpperCase()){case"LIKE":1<s.length&&a.push(s[2]);break;case"BETWEEN":(s=/^[#]BETWEEN\s+[']?([^']+)[']?\s+AND\s+[']?([^']+)[']?\s*$/.exec(e))&&1<s.length&&(t="BETWEEN",a.push(s[1]),a.push(s[2]));break;case"IS":if((s=/^[#]IS\s+(NOT\s+)?(NULL)\s*(?:(\s+[#]OR\s+[<=>]+)\s[']?(.+)[']?\s*)?$/.exec(e))&&1<s.length){t="IS",i="";for(var r=1,n=s.length;r<n;r++){var o=s[r];void 0!==o&&(r===n-1?a.push(o):i+=s[r]+" ")}i=i.replace(/^\s+|\s+$/g,"").replace(/\s+/g," ")}break;case"NOT":case"IN":(s=/^[#](NOT\s+)?IN\s*[(]?([^)]+)[)]?$/.exec(e))&&1<s.length&&(t="IN",void 0!==s[1]&&(i="NOT"),a=s[2].match(/([^)',]+)/g),a=$.map(a,function(e){return $.trim(e)}));break;default:t=null}}else{var l=/^([<=>]+)\s[']?([^']+)[']?\s*$/.exec(e);l&&1<l.length?(t=l[1],a.push(l[2])):-1<e.indexOf("%")&&(t="LIKE",a.push(e))}return{criteria:t,modifier:i,values:a}},build:function(e,t,i,a){var s="";switch(null===t&&(t=""),e=e.toUpperCase()){case"LIKE":s="#LIKE "+Frames.Query._quote(i[0],a);break;case"BETWEEN":s="#BETWEEN "+Frames.Query._quote(i[0],a)+" AND "+Frames.Query._quote(i[1],a);break;case"IS":s="#IS "+t.toUpperCase(),void 0!==i[0]&&(s+=" "+Frames.Query._quote(i[0],a));break;case"NOT":case"IN":s=Frames.isUndef(t)?"#IN ":s="#"+t.toUpperCase()+" IN ",s+="("+Frames.Query._join(i,a)+")";break;default:Frames.isUndef(e)||(s=e+" "+Frames.Query._quote(i[0],a))}return s},reverse:function(e,t,i,a){switch(e=e.toUpperCase()){case"LIKE":str=Frames.Query._unquote(i[0],a);break;case"BETWEEN":str="BETWEEN "+Frames.Query._unquote(i[0],a)+" AND "+Frames.Query._unquote(i[1],a);break;case"IS":str=Frames.isUndef(t)?"IS ":str=t.toUpperCase()+" IS ",void 0!==i[0]&&(str+=" "+Frames.Query._unquote(i[0],a));break;case"NOT":case"IN":str=Frames.isUndef(t)?"IN ":str=t.toUpperCase()+" IN ",str+="("+Frames.Query._join(i,a)+")";break;default:Frames.isUndef(e)||(str=e+" "+Frames.Query._unquote(i[0],a))}return str},applyValues:function(e,t){for(var s={},i=t.length-1;0<=i;i--){var a=t[i];a.clear(),s[a.member]=a}$.each(e,function(e,t){var i=s[t.field];if(!Frames.isUndef(i)){var a=t.value;"upper"==i.props.case&&(a=a.toUpperCase()),i.value(a)}})},_join:function(e,t){return $.map(e,function(e){return Frames.Query._quote(e,t)}).join(", ")},_quote:function(e,t){return(e=Frames.isUndef(e)?"":e).replace("'","''"),""===e||"Date"==t||"String"==t?"'"+e+"'":e},_unquote:function(e,t){return e=(e=Frames.isUndef(e)?"":e).replace(/'/g,"")}}}(jQuery),function($){Frames.Template=$.inherit({},{_URLS_:[],_KEYS_:[],_TPLS_:{},defaults:function(){return $.extend({},doT.templateSettings,{varname:"data"})},_load:function(t,i){t=Frames.addversiontourl(t),$.ajax({context:document.body,url:t,dataType:"text",success:function(e){Frames.Template._URLS_.push(t),$.isFunction(i)&&i(e)}})},create:function(e,t){var i=$.extend({},{i18n:Frames.Locale.get},t||{});return doT.template(e,Frames.Template.defaults(),i)},load:function(i,t,a,s){if(a=void 0===a||a,-1==$.inArray(i,Frames.Template._URLS_))Frames.Template._load(i,function(e){e&&(a?Frames.Template._TPLS_[i+"#"+t]=e:$.each($(e),function(){var e=$(this),t=e.attr("id");e.is("script")&&(Frames.Template._TPLS_[i+"#"+t]=e.html())})),$.isFunction(s)&&s(Frames.Template._TPLS_[i+"#"+t])});else $.isFunction(s)&&s(Frames.Template._TPLS_[i+"#"+t])},gettext:function(e,t){var i=e.split("#");if(1<i.length){var a=i[0],s=i[1];return Frames.Template.load(a,s,!1,t)}},getByName:function(e){return Frames.Template._TPLS_[e]},get:function(e,i,a){Frames.isUndef(a)&&$.isFunction(i)&&(a=i,i=null),Frames.Template.gettext(e,function(e){var t;Frames.isEmpty(e)||(t=Frames.Template.create(e,i)),$.isFunction(a)&&a(t)})},transform:function(e,t){var i=Frames.Template.create(e);return $(i(t))},put:function(e,t){Frames.Template._TPLS_[e]=t}})}(jQuery),function($){Frames.Config={__data:null,__actions:null,__actkeys:null,__keys:null,__okeys:null,init:function(e,t){this.__load(e,t)},__load:function(e,a){if(!this.__data){e=e||{},this.__data={},this.__actions=new Frames.HashMap,this.__actkeys=new Frames.HashMap,this.__keys=new Frames.HashMap,this.__okeys=new Frames.HashMap,Frames.Config.set("RUNTIME_URL",e.runtime),Frames.Config.set("ROOT_URL",e.root||".");var t=Frames._fixUrl(Frames.Config.get("ROOT_URL","."))+"/config.xml";t=Frames.addversiontourl(t),$.ajax({url:t,success:function(e,t,i){Frames.Config.__collect(e,t,i),Frames.isUndef(a)||a()},error:function(){Frames.Application._show_system_error("Framework message","error loading config file at: "+t)}})}},__collect:function(e,t,i){var a,s=$.xmlToJSON(e),r=s.find("param");for(a=0;a<r.length;a++){var n=r[a],o=n.attr("value");if(Frames.isUndef(o)){var l,d=n.find("item");if(d&&0<d.length)for(o=new Frames.HashMap,l=0;l<d.length;l++){var u=d[l];o.put(u.attr("key"),u.attr("value"))}}this.__data[n.attr("name")]=o}var c=s.find("actions/action");for(a=0;a<c.length;a++){var p,m=c[a],h={};for(p in m)if(m.hasOwnProperty(p)){var f=m[p],g=p.replace("@","");if("object"==typeof f||"function"==typeof f)continue;h[g]=f}this.regaction(h)}var _=s.find("keys/key");for(a=0;a<_.length;a++){var v,b=_[a],F={};for(v in b){var y=b[v],w=v.replace("@","");"object"!=typeof y&&"function"!=typeof y&&(F[w]=y)}void 0!==F.accesskey&&this.__keys.put(F.accesskey,F)}},get:function(e,t,i){this.__load();var a=this.__data[e];return a=Frames.isUndef(a)?t:a,!0===i&&"string"==typeof a&&(a=this._parseclazz(a)),a},getclass:function(e,t){return this.get(e,t,!0)},getbool:function(e,t){var i=this.get(e,Frames.isTrue(t));return Frames.isTrue(i)},set:function(e,t){this.__load(),this.__data[e]=t},haskeys:function(e){var t=Frames.Keys.string(e),i=Frames.Config.getaction(t);return!!i||!!(i=this.__okeys.get(t))},_convertkey:function(i){var e=(i=i.toUpperCase()).split("+"),a=[],s=[];return $.each(["CTRL","SHIFT","ALT"],function(e,t){-1!=i.indexOf(t)&&a.push(t)}),$.each(e,function(e,t){-1==$.inArray(t,["CTRL","SHIFT","ALT"])&&s.push(t)}),a.join("+")+(0<a.length&&0<s.length?"+":"")+s.join("+")},regaccesskey:function(e){var t=this._convertkey(e);this.__okeys.put(t,!0)},regaction:function(e){e&&void 0!==e.name&&(this.__load(),this.__actions.put(e.name,e),e.accesskey&&this.__actkeys.put(e.accesskey,e))},unregaction:function(e){for(this.__ACTIONS__.reset();this.__ACTIONS__.hasNext();){var t=this.__ACTIONS__.next();if(t==e){this.__ACTIONS__.remove(t);break}}},getaction:function(e){return this.__load(),this.__actkeys.get(e)},getaction_name:function(e){return this.__load(),this.__actions.get(e)},getkeyaction:function(e){return this.__load(),this.__keys.get(e)},_parseclazz:function(e){var i=function(e,t){return 0===e.length?t:i(e,null===t?window:t[e.shift()])};return clazz=i(e.split("."),null),clazz}}}(jQuery),function($,p){p.Item=$.inherit({logger:new p.Logger("Frames.Item"),__constructor:function(e,t){var i;!p.isUndef(e)&&e.jquery&&(this.elem=e,this.widget(t),this.widget("wrapper",this),i=e.data("member")),this.member=i,this._props=null,this._exts={}},objid:function(){return this.view.id+":"+this.elem.attr("id")},props:function(){if(p.isUndef(this._props)&&(this._props={},this.props("Valid",!0),this.props("ValidationEnabled",p.Config.get("VALIDATION_ENABLED",!0)),this.props("AllowUpdate",!0),this.props("AllowInsert",!0),this.props("AllowSearch",!0),this.props("AllowSort",!0),this.props("formatEnabled",!0),this.props("Navigable",!0),this.props("InputTransform",p.Config.get("INPUT_DEFAULT_FORMAT","none"))),1==arguments.length){if("string"==typeof arguments[0])return this._props[arguments[0]];if("object"==typeof arguments[0]){var e,t=arguments[0];for(e in t)this.props(e,t[e])}}if(2<=arguments.length){var i=arguments[0].replace("@",""),a=arguments[1];if(!p.isUndef(a)&&"object"==typeof a||"function"==typeof a)return;if(3==arguments.length){var s=arguments[2];if(p.isTrue(s)&&!p.isUndef(this.props(i)))return}var r=p.Item.PROP_MAP[i];if(p.isUndef(r)||p.isUndef(r.rename)||(i=r.rename,r=$.extend(p.Item.PROP_MAP[i],r)),p.isUndef(r)||p.isUndef(r.value)||(a=r.value),this._props[i]===a)return;if(this._set_prop(i,a),!p.isUndef(r)){var n=r.method;"function"==typeof this[n]&&this[n].apply(this,r.arg?[r.arg,a]:[a])}"ValidationMessage"==i&&"string"==typeof a&&0<a.length&&this.props("Valid",!1)}return this._props},_set_prop:function(e,t){this._props[e]=t},_parse_extensions:function(e){var r;if("string"==typeof e&&0===e.indexOf("{"))if(r={},-1!==e.indexOf('"'))r=JSON.parse(e);else if(-1!==e.indexOf("=")){var n=e.substring(1,e.length-1).split(",");$.each(n,function(e,t){var i=n[e],a=i.substring(0,i.indexOf("=")),s=i.substring(i.indexOf("=")+1);r[$.trim(a)]=$.trim(s)})}return r},extensions:function(){if(p.isUndef(this._exts)&&(this._exts={}),0===arguments.length)return this._exts;if(1==arguments.length){var e=arguments[0];if("string"==typeof e){if(0!==e.indexOf("{"))return this._exts[e];this._exts=this._parse_extensions(e)}}else if(2==arguments.length){var t=arguments[0],i=arguments[1];this._exts[t]=i}},data:function(){return this.elem?this.elem.data.apply(this.elem,arguments):void 0},_ev_obj:function(){return this.elem?this.elem.eq(0):$(this)},on:function(){var e=this._ev_obj();this._ev_obj().on.apply(e,arguments)},one:function(){var e=this._ev_obj();e.one.apply(e,arguments)},off:function(){var e=this._ev_obj();e.off.apply(e,arguments)},bind:function(){var e=this._ev_obj();return e.bind.apply(e,arguments)},trigger:function(){var e=this._ev_obj();e.trigger.apply(e,arguments)},widgetcls:function(){return p.isUndef(this.elem)?null:this.elem.data("widget")},widget:function(){var e=this.widgetcls();if(!p.isUndef(e)&&!p.isUndef(this.elem)){var t=this.elem[e];if(!p.isUndef(t))try{return t.apply(this.elem,arguments)}catch(e){0}}},init:function(e){this.view=e,this._last=this.mapvalue(""),p.isEmpty(this._last)||this.value(this._last),this.defaults(),this.storeDefaults(),this.autoregister(),this.elem&&this.elem.trigger("frames:init",{item:this})},_initUserEvents:function(){var e=this.props();for(var t in e)if(e.hasOwnProperty(t)&&0===t.lastIndexOf("event",0)){var i=t.slice("event".length);if("doubleclick"===i)i="dblclick";else if("click"===i){var a=this.labelObj();if(!p.isUndef(a)){var s=this;a.bind(i,function(e,t){s.focus(),s._executeEventAction.apply(s,[e,t])})}}this.bind(i,$.proxy(this._executeEventAction,this))}},_executeEventAction:function(e,t){if(this.enabled()&&!p.Application.processing()){this.elem.data("action");var i=e.type,a=this.props("event"+i);if("dblclick"===i&&(i="doubleclick",p.isEmpty(a)&&(a=this.props("event"+i))),"doubleclick"===i&&this.block.item!==this&&"repeater"===this.bindable().widgetcls()){var s=$.Event("focuschange",{target:this.input()});this.bindable().trigger(s)}p.Application.elemexec(this.elem,void 0,a)}return e.preventDefault(),e.stopImmediatePropagation(),!1},enterHasTab:function(){return!0},defaults:function(){p.isUndef(this.elem.data("enabled"))||p.isTrue(this.elem.data("enabled"))||this.enabled(!1),!p.isUndef(this.elem.data("readonly"))&&p.isTrue(this.elem.data("readonly"))&&this.readonly(!0),"none"==this.elem.data("border")&&this.elem.addClass("ui-noborder"),p.isTrue(this.elem.data("required"))&&this.required(!0);var e=this;this.elem.focus(function(){p.isTrue(e._defaults)||(e._defaults_deferred(),e._defaults=!0)}),this._checkFormat(),this._computeLabelPosition(),this._listenChanges(),this._applyDirection()},_checkFormat:function(){if(!0!==this.props("formatDefault")&&(this.props("formatDefault",!1),void 0===this.props("format")&&void 0!==this.props("type"))){var e=p.Locale.formats[this.props("type").toUpperCase()+"_FORMAT"];void 0!==e&&(this.props("format",e),this.props("formatDefault",!0))}},storeDefaults:function(){this.props("__format",this.props("format")),this.props("__type",this.props("type"))},_getDataDirection:function(e,t){p.isUndef(e)&&(e=this.elem||$());var i,a=t;return p.isUndef(i)&&(i="fixed",e.hasClass("frames-direction-auto")&&(i="auto")),"fixed"==i?a=p.Config.get("INPUT_DEFAULT_DIRECTION","ltr"):"auto"!=i&&(a=i),a},_applyDirection:function(e){if(p.isUndef(e)&&(e=p.isUndef(this.input())?this.elem.children("input,select,button"):this.input()),!p.isUndef(e)&&0<e.length){e.removeAttr("dir");var t=$.isFunction(this._getDataDirection)?this._getDataDirection():p.Item.prototype._getDataDirection.call(this);p.isUndef(t)||"Date"==this.props("type")&&("Date"!=this.props("type")||p.Locale.formats.DATE_IS_RTL)||e.attr("dir",t)}},dirty:function(){if(0===arguments.length)return this._isdirty||!1;this._isdirty=p.isTrue(arguments[0]),!0===this._isdirty&&this.block.dirty(!0)},_listenChanges:function(){var i=this,e=p.isUndef(this.input())?this.elem.children("input"):this.input();function a(){return!(!i.hasChanges()&&!i._changeNotified)&&(i._changeNotified=!0,p.Application.trigger("itemchanged",i),i.block&&i.hasChanges(!0)&&$.isFunction(i.dirty)&&i.dirty(!0),i.hasChanges()||delete i._changeNotified,!0)}!p.isUndef(e)&&0<e.length&&($.isFunction(i.optmodel)?e.on("change valuechange",function(){a()&&i._applyAutoskip(!1)}):(e.on("change valuechange",function(e){e.isTrigger&&a()}),e.on("input",function(e){var t=void 0!==i._autoskip&&i._autoskip.enabled?i._autoskip.lastlength:-1;a()?i._applyAutoskip(e.keyCode==$.ui.keyCode.BACKSPACE):0===t&&e.keyCode==$.ui.keyCode.BACKSPACE&&i._applyAutoskip(!0)})))},_applyAutoskip_reset:function(){this._autoskip&&(this._autoskip.lastlength=-1)},_applyAutoskip:function(e){if(p.Config.getbool("AUTOSKIP_ENABLED",!1)&&p.isTrue(this.props("autoskip"))){if(void 0===this._autoskip){var t,i=p.isUndef(this.input())?this.elem.children("input"):this.input(),a=this.props("type"),s=this.props("format");switch(this.on("commit",$.proxy(this._applyAutoskip_reset,this)),a){case"String":t=parseInt(this.props("maxlength"),10);break;case"Integer":if(t=parseInt(this.props("maxlength"),10),!$.isNumeric(t)){var r=parseInt(this.props("maxvalue"));$.isNumeric(r)&&(t=String(r).length)}if(!p.isUndef(s)){var n=String(s).length;(!$.isNumeric(t)||n<t)&&(t=n)}break;case"Number":t=parseInt(this.props("maxlength"),10),$.isNumeric(t)||(t=0);break;case"Date":case"Time":t=0;break;default:t=-1}$.isNumeric(t)&&0!==t?this._autoskip={enabled:!0,maxlength:t,lastlength:-1,input:i,type:a,format:s}:this._autoskip={enabled:!1}}if(void 0!==this._autoskip&&this._autoskip.enabled){var o=this.value(),l=(o||"").length,d=this._autoskip.maxlength;if(-1==d){var u=this._autoskip.type,c=this._autoskip.format;if("Date"==u)6<o.replace(/[\/\.-]/g,"").length&&p.Format.test(o,c,u)&&(d=l);else p.Format.test(o,c,u)&&(d=l)}e?0===l&&0===this._autoskip.lastlength&&this._autoskipNavigate(!0):-1!=d&&this._autoskip.lastlength<d&&l==d&&this._autoskipNavigate(!1),this._autoskip.lastlength=l}}},_autoskipNavigate:function(e){this._autoskip.lastlength=-1,p.isUndef(this.block)||this.block.processKey(this,e?"SHIFT+SKIP":"SKIP")},_unlistenChanges:function(){var e=p.isUndef(this.input())?this.elem.children("input,select,button"):this.input();!p.isUndef(e)&&0<e.length&&e.off("keyup")},restrictCase:function(){if(0<arguments.length)"upper"!=arguments[0]||p.isUndef(this.elem)||this.elem.find(":input, span.ui-widget-content").css("text-transform","uppercase");else if(!p.isUndef(this.elem))return"uppercase"==this.elem.find(":input, span.ui-widget-content").css("text-transform")?"upper":void 0},_defaults_deferred:function(){this.enterHasTab()&&(p.isUndef(this.input())?this.elem.children("input"):this.input()).keydown(function(e){e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.wich=$.ui.keyCode.TAB)});p.isUndef(this.data("accesskey"))||this.regkey(this.data("accesskey"))},processNavigationKey:function(e){return!1},destroy:function(){this.autounregister(),this.unregkeys(),this._unlistenChanges(),this.off("commit"),delete this._autoskip},model:function(){var e=this.value(),t=p.isTrue(this.props("formatEnabled"),!0);if(0===arguments.length){var i=this.hasChanges(!0),a=this.mode&&"SEARCH"==this.mode.name&&p.isTrue(this.props("AllowSearch")||!0);return i||a?("string"!=typeof(e=p.Item.formatToCanonical(e,a,t,this.props("format"),this.props("type")))||"upper"!=this.props("InputTransform")||$.isFunction(this.optmodel)||(e=e.toUpperCase()),p.Model.createItem(this.member,e)):null}var s=arguments[0];if(s){var r=s.record;if(r){var n=this.rowidx(),o=this.block.idOf(n);(p.isUndef(n)||-1==n||n>r.length-1)&&(n=0),this._block_selid&&this._block_selid!==o&&(this.props("Valid","true"),this.dirty(!1),this._block_selid=o),this._set_value(r[n])}else p.isTrue(s["@hasChanges"])&&(this.props("Valid","true"),this.dirty(!1),this._clear_value())}},rowidx:function(){return this.block.index()},rowid:function(){return this.block.selid},_clear_value:function(){this.value(""),this.ovalue(null),this._last=this.mapvalue(""),this.commitChanges()},clear:function(){this._clear_value()},_set_value:function(e){var t=p.isTrue(this.props("formatEnabled")||!0),i=this.props("type"),a=this.props("format"),s=p.find(e,"item",this.member);if(!p.Application._emptytags||!p.isUndef(s)){var r="SEARCH"==(this.mode?this.mode.name:this.block?this.block.props("blockMode"):void 0)&&p.isTrue(this.props("AllowSearch")||!0);this.props("serverStatus",p.Model.attr(e,"serverStatus"));var n,o=p.Application._supportnulls&&!p.isUndef(s)&&p.isTrue(p.Model.attr(s[0],"valueIsNull")),l=o?null:p.Model.text(s)||"";if(!r){var d=this.mapvalue(l);void 0!==d&&(l=d,o=p.isUndef(l))}if((this._last=l)!==p.Format.formatToCanonical(this.ovalue(),a,i)||this._last_value!==this.value()){var u=p.Item.formatFromCanonical(l,o,this._last,r,t,a,i);l=u.value,n=u.ovalue,this.ovalue(n),this.value(l),this.commitChanges(),p.isUndef(this._last_exec)||this._last_exec==l||p.isTrue(this.props("Valid"))||(this._last_value=this._last_exec),delete this._last_exec}}},focus:function(){},controlInfo:function(e,t){if(e){if("true"===p.Config.get("OPTIMIZATION.CONTROLINFO","false")){var i=p.findSingle(e,"item",this.member);if(!(e.properties||i&&(i.properties||i.instance)))return;if(i&&i.instance){var a=p.findSingle(i,"instance",this.block.selid,"@row");if(!a||!a.properties)return}}0,this._itemControlInfo(e,t)}},_preModelControlInfo:function(e,t){if(this._itemControlInfo(),e){var i=p.findSingle(e,"item",this.member);p.isUndef(t)||(this._set_prop("type",this.props("__type")),this._set_prop("format",this.props("__format"))),this._applyPreModelProps(i),this.storeDefaults(),t&&this._applyPreModelProps(p.findSingle(i,"instance",t,"@row"))}},_applyPreModelProps:function(e){if(e&&e.properties){var t=e.properties[0];if(!p.isUndef(t)){var i=t["@DataType"];p.isUndef(i)||this.props("type")==i||this.props("type",i);var a=t["@FormatMask"];p.isUndef(a)||this.props("format")==a||this.props("format",a)}}},_itemControlInfo:function(e,t){var i=this.block.props("blockMode");p.Modes.leave(this),p.isUndef(e)||this.itemControlInfo(e,t),p.Modes.enter(i,this)},_getItemControlInfo:function(e,t){var i,a,s={};if(this._props.Valid=!0,delete this._props.ValidationMessage,e.properties)for(i in a=e.properties[0])"string"==typeof i&&-1!==i.indexOf("@Allow")&&(s[i]=a[i]);var r=p.findSingle(e,"item",this.member);if(r){if(r.properties)for(i in a=r.properties[0])"string"==typeof i&&-1===i.lastIndexOf("@",0)||(s[i]=a[i]);this._itemInstanceControlInfo(r,s,t)}return s},itemControlInfo:function(e,t){var i,a=this._getItemControlInfo(e,t);for(i in a)a.hasOwnProperty(i)&&this.props(i,a[i])},editor:function(){if(0===arguments.length)return this.props("Editor");var e=arguments[0],t="repeater"===this.bindable().widgetcls()?this._refreshing&&!this._transforming:!this._transforming;if(e&&t){var i=this.props("format"),a=this.props("formatDefault");this._transforming=!0,"calendar"===e&&"textinput"===this.widgetcls()?this._transformWidget("datefield"):"calendar"!==e&&"datefield"===this.widgetcls()&&this._transformWidget("textinput"),this._transforming=!1,p.isTrue(a)&&!p.isUndef(i)&&this.props("format",void 0)}},_transformWidget:function(e){this.widget("destroy"),this.elem.removeData(this.elem.data("widget")),p.remove(this,p.Application.task,this.view),this.elem.data("widget",e),p.create(this.elem[0].id,this.elem,this.view),this.view._OBJS_[this.elem[0].id].init(this.view),this.widget("wrapper",this),this.defaults(),this.autoregister();var t=this.bindable();t&&"repeater"===t.widgetcls()&&t.registerRepeaterItemContext(this.elem)},_itemInstanceControlInfo:function(e,t,i){if(e.instance){var a=p.findSingle(e,"instance",i||this.block.selid,"@row");if(a&&a.properties){var s,r=a.properties[0];for(s in r)"string"==typeof s&&-1===s.lastIndexOf("@",0)||(t[s]=r[s])}}},autoregister:function(){var e=this.props("block"),t=p.Application.task.get(e);t&&t.register(this)},autounregister:function(){this.block&&this.block.remove(this)},commitChanges:function(e,t){this.trigger("commit");var i=$.isFunction(this.value)?this.value():null;this._last_value=i;var a=this.input();if(!p.isUndef(a)){var s=a.data("frames");if(!p.isUndef(s)&&!p.isTrue(s.props("DisplayAsPassword"))&&$.isFunction(s.dvalue)){var r=s.dvalue();p.isUndef(r)||a.attr("title",r)}}if(e&&void 0!==t){var n=null,o="SEARCH"==(this.mode?this.mode.name:this.block?this.block.props("blockMode"):void 0)&&p.isTrue(this.props("AllowSearch")||!0),l=p.isTrue(this.props("formatEnabled")||!0);n=!o&&l?p.Format.toValue(t,this.props("format"),this.props("type")):t,this.ovalue(n)}},hasChanges:function(e){var t=this.value();if(!0!==e)return!p.isUndef(t)&&p.isUndef(this._last_value)&&(this._last_value=""),this._last_value!=t;var i=this._last,a=this.ovalue(),s=p.isTrue(this.props("formatEnabled"),!0),r=this.props("format"),n=this.props("type");return i!=a&&s&&!p.isEmpty(a)&&(i=p.Format.formatFromCanonical(i,r,n),a=p.Format.format(a,r,n)),p.Application._supportnulls||(i=i||"",a=a||""),!p.Format.equals(i,a,r,n)},validable:function(){return this.input()},valid:function(){return p.isTrue(this.props("Valid"))&&!this.hasChanges()},toValidate:function(){return p.isTrue(this.props("ToValidate"))||!this.hasChanges()},validate:function(){if(!p.isTrue(this.props("ValidationEnabled"))||p.isUndef(this.elem))return!1;if(p.isTrue(this.props("ToValidate")))return!0;var e=!0;return this.elem.parentsUntil(".ui-window-container").each(function(){return e=p.isVisible($(this))}),e},rules:function(){var e=this.props("type");if(0===arguments.length)return{format:null!==p.Format._getFormatter(e),required:"true"===p.Config.get("VALIDATE_REQUIRED","true"),maxlength:!0,minlength:!0,maxvalue:!0,minvalue:!0};var t,i=arguments[0],a=p.gettype(this.widgetcls());if(p.isUndef(a)||(t=a.prototype.rules()),"maxlength"==i&&!p.isUndef(t)&&p.isTrue(t.maxlength)&&"Date"!=e){var s=arguments[1],r=this.input();!p.isUndef(r)&&0<r.length&&r.attr(i,s)}},input:function(){},labelObj:function(){},label:function(){},name:function(){if(0===arguments.length)return this.elem.data("name");this.elem.data("name",arguments[0])},canonicalValue:function(){return this._last},ovalue:function(){if(0===arguments.length)return p.Format.format(this._ovalue,this.props("format"),this.props("type"))!==this.value()&&(this._ovalue=p.Format.toValue(this.value(),this.props("format"),this.props("type"))),this._ovalue;this._ovalue=arguments[0]},dvalue:function(){return this._last_value},value:function(){},mapvalue:function(){return arguments[0]},clickable:function(){return!1},bindable:function(){return this},resolve:function(){return this},isContext:function(){return!1},api_mouse_target:function(e){return this.input()},describe:function(){return{draggable:this.elem,draghandle:"input",resizable:this.input(),group:"input",droppable:!1}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1,caseRestriction:!1},data:{block:!0,member:!0,datatype:!0,value:!1},validation:{required:!1,maxlength:!1,minlength:!1,maxvalue:!1,minvalue:!1}}},designprops:function(e){return e},design:function(){if(!(0<arguments.length))return p.inDesignMode||this.inDesignMode;var e,t,s=this,i=p.isTrue(arguments[0]),r=this.describe(),a=r.draggable&&r.draghandle?r.draggable.find(r.draghandle):r.draggable||this.elem;void 0===arguments[1]||arguments[1];if(r.draggable&&!p.isUndef(r.resizable)||p.Log.debug("widget %s not supported!",this.widgetcls()),i){if(this.value(""),!p.isUndef(r.resizable)&&!1!==r.resizable){a[0]&&(e=a[0].style.height,t=a[0].style.width),r.resizable.is(".ui-resizable")&&!r.resizable.is(".ui-panel,.ui-framepanel,.ui-collapsiblepanel")&&(r.resizable.resizable("destroy"),r.resizable.css("position",""),r.resizable.css("margin","")),r.resizable.resizable({grid:1,resize:function(){r.resizable.trigger("designer.resize"),s._label_position(!0)},stop:function(){s.design_refresh($.Event("resize"))}}),r.alsoResize&&r.resizable.resizable("option","alsoResize",r.alsoResize);var n=this._wrapper?this._wrapper:this.elem;n.children(".ui-wrapper,.ui-resizable-wrapper").css({padding:"",overflow:""}),r.resizable.css("display",""),this.isCanvas||"datagrid"==this.widgetcls()||(a.css("height",e),a.css("width",t));var o=n.prop("style");o.left&&o.right&&n.css("width",""),o.top&&o.bottom&&n.css("height","")}if(!1!==r.draggable){if(r.draggable.draggable({addClasses:!1,cancel:"",handle:r.draghandle,zIndex:1010,grid:[1,1],start:function(e,t){var i=$(this);t.helper.css({width:i.get(0).style.width?i.get(0).style.width:"",height:i.get(0).style.height?i.get(0).style.height:""}),!1!==r.canChangeContainer?$(this).css("display","none"):$(this).addClass("ui-container-fixed")},stop:function(e,t){var i=t.helper.data("over");p.isUndef(i)&&(i=p.Application.task.view.window()),t.helper.data("over",null);var a=t.helper.offset();r.draghandle&&(a=t.helper.find(r.draghandle).offset()),!1!==r.canChangeContainer?($(this).css("display",""),t.helper.remove(),r.draggable.css("padding",""),p.Designer._dropped(i,r.draggable,a)):($(this).removeClass("ui-container-fixed"),s.design_refresh($.Event("drag"))),i.removeClass("ui-state-active"),p.Designer._over=null}}),!1!==r.canChangeContainer){var l=p.Application.task.view.window(),d=l;l.is(".ui-layout-horizontal,.ui-layout-vertical")||"relative"!==r.draggable.css("position")||0===(d=$(".ui-designer-dragholder")).size()&&(d=$('<div class="ui-layout-horizontal ui-designer-dragholder"/>'),l.prepend(d)),r.draggable.draggable("option","helper","clone"),r.draggable.draggable("option","appendTo",d)}else"relative"===r.draggable.css("position")&&r.draggable.draggable("option","cancel","*");a.css("cursor","move"),r.draggable.off("mousedown.designer").on("mousedown.designer",function(){return p.Designer.select(s,a),!1})}p.isUndef(r.droppable)||!1===r.droppable||r.droppable.droppable({accept:"*:not(.pdialog):not(.ui-container-fixed)",hoverClass:"ui-drop-active",greedy:!0,tolerance:"pointer",over:function(e,t){var i=r.container||$(this);p.Designer._over=i,t.helper.data("over",i)},out:function(e,t){p.Designer._over=null,t.helper.data("over",null)}}),this._last_readonly=this.readonly(),this._last_enabled=this.enabled(),this._last_visible=this.visible(),this._label_position(!0),r.resizable&&this.elem.find(".ui-wrapper").css("margin","0"),p.isUndef(this.labelObj())||this.labelObj().removeAttr("for"),this.inDesignMode=!0,this.visible(this._last_visible),this.enabled(this._last_enabled),this.readonly(this._last_readonly)}else!1!==r.draggable&&(r.draggable.off("mousedown.designer"),r.draggable.draggable("destroy"),a.css("cursor","")),p.isUndef(r.resizable)||!1===r.resizable||(r.resizable.resizable("destroy"),this.isCanvas||"datagrid"==this.widgetcls()||(a.css("height",e),a.css("width",t))),p.isUndef(r.droppable)||!1===r.droppable||r.droppable.droppable("destroy"),this.value(this._last_value),p.isUndef(this._last_editable)||(this.editable(!0),delete this._last_editable),p.isUndef(this.labelObj())||p.isUndef(this.input())||(this.labelObj().attr("for",this.input().attr("id")),this.input().css({display:""})),delete this.inDesignMode},design_refresh:function(e){if(e=!!p.isUndef(e)||e){var t="none";p.isUndef(e)||p.isUndef(e.type)||(t=e.type),p.Designer.refresh(t)}},design_deselect:function(e){},design_draggable:function(){return this.elem},erroranchor:function(){return this.input()},_getaction:function(e){if(!p.isUndef(e)){var t=e.data("action");return p.isUndef(t)&&(t=e.data("eventclick")),p.isUndef(t)||"script:"!=t.substring(0,7)||(t=void 0),t}},_updateshortcut:function(e,t){var i=this._getaction(e);if(!p.isUndef(i)){var a=p.Config.getaction_name(i);if(!p.isUndef(a)&&!p.isUndef(a.accesskey)){var s=p.humanize_shortcut(a.accesskey);t=t||this.props("tooltip-original")||this.props("tooltip");var r=(p.isEmpty(t)?"":t+" ")+"("+s+")";e.attr("title",r),this._set_prop("tooltip",r),this._set_prop("tooltip-original",t)}}},updateshortcut:function(){this._updateshortcut(this.elem,void 0)},tooltip:function(){if(!(0<arguments.length))return this.props("tooltip");this.props("tooltip-original",arguments[0]),this.elem.attr("title",arguments[0]),this.updateshortcut()},enabled:function(){var e=this.input(),t=p.isUndef(e)?this.elem.children("input,select,textarea,button"):e;if(!(0<arguments.length)){if(p.inDesignMode)return p.isUndef(this._last_enabled)?!!p.isUndef(this.elem.data("x-design-enabled"))||this.elem.data("x-design-enabled"):this._last_enabled;var i=t.attr("disabled");return p.isUndef(i)||""===i}var a=p.isTrue(arguments[0]);if(p.inDesignMode)this._last_enabled=a,this.elem.data("x-design-enabled",a);else a?t.removeAttr("disabled"):t.attr("disabled","disabled");p.isUndef(t.data("widget"))&&(a?t.parent().removeClass("ui-state-disabled"):t.parent().addClass("ui-state-disabled"))},readonly:function(){if(!(0<arguments.length))return!this.editable();var e=p.isTrue(arguments[0]);this.editable(!e)},editable:function(){if(p.isUndef(this.elem))return!1;var e=p.isUndef(this.input())?this.elem.children("input,select,textarea"):this.input();if(!(0<arguments.length)){if(p.inDesignMode)return p.isUndef(this._last_readonly)?!p.isUndef(this.elem.data("x-design-readonly"))&&this.elem.data("x-design-readonly"):this._last_readonly;var t=e.attr("readonly");return p.isUndef(t)||""===t}var i=p.isTrue(arguments[0]);if(p.inDesignMode)this._last_readonly=i,this.elem.data("x-design-readonly",i);else{i?e.removeAttr("readonly"):e.attr("readonly","readonly");i?this.elem.removeClass("ui-state-readonly"):this.elem.addClass("ui-state-readonly")}},visible:function(){if(!(0<arguments.length))return p.inDesignMode?p.isUndef(this._last_visible)?!!p.isUndef(this.elem.data("x-design-visible"))||this.elem.data("x-design-visible"):this._last_visible:p.isVisible(this.elem);var e=p.isTrue(arguments[0]);if(p.inDesignMode){this.elem.data("x-design-visible",e),this._last_visible=e;var t=p.isUndef(this.input())?this.elem.children("input,select,button"):this.input();e?this.elem.removeClass("ui-designer-invisible"):this.elem.addClass("ui-designer-invisible");e?t.removeClass("ui-designer-invisible"):t.addClass("ui-designer-invisible")}else{if(e===this.visible())return;e?this.elem.show():this.elem.hide();e&&this._computeLabelPosition(!0)}},required:function(){if(!(0<arguments.length))return this.props("required");var e=p.isTrue(arguments[0]);this.props("required",p.isTrue(e));e?this.elem.addClass("ui-required"):this.elem.removeClass("ui-required")},applyformat:function(e){var t=this.mode&&"SEARCH"==this.mode.name&&p.isTrue(this.props("AllowSearch")||!0),i=this.value();if(!t){var a=p.Format.format(i,this.props("format"),this.props("type"));i!=a&&this.value(a),this.commitChanges(!0,i)}},format:function(){if(0===arguments.length)return this.props("format");var e=arguments[0];if(e){var t=this.props("formatEnabled");if((p.isUndef(t)||p.isTrue(t))&&this.props("format")!=e){var i=p.Format.format(this.ovalue(),e,this.props("type"));this.value(i),this.commitChanges()}this._set_prop("format",e)}},css:function(){var e=arguments[0],t=e.indexOf(":"),i=p.isUndef(this.input())||"hidden"===this.input().attr("type")?this.elem:this.input();if(-1!=t&&"label"==e.substr(0,t)&&(i=this.labelObj(),p.isUndef(i)&&(i=$([])),e=e.substr(t+1)),1==arguments.length){if("class"==e)return this.props("StyleClass");if(-1==t||"position"!=e&&"align"!=e&&"offset"!=e)return i.css(e);var a=i.data(e);return p.isUndef(a)||"offset"!=e||(a+="px"),a}if("class"==e){var s=this.elem.data("StyleClass");s&&"string"==typeof s&&i.removeClass(s),arguments[1]&&"string"==typeof arguments[1]&&(s=arguments[1],i.addClass(s),this.elem.data("StyleClass",s))}else-1==t||"position"!=e&&"align"!=e&&"offset"!=e?"top"==e||"left"==e?this.elem.css(e,parseInt(arguments[1]+"px",10)):"width"==e||"height"==e?("image"==this.data("widget")&&(this.elem.css(e,parseInt(arguments[1]+"px",10)),i=this.elem.children("img")),i.css(e,parseInt(arguments[1]+"px",10))):i.css(e,arguments[1]):(i.data(e,arguments[1]),this._label_position(!0))},_parseLabelText:function(){var e=p.isUndef(this.labelObj())?this.elem.children("label"):this.labelObj(),t=this.label();if(!p.isUndef(t)&&!p.isUndef(t.indexOf)){var i=!1,a=t.indexOf("{");0===a&&(t=_(t.substring(1,t.length-1)),t=e.html(t).html(),i=!0);var s=i?"&amp;":"&";if(-1!=(a=t.indexOf(s))){var r=t.substr(a+s.length,1);if(" "!==r){t=t.split(s+r).join("<u>"+r+"</u>"),e.html(t);var n=p.Config.get("KEYBOARD_SHORTCUT","ALT+");this.regkey(n+r.toUpperCase())}}}},regkey:function(e){p.isUndef(this.__ACTIONS__)&&(this.__ACTIONS__=new p.HashMap);var t={name:"action:"+p.uuid(),accesskey:e,item:this,type:"ItemAction"};p.Config.regaction(t),this.__ACTIONS__.put(t.accesskey,t)},unregkeys:function(){if(!p.isUndef(this.__ACTIONS__)){for(this.__ACTIONS__.reset();this.__ACTIONS__.hasNext();){var e=this.__ACTIONS__.next();p.Config.unregaction(e)}this.__ACTIONS__.clear(),delete this.__ACTIONS__}},_computeLabelStyle:function(){var e=this.labelObj();p.isUndef(e)||(0<e.length&&p.isEmpty(e.text())?(e.addClass("empty"),this.elem.addClass("ui-nolabel")):(e.removeClass("empty"),this.elem.removeClass("ui-nolabel")),this.elem.triggerHandler("frames:labelstyle"))},_computeLabelPosition:function(e){if(p.isTrue(e)||!p.isTrue(this._initialized)){this._initialized=!0;0,this._parseLabelText(),this._label_position(),delete this._label_changed}},_labelposition:function(){var e="default";return this.elem.hasClass("ui-label-position-top")?e="top":this.elem.hasClass("ui-label-position-right")?e="right":this.elem.hasClass("ui-label-position-bottom")?e="bottom":this.elem.hasClass("ui-label-position-left")&&(e="left"),e},_layout:function(){var e=this.elem.parent(),t="vertical";return e.hasClass("ui-layout-positional")?t="positional":e.hasClass("ui-layout-horizontal")&&(t="horizontal"),t},_label_position:function(e){if(e=p.isTrue(e),p.Application._pos_lbl_enabled||e){if(p.isTrue(this.isCanvas))return;var t=p.isUndef(this.labelObj())?this.elem.children("label"):this.labelObj(),i=t.data("align");p.isEmpty(i)||(this.elem.removeClass("ui-label-align-start").removeClass("ui-label-align-center").removeClass("ui-label-align-end"),this.elem.addClass("ui-label-align-"+i));var a=this._labelposition(),s=t.data("position");if(!e&&a==s)return;p.isEmpty(s)&&(s=a);var r=p.isUndef(this.input())?this.elem.children("input,select,button"):this.input(),n=this.elem?this.elem.parent():[];if(!p.isUndef(r)&&!p.isUndef(t)&&0<n.length){var o=this._layout();e&&t.css({bottom:"",top:"",left:"",right:"","margin-left":"","margin-right":"","margin-bottom":"","margin-top":"",float:""}),this.elem.removeClass("ui-label-position-top").removeClass("ui-label-position-right").removeClass("ui-label-position-bottom").removeClass("ui-label-position-left").removeClass("ui-label-position-default"),t.data("position",s),this.elem.addClass("ui-label-position-"+s),p.inDesignMode&&"left"===s&&t.data("position",""),"positional"===o||"bottom"===s?0===t.index()&&t.appendTo(this.elem):0!==t.index()&&t.prependTo(this.elem),this._applyLabelOffset(t,s)}}},_applyLabelOffset:function(e,t){var i=e.data("offset");if(i&&0!==i)switch(i+="px",t){case"top":e.css("margin-bottom",i);break;case"bottom":e.css("margin-top",i);break;case"right":e.css("margin-left",i);break;default:e.css("margin-right",i)}}},{_getSearchFormatEnabled:function(){return void 0===p.Item.__formatinsearch&&(p.Item.__formatinsearch=p.Config.getbool("FORMAT_SEARCH_MODE",!0)),p.Item.__formatinsearch},formatFromCanonical:function(e,t,i,a,s,r,n){if(a){var o=p.Item._getSearchFormatEnabled(),l=p.Query.parse(e);if(l.criteria){var d=l.values;"LIKE"!=l.criteria&&o&&(d=$.map(l.values,function(e){return p.Format.formatFromCanonical(e,r,n)})),e=p.Query.reverse(l.criteria,l.modifier,d)}else o&&(e=p.Format.formatFromCanonical(e,r,n))}var u;return t||a||!s?u=i:(u=p.Format.toValueFromCanonical(e,n),e=p.Format.formatFromCanonical(e,r,n)),{value:e,ovalue:u}},formatToCanonical:function(e,t,i,a,s){if(t){var r=p.Item._getSearchFormatEnabled(),n=p.Query.parse(e);if(n.criteria){var o=n.values;"LIKE"!=n.criteria&&r&&(o=$.map(n.values,function(e){return p.Format.formatToCanonical(e,a,s)})),e=p.Query.build(n.criteria,n.modifier,o,s)}else r&&(e=p.Format.formatToCanonical(e,a,s))}else i&&!p.isEmpty(e)&&(e=p.Format.formatToCanonical(e,a,s));return e},password:function(e){var t=this.input();if(t){var i=t.attr("type");p.isTrue(e)&&"password"!=i&&t.clone(!0).attr("type","password").insertAfter(t).prev().remove(),elseif(!p.isTrue(e)&&"text"!=i),t.clone(!0).attr("type","text").insertAfter(t).prev().remove()}},PROP_MAP:{HasServerValidation:{rename:"validation",value:"server"},Validation:{rename:"validation"},Required:{rename:"required",method:"required"},Enabled:{method:"enabled"},ReadOnly:{rename:"readonly",method:"readonly"},readonly:{method:"readonly"},Visible:{method:"visible"},format:{method:"format"},FormatMask:{rename:"format"},DataType:{rename:"type"},transform:{rename:"InputTransform"},case:{rename:"InputTransform"},InputTransform:{method:"restrictCase"},Tooltip:{method:"tooltip",rename:"tooltip"},Editor:{method:"editor"},AutoSkip:{rename:"autoskip"},Value:{rename:"value"},FalseValue:{rename:"fvalue"},FalseValueIsNull:{rename:"fvalueisnull"},ValueIsNull:{rename:"valueisnull"},UnmatchedValue:{rename:"unvalue"},UnmatchedValueIsNull:{rename:"unvalueisnull"},Extensions:{rename:"extensions",method:"extensions"},maxlength:{method:"rules",arg:"maxlength"},minlength:{method:"rules",arg:"minlength"},maxvalue:{method:"rules",arg:"maxvalue"},minvalue:{method:"rules",arg:"minvalue"},MaxLength:{rename:"maxlength"},MinLength:{rename:"minlength"},MaxValue:{rename:"maxvalue"},MinValue:{rename:"minvalue"},FontFamily:{method:"css",arg:"fontFamily"},FontSize:{method:"css",arg:"fontSize"},FontColor:{method:"css",arg:"color"},BackgroundColor:{method:"css",arg:"background"},StyleClass:{method:"css",arg:"class"},class:{method:"css",arg:"class"},Label:{method:"label"},PromptText:{method:"label"},LabelPosition:{method:"css",arg:"label:position"},LabelAlign:{method:"css",arg:"label:align"},labeloffset:{method:"css",arg:"label:offset"},LabelOffset:{rename:"labeloffset"},labelfontfamily:{method:"css",arg:"label:fontFamily"},LabelFontFamily:{rename:"labelfontfamily"},labelfontsize:{method:"css",arg:"label:fontSize"},LabelFontSize:{rename:"labelfontsize"},labelcolor:{method:"css",arg:"label:color"},LabelFontColor:{method:"css",arg:"label:color"},LabelBackgroundColor:{method:"css",arg:"label:backgroundColor"},labelstyle:{method:"css",arg:"label:class"},LabelStyleClass:{method:"css",arg:"label:class"},top:{method:"css",arg:"top"},left:{method:"css",arg:"left"},height:{method:"css",arg:"height"},width:{method:"css",arg:"width"},Y:{rename:"top"},X:{rename:"left"},Height:{rename:"height"},Width:{rename:"width"},DisplayAsPassword:{method:"password"}},PROP_OVERRIDE:{Enabled:"false",Valid:"false"}}),p.Item.prototype._call=p.Item.prototype.widget,p.regtype("item",p.Item)}(jQuery,Frames),function($,M){M.Block=$.inherit({__constructor:function(e){this.name=e,this.item=null,this.selid=null,this._ITEMS_=new M.HashMap,this._BINDS_=new M.HashMap,this._exts={},this._exts_items=new M.HashMap,this._props={AllowUpdate:"true",AllowInsert:"true",AllowSearch:"true",AllowDelete:"true",AllowSort:"true"},this._ctrinf=null,this._recs=new M.HashMap},destroy:function(){for(this._ITEMS_.reset();this._ITEMS_.hasNext();){this._ITEMS_.next().destroy()}this._ITEMS_.clear(),this._BINDS_.clear(),this._recs.clear(),delete this._ITEMS_,delete this._BINDS_,delete this.item,delete this._ctrinf,delete this._recs,delete this._exts,delete this._exts_items},props:M.Item.prototype.props,_set_prop:M.Item.prototype._set_prop,extensions:M.Item.prototype.extensions,_parse_extensions:M.Item.prototype._parse_extensions,_clearextitems:function(){this._exts_items.clear()},_addextitem:function(e,t){this._exts_items.put(e,t)},getextitem:function(e){if(1==arguments.length){var t=this._exts_items.get(e);return M.isUndef(t)&&!M.isUndef(this.get(e))&&(t=this.get(e).extensions()),t}if(!0!==this._exts_items_init){for(this._ITEMS_.reset();this._ITEMS_.hasNext();){var i=this._ITEMS_.next(),a=i.extensions();M.isUndef(a)||$.isPlainObject(a)||this._addextitem(i.member,null)}this._exts_items_init=!0}return this._exts_items.keys()},css:$.noop,bindable:function(e){var t=e.objid();this._BINDS_.put(t,e)},getbnd:function(e){return this._BINDS_.get(e)},get:function(e){return this._ITEMS_.get(e)},getRegisteredItems:function(){return this._ITEMS_},rindex:function(){if(0===arguments.length)return M.isUndef(this.paging)?this.selidx+1:this.paging.record},index:function(){if(0===arguments.length)return this.selidx;"string"==typeof arguments[0]?(this.selid=arguments[0],this.selidx=this.indexOf(this.selid)):"number"==typeof arguments[0]&&(this.selidx=arguments[0],this.selid=this._recs._keys[this.selidx]),this._last_id!==this.selid&&($(this).trigger("indexchange",{selidx:this.selidx,selid:this.selid,record:(this.paging.number-1)*this.paging.size+this.selidx+1}),this.refresh()),this._last_id=this.selid},select:function(e){e=String(e),this.selid!=e&&this.dirty(!0),this.selid=e,this.selidx=this.indexOf(e),this._last_id=this.selid,M.isUndef(this.paging)||(this.paging.record=this.selidx+1),this.refresh()},indexOf:function(e){return this._recs.indexOf(e)},idOf:function(e){return this._recs.keys().length>e?this._recs.keys()[e]:""},model:function(){var e,t;if(0===arguments.length){if(M.Application._performance&&!this.hasChanges())return;0;var i=M.Model.createBlock(this.name),a=M.Model.createRecord(M.isUndef(this.selid)?null:this.selid);for(this._BINDS_.reset();this._BINDS_.hasNext();)t=this._BINDS_.next(),(this.bindAllViews||t.view==this.task.view)&&(e=t.model())&&("block"==M.Model.name(e)?this._mergeModel(i,e):M.Model.append(a,e,"item"));if(M.Model.hasChildren(a)){M.Model.attr(a,"status","C");var s=M.Model.createBlock();M.Model.append(s,a),this._mergeModel(i,s)}return M.isUndef(this.selid)||""===this.selid?M.Model.hasChildren(i)||(i=null):M.Model.attr(i,"selected",this.selid),i}if(e=arguments[0],M.Application._emptytags||(this._recs=new M.HashMap),$(this).trigger("prebind",e),this.dirty(!1),e){var r,n,o=M.find(e,"block",this.name);if(o){var l=(e=o[0]).page;if(M.isUndef(l)&&e.record)l=[$.xmlToJSON('<page enabled="false" pageNumber="1" pageSize="1" totalPages="1" totalRecords="'+e.record.length+'" />')];M.isUndef(l)||(M.isUndef(this.paging)&&(this.paging=new M.Paging(this)),this.paging.controlInfo(l[0])),this._last_id=this.selid;var d=M.Model.attr(e,"selected");this.selid=d||this._last_id,this._last_model_id=this.selid,this.selidx=-1,this.master=M.isTrue(M.Model.attr(e,"master"));var u=this._last_id!=this.selid,c=M.isUndef(M.Model.attr(e,"hasChanges"))||M.isTrue(M.Model.attr(e,"hasChanges"));if(this._recs=new M.HashMap,M.isUndef(this.selid)){if((r=c||M.isUndef(this._last_model)?e.record:this._last_model.record)&&0<r.length)for(this.selid=M.Model.attr(r[0],"id"),n=this.selidx=0;n<r.length;n++)this._recs.put(M.Model.attr(r[n],"id"),n);M.isUndef(this.selid)&&(this.selid="")}else if((r=c||M.isUndef(this._last_model)?e.record:this._last_model.record)&&0<r.length)for(n=0;n<r.length;n++)M.Model.attr(r[n],"id")==this.selid&&(this.selidx=n,this.selstatus=M.Model.attr(r[n],"serverStatus"),this.selchanged=M.isTrue(M.Model.attr(r[n],"serverStatus"))),this._recs.put(M.Model.attr(r[n],"id"),n);if(this._last_id=this.selid,c||u){c||M.isUndef(this._last_model)?this._last_model=e:(u&&M.Model.attr(this._last_model,"selected",this.selid),M.Model.attr(this._last_model,"hasChanges","false")),$(this).trigger("startbind",e);var p=u?this._last_model:e;for(this._BINDS_.reset();this._BINDS_.hasNext();)t=this._BINDS_.next(),this._model_item(t,p);return $(this).trigger("endbind",e),void $(this).trigger("postbind",e)}for(this._BINDS_.reset();this._BINDS_.hasNext();)t=this._BINDS_.next(),$.isFunction(t._dynmodel)?t._dynmodel():this._dynamic_model_item(t)}if(!M.isUndef(this.selid)&&-1!=this.selid)for(this._BINDS_.reset();this._BINDS_.hasNext();)"function"==typeof(t=this._BINDS_.next()).selected&&t.selected(this.selid)}$(this).trigger("postbind",e)},refresh:function(){var e=M.isUndef(this.item)?null:this.item.bindable();for(this._BINDS_.reset();this._BINDS_.hasNext();){var t=this._BINDS_.next();if("function"==typeof t.bindable){var i=t.bindable();if(e!=i)if("datagrid"==i.widgetcls()||"repeater"==t.widgetcls()||0<=String(t.widgetcls()).indexOf("chart"))t.selected(this.selid);else{var a=this._last_model,s=M.findExp(a,"record[@id="+this.selid+"]");s&&(a=M.Model.create("block"),M.Model.append(a,s[0]),this._model_item(t,a))}}}},_model_item:function(e,t){var i=M.isTrue(this.extensions("BIND_ALWAYS"));(e.view==this.task.view||i)&&(this._dynamic_model_item(e),e.model(t))},_dynamic_model_item:function(e){if($.isFunction(e.dynmodel)){var t=this.name+"."+e.member,i=this.task.list(t);M.isUndef(i)||e.dynmodel(i)}},_preModelControlInfo:function(e,t){if(e){if(e.properties){var i,a=e.properties[0];for(i in a)"string"==typeof i&&-1===i.lastIndexOf("@")||this.props(i,a[i])}this.props("blockMode",M.Model.attr(e,"blockMode")),this._mergedInfo(e);var s,r={};for(this._ITEMS_.reset();this._ITEMS_.hasNext();){var n=this._ITEMS_.next(),o=n.bindable(),l=this._ctrinf;M.isUndef(o)||o==n?$.isFunction(n._preModelControlInfo)&&(M.isUndef(s)&&t&&(s=M.Model.attr(t,"selected")),n._preModelControlInfo(l,s)):r[o.id]||o.block.name==M.Model.attr(e,"name")&&(r[o.id]=!0,$.isFunction(n._preModelControlInfo)&&o._preModelControlInfo(l))}0}},controlInfo:function(e){if(e){this._clearextitems();var t=this.props("blockMode");if(e.properties){var i,a=e.properties[0];for(i in a)"string"==typeof i&&-1===i.lastIndexOf("@")||this.props(i,a[i])}this.props("blockMode",M.Model.attr(e,"blockMode"));var s=this._laststatus!=this.selstatus;if(this._laststatus=this.selstatus,this.props("blockMode")!=t||e.properties||e.item||s){if(e.item){var r,n=[];for(this._exts_items_init=!1,r=0;r<e.item.length;r++){var o=e.item[r],l=o.properties?o.properties[0]:void 0,d=l?M.Model.attr(l,"Extensions"):void 0;if(!M.isUndef(d)&&"{}"!=d){var u,c=this._parse_extensions(d);if("Filter"!==c.ViewMode)continue;for(u in l)"string"==typeof u&&-1===u.lastIndexOf("@")||0===u.lastIndexOf("@Extensions")||(c[u.replace("@","")]=l[u]);if(!M.isEmpty(o.buttons)){for(var p={},m=o.buttons[0].button,h=0,f=m.length;h<f;h++){var g=m[h].properties[0],_=M.Model.attr(g,"Value"),v=M.Model.attr(g,"Label");p[_]=v}c.data=p}this._addextitem(M.Model.attr(o,"name"),c),n.push(r)}}if(!M.isEmpty(n))for(r=n.length-1;0<=r;r--)e.item.splice(n[r],1)}var b=e;if((e=this._ctrinf||e).item){var F,y=this.task._NOBJS_;for(F=0;F<e.item.length&&0<y.size();F++){var w=this.name+"."+M.Model.attr(e.item[F],"name"),C=y.get(w);if(!M.isUndef(C)){var x=C.elem.attr("id");(M.isUndef(x)||""===x)&&(x=M.uuid(),C.elem.attr("id",x)),M.get(x,void 0,C.view,C.elem),y.remove(w)}}}var k,T={};if(M.Application._emptytags){if(e.item)for(k=0;k<e.item.length;k++){var E=e.item[k],A=M.Model.attr(E,"name"),D=this._ITEMS_.get(A);if(D){var I=D.bindable();M.isUndef(I)||I==D||M.isTrue(T[I.id])||O.block.name==M.Model.attr(e,"name")&&(T[I.id]=!0,I.controlInfo(e,void 0,b)),D.controlInfo(e,void 0,b);var S=M.getplugs(M.PLUGIN_CONTROLINFO);for(S.reset();S&&S.hasNext();)S.next().apply(D,e)}}}else for(this._ITEMS_.reset();this._ITEMS_.hasNext();){var O=(h=this._ITEMS_.next()).bindable();M.isUndef(O)||O==h?h.controlInfo(e):T[O.id]||O.block.name==M.Model.attr(e,"name")&&(T[O.id]=!0,O.controlInfo(e,void 0,b));var U=M.getplugs(M.PLUGIN_CONTROLINFO);for(U.reset();U&&U.hasNext();)U.next().apply(h,e)}}0}},_mergedInfo:function(e){var t;if(e)if(this._ctrinf&&M.Application._mergectrinfo){if(this._mergeNode(this._ctrinf,e),e.item)for(t=0;t<e.item.length;t++){var i=e.item[t],a=M.find(this._ctrinf,"item",M.Model.attr(i,"name"),!0);a?this._mergeNode(a[0],i):M.Model.append(this._ctrinf,i,"item")}}else this._ctrinf=e;return this._ctrinf},_getAttr:function(e,t){return M.Model.attr(e,t)},_getChild:function(e,t,i){var a=this,s=$.map(e,function(e){if(a._getAttr(e,t)==i)return e});return 0<s.length?s[0]:void 0},_mergeModel:function(e,t,i){if("block"==(i=M.Model.name(e)||i)){var a=(o=M.Model.children(t,!0)).length;for(c=0;c<a;c++){var s=o[c],r=this._getAttr(s,"id"),n=this._getChild(M.Model.children(e,!0),"id",r);n?this._mergeModel(n,s,"record"):M.Model.append(e,s,"record")}}else if("record"==i){var o,l=(o=M.Model.children(t,!0)).length;for(j=0;j<l;j++){var d=o[j],u=this._getAttr(d,"name"),c=this._getChild(M.Model.children(e),"name",u);c?c.value=d.value:M.Model.append(e,d,"item")}}},_mergeNode:function(e,t){if(!M.isUndef(t)){var i;for(i in t)0===i.lastIndexOf("@",0)&&M.Model.attr(e,i.substr(1),M.Model.attr(t,i.substr(1)));if(t.properties&&(e.properties?(delete e.properties[0]["@Valid"],delete e.properties[0]["@ValidationMessage"],delete e.properties[0]["@Error"],this._mergeNode(e.properties[0],t.properties[0])):M.Model.append(e,t.properties[0],"properties")),e.instance){var a,s=e.instance.length;for(a=0;a<s;a++){var r=e.instance[a];delete r.properties[0]["@Valid"],delete r.properties[0]["@ValidationMessage"],delete r.properties[0]["@Error"]}}if(t.instance){var n,o=t.instance.length;for(n=0;n<o;n++){var l=t.instance[n],d=M.Model.attr(l,"row"),u=M.findSingle(e,"instance",d,"@row");u?this._mergeNode(u.properties[0],t.instance[n].properties[0]):M.Model.append(e,t.instance[n],"instance")}}if(t.buttons&&(e.buttons?this._mergeNode(e.buttons[0],t.buttons[0]):M.Model.append(e,t.buttons[0],"buttons")),t.button){var c,p=t.button.length;for(c=0;c<p;c++){var m=t.button[c],h=M.Model.attr(m,"name"),f=M.Model.findExp(e,"button[@name="+h+"]");f?this._mergeNode(f[0],m):M.Model.append(e,m,"button")}}}},ctrlProp:function(e,t,i){var a=e.member,s=M.find(this._ctrinf,"item",a);s&&s[0].properties&&M.Model.attr(s[0].properties[0],t,i)},register:function(e){e&&(e.block=this,e.member=e.props("member"),this._ITEMS_.put(e.member,e),e.bind("focus",$.proxy(this._itemOnFocusIn,this)),e.bind("focuschange",$.proxy(this._itemOnFocusChange,this)),e.bind("focusout",$.proxy(this._itemOnFocusOut,this)),e.bind("keydown",$.proxy(this._keyEventHandler,this)),M.isUndef(this._last_model)||(e.controlInfo(this._ctrinf,e.rowid()),this._model_item(e,this._last_model)))},remove:function(e){this._ITEMS_.remove(e),this._BINDS_.remove(e),M.inDesignMode&&!M.isUndef(M.Designer.formService)&&M.Designer.formService.itemRemoved(e)},rowChanged:function(){return this._last_id!=this.selid||void 0!==this._selid_click&&this._selid_click!==this.selid||this._last_id!==this._last_model_id},commitChanges:function(){if(this.task.block=this,M.Application.task=this.task,this._last_id=this.selid,!M.isUndef(this.paging)){var e=$.validator.format(M.Locale.messages.Record+": {0}/{1}",this.rindex(),this.paging.records);M.StatusBar.record(e)}M.StatusBar.context(this.item&&this.item.mode?this.item.mode.name:this.props("blockMode")),M.StatusBar.info(this.name+"."+(this.item?this.item.member:"<none>")+" ["+this.rindex()+"]"),this._itemActivate(this.item),M.ToolBar.refresh()},_itemActivate:function(e){if(e){this._itemInactivate(this.task._lastitem,e);var t=$.isFunction(e.widget)?e.widget():void 0;M.isUndef(t)||t.addClass("ui-widget-active"),M.Application.trigger("itemactivated",this.item),M.Workspace&&$.isFunction(M.Workspace.activate)&&M.Workspace.activate(),this.task._lastitem=e}},_itemInactivate:function(e,t){if(e){var i=$.isFunction(e.widget)?e.widget():void 0;M.isUndef(i)||i.removeClass("ui-widget-active");var a=$.isFunction(e.bindable)?e.bindable():void 0;if(!M.isUndef(a)&&"datagrid"==a.widgetcls()&&!M.isUndef(t)){var s=$.isFunction(t.bindable)?t.bindable():void 0;(t.block!=e.block||!M.isUndef(s)&&a.widgetcls()!=s.widgetcls())&&a.closeEditor()}M.Application.trigger("iteminactivated",this.item)}},_itemOnFocusIn:function(e){var t=$(e.target).data("frames");t&&(t=t.resolve?t.resolve():t,M.Application.trigger("refresh"),M.FocusManager.validate(t))},_itemOnFocusChange:function(e){var t=$(e.target).data("frames");if(t){var i="datagrid"!=t.bindable().widgetcls(),a=this.item;if(a=a&&$.isFunction(a.resolve)?a.resolve():a,i&&a&&a.valid()&&a.elem&&M.isTrue(a.props("formatEnabled"))){var s=M.Format.format(a.value(),a.props("format"),a.props("type"));a.value(s)}if(this.item=t,this.commitChanges(),i&&a&&a.valid()&&t&&M.isTrue(t.props("formatEnabled"))&&t.editable()){var r=t.value(),n=M.Format.unformat(r,t.props("format"),t.props("type"));r!==n&&t.value(n)}}},_itemOnFocusOut:function(e){},_applyformat:function(e,t){if(e){var i="datagrid"!=e.bindable().widgetcls(),a=e.props("type"),s=e.editable()&&"String"!==a;i&&M.isTrue(e.props("formatEnabled"))&&s&&e.applyformat(t)}},_keyEventHandler:function(e){var t=$(e.target).data("frames"),i=M.Keys.string(e);if(this.processKey(t,i))return e.preventDefault(),e.stopImmediatePropagation(),!1},processKey:function(e,t){if(M.isUndef(e))return!1;if(e.processNavigationKey(t))return!0;var i=M.Config.getkeyaction(t);if(i){var a=e.props("keyactions");if(a){var s,r=a.split(",");for(s=0;s<r.length;s++){if(r[s]==i.name)return this._actexecute(e,i.action)}}}var n=M.Config.getaction(t);return n&&"TAB"!=t&&"SHIFT+TAB"!=t?this._actexecute(e,n):("SKIP"===t||"SHIFT+SKIP"===t)&&this._actexecute(e,"SKIP"===t?"SKIP_NEXT":"SKIP_PREV")},_actexecute:function(e,t){var i="string"==typeof t?M.Config.getaction_name(t):t,a=i&&i.validation?M.isTrue(i.validation):void 0,s=!0;return(void 0===a||a)&&(s=M.Validation.validateFormat(e)),!!s&&(this._applyformat(e,!1),this._itemInactivate(e),M.Application._actexecute(i||t),!0)},dirty:function(){if(0===arguments.length)return this._isdirty||!1;this._isdirty=M.isTrue(arguments[0])},isMultiRecord:function(e){var t=this.props("MultiRecord");if(M.isUndef(t)&&e){var i=e.properties;M.isUndef(t)&&i&&(t=M.Model.attr(i[0],"MultiRecord"))}return M.isTrue(t)},hasChanges:function(){if(!M.isUndef(this.selchanged)&&this.selchanged&&"INSERTED"==this.selstatus)return!0;if(this.rowChanged())return!0;var e=this.props("blockMode");if("SEARCH"===e)return!0;if("READ"===e)return!1;if(this.dirty())return!0;if(M.Application._performance)return!1;for(this._BINDS_.reset();this._BINDS_.hasNext();){var t=this._BINDS_.next().bindable();if(t.hasChanges(!0)||t.dirty())return!0}return!1}})}(jQuery,Frames),function($,s){s.Canvas=$.inherit(s.Item,{__constructor:function(e){this.root=this.elem=e;var t=e.data("name");s.isUndef(t)&&$(this).data("name",$(this).attr("id")),this.name=e.data("name"),this.type=e.data("class"),this.widget(),this.widget("wrapper",this),this.isCanvas=!0},autoregister:function(){s.isEmpty(this.name)||this.view.register(this)},controlInfo:function(){var e=s.findSingle(this.view._wininf,"canvas",this.name);e&&e.properties&&(void 0!==e.properties[0]["@Popup"]&&this.popup(s.isTrue(e.properties[0]["@Popup"])),void 0!==e.properties[0]["@Title"]&&this.title(e.properties[0]["@Title"]),void 0!==e.properties[0]["@Visible"]&&(s.isTrue(e.properties[0]["@Visible"])?this.show():this.hide()))},autounregister:function(){this.view&&!s.isEmpty(this.name)&&this.view.remove(this)},describe:function(){var e={draggable:this.elem,draghandle:"",resizable:this.elem,group:"container"},t=this.elem.find(".ui-layout-grid .ui-layout-cell, .ui-layout-gridflow .ui-layout-horizontal");return 0<t.length?e.droppable=t:e.droppable=this.elem,e},hide:function(){this.isVisible()&&(this._popup&&this.closePopup(),this.root.hide(),$(this).trigger("afterhide"))},show:function(){return!this.isVisible()&&(this.root.show(),$(this).trigger("aftershow"),this._popup&&this.openPopup(),!0)},popup:function(e){this._popup=e},title:function(e){this._title=e,this._popup&&this.setPopupTitle(e)},openPopup:function(){if(this._popup_init)this.root.dialog("open");else{var e=this._title,a=this.root.parent(),t=this.root.height()+s.Canvas.POPUP_HEADER_HEIGHT,i=this.root.width();this.root.css("zIndex",""),this.root.dialog({classes:{"ui-dialog":"ui-popup-canvas"},closeOnEscape:!1,height:t,width:i,title:e,resizable:!1,open:function(e,t){var i=$(e.target).parent();i.draggable("option","containment",a).appendTo(a),$(this).dialog("option","position",{my:"center",at:"center",of:a})}}),this._popup_init=!0}},closePopup:function(){this._popup_init&&this.root.dialog("close")},setPopupTitle:function(e){this._popup_init&&this.root.dialog("option","title",e)},isVisible:function(){return s.isVisible(this.root)},_computeLabelPosition:$.noop},{POPUP_HEADER_HEIGHT:40})}(jQuery,Frames),function($,s){s.Paging=$.inherit({__constructor:function(e){var i=this;this.block=e,this.number=-1,this.size=-1,this.pages=-1,this.records=-1,this.record=-1,this.index=-1,this.multiple=!0,this.enabled=!0,this.unit="page",this.view=s.Application.task.view,this._idx_change=function(e,t){i.record=t.record},$(e).on("indexchange",this._idx_change)},controlInfo:function(e){if(e){this.number=parseInt(s.Model.attr(e,"pageNumber"),10),this.size=parseInt(s.Model.attr(e,"pageSize"),10),this.pages=parseInt(s.Model.attr(e,"totalPages"),10),this.records=parseInt(s.Model.attr(e,"totalRecords"),10),this.record=parseInt(s.Model.attr(e,"recordIndex"),10);var t=s.Model.attr(e,"multiRecord"),i=s.Model.attr(e,"enabled"),a=s.Model.attr(e,"unit");void 0!==a&&(this.unit=a),void 0!==i&&(this.enabled=s.isTrue(i)),void 0!==t&&(this.multiple=s.isTrue(t)),$.isNaN(this.record)&&(this.record=1),$.isNaN(this.number)&&(this.number=1),$.isNaN(this.size)&&(this.size=1),-1==this.pages&&(this.pages=Math.floor(this.records/this.size)),this.index=this.record-(this.number*this.size-this.size)-1}},first:function(){this.unit,this.execute("FIRST_PAGE")},next:function(){"record"==this.unit?this.execute("NEXT_RECORD"):this.execute("NEXT_PAGE")},execute:function(e,t){var i=this.block.item;if(s.isUndef(i)){if(i=this.block.get(0),s.isUndef(i)){var a=this.block.getbnd(0);$.isFunction(a.getItemContext)&&(i=a.getItemContext(0))}if(s.isUndef(i))return}s.Application.execute({name:e,params:t},void 0,void 0,this.block.name,i.member,!1)},previous:function(){"record"==this.unit?this.execute("PREVIOUS_RECORD"):this.execute("PREVIOUS_PAGE")},last:function(){this.unit,this.execute("LAST_PAGE")},page:function(e){this.execute("GOTO_PAGE",[{name:"page",value:e,type:"int"}])},setup:function(e,t,i){var a=[{name:"pageSize",value:e,type:"int"}];!1===i&&a.push({name:"reset",value:"false",type:"boolean"});var s=t?"LOV_SETUP_PAGE":"SETUP_PAGE";this.execute(s,a)},single:function(){this._lastsize=this.size,this._lastmultiple=this.multiple,this.setup(1,void 0,!1),this.multiple=!1},restore:function(){this.setup(this._lastsize,void 0,!1),this.multiple=this._lastmultiple,delete this._lastsize,delete this._lastmultiple},destroy:function(){$(block).off("indexchange",this._idx_change)}})}(jQuery,Frames),function($,p){p.Task=$.inherit({logger:new p.Logger("Frames.Task"),__constructor:function(e,t){this.id=e,this.name=t,this.view=null,this.block=null,this._NOBJS_=new p.HashMap,this._VIEWS_=new p.HashMap,this._BLOCKS_=new p.HashMap},toString:function(){return"Frames.Task"},blocks:function(e){var t;for(t in e)if(!p.isEmpty(t)){var i=this._BLOCKS_.get(t);if(!i){var a=e[t];((i=$.isPlainObject(a)?new p.Block(t,a):a).task=this)._BLOCKS_.put(t,i)}}},remove:function(e){this._BLOCKS_.remove(e)},get:function(e){if(!p.isUndef(this._BLOCKS_)){var t=this._BLOCKS_.get(e);if(!p.inDesignMode&&p.isUndef(t)&&!p.isUndef(e)){var i={};i[e]={},this.blocks(i),t=this._BLOCKS_.get(e)}return t}},getView:function(e){return this._VIEWS_.get(e)},setContainerTitle:function(e){var t=this.container();if(!p.isUndef(t)){var i=t.index();-1!=i&&t.children("ul").children("li").eq(i-1).find("a").text(e)}},container:function(){if(0===arguments.length)return this._container;this._container=arguments[0]},focus:function(){var e=(p.Application.task=this).container();if(!p.isUndef(e)){var t=p.Application.getTaskContainer(this),i=p.Application.getTaskContainerIndex(this);t.tabs("option","active",i)}},isLoading:function(){return!p.isUndef(this._loading_view)},loading:function(){if(0===arguments.length)return this._loading_view;p.isUndef(arguments[0])?delete this._loading_view:this._loading_view=arguments[0]},openView:function(e,t,i){this.logger.time("VIEW",!0);var a=p.View.getViewId(e);this.callback=i,this.loading(a);var s=this._VIEWS_.get(a);s?(s.show(),this._viewReady(s,"success")):(this._hideAllViews(s,t),this.logger.time("VIEW_GET",!0),(s=new p.View(e,t)).task=this,s._task_container=this.container(),this.view=s,this._VIEWS_.put(a,s),s.load($.proxy(this._viewReady,this)))},_hideAllViews:function(a,e){var s=this;if(!e){var t=this._VIEWS_.keys().slice();$.each(t,function(e,t){var i=s._VIEWS_.get(t);i===a||i.modal||i.hide()})}},closeView:function(e){var t=new p.HashMap;for(var i in e._OBJS_){var a=e._OBJS_[i];if(p.isUndef(a)||p._destroy_plugins(a),a.block){var s=a.block.name;t.hasKey(s)||t.put(s,a.block),a.destroy()}else $.isFunction(a.destroy)&&a.destroy();p.remove(a,e.task,e)}for(t.reset();t.hasNext();){var r=t.next();0===r._ITEMS_.size()&&e.task.remove(r)}t.clear(),e._closed=!0,e.close(),this._VIEWS_.remove(e.id),p.Application.trigger("viewclose",{task:this,view:e})},_viewReady:function(e,t){this.view=e,$.isFunction(this.callback)&&this.callback(this,e,t)},hide:function(){this.view&&this.view._hide(!1)},show:function(){var e=this.container();if(e&&!e.is(":visible")&&this.focus(),this.view){var t=this._VIEWS_.get(this.view.id);if(p.isUndef(t)){if(t=this._VIEWS_.get(0),p.isUndef(t))return;this.view=t}this.view.show(!1)}},close:function(){var e,t=this._VIEWS_.values();for(e=t.length-1;0<=e;e--)this.closeView(t[e]);for(this._VIEWS_.clear(),delete this._VIEWS_,this._BLOCKS_.reset();this._BLOCKS_.hasNext();){this._BLOCKS_.next().destroy()}this._BLOCKS_.clear(),delete this._BLOCKS_,$(this).off("endbind"),p.Application.removeTask(this)},model:function(){var e;if(0===arguments.length){0;var t=p.Model.create("model");for(this._BLOCKS_.reset();this._BLOCKS_.hasNext();)(e=this._BLOCKS_.next().model())&&p.Model.append(t,e);return t}for(p.Application.logger.time("MODEL",!0,void 0,this.name),e=arguments[0],this._lists(e),this._BLOCKS_.reset();this._BLOCKS_.hasNext();)this._BLOCKS_.next().model(e);p.Application.logger.timeEnd("MODEL")},list:function(e){return p.isUndef(this.__LISTS__)?null:this.__LISTS__.get(e)},_lists:function(e){p.isUndef(this.__LISTS__)&&(this.__LISTS__=new p.HashMap);var t,i=e?e.listData:void 0;if(i)for(t=0;t<i.length;t++){var a=p.Model.attr(i[t],"name");this.__LISTS__.put(a,i[t])}},windowInfo:function(e){p.Application.logger.time("WINDOW_INFO",!0);var t=!p.Application.isLovView(this.view.id);if(!p.isUndef(e)&&!p.isUndef(this.view)&&t){var i=p.isUndef(this.view.name)?"WIN_PRINCIPAL":this.view.name,a=p.find(e,"windowCtrl",i);p.isUndef(a)&&(a=e.windowCtrl,p.isUndef(a)||(this.view.name=p.Model.attr(a[0],"name"))),p.isUndef(a)||(this.view._mergedInfo(a[0]),this.view.controlInfo(a[0]))}p.Application.logger.timeEnd("WINDOW_INFO")},_preModelControlInfo:function(e,t){this.controlInfo(e,t,!0)},controlInfo:function(e,t,i){var a,s,r=!0===i?"PRE_CONTROL_INFO":"CONTROL_INFO",n=!0===i?"_preModelControlInfo":"controlInfo";if(p.Application.logger.time(r,!0,void 0,this.name),e)if(p.Application._emptytags){if(e.blockCtrl)for(s=0;s<e.blockCtrl.length;s++){var o=e.blockCtrl[s],l=p.Model.attr(o,"name"),d=this._BLOCKS_.get(l);d&&(a=i&&d.isMultiRecord(o)?p.find(t,"block",l):void 0,d[n](o,a?a[0]:null))}}else for(this._BLOCKS_.reset();this._BLOCKS_.hasNext();){var u=this._BLOCKS_.next(),c=p.find(e,"blockCtrl",u.name);c&&(a=i&&u.isMultiRecord(c[0])?p.find(t,"block",u.name):void 0,u[n](c[0],a?a[0]:null,r))}p.Application.logger.timeEnd(r)},hasChanges:function(){for(this._BLOCKS_.reset();this._BLOCKS_.hasNext();){if(this._BLOCKS_.next().hasChanges())return!0}return!1}},{openViewDesign:function(e,t){var i=(e=e||p.Application._OPTS_).lang,a=p.isUndef(e.view)?taskId:e.view,s=new p.View(a);s.isDesigner=!0,s.task=p.Application.task,p.Application.task.view=s,p.Application.task._VIEWS_.put(a,s),t?p.Application._loadapp(i,function(){s.load(function(){e.designer&&p.Designer.init(),p.Application.trigger("viewready",{task:s.task,view:s})})}):s.load(function(){e.designer&&p.Designer.init(),p.Application.trigger("viewready",{task:s.task,view:s})})}})}(jQuery,Frames),function($,d){d.View=$.inherit({logger:new d.Logger("Frames.View"),__constructor:function(e,t){this.id=d.View.getViewId(e),this.fid=e,this._OBJS_={},this.modal=d.isTrue(t),this.toolbar=!1,this._CANVAS_=new d.HashMap,this.name="WIN_PRINCIPAL",this._wininf=null,this._visible=!1},toString:function(){return"Frames.View"},bind:function(){var e=this.window();return e.bind.apply(e,arguments)},trigger:function(){var e=this.window();return e.trigger.apply(e,arguments)},title:function(){if(0===arguments.length){if(this._title)return this._title;var e=this.id.split("/");return e[e.length-1]}this._title=arguments[0],this.modal?this.container().dialog("option","title",this._title):this.task.setContainerTitle(this._title)},needsTaskContainer:function(){return!this._task_container},load:function(e){this.callback=e;var t=d.View.mapView(this.fid);if(this.isDesigner&&(t+="?_="+(new Date).getTime()),this.isDesigner||null===d.Locale.lang||(t+=-1!=t.indexOf("?")?"&":"?",t+="lang="+d.Locale.lang),d.Application.isWorkspaceView(this.id)||this.isDesigner){var i=$(document.body);this.isDesigner&&(i=i.children("#designer")),i.addClass("ui-view-loading").load(t,$.proxy(this._loadComplete,this)),this.container(i)}else{var a=this.title(),s=this.container();this.path=t,this.modal?this.container(d.Dialog.load(a,t,$.proxy(this._loadComplete,this),{container:this._task_container})):(this.needsTaskContainer()&&(this._task_container=d.Application.createTaskContainer(this.task),this.task.container()||(this.task._container=this._task_container)),s||(s=d.Application.createViewContainer(this),this.container(s)),s.addClass("ui-view-loading").load(t,$.proxy(this._loadComplete,this)))}},_setTitle:function(e){var t,i=d.Application.isWorkspaceView(this.id);if(!this._title)if(this.modal&&!i){if(0!==(t=this._container.find("title")).length||d.isUndef(e))this._title=t.html(),t.remove();else{var a=e.indexOf("<title>");if(-1!=a){var s=e.indexOf("</title>");this._title=e.substring(a+7,s)}}this._container.dialog("option","title",this.title())}else if(this._container){if(0!==(t=$("title",this._container)).length||d.isUndef(e))this._title=t.html(),t.remove();else{var r=e.indexOf("<title>");if(-1!=r){var n=e.indexOf("</title>");this._title=e.substring(r+7,n)}}this._container.parent().find("a[href='#"+this._container.attr("id")+"']").text(this.title())}},_loadComplete:function(e,t){"error"==t&&(this.isDesigner||alert("View "+this.id+" not found!"));d.Application.isWorkspaceView(this.id);if(!this._title){if(this._setTitle(e),this._container){this._container.find("meta").remove();var i=this._container.find(".ui-view-window"),a=i.find("> .ui-panel");0===a.length&&(a=i.find("> *:first")),(i.attr("class")?i.attr("class").match(/(?:\s+|^)(ui-layout-\w+)(?:\s+|$)/):null)||i.css({height:a.height()}),d.Application.task.opening&&i.addClass("ui-view-loading"),d.Application.one("viewready",function(e,t){t.view._container.find(".ui-view-window").removeClass("ui-view-loading").addClass("ui-view-finished-loading"),$(t.view._container).removeClass("ui-view-loading")})}d.waiting()||this.trigger("complete")}$.isFunction(this.callback)&&this.callback(this,t)},reload:function(){var e=this.id,t=this.modal;d.inDesignMode?($(document.body).children("#designer").empty(),$("head > style").remove(),d.Task.openViewDesign()):(this.task.closeView(this),d.Application._commands_pre_viewopen(this.task)&&this.task.openView(e,t,d.Application._viewPreReady))},close:function(){this.modal&&this._container?d.Dialog.close(this._container):this._container&&(d.isTrue(this._closed)?this._hide():this.task.closeView(this)),this._visible=!1,d.Application.trigger("viewclose",{view:this})},hide:function(){this.visible()&&this._hide(!1)},_hide:function(e){if(this._visible=!1,e=void 0===e||e,this.modal&&this._container){var t=this._container.data("ui-dialog");if(t&&t.uiDialog&&this._container.dialog("close"),e){var i=this.task._VIEWS_.get(0);d.isUndef(i)||i==this||i._hide()}}else{var a=this.container();if(this._closed)return void a.remove();if(a){var s=a.parent().index(),r=d.Application.getViewContainer(this);-1!=s&&r&&(r.children("ul").children("li").eq(s-1).hide(),a.hide())}}},show:function(e){this.visible()||this._show(e)},_show:function(e){if(this._visible=!0,(e=void 0===e||e)&&this.task._hideAllViews(this,this.modal),this.modal&&this._container&&!d.Application.isWorkspaceView(this.id)){var t=this._container.data("ui-dialog");t&&t.uiDialog&&this._container.dialog("open")}else{var i=this.container();if(i){var a=i.parent().index(),s=d.Application.getViewContainer(this);-1!=a&&s&&(s.children("ul").children("li").eq(a-1).show(),i.show())}}},visible:function(){return this._visible},hideCanvas:function(e){var t=this._CANVAS_.get(e);d.isUndef(t)||t.hide()},showCanvas:function(e){var t=this._CANVAS_.get(e);if(d.isUndef(t)){var i=e.replace("$","\\$"),a=this.window().find("[data-widget=tabpanel], [data-widget=panel], [data-widget=framepanel]").filter("[data-name="+i+"]");if(0<a.length){var s=a.attr("id");d.isEmpty(s)&&(s=d.uuid(),a.attr("id",s)),t=d.create(s,a,this)}}if(!d.isUndef(t)){t.elem.addClass("ui-view-loading");var r=t.show();switch(this._CANVAS_.reset(),t.type){case"contentcanvas":for(;this._CANVAS_.hasNext();){var n=this._CANVAS_.next();n!=t&&"contentcanvas"==n.type&&n.hide()}break;default:for(this._CANVAS_.remove(e),this._CANVAS_.put(e,t),this._CANVAS_.index=1;this._CANVAS_.hasNext();){var o=this._CANVAS_.next();if(!d.isUndef(o.type)&&"contentcanvas"!=o.type||o.elem&&o.elem.hasClass("ui-tabpanel")){var l=0;this.modal&&(l=parseInt(this._container.parent().css("zIndex"),10)),o.root.css("zIndex",++this._CANVAS_.index+l)}}}r&&d.repaint(t.elem),t.elem.removeClass("ui-view-loading").addClass("ui-view-finished-loading")}},getCanvasCount:function(){return this._CANVAS_.size()},container:function(){if(0===arguments.length)return this._container;this._container=arguments[0]},window:function(){var e=this.container();return $(".ui-view-window",e)},register:function(e){e&&(d.isUndef(this._CANVAS_.index)&&(this._CANVAS_.index=1),e.view=this,"stackedcanvas"==e.type&&e.root.css("zIndex",++this._CANVAS_.index),this._CANVAS_.put(e.name,e))},remove:function(e){this._CANVAS_.remove(e)},controlInfo:function(){var e=this._CANVAS_;if(e.reset(),!(0<arguments.length)){for(var t=d.Model.create("windowCtrl",void 0,{name:this.name});e&&e.hasNext();){var i=e.next().controlInfo();d.isUndef(i)||d.Model.append(t,i)}return t}var a=arguments[0];if(a){var s=d.Model.attr(a,"name");if(d.isUndef(s)||(this.name=s),a.properties){var r=d.Model.attr(a.properties[0],"Title");d.isUndef(r)||this.title(r);var n=d.Model.attr(a.properties[0],"Toolbar");d.isUndef(n)||(this.toolbar=d.isTrue(n))}}for(;e&&e.hasNext();)e.next().controlInfo(a)},_mergedInfo:function(e){var t;if(e)if(this._wininf){if(e.canvas)for(t=0;t<e.canvas.length;t++){var i=e.canvas[t],a=d.findSingle(this._wininf,"canvas",i["@name"]);a?this._mergeNode(a,i):d.Model.append(this._wininf,i)}}else this._wininf=e},_mergeNode:function(e,t){var i;for(i in t)if(t.hasOwnProperty(i)&&0===i.lastIndexOf("@",0)){var a=d.Model.attr(t,i.substr(1));d.Model.attr(e,i.substr(1),a)}t.properties&&(e.properties?this._mergeNode(e.properties[0],t.properties[0]):d.Model.append(e,t.properties[0]))}},{mapView:function(e){return(!(d.Application._OPTS_.preview||d.Application._OPTS_.designer)?d.Config.get("VIEWS_URL","views"):"views")+"/"+d.View.mapViewId(e)},getViewId:function(e){return d.View.mapViewId(e,!1)},mapViewId:function(e,t){if(d.isUndef(e))return e;t=void 0===t||t;var i="",a=e.indexOf("?");return-1!==a&&(i=e.substr(a),e=e.substr(0,a)),e+(t?".html"+i:"")}})}(jQuery,Frames),function($,a){a.Bindable=$.inherit({__constructor:function(e,t){var i=a.Application.task.get(e);i&&(this.block=i,this.view=a.Application.task.view,i.bindable(this)),this._setterfn=t},objid:function(){return void 0===this._id&&(this._id="bnd_"+a.uuid()),this._id},model:function(){if(0===arguments.length)return null;var e=arguments[0];$.isFunction(this._setterfn)&&this._setterfn.apply(this,[e])}}),a.BindableItem=$.inherit(a.Bindable,{__constructor:function(e,t){a.Bindable.prototype.__constructor.apply(this,[e,this._setterfn]),this.member=t,this._value=""},props:a.Item.prototype.props,_set_prop:a.Item.prototype._set_prop,value:function(){return this._value},_setterfn:function(e){a.Item.prototype.model.apply(this,[e])},rowidx:function(){return this.block.index()},_set_value:function(e){var t=a.find(e,"item",this.member);this._value=a.Model.text(t)||""}})}(jQuery,Frames),function($){Frames.PLUGIN_VIEW="view",Frames.PLUGIN_CONTROLINFO="controlinfo",Frames.Application=$.inherit({},{logger:new Frames.Logger("Frames.Application"),_service:null,_TASKS_:{},__acthandlers:new Frames.HashMap,__cmdhandlers:new Frames.HashMap,WORKSPACE_CLOSE:1,SESSION_END:2,VIEW_NOT_RETURNED:3,current:function(){if(Frames.Application.task&&Frames.Application.task.block)return Frames.Application.task.block.item},start:function(s){Frames.Application._OPTS_=s=$.extend(Frames.Application.options,s),Frames.Config.init(s,function(){if(Frames.History.init(),s.params){var e=s.params;for(var t in e)e.hasOwnProperty(t)&&Frames.Config.set(t,e[t])}if(Frames.isTrue(s.preview)){var i=Frames.Config.get("DEFAULT_LOCALE","en"),a="designer";Frames.inDesignMode=!0,$(document.body).append('<div id="designer" class="ui-designer-container"></div>'),$(document.body).addClass("preview"),Frames.Application.task=new Frames.Task(a),Frames.Application.mainTask=Frames.Application.task,Frames.Application._TASKS_[a]=Frames.Application.task,Frames.isUndef(s.view)?Frames.Application._loadapp(i,function(){Frames.Application.trigger("ready"),s.designer&&Frames.Designer.init()}):(s.lang=i,Frames.Task.openViewDesign(s,!0))}else Frames.wait(""),Frames.Service.SERVICE_URL=Frames.Config.get("SERVICES_URL"),Frames.Application._pos_lbl_enabled=Frames.Config.getbool("POSITION_LABELS",!1),Frames.Application._emptytags=Frames.Config.getbool("EMPTY_TAG_MODELS",!1),Frames.Application._bindMainTask=Frames.Config.getbool("MODEL_WORKSPACE_TASK",!1),Frames.Application._supportnulls=Frames.Config.getbool("SUPPORT_NULLS",!1),Frames.Application._readydef=Frames.Config.getbool("READY_DEFERRED",!0),Frames.Application._mergectrinfo=Frames.Config.getbool("MERGE_CONTROL_INFO",!0),Frames.Application._performance=Frames.Config.getbool("PERFORMANCE_ENABLED",!0),Frames.Application._service_call()})},_service_create:function(){if(!Frames.Application._service){var e=new(Frames.Config.get("SERVICES_CLASS",Frames.Service,!0))(Frames.Application._success,Frames.Application._error);e.SERVICE_URL=Frames.Config.get("SERVICES_URL"),Frames.Application._service=e}},_service_init:function(){if(Frames.Application._service_create(),Frames.Config.getbool("SERVICE_HANDLE_REFRESH",!0)&&window.sessionStorage){var e;try{e=window.sessionStorage.getItem("FRAMES_TASK_ID")}catch(e){}var t,i=Frames.getqs(),a=[];for(t in i)i.hasOwnProperty(t)&&a.push({name:t,type:"String",value:i[t]});Frames.isUndef(e)?Frames.Application._service.execute({name:"WORKSPACE_INIT",params:a}):Frames.Application._service.execute({name:"WORKSPACE_REFRESH",params:a},{id:e})}else Frames.Application._service.execute("MV:INITAPP");$(window).on("beforeprint",function(){this.explicitOpeningBrowserNativeWindow=!0}),$(window).on("beforeunload",function(){if(this.explicitOpeningBrowserNativeWindow)$(window).one("focus",function(){this.explicitOpeningBrowserNativeWindow=!1});else{var e=Frames.Application.getMainTask();if(!Frames.isUndef(e)){if(Frames.Application.executing())return;Frames.Application.close()}}})},_maintask_execsync:function(e){var t=Frames.Application.getMainTask();Frames.isUndef(t)||($.ajaxSetup({async:!1}),Frames.Application.execute(e,t))},close:function(){Frames.Application._maintask_execsync("WORKSPACE_CLOSE")},exit:function(){Frames.Application._maintask_execsync("WORKSPACE_EXIT")},end:function(e){switch(e){case Frames.Application.SESSION_END:Frames.Application._show_system_error("Session Timeout",_(Frames.Locale.messages.SESSION_TIMEOUT));break;case Frames.Application.VIEW_NOT_RETURNED:var t=_(Frames.Locale.messages.VIEW_NOT_RETURNED);0,Frames.Dialog.show(_(Frames.Locale.messages.APPLICATION_MESSAGE),t,Frames.Dialog.ICON_ERROR);break;case Frames.Application.WORKSPACE_CLOSE:location.reload()}Frames.Application.trigger("application.end",{reason:e})},reset:function(){Frames.Application._TASKS_={},delete Frames.Application.task,delete Frames.Application.mainTask},_service_call:function(){var e=Frames.Config.getbool("SERVICE_IFRAME",!0);Frames.Config.getbool("SERVICE_CROSSDOMAIN",!1)&&$.ajaxSetup({crossDomain:!0,xhrFields:{withCredentials:!0}}),e?Frames.Application._service_call_iframe():Frames.Application._service_init()},_service_call_iframe:function(){function t(e,i,a,s){var r=$("<iframe></iframe>");r.hide(),$("body").append(r),r.on("load",function(){var t;try{t=!$.isFunction(i)||i(r.contents())}catch(e){t=!1}r.remove(),t?$.isFunction(a)&&a():$.isFunction(s)&&s()}),r.attr("src",e)}var e=Frames.Config.get("SESSION_URL");Frames.isUndef(e)?function(){Frames.Application._service_create();var e=Frames.Application._service.getTestUrl();Frames.isEmpty(e)?Frames.Application._service_init():t(e+"?ts="+(new Date).getTime(),function(e){return e&&e[0]&&"text/html"!=e[0].contentType},function(){Frames.Application._service_init()},function(){Frames.Application._show_system_error("Service Invocation Failed","Couldn't access remote service."),Frames.waitEnd()})}():t(e+"/initialize",void 0,function(){Frames.Application._service_init()},function(){Frames.Application._show_system_error("Session Initialization Failed","Couldn't access remote session service."),Frames.waitEnd()})},_error:function(e){Frames.isUndef(Frames.Application.task)&&Frames.Application._show_system_error("Service Invocation Failed",e),Frames.waitEnd()},_success:function(e){var t=Frames.isUndef(Frames.Application.task),i=Frames.isUndef(Frames.Application.mainTask);if((t||i)&&e){var a=e.header[0].control[0],s=a.profile?a.profile[0]:null,r=s?s["@language"]:null;Frames.isEmpty(r)&&(r=Frames.Config.get("DEFAULT_LOCALE","en")),r=r.replace("_","-"),Frames.isUndef(Frames.Locale.lang)||Frames.Locale.lang!==Frames.Locale.accepted(r)?Frames.Application._loadapp(r,function(){Frames.Application.trigger("loadapp"),Frames.Application._success_after_locale(e)}):Frames.Application._success_after_locale(e)}else Frames.Application._success_after_locale(e)},_loadapp:function(e,t){var i=function(){$.isFunction(Frames.Workspace.localize)&&Frames.Workspace.localize(),Frames.ready(),Frames.Application.trigger("ready"),$.isFunction(t)&&t()},a=Frames.Config.get("APP_NAME");void 0===Frames._app&&a?(Frames._app=a,Frames.Config.set("LOCALE",e),Frames.loadapp(a,i)):Frames.Locale.init(e,i)},_success_after_locale:function(e){if(Frames.Application.logger.time("TASK",!0),Frames.Application._executing=!0,e){var t=e,i=t.header[0].control[0],a=t.body[0],s=Frames.Model.attr(i,"task"),r=Frames.Model.attr(i,"taskName"),n=Frames.Model.attr(i,"view"),o=Frames.View.getViewId(n),l=Frames.Model.attr(i,"modal");Frames.Application.isLoginView(o)&&Frames.Application.mainTask&&Frames.Application.reset();var d=Frames.Application._TASKS_[s];if(s){if(d?d.show():((d=new Frames.Task(s,r)).opening=!0,d.validation=Frames.Config.get("VALIDATION_MODE","Blocking"),Frames.Application._TASKS_[s]=d),d.data=a,d.control=i,d.request=i&&i.request?i.request[0]:null,Frames.Application.task=d,o){if(!Frames.Application._commands_pre_viewopen(d))return;d.openView(n,Frames.isTrue(l),Frames.Application._viewPreReady),Frames.Application.isWorkspaceView(d.view)||(Frames.Application.task=d)}if(!Frames.Application.mainTask){if(Frames.Config.getbool("SERVICE_HANDLE_REFRESH",!0)&&window.sessionStorage)try{window.sessionStorage.setItem("FRAMES_TASK_ID",d.id)}catch(e){}Frames.Application.isLoginView(o)||(Frames.Application.mainTask=d)}}else d={control:i};if(!o){var u,c=Frames.findExp(i,"commands/command");if(c)for(u=0;u<c.length;u++){var p=Frames.Model.attr(c[u],"name");Frames.Application.end(Frames.Application._getEndSession(p))}Frames.waitEnd(),s&&Frames.Application._commands(d),Frames.Application._messages(d)}}else{var m=_(Frames.Locale.messages.NO_MESSAGE_RETURNED);0,Frames.Application._show_system_error("Service Invocation Failed",m),Frames.waitEnd()}delete Frames.FocusManager.disabled,delete Frames.Application._executing,Frames.Application.logger.timeEnd("TASK")},_getEndSession:function(e){var t=Frames.Application.VIEW_NOT_RETURNED;return"SESSION_END"===e&&(t=Frames.Application.SESSION_END),t},_commands_pre_viewopen:function(e){var t,i=!1,a=e.control,s=Frames.findExp(a,"commands/command");if(s)for(t=0;t<s.length;t++){var r=Frames.Model.attr(s[t],"name"),n=r.split("_"),o=n[0],l=n[1];switch(o){case"CONFIGURATION":switch(l){case"FORMAT":$.each(s[t].param,function(e,t){Frames.Locale.formats[Frames.Model.attr(t,"name")]=Frames.Model.text(t)})}break;case"SYSTEM":switch(l){case"ERROR":Frames.findTxt(s[t],"param","kind");var d=Frames.findTxt(s[t],"param","message");Frames.Application._show_system_error("Service Invocation Failed",d),i=!0,Frames.waitEnd()}}}return!i},_commands_pre_viewready:function(e){var t,i=e.control,a=Frames.findExp(i,"commands/command");if(a)for(t=0;t<a.length;t++){var s=Frames.Model.attr(a[t],"name"),r=s.split("_"),n=r[0],o=r[1];switch(n){case"TASK":var l=Frames.findTxt(a[t],"param","task"),d=Frames.Application._TASKS_[l];if(Frames.isUndef(d)){0;continue}switch(o){case"OPEN":var u=Frames.isTrue(Frames.findTxt(a[t],"param","validationKind"));if(u&&(d.validation=u),Frames.isEmpty(d.name)&&(d.name=Frames.findTxt(a[t],"param","name"),d.title=Frames.findTxt(a[t],"param","title")),Frames.isTrue(Frames.findTxt(a[t],"param","replaceView"))){var c=Frames.findTxt(a[t],"param","parent"),p=Frames.Application._TASKS_[c];Frames.isUndef(p)||p===Frames.Application.getMainTask()||p.hide()}break;case"CLOSE":d==Frames.Application.getMainTask()?Frames.Application.end(Frames.Application.WORKSPACE_CLOSE):(Frames.Application._processing=!0,d.close(),delete Frames.Application._processing);break;case"ACTION":var m=Frames.findTxt(a[t],"param","action");Frames.Application.execute(m,d,void 0,void 0,void 0,void 0,void 0,0)}break;case"WINDOW":var h=Frames.findTxt(a[t],"param","task"),f=Frames.findTxt(a[t],"param","view"),g=Frames.Application._TASKS_[h];if(g){if(g.isLoading()&&g.loading()==f)continue;var _=g.getView(f);if(_)switch(o){case"HIDE":_.hide();break;case"SHOW":_.show()}}break;case"CANVAS":var v=Frames.findTxt(a[t],"param","task"),b=Frames.findTxt(a[t],"param","view"),F=Frames.Application._TASKS_[v];if(F){var y=F.getView(b);if(y){var w=Frames.findTxt(a[t],"param","canvas");switch(o){case"HIDE":y.hideCanvas(w);break;case"SHOW":y.showCanvas(w)}}}break;case"VISUAL":switch(o){case"CONTROL":var C=Frames.findTxt(a[t],"param","data"),x=[];try{x=JSON.parse(C),$.isPlainObject(x)&&(x=[x])}catch(e){0}$.each(x,function(e,t){var i=Frames.get(t.name);if(Frames.isUndef(i))0;else if($.isFunction(i.props)){var a;for(a in t.properties)t.properties.hasOwnProperty(a)&&i.props(a,t.properties[a])}else 0});break;case"WIDGET":var k=Frames.findTxt(a[t],"param","type"),T=Frames.findTxt(a[t],"param","value"),E=Frames.gettype(k),A="openInDialog";$.isFunction(E[A])&&E[A](T)}}}Frames.isEmpty(e.name)&&(Frames.Application.logger.info("*** Unnamed task! Please update server runtime! ***"),e.name=Frames.uuid().toUpperCase())},_commands_post_viewready:function(e){var t=e.control;e.loading(null);var i=Frames.findExp(t,"commands/command");if(i){var a;for(Frames.Application.trigger("commandsstart"),a=0;a<i.length;a++){var s=i[a],r=Frames.Model.attr(s,"name");0;var n=Frames.Application.__cmdhandlers.get(r);"function"==typeof n&&n.apply(Frames.Application,[e,s]),Frames.Workspace&&Frames.Workspace.handleCommand&&Frames.Workspace.handleCommand(e,r,s)}Frames.Application.trigger("commandsend")}},registerCommandHandler:function(e,i){Array.isArray(e)?$.each(e,function(e,t){Frames.Application.__cmdhandlers.put(t,i)}):Frames.Application.__cmdhandlers.put(e,i)},_show_system_error:function(e,t){if(Frames.Config.getbool("SERVICE_HANDLE_REFRESH",!0)&&window.sessionStorage)try{window.sessionStorage.removeItem("FRAMES_TASK_ID")}catch(e){}var i=$('<div class="container"><div class="alert alert-error"><h4>'+e+"</h4><p>"+t+"</p></div></div>");$(document.body).empty().append(i)},_show_alert:function(e,t){var i=Frames.Model.value(e.param[0]),a=Frames.find(t,"alert",i);if(a){var s,r={},n=Frames.Model.value(a[0].text[0])||"",o=Frames.Model.attr(a[0],"title"),l=Frames.Model.attr(a[0],"type")||Frames.Dialog.ICON_DEFAULT,d=[],u=function(i,a,s,r){return function(){var e=Frames.Model.create("model"),t=Frames.Model.createAlert(a,r);Frames.Model.append(e,t),execute(i,null,e,null,null,s)}},c=Frames.findExp(a[0],"buttons/button");for(s=0;s<c.length;s++){var p=c[s],m=Frames.Model.attr(p,"action"),h=Frames.Model.attr(p,"index"),f=Frames.Model.attr(p,"causesValidation"),g=Frames.Model.attr(p,"label"),_=Frames.Model.attr(p,"default"),v=Frames.Model.attr(p,"accessKey");d.push(m),Frames.isTrue(_)&&(r.selected=h),r[g]={accessKey:v,callback:u(m,i,f,h)}}Frames.Application.blockExecution("alert",d,!0),Frames.Workspace&&Frames.Workspace.showAlert?Frames.Workspace.showAlert(o,n,l,r):Frames.Dialog.show(o,n,l,r)}else 0},_commands:function(e){this._commands_pre_viewready(e),this._commands_post_viewready(e)},_messages:function(e){var t=e.control,i=Frames.findExp(t,"messages/message");if(i){i.reverse();var a,s=0;for(a=0;a<i.length;a++){var r=Frames.Model.attr(i[a],"message_type"),n=Frames.Model.attr(i[a],"message_string"),o=Frames.Model.attr(i[a],"message_title"),l=Frames.Model.attr(i[a],"user_response");switch(r){case"RECORDCOUNT":Frames.StatusBar.record(n);break;case"NONE":break;default:if(0<s++||!Frames.StatusBar.isInitialized()||"ACKNOWLEDGE"===l)if(Frames.Workspace&&Frames.Workspace.showMessage&&"ACKNOWLEDGE"!==l)Frames.Workspace.showMessage(n,r);else{var d=Frames.isUndef(o)?_(Frames.Locale.messages.ALERT_FROM_SERVER_TITLE):o;Frames.Dialog.show(d,n,r)}else Frames._block_msg=Frames.StatusBar.message(),Frames.Workspace&&Frames.Workspace.showMessage?Frames.Workspace.showMessage(n,r):Frames.StatusBar.message(n)}}}},_viewPreReady:function(e,t,i){Frames.Application._readydef&&Frames.ready(),Frames.Application._commands_pre_viewready(e),Frames.Application._viewReady(e,t,i),Frames.Application._commands_post_viewready(e),Frames.Application._messages(e),e.opening&&(Frames.Application.trigger("taskopen",{task:e}),delete e.opening),Frames.Application.trigger("viewready",{task:e,view:t})},_viewReady:function(e,t,i){if(e.focus(),t.initialized){var a=Frames.getplugs(Frames.PLUGIN_VIEW);for(a&&a.reset();a&&a.hasNext();)a.next().init(t);e._processing=!0,e.windowInfo(e.control),e._preModelControlInfo(e.control,e.data),e.model(e.data),e.controlInfo(e.control),$(e).trigger("endbind"),Frames.Application.trigger("endbind");var s=Frames.Application.getMainTask();Frames.Application._bindMainTask&&s!=e&&(s.controlInfo(e.control,null,!0),s.model(e.data),s.controlInfo(e.control)),delete e._processing;var r=Frames.Model.attr(e.control,"block"),n=Frames.Model.attr(e.control,"item");0,e.block=e.get(r),e.block?(e.block.item=e.block.get(n),e.block.item||(e.block.item=e.block.get(0)),e.block.item||(e.block=e.get(0),e.block.item=e.block.get(0)),Frames.focus(e,!0)):e===Frames.Application.getMainTask()&&(e.block=new Frames.Block(r),e.block.item=new Frames.Item(n)),Frames.Application._initModalToolbal(t)}Frames.waitEnd(),this.logger.timeEnd("VIEW"),this.logger.timeEnd("TASK"),Frames.deferred()},_initModalToolbal:function(e){Frames.isTrue(e.modal)&&e._container&&0===e._container.find("#toolbar").length&&Frames.isTrue(Frames.Application.task.view.toolbar)&&(e._container.prepend('<div id="toolbar" class="ui-modal-toolbar"></div>'),e._container.find("#toolbar").load(Frames.Config.get("TOOLBAR_MODAL",""),function(){Frames.ToolBar.init(e._container.find("#toolbar"))}))},removeTask:function(e){Frames.Application.trigger("beforetaskclose",{task:e});var i=Frames.Application.getTaskContainer(e),a=i.children(".ui-tabs-nav");if($('li a[href="#'+e.id+'"]',a).each(function(){var e=a.find("li a").index($(this));if(-1!=e){var t=a.find("li:eq("+e+")");i.tabs("destroy"),t.remove(),$($(this).attr("href")).remove(),i.tabs({activate:function(e,t){var i=t.newTab.find("a").attr("href").substr(1);"tabs-1"!=i&&Frames.Application._showTask(i)}}),Frames.Application.task.focus()}}),i!=Frames.Application._container&&(i=Frames.Application._container,a=i.children(".ui-tabs-nav"),$('li a[href="#'+e.id+'"]',a).each(function(){var e=a.find("li a").index($(this));-1!=e&&(i.tabs("remove",e),Frames.Application.task.focus())})),e._TIMERS_)for(var t in e._TIMERS_)clearInterval(e._TIMERS_[t]),delete e._TIMERS_[t];delete Frames.Application._TASKS_[e.id],Frames.Application.trigger("refresh"),Frames.Application.trigger("taskclose",{task:e})},getMainTask:function(){return Frames.Application.mainTask||Frames.Application.task},_getViewId:function(e){var t=e;return"string"==typeof e||Frames.isUndef(e.id)||(t=t.id),t},isWorkspaceView:function(e){if(Frames.isUndef(e))return!1;var t=Frames.Application._getViewId(e);return Frames.isTrue(Frames.Application.WORKSPACE_VIEWS[t])},isLoginView:function(e){if(Frames.isUndef(e))return!1;var t=Frames.Application._getViewId(e);return!!Frames.Application.isWorkspaceView(e)&&-1!==t.indexOf("Login")},isLovView:function(e){return!Frames.isUndef(e)&&-1!==Frames.Application._getViewId(e).indexOf(Frames.Dialog.LOV.viewName)},_showTask:function(e){if(!Frames.Application._processing){var t=Frames.Application._TASKS_[e];void 0===t&&(t=Frames.Application.getMainTask()),Frames.Application.task=t,Frames.isUndef(Frames.Application.task.block)||(Frames.Application.task.block.commitChanges(),Frames._currentItemAndFocus(t,!1),Frames.Application.trigger("taskopen",{task:t}))}},getTask:function(e){return null==e?Frames.Application.getMainTask():Frames.Application._TASKS_&&Frames.Application._TASKS_[e]},getCurrentTask:function(){return Frames.Application.task},getContainer:function(e){var t;return 0<(t=e.parents(".ui-dialog")).length?t.children(".ui-dialog-content"):0<(t=e.parents(".ui-panel-view-container").eq(0).children(".ui-tabs-panel:visible")).length?t:(t=Frames.Application.getTaskContainer(),Frames.isUndef(t)?null:t.parent())},getTaskContainer:function(e){return Frames.Application._container},_getTaskContainerIndex:function(e,t){return e.children("ul").find("li").has('a[href="#'+t+'"]').index()},getTaskContainerIndex:function(e){return Frames.Application._getTaskContainerIndex(e.container().parent(),e.id)},getViewContainer:function(e){return Frames.Application.getTaskContainer(e.task)},getViewContainerIndex:function(e){return Frames.Application._getContainerIndex(e.container().parent(),e.task.id)},createViewContainer:function(e){var t=e._task_container,i=$('<div class="ui-window-container"></div>');return t.append(i),i},createTaskContainer:function(r){var e=_(Frames.Locale.messages.LOADING),n=Frames.Application.getViewContainer(r.view),t=n.find(">ul >li").length;var i=(n.is(".ui-panel-view-container")?"view_":"")+r.id,a=n.children("ul").find('li > a[href="#'+i+'"]');if(0<a.length)return n.tabs("option","active",a.parent().index()),n.children("#"+i);$('<li><a href="#'+i+'">'+e+"</a></li>").appendTo(n.children(".ui-tabs-nav")),$("<div id="+i+"></div>").appendTo(n),n.tabs("refresh");var s=n.children("#"+i);return s.data("task",r.id),s.addClass("ui-tab-panel-container"),$($(">ul.ui-tabs-nav li span.ui-icon-close",n)[t-1]).bind("click",function(){var e=$(this).parent().find("a"),t=e.attr("href").substr(1),i=n.children("#"+t).data("task"),a=Frames.Application._TASKS_[i];if(Frames.inDesignMode||Frames.isUndef(a))Frames.inDesignMode&&Frames.Workspace.message&&(Frames.isUndef(a)&&(i=e.attr("href"),a=Frames.Application._TASKS_[i]),Frames.inDesignMode?Frames.Workspace.message("Exit Designer?","Are you sure you want to exit design mode?",function(e){Frames.Designer.close(),e.alert("close"),a.view.isBlank&&(r.close(),Frames.Application.task=Frames.Application.getMainTask())}):a.view.isBlank&&(a.close(),Frames.Application.task=Frames.Application.getMainTask()));else{var s=Frames.Config.getaction_name("EXIT");Frames.Application.execute("EXIT",a,null,null,null,s?Frames.isTrue(s.serverValidation,!0):void 0)}}),n.tabs("option","active",t),s},callmenu:function(e,t,i,a,s){s=s||"Main";var r=Frames.Application.task.model(),n=Frames.Model.create("menu");Frames.Model.attr(n,"kind",s),Frames.Model.attr(n,"name",a),Frames.Model.attr(n,"item",i),Frames.Model.append(r,n),Frames.Application.execute(t,e,r,void 0,void 0,void 0,"Menu",0)},callform:function(e,t,i){Frames.Application.callmenu(Frames.Application.getMainTask(),"CALL_FORM",e,t||"Detail",i)},executing:function(){return!Frames.isUndef(Frames.Application._service)&&Frames.Application._service.executing()},processing:function(){return Frames.Application.executing()||!0===Frames.Application._executing},_actionvalidate:function(e,t){var i=Frames.Config.getaction_name(e),a=i&&i.validation?Frames.isTrue(i.validation):void 0,s=Frames.Application.current();return!!Frames.isUndef(s)||(void 0===a||a?(Frames.isUndef(t)&&(t={block:{}}),Frames.validate(s,t)):Frames.Validation.validateFormat(s))},elemexec_format:function(e,t){Frames.Application.elemexec(e,void 0,t,function(e,t){var i="string"==typeof e?Frames.Config.getaction_name(e):e,a=i&&i.validation?Frames.isTrue(i.validation):void 0,s=!0;return(void 0===a||a)&&(s=Frames.Validation.validateFormat(t)),s})},elemexec:function(elem,delay,action,validationFn){if(action=action||elem.data("action"),Frames.isUndef(action)&&(action=elem.data("eventclick")),!Frames.isUndef(action)){if("script:"!=action.substring(0,7)){var b=elem.data("block"),m=elem.data("member");if(validationFn=validationFn||Frames.Application._actionvalidate,!validationFn(action,elem.data("frames")))return!1;var act=Frames.Config.getaction_name(action),task=null;if($.isFunction(elem.data)){var it=elem.data("frames");if(!Frames.isUndef(it)&&!Frames.isUndef(it.view)&&(task=it.view.task,Frames.isTrue(it.props("Navigable"))&&!Frames.isUndef(b)&&!Frames.isUndef(m))){var block=task.get(b);if(!Frames.isUndef(block)){var item=block.get(m);Frames.isUndef(item)||(block.item=item,task.block=block)}}}return Frames.Application.execute(action,task,null,Frames.isUndef(b)?null:b,Frames.isUndef(m)?null:m,act?Frames.isTrue(act.serverValidation,!0):void 0,void 0,delay),!0}try{return eval(action.substring(7)),!0}catch(e){0}}return!1},valexec:function(e,t,i){return!Frames.isUndef(e)&&(!!Frames.Application._actionvalidate(e)&&(Frames.Application._actexecute(e,t,i),!0))},blockExecution:function(e,t,i){Frames.Application._blockExec={type:e,actions:["WORKSPACE_CLOSE"].concat(t),remove:Frames.isTrue(i)},Frames.Application.trigger("block",Frames.Application._blockExec)},unblockExecution:function(e,t,i){delete Frames.Application._blockExec,Frames.Application.trigger("unblock")},testExecution:function(e){var t="string"==typeof e?e:e.name;if(!Frames.isUndef(Frames.Application._blockExec)){if(-1==$.inArray(t,Frames.Application._blockExec.actions))return!1;Frames.Application._blockExec.remove&&Frames.Application.unblockExecution()}return!0},_actexecute:function(e,t,i){Frames.Application.execute(e,void 0,void 0,t||null,i||null)},execute:function(e,t,i,a,s,r,n,o){if("string"==typeof e){var l=Frames.Config.getaction_name(e);e=Frames.isUndef(l)?{name:e,type:"MessageServiceAction"}:l}if(Frames.Application.__acthandler===e.name&&(e=$.extend({},e,{type:"MessageServiceAction"})),Frames.isEmpty(e.type)||"MessageServiceAction"==e.type||"ExitServiceAction"==e.type)Frames.isUndef(e.name)||(r=Frames.isUndef(e.serverValidation)?r:Frames.isTrue(e.serverValidation,!0),Frames.Application._execute(e,t,i,a,s,r,n,o));else if("ItemAction"==e.type)Frames.isUndef(e.item)||Frames.Application.elemexec(e.item);else{var d=Frames.Application.__acthandlers.get(e.type);"function"==typeof d&&(Frames.Application.__acthandler=e.name,d.apply(Frames.Application,[e,a,s]))}delete Frames.Application.__acthandler},_execute:function(e,t,i,a,s,r,n,o){if(delete Frames.Application.__acthandler,!Frames.isTrue(Frames.inDesignMode)&&!Frames.Application.executing()&&Frames.Application.testExecution(e)){Frames.Application._readydef&&delete Frames._ready,Frames.FocusManager.disabled=!0,Frames.Validation.hideError(),t||(t=Frames.Application.task),i||(i=t.model()),void 0!==a||Frames.isUndef(t.block)||(a=t.block.name),void 0!==s||Frames.isUndef(t.block)||Frames.isUndef(t.block.item)||(s=t.block.item.member);var l=t.block&&t.block.item&&$.isFunction(t.block.item.model)?t.block.item.model():null;if(null!=l&&(t.block.item._last_exec=l.value),!Frames.isUndef(t.block)&&!Frames.isUndef(t.block.item))try{Frames.Validation.hideError(t.block.item)}catch(e){}t.block&&t.block.item&&t.block._itemInactivate(t.block.item),Frames.wait(_(Frames.Locale.messages.EXECUTING_ACTION),o),Frames.Application.trigger("execute",{action:e,task:t,model:i,block:a,item:s,validation:r,kind:n}),Frames.Application.trigger("cancelpopups"),Frames.Application._service.execute(e,t,i,a,s,r,n)}},registerActionHandler:function(e,t){Frames.Application.__acthandlers.put(e,t)},on:function(){var e=$(Frames.Application);e.on.apply(e,arguments)},one:function(){var e=$(Frames.Application);e.one.apply(e,arguments)},off:function(){var e=$(Frames.Application);e.off.apply(e,arguments)},trigger:function(){var e=$(Frames.Application);e.trigger.apply(e,arguments)}}),Frames.Application.options={designer:!1,runtime:".",root:".",scripts:[]},execute=Frames.Application.execute,callform=Frames.Application.callform,Frames.Application.WORKSPACE_VIEWS={"morphis/frames/workspace/ViewWorkspaceWindow":!0,"morphis/frames/workspace/ViewLoginSimple":!0},Frames.Workspace={}}(jQuery),Frames.Application.registerCommandHandler("SHOW_DOC",function(e,t){var i=Frames.Model.text(t.param[1]);window.open(i)}),Frames.Application.registerCommandHandler("REPORT_GENERATED",function(e,t){var i=Frames.Model.text(t.param[0]);window.open(i,"report")}),Frames.Application.registerCommandHandler("SHOW_ALERT",function(e,t){var i=e.data;Frames.Application._show_alert(t,i)}),Frames.Application.registerCommandHandler("OPEN_LOV",function(e,t){var i,a=e.data,s=Frames.Model.text(t.param[0]);t.param[1]&&(i=Frames.Model.text(t.param[1]));var r=Frames.find(a,"list",s);r&&(Frames.Model.attr(r[0],"criteria",i),Frames.Dialog.LOV.load(r,a))}),Frames.Application.registerCommandHandler("OPEN_EDIT",function(e,t){var i=Frames.Model.text(t.param[0]),a=Frames.Model.text(t.param[1]);Frames.Dialog.Edit.load(i,a)}),Frames.Application.registerCommandHandler("SHOW_EDITOR",function(e,t){var i=Frames.Model.text(t.param[0]),a=Frames.Model.text(t.param[1]);Frames.Dialog.Editor.load(a,i)}),Frames.Application.registerCommandHandler("SYNCHRONIZE",function(e,t){Frames.Application.execute("SYNC_RESPONSE")}),Frames.Application.registerCommandHandler(["TASK_CLOSE","TASK_OPEN","WINDOW_HIDE","WINDOW_SHOW","CANVAS_HIDE","CANVAS_SHOW"],function(e,t){}),Frames.Download={_downloads:[],_download_files:function(e){this._download_file(e[0].url,e[0].downloadid),this._download_manager(e)},_download_file:function(e,t){$.cookie(t,"pending",{path:"/"});var i=e+(-1!==e.indexOf("?")?"&":"?")+$.param({downloadid:t});$("body").append('<iframe style="visibility: hidden; display: none;"" data-downloadid="'+t+'"" src="'+i+'""></iframe>')},_download_complete:function(e){return"complete"===$.cookie(e)},_download_pending:function(e){return"pending"===$.cookie(e)},_download_manager:function(e){var t,i,a=!1;for(t=e.length;0<t;t--)if(this._download_complete(e[t-1].downloadid)){t===e.length?a=!0:this._download_pending(e[t].downloadid)||this._download_file(e[t].url,e[t].downloadid);break}if(a)for(i=e.length;0<i;i--)$.removeCookie(e[i-1].downloadid,{path:"/"}),$('iframe[data-downloadid="'+e[i-1].downloadid+'"]').remove();else this._delay(this._download_manager,1e3,e)},_delay:function(e,t){var i=this,a=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return e.apply(i,a)},t)}},Frames.Application.on("commandsstart",function(){Frames.Download._downloads=[]}),Frames.Application.on("commandsend",function(){0<Frames.Download._downloads.length&&Frames.Download._download_files(Frames.Download._downloads)}),Frames.Application.registerCommandHandler("FILE_GENERATED",function(e,t){var i=e.request["@reqId"]+"."+(Frames.Download._downloads.length+1);Frames.Download._downloads.push({url:Frames.Model.text(t.param[0]),downloadid:i})}),Frames.Timers={fireTimerExpired:function(e){var i={name:"CLIENT-TIMER-EXPIRED",params:[{name:"timerName",value:e,type:"String"}]};Frames.Application.executing()?Frames.Application.one("viewready",function(e,t){Frames.Application.execute(i,null,null,null,null,!1)}):Frames.Application.execute(i,null,null,null,null,!1)}},Frames.Application.registerCommandHandler("CREATE_TIMER",function(e,t){var i=Frames.findTxt(t,"param","name"),a=Frames.isTrue(Frames.findTxt(t,"param","iterate")),s=parseFloat(Frames.findTxt(t,"param","elapse"));Frames.Application.task._TIMERS_||(Frames.Application.task._TIMERS_={}),Frames.Application.task._TIMERS_[i]=a?setInterval(function(){Frames.Timers.fireTimerExpired(i)},s):setTimeout(function(){Frames.Timers.fireTimerExpired(i)},s)}),Frames.Application.registerCommandHandler("SET_TIMER",function(e,t){var i=Frames.findTxt(t,"param","name"),a=Frames.isTrue(Frames.findTxt(t,"param","iterate")),s=parseFloat(Frames.findTxt(t,"param","elapse"));Frames.Application.task._TIMERS_[i]&&(clearInterval(Frames.Application.task._TIMERS_[i]),delete Frames.Application.task._TIMERS_[i]),Frames.Application.task._TIMERS_[i]=a?setInterval(function(){Frames.Timers.fireTimerExpired(i)},s):setTimeout(function(){Frames.Timers.fireTimerExpired(i)},s)}),Frames.Application.registerCommandHandler("CANCEL_TIMER",function(e,t){var i=Frames.findTxt(t,"param","name");clearInterval(Frames.Application.task._TIMERS_[i]),delete Frames.Application.task._TIMERS_[i]}),function($){Frames.FocusManager={register:function(e){if(!Frames.isUndef(e.member)){var t=e.input();if(Frames.isUndef(t))return;t.length&&0===t.length&&(t=$(t)),t.bind("focusin",Frames.FocusManager._itemTestFocus),t.bind("focus",Frames.FocusManager._itemUnknownNavigation),t.bind("click",Frames.FocusManager._itemUnknownNavigation),t.bind("dblclick",Frames.FocusManager._itemTestFocus),t.bind("btnclick",Frames.FocusManager._itemUnknownNavigation),t.bind("keydown.navigation",Frames.FocusManager._itemKeyboardNavigation)}},unregister:function(e){if(!Frames.isUndef(e.member)){var t=e.input();if(Frames.isUndef(t))return;t.length&&0===t.length&&(t=$(t)),t.unbind("focusin",Frames.FocusManager._itemTestFocus),t.unbind("focus",Frames.FocusManager._itemUnknownNavigation),t.unbind("click",Frames.FocusManager._itemUnknownNavigation),t.unbind("dblclick",Frames.FocusManager._itemTestFocus),t.unbind("btnclick",Frames.FocusManager._itemUnknownNavigation),t.unbind("keydown.navigation",Frames.FocusManager._itemKeyboardNavigation)}},_itemTestFocus:function(e){if(Frames.isTrue(Frames.FocusManager.disabled)||Frames.isTrue(Frames.inDesignMode))return!0;var t=$(e.target);"webkit"!=Frames.browser.engine||"click"!=e.type||t.hasClass("ui-widget")||(t=t.parents(".ui-widget").eq(0));var i=t.data("frames");if(i){if(i.design&&i.design())return!0;var a=Frames.FocusManager._getCurrItem(e,i);if(!Frames.isUndef(a)&&!Frames.FocusManager.equals(a,i)){var s=a.props("Valid"),r=a.props("ValidationMessage");if(Frames.FocusManager._isButtonValidable(i)){var n=Frames.Validation.validateFocusChange(a,i);if(s||(a.props("Valid",s),a.props("ValidationMessage",r)),Frames.Validation.blocking()){if(Frames.isUndef(n)||a==n)return Frames.FocusManager._temporaryBringToTop(a),a.focus(),e.preventDefault(),e.stopImmediatePropagation(),!1;if(!Frames.FocusManager._itemValidateHasChanges(a,r,s))return e.preventDefault(),e.stopImmediatePropagation(),!1}}}}return!0},_isButtonValidable:function(e){var t=!0;if("button"==e.data("widget")){var i=e.data("action"),a=Frames.Config.getaction_name(i);Frames.isUndef(a)?Frames.isTrue(e.props("Navigable"))||(t=!1):t=void 0===a.validation||Frames.isTrue(a.validation)}return t},_itemValidateHasChanges:function(e,t,i){var a=Frames.isUndef(e.context),s=!Frames.isUndef(t)&&!Frames.isEmpty($.trim(t)),r=!e.hasChanges();return!(a&&s&&r&&!Frames.isTrue(i)&&Frames.isTrue(e.props("ValidationEnabled"))&&(e.props("ValidationMessage",t),e.props("Valid",i),Frames.Validation.blocking()))||(Frames.FocusManager._temporaryBringToTop(e),e.focus(),Frames.Validation.showError(e,t),!1)},_itemUnknownNavigation:function(e){if(!Frames.isTrue(Frames.FocusManager.disabled)&&!Frames.isTrue(Frames.inDesignMode)){var t=$(e.target);"click"!=e.type||t.hasClass("ui-widget")||(t=t.parents(".ui-widget").eq(0));var i,a=t.data("frames");if(Frames.isUndef(a)&&(a=Frames.get_frames(t)),a){if(a.design&&a.design())return!0;if(Frames.isTrue(a.clickable())||"btnclick"==e.type){if("click"==e.type||"btnclick"==e.type){i=Frames.FocusManager._getCurrItem(e,a);var s=Frames.FocusManager._isButtonValidable(a)&&!Frames.FocusManager.equals(i,a),r=Frames.FocusManager.rowChanged(i,a);if(s||r){if(!Frames.FocusManager.itemFocusChange(i,a,!0))return!1;Frames.FocusManager._executing=!0,a.trigger("action")}else Frames.FocusManager._executing=!0,a.trigger("action")}}else if(Frames.isTrue(a.props("Navigable"))||"focus"==e.type||"focusin"==e.type){if(!Frames.isUndef(a.props)){var n=a.props("ValidationMessage");Frames.isTrue(a.props("Valid"))||Frames.isUndef(n)||Frames.isEmpty(n)||(Frames.FocusManager._temporaryBringToTop(a),Frames.Validation.showError(a,n))}if((i=Frames.FocusManager._getCurrItem(e))!=a&&!Frames.FocusManager.itemFocusChange(i,a)&&Frames.Validation.blocking()){var o="firefox"==Frames.browser.name;return e.preventDefault(),o||e.stopImmediatePropagation(),!1}}}return!0}},_getCurrItem:function(e,t){var i=Frames.Application.current(),a=$(e.target).data("frames");if((!Frames.isUndef(t)||"focusin"==e.type)&&a&&"datagrid"===a.bindable().widgetcls()&&Frames.Application.task.block&&Frames.Application.task.block._item&&Frames.Application.task.block._item!=i){if(Frames.isUndef(t))i=Frames.Application.task.block._item;else{var s=Frames.isUndef(t.elem.parent().attr("row"))?t.elem.parent().attr("data-row"):t.elem.parent().attr("row");i.block==t.block&&i.member==t.member&&Frames.FocusManager._getItemRow(i)==s&&(i=t)}delete Frames.Application.task.block._item}return i},_getItemRow:function(e){var t,i=e.bindable();return $.isFunction(i.getItemRowIndex)&&(t=i.getItemRowIndex(e)),Frames.isUndef(t)&&(t=String(e.block.selidx)),t},_getItemRowId:function(e){var t=parseInt(Frames.FocusManager._getItemRow(e),10);return e.block.selidx==t?e.block.selid:e.block.idOf(t)},_itemKeyboardNavigation:function(e){if(!Frames.isTrue(Frames.FocusManager.disabled)&&!Frames.isTrue(Frames.inDesignMode)){var t=$(e.target).data("frames");if(t){var i=Frames.Keys.string(e);if(!Frames.isUndef(t.view)&&!Frames.isUndef(t.view._defaultButton)&&Frames.isVisible(t.view._defaultButton))if("ENTER"==i&&!Frames.isTrue(t.clickable()))if(0===t.view._defaultButton.elem.parentsUntil(".ui-window-container").not(":visible").length)return void t.view._defaultButton.trigger("click");var a=Frames.Navigation.nextFocusKey(e,t);if(!Frames.isUndef(a))return Frames.FocusManager.itemFocusChange(t,a,void 0,i)?void 0:(e.preventDefault(),e.stopImmediatePropagation(),!1);var s=Frames.Config.getkeyaction(i);if(s){var r=t.props("keyactions");if(r){var n,o=r.split(",");for(n=0;n<o.length;n++){if(o[n]==s.name){var l=Frames.Config.getaction_name(s.action||s.name),d=l&&l.validation?Frames.isTrue(l.validation):void 0,u=!0;return(void 0===d||d)&&(u=Frames.Validation.validateFormat(t)),u?void 0:(e.preventDefault(),e.stopImmediatePropagation(),!1)}}}}var c=Frames.Config.getaction(i);if(c&&"TAB"!=i&&"SHIFT+TAB"!=i&&!("MessageServiceAction"!=c.type&&"ExitServiceAction"!=c.type||Frames.isUndef(c.item)&&Frames.isUndef(c.name))){var p=Frames.Config.getaction_name(c.name),m=p&&p.validation?Frames.isTrue(p.validation):void 0,h=!0;if((void 0===m||m)&&(h=Frames.Validation.validateFormat(t)),!h)return e.preventDefault(),e.stopImmediatePropagation(),!1}}}},itemPreValidation:function(e,t){if(!Frames.isUndef(e)&&!Frames.isUndef(t)){if(Frames.Validation.reset(e),!Frames.Validation.validateFormat(e))return{value:!1};if(e.enterHasTab()&&"ENTER"==t&&(t="TAB"),e.block.processKey(e,t))return{value:!1}}},_validAndFromSameTask:function(e,t){var i=!1;Frames.isUndef(t)||Frames.isUndef(t.view)||!Frames.Application.isWorkspaceView(t.view.id)||Frames.isUndef(Frames.ToolBar._elem)||(i=0<Frames.ToolBar._elem.has(t.elem).length);var a=e&&e.view?e.view.task:void 0,s=t&&t.view?t.view.task:void 0;return!Frames.isUndef(e)&&!Frames.isUndef(t)&&a!=s&&!i},itemFocusChange:function(e,t,i,a){var s=Frames.isUndef(a)?null:Frames.isUndef(e)?null:e.props("navigate");if(Frames.isUndef(e)||e.props("navigate",null),Frames.isUndef(s)&&Frames.FocusManager._validAndFromSameTask(e,t)){if(!Frames.isUndef(t)&&0<t.length&&(t.hasClass("editor-text")||t.hasClass("slick-header-column")))return!0;if(Frames.isTrue(i))return!0;if(!Frames.isUndef(t.view.task)){var r=t.view.task;if(Frames.Application.task===r)return!0;if((e=(Frames.Application.task=r).block.item)!=t)return Frames.FocusManager.itemFocusChange(e,t);var n=$.Event("focuschange",{target:t.input()}),o=t.input()?t.input():t;o&&o.trigger(n)}return!1}var l=Frames.isUndef(e)?"true":e.props("Valid"),d=Frames.isUndef(e)?void 0:e.props("ValidationMessage"),u=Frames.FocusManager.itemPreValidation(e,a);if(!Frames.isUndef(u))return u.value;if(Frames.isUndef(e)||Frames.isUndef(t)||Frames.isUndef(t.block))return Frames.isTrue(i);var c=Frames.FocusManager.equals(e,t);if(c&&Frames.isUndef(s))return Frames.Validation.reset(e),!0;var p=Frames.Validation.validateFocusChange(e,c?{}:t,i);if(!Frames.isUndef(p)&&e!=p){if(!Frames.isUndef(s))return Frames.Navigation._callService(s,e),!1;if(Frames.isTrue(t.block.props("IgnoreNavigation")))return!0;if(!Frames.FocusManager._itemValidateHasChanges(e,d,l))return!1;if(Frames.isTrue(l)||e.props("Valid",l),Frames.FocusManager.needsServer(e,t))return Frames.Validation.validateFormat(e)&&(e.props("Valid",!0),Frames.FocusManager.execute(e,t,i)),!1;if($.isFunction(e.applyformat)&&e.applyformat(!0),e.props("Valid",!0),Frames.isTrue(t.props("Navigable"))){var m=t.input(),h=$.Event("focuschange",{target:m}),f=m||t;f&&f.trigger(h)}}return!Frames.isUndef(p)&&(!(!Frames.isTrue(t.props("Navigable"))&&!Frames.isTrue(i))&&(e!=p&&(Frames.FocusManager._temporaryBringToTop(p),p.focus()),e!=p))},_temporaryBringToTop:function(e){var t=e.bindable().elem;Frames.isUndef(t)||(t.parents(".ui-tabs-panel").each(function(){var e=$(this),t=e.index(),i=e.parent().data("frames");Frames.isUndef(i)||Frames.isUndef(t)||i.selected(t-1)}),t.parents(".ui-accordion-content, .ui-collapsiblepanel-content").reverse().each(function(){var e=$(this).closest(".ui-accordion-widget, .ui-collapsiblepanel").data("frames");if(e){var t=$(this).prev(".ui-accordion-header, .ui-collapsiblepanel-header").attr("tabindex");e.show(Frames.isUndef(t)?void 0:parseInt(t,10))}}))},validate:function(e){try{if(Frames.isTrue(e._infocusvalidation))return;if(e._infocusvalidation=!0,Frames.isUndef(e)&&(e=Frames.Application.current()),!Frames.isUndef(e.props)){var t=e.props("ValidationMessage");if(Frames.isUndef(t)&&(t=e.props("Error")),!Frames.isTrue(e.props("Valid"))&&!Frames.isUndef(t)&&!Frames.isEmpty(t)&&Frames.Validation.blocking())return Frames.FocusManager._temporaryBringToTop(e),e.focus(),Frames.Validation.showError(e,t),!1}}catch(e){}finally{e._infocusvalidation=!1}return!0},rowChanged:function(e,t){if(!Frames.isUndef(e)&&!Frames.isUndef(t)&&e.block==t.block&&$.isFunction(e.bindable)&&$.isFunction(t.bindable)&&e.bindable()==t.bindable()){var i=e.bindable();if(!Frames.isUndef(i)){var a=i.widgetcls();if("datagrid"==a){if(Frames.FocusManager._isEditor(e)&&Frames.FocusManager._isEditor(t))return e.args.item.__id__!=t.args.item.__id__;if(Frames.FocusManager._isEditor(e)&&Frames.FocusManager._isContext(t)){var s=Frames.FocusManager.rowChanged(e,t._curr);return!s&&t.selid&&(s=e.args.item.__id__!=t.selid),s}if(Frames.FocusManager._isContext(e)&&Frames.FocusManager._isEditor(t))return Frames.FocusManager.rowChanged(e._curr,t);if(e.selid&&t.selid)return e.selid!=t.selid}if("repeater"==a&&!Frames.isUndef(e.id)&&!Frames.isUndef(t.id))return e.id!=t.id}}},equals:function(e,t){if(Frames.isUndef(e)||Frames.isUndef(t))return e==t;if(e.block!=t.block)return!1;if(e.member!=t.member)return!1;if($.isFunction(e.bindable)&&$.isFunction(t.bindable)&&e.bindable()==t.bindable()){var i=e.bindable();if(!Frames.isUndef(i)){var a=i.widgetcls();if("datagrid"==a){if(Frames.FocusManager._isEditor(e)&&Frames.FocusManager._isEditor(t))return e.args.item.__id__==t.args.item.__id__;if(Frames.FocusManager._isEditor(e)&&Frames.FocusManager._isContext(t)){var s=Frames.FocusManager.equals(e,t._curr||t._editor);return s&&t.selid&&(s=e.args.item.__id__==t.selid),s}if(Frames.FocusManager._isContext(e)&&Frames.FocusManager._isEditor(t))return Frames.FocusManager.equals(e._curr||e._editor,t)}if("repeater"==a){if(!Frames.isUndef(e.id)&&!Frames.isUndef(t.id))return e.id==t.id;e=e.context?e.context():e,t=t.context?t.context():t}}}return e==t},_isRepeaterContext:function(e){return!$.isFunction(e.context)&&!Frames.isUndef(e._repeater)},_isEditor:function(e){return!Frames.isUndef(e.context)&&!Frames.isUndef(e.args)},_isContext:function(e){return $.isFunction(e.isContext)?e.isContext():!Frames.isUndef(e._curr||e._editor)},needsServer:function(e,t){var i;if("xbutton"===t.widgetcls()&&!Frames.isTrue(t.props("Navigable"))&&!0===t.clickable())return!1;if(e.block==t.block&&e.block.rowChanged()){if(i=e.block.props("NavigationAction"),Frames.isTrue(e.block.master)||"server"==e.props("validation")||"server"==e.block.props("validation")||!Frames.isUndef(i)&&(-1!=i.indexOf("R")||-1!=i.indexOf("O")))return!0;if(e.block.hasChanges())return!0}if(e.block!=t.block){var a=Frames.isTrue(t.props("Navigable"));if(a&&!e.valid()&&("server"==e.props("validation")||"server"==e.block.props("validation")))return!0;if(a&&e.block.hasChanges()&&"server"==e.block.props("validation"))return!0;if(i=e.block.props("NavigationAction"),a&&!Frames.isUndef(i)&&-1!=i.indexOf("O"))return!0;if(i=t.block.props("NavigationAction"),!Frames.isUndef(i)&&(a&&-1!=i.indexOf("I")||-1!=i.indexOf("R")))return!0;if(Frames.isTrue(t.block.master)&&t.block.rowChanged())return!0}if(e!=t){var s=!Frames.isTrue(e.props("required"))||!Frames.isEmpty(e.value());if((!e.valid()||e.toValidate()||!s)&&"server"==e.props("validation"))return!0;if(i=e.props("NavigationAction"),!Frames.isUndef(i)&&-1!=i.indexOf("O"))return!0;if(i=t.props("NavigationAction"),!Frames.isUndef(i)&&-1!=i.indexOf("I"))return!0}return!1},execute:function(e,t,i){Frames.FocusManager.disabled=!0,Frames.focus.callback=Frames.FocusManager._restoreFocus;var a="",s="",r="string";if(Frames.isTrue(i)&&(a=t.data("action"),Frames.isUndef(a)?a="":"script:"==a.substring(0,7)&&(a="",Frames.FocusManager._elemScript=t),$.isFunction(t.optmodel))){var n=t.optmodel();if(n){var o=Frames.Model.value(n);void 0!==o&&(Frames.Application._supportnulls?(s={value:o},r="json"):s=o)}}var l=(Frames.Application.task.block.item=e).selid?e.selid:e.block.selid,d=Frames.FocusManager._getItemRowId(t);e.block.selid=l,"datagrid"===t.bindable().widgetcls()&&(e.block==t.block||Frames.isUndef(t.block._last_id)?e.block!=t.block||"datagrid"===e.bindable().widgetcls()||Frames.isUndef(e.block._last_id)||(e.block.selid=e.block._last_id,l=e.block.selid):t.block.selid=t.block._last_id),$.isFunction(e.applyformat)&&e.applyformat(!1),Frames.Application.execute({name:"PROC:GOTOITEM",params:[{name:"previousItem",value:e.member,type:"string"},{name:"previousBlock",value:e.block.name,type:"string"},{name:"previousRecord",value:l,type:"string"},{name:"item",value:t.member,type:"string"},{name:"block",value:t.block.name,type:"string"},{name:"record",value:d,type:"string"},{name:"actionValue",value:Frames.Model.encode(s,!0),type:r},{name:"fireItemAction",value:a,type:"string"}]},void 0,void 0,void 0,void 0,!1)},_restoreFocus:function(e,t){if(delete Frames.FocusManager.disabled,Frames.focus(e,t),!Frames.isUndef(Frames.FocusManager._elemScript)){var i=Frames.FocusManager._elemScript;delete Frames.FocusManager._elemScript,Frames.Application.elemexec(i)}}},Frames.regplug("focusmanager",Frames.FocusManager,Frames.PLUGIN_WIDGET),$(document).keydown(function(e){var t=$(document.activeElement);if(0<t.length&&8===e.keyCode&&(!t.is(":input")||t.is(":button")||"readonly"==t.attr("readonly")))return!1;if(0<t.length){var i=Frames.Application.mainTask==Frames.Application.task,a=Frames.Application.current();if(a&&a.block){var s=Frames.Keys.string(e);if(i){var r=Frames.Config.getaction(s);if(r)if(!(-1!=$.inArray(r.type,["MessageServiceAction","ExitServiceAction","ItemAction"])))return a.block.processKey(a,s)}else a.block.processKey(a,s)}}})}(jQuery),function($){Frames.Navigation=$.inherit({},{__constructor:function(){},nextFocusKey:function(e,t){var i=null,a=Frames.Keys.code(e);return(9==a||13==a&&t.enterHasTab())&&(Frames.Navigation._last_key=Frames.Keys.string(e),void 0!==(i=this._changeFocus(Frames.Keys.shift(e),t))&&Frames.Keys.cancel(e),delete Frames.Navigation._last_key),i},_changeFocus:function(e,t){return e?this._previousFocus(t):this._nextFocus(t)},_previousFocus:function(e){if(!Frames.isUndef(e)){var t,i=null;return Frames.isUndef(e)||Frames.isUndef(e.block)||(t=e.block,i=this._findPreviousItem(t,e),Frames.isUndef(i)),!Frames.FocusManager.equals(e,i)&&this._isNavigable(i)?i:(e.props("navigate","PREVIOUS_ITEM"),e)}},_nextFocus:function(e){if(!Frames.isUndef(e)){var t,i=null;if(Frames.isUndef(e)?t=Frames.Application.task.get(0):Frames.isUndef(e.block)||(t=e.block,i=this._findNextItem(e.block,e),Frames.isUndef(i)),!Frames.FocusManager.equals(e,i)){if(Frames.isUndef(t))return;if(this._isNavigable(i))return i}return e.props("navigate","NEXT_ITEM"),e}},_findPreviousItem:function(e,t){var i,a,s;if(t&&t.props("PreviousItem")){a=(s=t.props("PreviousItem").split("."))[0],i=s[1];var r=Frames.Application.task.get(a);if(!Frames.isUndef(r)){var n=r.get(i);if(!Frames.isUndef(n)){var o=t.props("ChangeRecord");if("previous"!=o&&"both"!=o)return n}}}return t&&t.props("navigate","PREVIOUS_ITEM"),t},_findNextItem:function(e,t){var i,a,s;if(t&&t.props("NextItem")){a=(s=t.props("NextItem").split("."))[0],i=s[1];var r=Frames.Application.task.get(a);if(!Frames.isUndef(r)){var n=r.get(i);if(!Frames.isUndef(n)){var o=t.props("ChangeRecord");if("next"!=o&&"both"!=o)return n}}}return t&&t.props("navigate","NEXT_ITEM"),t},_isNavigable:function(e){if(e){var t=e.resolve();return Frames.isUndef(t)&&(e=t),Frames.isTrue(e.props("Navigable"))&&Frames.isTrue(e.props("Enabled"),!0)}return!1},_callService:function(e,t){var i=Frames.FocusManager.itemPreValidation(t,Frames.Navigation._last_key);if(delete Frames.Navigation._last_key,!Frames.isUndef(i))return i.value;Frames.Application.execute(e)}})}(jQuery),function($,g){g.Validation={form:function(e){if(!e)return $([]);if((e=$(e)).length){var t=$(e.get(0).form);return 0!==t.length||!e.is("input,select,textarea")||0!==e.parent().length&&0!==e.parent().parent().length||(t=g.Application.task.view.window().find("form"),e.appendTo(t).hide(),t._appended=!0),t}return $([])},_clean:function(e,t){if(e&&e._appended&&(t.remove(),delete e._appended),t&&t._appended){var i=t.data("frames");if(i){var a=i.input().removeClass("error");t.hasClass("error")&&a.addClass("error")}t.remove()}},input:function(e){var t=$(e.validable?e.validable():e.input()),i=e.props("type"),a=e.props("format"),s=g.Format.rules(a,i),r=g.isTrue(s.numeric);if(r){var n=e.value(),o=t.parent().find(".frames-clone");if(0===o.length){var l=t.attr("id");if(g.isUndef(l)&&(l=g.uuid()),0===(o=$('<input id="'+l+'_clone" type="hidden" class="frames-clone" />').appendTo(t.parent())).length){var d=g.Application.task.view.window().find("form");o.appendTo(d).hide()}o._appended=!0,o.data("frames",t.data("frames"))}if(o.data("format-value",n),o.data("unformated-value",t.val()),r){var u=g.Format.toValue(n,e.props("format"),i);n=g.isUndef(u)?String(n):$.isFunction(u.toFixed)?u.toFixed():u}else n=g.Format.unformat(n,e.props("format"),i);o.val(n),t=o}return t},hasRules:function(e){var t=g.Validation.input(e),i=g.Validation.form(t);if(i.length){var a=$.data(i[0],"validator");return g.Validation._clean(i,t),!g.isUndef(a)&&!g.isUndef(a.settings.rules[t.attr("id")])}return!1},validate:function(e){var t=$.isFunction(e.input)?e.input():void 0;if(void 0!==t&&!t.is("input,select,textarea"))return!0;if(!e.editable())return!0;t=g.Validation.input(e);var i=g.Validation.form(t);if(i.length){var a=e.props?e.props("ValidationEnabled"):void 0;if(void 0!==a&&!g.isTrue(a))return!0;try{g.isUndef(e.context)||(e.context._invalidation=!0);var s=i.validate().element(t);return g.Validation._clean(i,t),e.props("Valid",s),g.isTrue(s)}finally{g.isUndef(e.context)||(e.context._invalidation=!1)}}return!0},rules:function(e,t,i){var a=$.isFunction(e.input)?e.input():void 0;if(void 0===a||a.is("input,select,textarea")){var s=g.isUndef(t)||g.isTrue(t),r=g.isUndef(i)||g.isTrue(i);a=g.Validation.input(e);var n=e.rules(),o=g.Validation.form(a);if(o.data("validator")&&!g.isUndef(n)){var l={},d=!1;if(a.rules("remove"),s){var u=e.props("type"),c=e.props("formatDefault"),p=e.props("format"),m=g.Format.rules(p,u);if(c&&g.isTrue(m.numeric)&&(d=!0,l.number=!0),n.format&&g.isTrue(e.props("formatEnabled"))&&g.isTrue(m.format)&&(d=!0,l.format=[e.props("format"),u]),n.restrict&&g.isTrue(e.props("formatEnabled"))&&"true"===g.Config.get("VALIDATE_RESTRICT","true")&&(d=!0,l.restrict=[e.dataModel()]),g.isTrue(m.range)){var h=e.props("maxvalue"),f=e.props("minvalue");g.isUndef(h)||(h=g.Format.toValueFromCanonical(h,u)),g.isUndef(f)||(f=g.Format.toValueFromCanonical(f,u)),n.maxvalue&&!g.isUndef(h)&&(d=!0,l.max=h),n.minvalue&&!g.isUndef(f)&&(d=!0,l.min=f)}g.isTrue(m.length)&&(n.maxlength&&!$.isNaN(e.props("maxlength"))&&(d=!0,l.maxlength=parseInt(e.props("maxlength"),10)),n.minlength&&!$.isNaN(e.props("minlength"))&&(d=!0,l.minlength=parseInt(e.props("minlength"),10)))}r&&n.required&&g.isTrue(e.props("required"))&&(d=!0,l.required="true"===g.Config.get("VALIDATE_REQUIRED","true")),d&&a.rules("add",l),g.Validation._clean(o,a)}else{if(g.isUndef(n)&&0<a.length)try{a.rules("remove")}catch(e){}g.Validation._clean(o,a)}}},validateFormat:function(e){if(!g.isUndef(e.context)&&g.isTrue(e.context._invalidation))return!1;if(g.isUndef(e)||!e.validate(!0))return!0;var t=!0,i=g.Validation.input(e),a=g.Validation.form(i);if(a.length){g.Validation.hasRules(e)||g.Validation.ControlInfo.apply(e);var s=i.rules("remove");(s.format||s.maxlength||s.minlength||s.minvalue||s.maxvalue||s.number||s.restrict)&&(g.Validation.rules(e,!0,!1),t=this.validate(e),i.rules("remove"),i.rules("add",s)),g.Validation._clean(a,i)}return t},validateFocusChange:function(e,t,i){if(g.isUndef(e)||!e.validate(!0))return t;if(!g.isUndef(t)&&(e.block!=t.block||"server"==e.props("validation")))if(g.isTrue(e.block.props("MultiRecord"))){if($.isFunction(e.recordHasChanges)&&!e.recordHasChanges())return t}else if(!e.block.hasChanges())return t;return g.Validation.hasRules(e)||g.Validation.ControlInfo.apply(e),g.Validation.reset(e),this.validate(e)?t:g.Validation.blocking()?e:t},isWidget:function(e){return!g.isUndef(e)&&!!$.isFunction(e.widget)},reset:function(e){if(g.Validation.isWidget(e)){var t=$(e.input()),i=g.Validation.form(t);if(i.length){var a=t.rules("remove");this.validate(e),t.rules("add",a),g.Validation.hideError(e),e.props("Error",null),e.props("ValidationMessage",null),g.Validation._clean(i,t)}}},showError:function(e,t){if(!g.isUndef(e)&&!g.isUndef(e.elem)&&!g.isUndef(e.args)){var i=e.elem.parent();0<i.length&&i.addClass("ui-error")}},hideError:function(e){if(g.isUndef(e)&&(e=g.Application.current()),e&&e.elem){var t=e.elem.parent();0<t.length&&t.removeClass("ui-error")}},blocking:function(){return g.Application.task&&"NonBlocking"!=g.Application.task.validation}},g.Validation.Plugin={init:function(e){var t=e.window(),i=t.length?$("form",t):$("form");if(!i.length){if(i=$("<form></form>"),t[0]){var a=t.attr("class").match(/(?:\s+|^)(ui-layout-\w+)(?:\s+|$)/);a&&i.addClass(a[1])}i.attr("id",g.uuid()),t.wrapInner(i),i=$("form",t)}i.submit(function(e){if($(e.target).is("form")&&e.target==i.get(0))return!1}),i.validate({onkeyup:!1,onfocusout:function(e){},errorLabelContainer:$([]),errorPlacement:function(e,t){var i=$(t);i.parents("span.right").length;if(!e.is(":empty")){var a=i.data("frames");return g.isUndef(a)&&(a=g.Application.current()),g.isUndef(a)||(g.Validation.blocking()&&a.focus(!0),g.Validation.showError(a,e),a.props("Valid","false"),a.props("Error",e.text())),!1}var s=i.data("frames");g.isUndef(s)||(g.Validation.hideError(s),s.props("Valid","true"),s.props("Error",null))},success:$.noop,invalidHandler:function(){$(this).find(":input.error:first").focus()}})}},g.regplug("validationmanager",g.Validation.Plugin,g.PLUGIN_VIEW),g.Validation.ControlInfo={apply:function(e,t){if(g.isUndef(e._editor)||(e=e._editor),"true"===g.Config.get("OPTIMIZATION.CONTROLINFO","false")&&void 0!==t){var i=g.findSingle(t,"item",e.member);if(!(t.properties||i&&(i.properties||i.instance)))return}g.Validation.rules(e)}},g.regplug("itemvalidation",g.Validation.ControlInfo,g.PLUGIN_CONTROLINFO),$.fn.validateDelegate=function(e,t,i){return this.bind(t,$.noop)},$.validator.addMethod("format",function(e,t,i){var a=$(t).data("format-value"),s=i[0],r=i[1];return this.optional(t)||g.Format.test(a||e,s,r)},function(e,t){var i=g.Format.convertFormatLocalized(e[0],e[1]);return $.validator.format(g.Format.message(null,e[0],e[1]),[i,e[0]])});var a=$.validator.methods.min;$.validator.methods.min=function(e,t,i){return!g.isEmpty(e)&&i instanceof Big?(e=new Big(e),this.optional(t)||0<=e.cmp(i)):a.apply(this,arguments)};var s=$.validator.methods.max;$.validator.methods.max=function(e,t,i){return!g.isEmpty(e)&&i instanceof Big?(e=new Big(e),this.optional(t)||e.cmp(i)<=0):s.apply(this,arguments)};var r=$.validator.methods.range;$.validator.methods.range=function(e,t,i){var a=i[0];return!g.isEmpty(e)&&a instanceof Big?(e=new Big(e),this.optional(t)||0<=e.cmp(a)&&e.cmp(i[1])<=0):r.apply(this,arguments)},g.Application.on("locale",function(){if(g.Config.getbool("FORMAT_VALIDATION_MESSAGE",!1)){var d=$.validator.messages.range;$.validator.messages.range=function(e,t){var i=$(t),a=i.parent().data("format"),s=i.parent().data("type"),r=e[0].toFormat(),n=e[1].toFormat(),o=g.Format.format(r,a,s),l=g.Format.format(n,a,s);return d(o,l)}}}),$.validator.addMethod("restrict",function(i,e,t){var a=$(e);if(a.hasClass("frames-clone")){var s=a.data("unformated-value");i=g.isEmpty(s)?i:s}else"select-one"==e.type&&$(e).parent().is('[data-widget="combobox"]')&&(i=$(e).parent().find("input").val());var r=!$.validator.methods.required.call(this,i,e)&&"dependency-mismatch"||""===i;if(r)return r;var n=t[0];if(n instanceof $)return!0;if($.isArray(n))return $.each(n,function(e,t){if(i===t.label)return!(r=!0)}),r;for(var o in n)if(n.hasOwnProperty(o)&&i===n[o])return!0;return!1},function(e,t){return $.validator.format(g.Locale.messages.VALIDATION_RESTRICT)});var n=$.validator.methods.required;$.validator.methods.required=function(e,t,i){var a=e;null===a&&"select-one"==t.type&&$(t).parent().is('[data-widget="combobox"]')&&(a=$(t).parent().find("input").val());var s=n.apply(this,arguments);return s||"string"!=typeof a?s:0<a.length},$.validator.setDefaults({ignore:"",ignoreTitle:!0}),g.ready(function(){$.validator.autoCreateRanges=g.Config.getbool("AUTO_CREATE_RANGES",!1)})}(jQuery,Frames),function($){var s={isExtendable:function(e){return e.elem&&e.member&&e.input()},register:function(e){Frames.inDesignMode||this._isInitialized()&&(this.hintEl=$(document).find("#hint").children("span.hint"),this.isExtendable(e)&&e.input().bind("focusin",this._focusEvent))},_isInitialized:function(){return!Frames.isUndef(this.hintEl)||0<$(document).find("#hint").length},_focusEvent:function(e){var t=$(e.target);"chrome"!==Frames.browser.name||"click"!=e.type||t.hasClass("ui-widget")||(t=t.parents(".ui-widget").eq(0));var i=t.data("frames");if(i){var a=i.props("hint");s.hintEl.html(Frames.isEmpty(a)?"&#160;":a)}return!0},unregister:function(e){if(this._isInitialized()){this.hintEl.html("&#160;");var t=e.input();Frames.isUndef(t)||t.off("focusin",this._focusEvent)}}};Frames.regplug("HintManager",s,Frames.PLUGIN_WIDGET)}(jQuery),function($){var a={register:function(e){if(Frames.isUndef(a._enabled)&&(a._enabled=Frames.Config.getbool("TOOLTIP_ENABLED")),a._enabled){if(!Frames.isUndef(e.member)){var t=e.input();if(Frames.isUndef(t))return;t.bind("focusin",a._focusEvent)}}else if($.isFunction(e.tooltip)){var i=e.props("tooltip-original")||e.props("tooltip");e.tooltip(i)}},_focusEvent:function(e){var t=$(e.target);"webkit"!=Frames.browser.engine||"click"!=e.type||t.hasClass("ui-widget")||(t=t.parents(".ui-widget").eq(0));var i=t.data("frames");if(i){if(i.design&&i.design())return!0;var a=Frames.Config.get("TOOLTIP_IGNORE_WIDGETS","xbutton").split(",");if(-1!==$.inArray(i.widgetcls(),a))return;var s=i.tooltip();if(!Frames.isEmpty(s)){Frames.Application.current();var r=i.input()?i.input():i;r.tooltip("destroy"),r.tooltip({title:s,placement:"top left",template:'<div class="tooltip" role="tooltip"><div class="tooltip-inner"></div></div>'})}}return!0},_focusInEvent:function(e){return!0},unregister:function(e){var t=e.input();Frames.isUndef(t)||t.off("focusin",a._focusEvent)}};Frames.regplug("TooltipManager",a,Frames.PLUGIN_WIDGET)}(jQuery),Frames.History={init:function(){void 0!==window.history&&history.pushState&&(history.pushState(null,document.title,location.href),window.addEventListener("popstate",function(e){history.pushState(null,document.title,location.href),Frames.Application.valexec("WORKSPACE_BACK")}))}},function($){Frames.Modes={_TYPES_:{},enter:function(e,t){var i=Frames.Modes.gettype(e);if(i){var a=new i(t);a.name=e,(t.mode=a).enter(),t.elem.addClass("mode-"+t.mode.name.toLowerCase())}},leave:function(e){e.mode&&(e.mode.leave(),e.elem.removeClass("mode-"+e.mode.name.toLowerCase()),delete e.mode)},regtype:function(e,t){Frames.Modes._TYPES_[e]=t},gettype:function(e){return Frames.Modes._TYPES_[e]}},Frames.Modes.BaseMode=$.inherit({__constructor:function(e){this.item=e},enter:function(){},leave:function(){}})}(jQuery),function($){Frames.Modes.Edit=$.inherit(Frames.Modes.BaseMode,{__constructor:function(e){e.isContext&&e.isContext()&&e._repeater&&(e=e.resolve()),this.item=e},enter:function(){var e=this.item.props("serverStatus");this._allow=void 0!==e&&"INSERTED"==e?Frames.isTrue(this.item.props("AllowInsert")):Frames.isTrue(this.item.props("AllowUpdate"));var t=this.item.props("ReadOnly")||this.item.props("readonly");this._allow=this._allow&&!Frames.isTrue(t),this._lastEditable=this.item.editable(),this._allow?this.item.editable(!0):this.item.editable(!1)},leave:function(){if(!this._allow)try{this.item.editable(this._lastEditable)}catch(e){}}}),Frames.Modes.regtype("EDIT",Frames.Modes.Edit)}(jQuery),function($){Frames.Modes.Read=$.inherit(Frames.Modes.BaseMode,{__constructor:function(e){this.item=e},enter:function(){this._lastEditable=this.item.editable(),this.item.editable(!1),this._lastValidationEnabled=this.item.props("ValidationEnabled"),this.item.props("ValidationEnabled","false")},leave:function(){this.item.editable(this._lastEditable),this.item.props("ValidationEnabled",this._lastValidationEnabled)}}),Frames.Modes.regtype("READ",Frames.Modes.Read)}(jQuery),function($){Frames.Modes.Search=$.inherit(Frames.Modes.BaseMode,{__constructor:function(e){this.item=e},enter:function(){var e=this.item.props("Enabled");this._allow=Frames.isTrue(this.item.props("AllowSearch"))&&(void 0===e||Frames.isTrue(e)),this._lastEditable=this.item.editable(),this._lastEnabled=this.item.enabled(),this._lastValidationEnabled=this.item.props("ValidationEnabled"),this._lastFormatEnabled=this.item.props("formatEnabled"),this._lastMaxlength=this.item.input()&&this.item.input().attr("maxlength"),Frames.isUndef(this._lastMaxlength)||this.item.input().removeAttr("maxlength"),this.item.props("ValidationEnabled","false"),this._allow?(this.item.enabled(!0),this.item.editable(!0),this.item.props("formatEnabled",!1)):this.item.editable(!1)},leave:function(){this.item.props("ValidationEnabled",this._lastValidationEnabled),Frames.isUndef(this._lastMaxlength)||this.item.input().attr("maxlength",this._lastMaxlength),this._allow?(this.item.enabled(this._lastEnabled),this.item.editable(this._lastEditable),this.item.props("formatEnabled",this._lastFormatEnabled)):this.item.editable(this._lastEditable)}}),Frames.Modes.regtype("SEARCH",Frames.Modes.Search)}(jQuery),function($){Frames.Modes.New=$.inherit(Frames.Modes.BaseMode,{__constructor:function(e){this.item=e},enter:function(){var e=this.item.props("ReadOnly")||this.item.props("readonly");this._allow=Frames.isTrue(this.item.props("AllowInsert"))&&!Frames.isTrue(e),this._lastEditable=this.item.editable(),this._allow||this.item.editable(!1)},leave:function(){this._allow||this.item.editable(this._lastEditable)}}),Frames.Modes.regtype("NEW",Frames.Modes.New)}(jQuery),function($){Frames.TextInput=$.inherit(Frames.Item,{init:function(e){this.fixRtl(),Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this),this._computeLabelStyle(),this.initInputMask()},fixRtl:function(){if("rtl"===this.elem.css("direction")&&"function"==typeof this.labelObj){var e=this.labelObj()&&this.labelObj()[0];if(e){e.style&&e.style.float&&(e.style.float="right");var t=e.style.marginLeft,i=e.style.marginRight;t&&(e.style.marginRight=i),i&&(e.style.marginLeft=t)}}},defaults:function(){Frames.Item.prototype.defaults.apply(this),Frames.Config.getbool("FIELD_AUTO_ALIGNMENT",!1)&&$.isFunction(this._setAutoAlignment)&&this._setAutoAlignment(),Frames.isUndef(this.elem.data("type"))&&this.props("type","String");var e=this.input();this._set_prop("DisplayAsPassword",!!e&&"password"===this.input().prop("type"))},_setAutoAlignment:function(){var e=this.elem.css("direction"),t=Frames.Item.prototype._getDataDirection.apply(this,[void 0,e]);if(""===this.input()[0].style.textAlign){var i=Frames.Format.getAlignment(e,t,this.props("type"));Frames.isUndef(i)||this.input().css("text-align",i)}},displayAsPassword:function(){if(0===arguments.length)return this.props("DisplayAsPassword");var e=Frames.isTrue(arguments[0])?"password":"text",t=this.input();t&&t.prop("type")!==e&&("text"===e?t.attr("title",this._call("value")):t.removeAttr("title"),t.prop("type",e))},initInputMask:function(e){if(Frames.Config.getbool("INPUTMASKS_ENABLED",!1)){var t=this.input();if(Frames.isTrue(this.props("formatEnabled"))){var i=this.props("format"),a=this.props("type");if(Frames.isUndef(i)||!Frames.Format.isValidFormat(i,a))return;var s=t.attr("maxlength");switch(a){case"Integer":i=i.toUpperCase();var r="left"!==t.prop("style")["text-align"]&&Frames.Config.getbool("FIELD_AUTO_ALIGNMENT",!1),n=Frames.Locale.formats.GROUP_SEPARATOR,o=""!==n&&-1!==i.indexOf("G");t.inputmask("integer",{groupSeparator:n,autoGroup:o,allowPlus:!1,rightAlignNumerics:r});break;case"Number":i=i.toUpperCase();var l="left"!==t.prop("style")["text-align"]&&Frames.Config.getbool("FIELD_AUTO_ALIGNMENT",!1),d=Frames.Locale.formats.GROUP_SEPARATOR,u=""!==d&&-1!==i.indexOf("G"),c=Frames.Locale.formats.DECIMAL_SEPARATOR,p=i.replace(/G/gi,"").split("D");t.inputmask("decimal",{groupSeparator:d,radixPoint:c,autoGroup:u,allowPlus:!1,skipRadixDance:!0,digits:p[1]?p[1].length:0,rightAlignNumerics:l});break;case"Date":i=(new Frames.FormatDate).convertFormat(i).toLowerCase(),void 0!==Inputmask.extendAliases[i]&&t.inputmask(i,{placeholder:"_"});break;default:void 0!==a&&"String"!==a&&void 0!==Inputmask.extendAliases[a.toLowerCase()]&&t.inputmask({alias:a.toLowerCase(),mask:i})}t.data("_inputmask")&&t.attr("maxlength",s)}else t.inputmask("remove")}},destroy:function(){this.autounregister(),delete this.view,this._call("wrapper",null),delete this.elem},input:function(){return this._call("input")},labelObj:function(){return this._call("labelObj")},label:function(){if(!(0<arguments.length))return this._call("label");this._call("label",arguments[0]),this.visible()&&this._label_position(),this._label_changed=!0,this._computeLabelStyle()},value:function(){if(!(0<arguments.length)){var e=this._call("value");return e instanceof jQuery?"":e}this._call("value",arguments[0])},focus:function(){this._call("focus")}}),Frames.regtype("textinput",Frames.TextInput),Frames.Item.PROP_MAP.formatEnabled={method:"formatEnabled"},Frames.Item.PROP_MAP.DisplayAsPassword={method:"displayAsPassword"}}(jQuery),function($){$.widget("ui.textinput",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-textinput ui-widget"),this._inp=$("input",this.element),this._lbl=$("label",this.element),this.checkid(),this._inp.attr("autocomplete","false"),this.fixpositions()},checkid:function(){var e=this._inp.attr("id");Frames.isEmpty(e)&&(e=Frames.uuid(),this._inp.attr("id","#"+e),this._lbl.attr("for","#l:"+e))},fixpositions:function(){Frames.Config.getbool("POSITION_FIXRTBT")&&(Frames.isUndef(this._lbl)||"absolute"!==this._lbl.css("position")||(this.element.hasClass("ui-label-position-bottom")?this._lbl.css("margin-top",this.element.height()+parseInt(this._lbl.css("margin-top"),10)):this.element.hasClass("ui-label-position-right")&&this._lbl.css("margin-left",this.element.width()+parseInt(this._lbl.css("margin-left"),10))))},destroy:function(){$.Widget.prototype.destroy.call(this),this._inp.data("frames",null),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this.input().data("frames",e)},value:function(){var e=this.input().data("frames");if(!(0<arguments.length)){var t=this.input().val.apply(this._inp);if(e){var i=e.canonicalValue(),a=/\r?\n|\r/g;Frames.isUndef(i)||Frames.isUndef(i.match(a))||i.replace(a,"")!=t||(t=i)}return t}e&&Frames.isTrue(e.props("DisplayAsPassword"))||this.input().attr("title",arguments[0]),this.input().val.apply(this._inp,arguments)},input:function(){return Frames.isUndef(this._inp)&&(this._inp=$("input",this.element),this._inp.addClass("ui-widget-content ui-corner-all"),this._inp.attr("autocomplete","off")),this._inp},labelObj:function(){return this._lbl},label:function(){if(!(0<arguments.length))return this.labelObj().text();this.labelObj().text(arguments[0])},focus:function(){if(!this.design()){var e=this.input();e.is(":disabled")||("ie"==$.browsercss()[0]?(e.get(0).focus(),e.get(0).select()):(e.focus(),e.select()))}},design:function(){var e=this.input().data("frames");return null!=e&&e.design()}})}(jQuery),function($){Frames.TextArea=$.inherit(Frames.TextInput,{enterHasTab:function(){return!1},mapvalue:function(){return Frames.Item.prototype.mapvalue.apply(this,arguments)}}),Frames.regtype("textarea",Frames.TextArea)}(jQuery),function($){$.widget("ui.textarea",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-textarea ui-widget"),this._inp=$("textarea",this.element),this._lbl=$("label",this.element),this._inp.attr("autocomplete","false").addClass("ui-widget-content ui-corner-all").keydown(function(e){if(e.keyCode==$.ui.keyCode.DOWN||e.keyCode==$.ui.keyCode.UP){var t=this.value.split("\n").length,i=this.value.substr(0,$(this).prop("selectionStart")).split("\n").length;1<t&&(1!==i&&i!==t||1===i&&e.keyCode!==$.ui.keyCode.UP||i===t&&e.keyCode!==$.ui.keyCode.DOWN)&&e.stopImmediatePropagation()}}),this.checkid(),this.fixpositions()},checkid:function(){$.ui.textinput.prototype.checkid.apply(this,arguments)},fixpositions:function(){$.ui.textinput.prototype.fixpositions.apply(this,arguments)},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-textarea ui-widget"),this._inp.removeClass("ui-widget-content ui-corner-all"),this._inp.data("frames",null),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this._inp.data("frames",e)},value:function(){return 0<arguments.length&&this._inp.attr("title",arguments[0]),this._inp.val.apply(this._inp,arguments)},input:function(){return this._inp},labelObj:function(){return this._lbl},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},focus:function(){this.design()||this._inp.focus()},design:function(){return this.input().data("frames").design()}})}(jQuery),function($){Frames.TextField=$.inherit(Frames.TextInput,{}),Frames.regtype("textfield",Frames.TextField)}(jQuery),function($){$.widget("ui.textfield",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-textfield ui-widget"),this._inp=$("span",this.element),this._lbl=$("label",this.element),this._inp.addClass("ui-widget-content ui-corner-all"),this.checkid(),this.fixpositions()},checkid:function(){$.ui.textinput.prototype.checkid.apply(this,arguments)},fixpositions:function(){$.ui.textinput.prototype.fixpositions.apply(this,arguments)},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-textfield ui-widget"),this._inp.removeClass("ui-widget-content ui-corner-all"),this._inp.data("frames",null),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this._inp.data("frames",e)},value:function(){if(!(0<arguments.length))return this._inp.text.apply(this._inp);var e=$.map(arguments,function(e,t){return e||""})[0],t=Frames.get_frames(this.element);t&&Frames.isTrue(t.props("DisplayAsPassword"))&&(e=e.replace(/./g,"*")),this._inp.text(e),this._inp.attr("title",e)},input:function(){return this._inp},labelObj:function(){return this._lbl},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},focus:function(){this._inp.focus()},design:function(){return this.input().data("frames").design()}})}(jQuery),function($){Frames.Text=$.inherit(Frames.Item,{widgetcls:function(){return"xtext"},init:function(e){this.templateTagRegex=new RegExp(/\{(.*?)\}/gi),this.bindables={},this.originalValue="",this._id=this.elem.attr("id"),Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this);var t=this.value();Frames.isEmpty(t)||this.haveTemplating(t)&&(t=this.applyTemplating(this,t),this.value(t))},destroy:function(){Frames.Application.off("endbind."+this._id,this._endbind),Frames.Item.prototype.destroy.apply(this),delete this.view,this._call("wrapper",null),delete this.elem},model:function(){var e;if(0===arguments.length)return(e=this._call("value"))!=this._last?Frames.Model.createItem(this.member,e):null;var t=arguments[0];if(t){var i=t.record;if(i){var a=this.block.index();(Frames.isUndef(a)||-1==a||a>i.length-1)&&(a=0);var s=Frames.find(i[a],"item",this.member);e=s?Frames.Model.text(s[0]):"",this._call("value",e),this._last=e}}},label:function(){if(!(0<arguments.length))return this._call("label");this._call("label",arguments[0])},labelObj:function(){return this._call("labelObj")},haveTemplating:function(e){var t=!1;return e&&0<e.length&&(t=new RegExp(this.templateTagRegex).test(e)),t},applyTemplating:function(e,t){if(t&&this.haveTemplating(t)){var i="",a="",s="",r=null,n=[];this.originalValue=t,Frames.Application.on("endbind."+this._id,this._endbind.bind(this));var o=[];if(t&&0<t.length){o=t.match(this.templateTagRegex);for(var l="",d=0;d<o.length;d++)if(2==(n=(l=o[d]).split(".")).length){i=n[0].replace("{",""),a=n[1].replace("}","");this.bindables[l]=new Frames.BindableItem(i,a),this.bindables[l]&&(r=this.bindables[l],s=Frames.Format.formatFromCanonical(r.value(),r.props("format"),r.props("type")),t=t.replace(l,s))}}}return t},_endbind:function(){var e=null,t=this.originalValue;for(var i in this.bindables)(e=this.bindables[i]).value()&&(itemFormatValue=Frames.Format.formatFromCanonical(e.value(),e.props("format"),e.props("type")),t=t.replace(i,itemFormatValue),this.value(t))},value:function(){if(!(0<arguments.length))return this._call("value");this.design()||this._call("value",arguments[0])},focus:function(){this._call("focus")},_computeLabelPosition:$.noop,_label_position:$.noop}),Frames.regtype("text",Frames.Text)}(jQuery),function($){$.widget("ui.xtext",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-text ui-widget");var e=$("span",this.element);this._inp=0<e.length?e:this.element,this._lbl=0<e.length?e:this.element},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-text ui-widget"),this._inp=null,delete this._inp},wrapper:function(e){this.element.data("frames",e)},value:function(){return this._inp.text.apply(this._inp,arguments)},label:function(){return this._lbl.text.apply(this._inp,arguments)},labelObj:function(){return this._lbl},focus:function(){}})}(jQuery),function($){Frames.TextLink=$.inherit(Frames.Item,{init:function(e){Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this)},value:function(){if(!(0<arguments.length))return this._call("value");this.design()||this._call("value",arguments[0])},input:function(){return this._call("input")},labelObj:function(){return this._call("labelObj")},clickable:function(){return!0},destroy:function(){Frames.Item.prototype.destroy.apply(this),delete this.view,delete this.elem}}),Frames.regtype("textlink",Frames.TextLink)}(jQuery),function($){$.widget("ui.textlink",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-textlink ui-widget"),this.element.bind("action",$.proxy(this._clickHandler,this)),this._inp=$("a",this.element),this._inp.click($.proxy(this._disableClickHandler,this)),this._defValue=this._inp.text(),this._lbl=$("label",this.element),this._inp.addClass("ui-widget-content ui-corner-all"),this.checkid()},checkid:function(){$.ui.textinput.prototype.checkid.apply(this,arguments)},_disableClickHandler:function(){var e=this.input().data("frames");return e&&Frames.isUndef(e.member)&&this._clickHandler(),Frames.isTrue(Frames.inDesignMode)},_clickHandler:function(e){return!1!==this._inp.data("editable")&&Frames.Application.elemexec(this.element),!1},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-textlink ui-widget"),this._inp.removeClass("ui-widget-content ui-corner-all"),this._inp.data("frames",null),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this.input().data("frames",e)},value:function(){if(!(0<arguments.length))return this.input().text();var e=arguments[0];Frames.isEmpty(e)&&!Frames.isEmpty(this._defValue)&&(e=this._defValue),this.input().text(e)},input:function(){return this._inp},labelObj:function(){return this._lbl},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},focus:function(){this._call("focus")},design:function(){return this.input().data("frames").design()}})}(jQuery),function($){Frames.Button=$.inherit(Frames.Item,{widgetcls:function(){return"xbutton"},init:function(e){this.view=e,this.defaults(),this.autoregister(),this._parseLabelText(),this.updateshortcut()},_initUserEvents:$.noop,destroy:function(){this.autounregister(),delete this.view,this._call("wrapper",null),delete this.elem},rules:function(){return null},props:function(){if(Frames.isUndef(this._props)&&(this._props={},this.props("Valid","true"),this.props("ValidationEnabled","false"),this.props("Navigable","true")),2==arguments.length){var e=arguments[0].replace("@",""),t=arguments[1];if(!Frames.isUndef(t)&&"object"==typeof t||"function"==typeof t)return;if("ValidationEnabled"==e)return}return Frames.Item.prototype.props.apply(this,arguments)},model:function(){return null},input:function(){return this._call("input")},validable:function(){},buttonObj:function(){return this._call("buttonObj")},labelObj:function(){return this._call("labelObj")},label:function(){if(!(0<arguments.length))return this._call("label");this._call("label",arguments[0]),this._updateshortcut(this.elem,arguments[0])},icon:function(){if(!(0<arguments.length))return this._call("icon");this._call("icon",arguments[0])},value:function(){if(!(0<arguments.length))return this._call("value");this._call("value",arguments[0])},focus:function(){this._call("focus")},clickable:function(){return!0},enterHasTab:function(){return!1},_computeLabelPosition:$.noop,_label_position:$.noop,_applyDirection:function(){if(this.elem.removeAttr("dir"),this.elem.hasClass("frames-direction-fixed")){var e=this._call("labelObj");Frames.Item.prototype._applyDirection.apply(this,[e])}},editable:function(){if(!(0<arguments.length))return!1},enabled:function(){if(!(0<arguments.length))return Frames.Item.prototype.enabled.apply(this);Frames.Item.prototype.enabled.apply(this,arguments);var e=this.elem,t=Frames.isTrue(arguments[0]);this.buttonObj().options.disabled=!t,t?e.removeClass("ui-state-disabled"):e.addClass("ui-state-disabled")},default:function(){if(!(0<arguments.length))return Frames.isTrue(this.elem.data("default"));var e=Frames.isTrue(arguments[0]);this.view=Frames.Application.task.view,e&&!Frames.isUndef(this.view)&&(this.view._defaultButton=this)},api_mouse_target:function(e){return this.elem}}),Frames.Item.PROP_MAP.Icon={method:"icon"},Frames.Item.PROP_MAP.default={method:"default"},Frames.regtype("button",Frames.Button)}(jQuery),function($){$.widget("ui.xbutton",{version:"@VERSION",options:{},_create:function(){var e=this.element.text(),t=this.element.data("icon"),i=this._parseIcon(t);this.element.bootstrapBtn().bind("action",$.proxy(this._clickHandler,this)).click($.proxy(this._disableClickHandler,this)).addClass("btn btn-default ui-state-default"),this._bsBtn=this.element.data("bs.button"),this._lbl=$(),Frames.isEmpty(e)||(this._lbl=this.element.bootstrapBtn().wrapInner("<span />").find("span")),this._fixLabel(e),this._fixIcon(t,i)},_parseIcon:function(e){return!e||-1===e.indexOf(".")&&-1===e.indexOf("/")?e:"ui-icon-image"},_fixIcon:function(e,t){var i=this.element.find(".ui-icon");if(this.element.bootstrapBtn().removeClass("ui-button-icon-only ui-button-text-only"),Frames.isEmpty(t))return Frames.isEmpty(this.label())||this.element.bootstrapBtn().addClass("ui-button-text-only"),this.buttonObj().options.icon=void 0,void i.remove();0===i.length?i=$('<span class="ui-icon"></span>').prependTo(this.element):i.removeClass(this.buttonObj().options.icon),this.buttonObj().options.icon=t,i.addClass(t),Frames.isEmpty(this.label())&&this.element.bootstrapBtn().addClass("ui-button-icon-only"),i.css("background-image",""),"ui-icon-image"===t&&(e=$.ui.image.prototype.url(e),i.css("background-image","url("+e+")"))},_disableClickHandler:function(){var e=this.element.data("frames");return e&&Frames.isUndef(e.member)&&this._clickHandler(),Frames.isTrue(Frames.inDesignMode)},_clickHandler:function(){return Frames.Application.elemexec(this.element),!1},destroy:function(){$.Widget.prototype.destroy.call(this),delete this._lbl},wrapper:function(e){this.element.data("frames",e)},input:function(){return this.element},value:function(){return null},label:function(){var e=this.labelObj();if(!(0<arguments.length))return e.text();var t=arguments[0];this._fixLabel(t)},_fixLabel:function(e){if(this.element.bootstrapBtn().removeClass("ui-button-icon-only ui-button-text-only"),Frames.isEmpty(e))return Frames.isEmpty(this.icon())||this.element.bootstrapBtn().addClass("ui-button-icon-only"),this.buttonObj().options.showLabel=!1,this._lbl.remove(),void(this._lbl=$());0===this._lbl.length&&(this._lbl=$("<span></span>").appendTo(this.element)),this.buttonObj().options.showLabel=!0,this._lbl.text(e),Frames.isEmpty(this.icon())&&this.element.bootstrapBtn().addClass("ui-button-text-only")},icon:function(){if(!(0<arguments.length))return this.buttonObj().options.icon;var e=arguments[0],t=this._parseIcon(e);this._fixIcon(e,t)},labelObj:function(){return this._lbl},buttonObj:function(){return this._bsBtn},focus:function(){this.element.focus()}}),Frames.Application.on("ready",function(){if($.fn.button.noConflict){var e=$.fn.button.noConflict();$.fn.bootstrapBtn=e}})}(jQuery),function($){Frames.ButtonGroup=$.inherit(Frames.Item,{widgetcls:function(){return"buttongroup"}}),Frames.regtype("buttongroup",Frames.ButtonGroup)}(jQuery),function($){$.widget("ui.buttongroup",{version:"@VERSION",options:{},_create:function(){this.element.addClass("btn-group"),this._dropdownBtn=this.element.find(".ui-button-dropdown > button"),Frames.isEmpty(this._dropdownBtn.text())&&this._dropdownBtn.addClass("btn-icon-only"),this._drawMenu()},_drawMenu:function(){var r=this;this.element.find("LI").each(function(e){var t=$(this),i=t.data("type"),a=t.data("icon");if("separator"!==i){if("check"===i&&(t.addClass("check"),a=a||"fa fa-check"),!Frames.isUndef(a)){var s=$.ui.xbutton.prototype._parseIcon.apply(r,[a]);t.children().prepend('<span class="'+("ui-icon-image"===s?"ui-icon ":"")+s+'"/>')}}else t.addClass("divider")})},wrapper:function(e){this.element.data("frames",e)}})}(jQuery),function($){Frames.ButtonDropDown=$.inherit(Frames.Item,{widgetcls:function(){return"buttondropdown"}}),Frames.regtype("buttondropdown",Frames.ButtonDropDown)}(jQuery),function($){$.widget("ui.buttondropdown",{version:"@VERSION",options:{},_create:function(){var i=this,e=this.element,t=e.find("button");this.btn=t;var a=this.menu=e.children("ul");e.addClass("btn-group"),a.addClass("dropdown-menu menu-button"),$('<span class="caret"/>').appendTo(t),this._container=$(".ui-window-container"),this._container.append(a.detach()),t.addClass("btn btn-default dropdown-toggle ui-state-default").attr("data-toggle","dropdown").attr("aria-haspopup",!0).attr("aria-expanded",!1).on("click",function(e){var t=$(e.target).closest(".ui-button-dropdown");i.toggle(t,i.menu)}),this._closehandler=function(e,t){i.hideMenu(e,t,!0)},this._cancelPopupsHandler=function(e,t){i.hideMenu(e,t)},Frames.Application.on("cancelpopups",this._cancelPopupsHandler),this._container.on("resize",this._closehandler),document.addEventListener("scroll",this._closehandler,!0),a.find("LI:not(.disabled) A").on("click",function(){var e=$(this).data("action"),t=$(this).parent().parent(),i=t.attr("name")||t.attr("id");Frames.Menu.execute(e,i)})},toggle:function(e,t){if(e.hasClass("open"))e.removeClass("open"),t.removeClass("show"),t.hide();else{t.addClass("show"),e.addClass("open");var i=e.find("button"),a=i.outerHeight(),s=i.outerWidth(),r=t.outerWidth(),n=t.outerHeight(),o=i.offset().top;n<o?t.css("top",o-n):t.css("top",o+a);var l=i.offset().left;Frames.Application.getContainer(i).outerWidth()-l-s<r?t.css("left",l-r+s):t.css("left",l)}},hideMenu:function(e,t,i){if(this.menu.hasClass("show")){if(!Frames.isTrue(i)&&!Frames.isUndef(t)&&!Frames.isUndef(t.event)){var a=$(t.event.target);if(a.is(this.btn)||0<this.btn.find(a).length||0<this.menu.find(a).length&&a.is("a")&&a.next().hasClass("dropdown-menu"))return}$(this.menu).removeClass("show"),$(this.menu).hide(),$(this.element).removeClass("open")}},wrapper:function(e){this.element.data("frames",e)},destroy:function(){this.menu.find("LI:not(.disabled) A").off("click"),this._container.off("resize",this._closehandler),document.removeEventListener("scroll",this._closehandler,!0),Frames.Application.off("cancelpopups",this._cancelPopupsHandler)}})}(jQuery),function($){Frames.ButtonInput=$.inherit(Frames.TextInput,{fixRtl:function(e){Frames.TextInput.prototype.fixRtl.apply(this,[e]),"rtl"===this.elem.css("direction")&&(this.input().removeClass("ui-corner-left").addClass("ui-corner-right"),"function"==typeof this.buttonObj&&this.buttonObj()&&this.buttonObj().removeClass("ui-corner-right").addClass("ui-corner-left"))},init:function(){Frames.TextInput.prototype.init.apply(this,arguments),this.updateshortcut()},updateshortcut:function(e){var t=this.buttonObj().text(),i=Frames.isEmpty(t)?void 0:t;this._updateshortcut(this.elem,i)},buttonObj:function(){return this._call("buttonObj")},_computeLabelPosition:function(e){if(Frames.TextInput.prototype._computeLabelPosition.apply(this),!this.input().is(":visible")){var t=this.elem.closest("[data-class$=canvas]");if(t[0]){var i=this.view._CANVAS_.get(t.data("name"));if(i){var a=this;return void $(i).one("aftershow",function(e){a._call("refresh")})}}}Frames.isTrue(e)&&this._call("refresh")},css:function(){if(!("width"===arguments[0]&&1<arguments.length))return Frames.TextInput.prototype.css.apply(this,arguments);this._call("changeWidth",arguments[1])},enabled:function(){if(!(0<arguments.length))return Frames.Item.prototype.enabled.apply(this);Frames.Item.prototype.enabled.apply(this,arguments);var e=this.buttonObj();if(e){var t=Frames.isTrue(arguments[0])&&this.editable();e.button("option","disabled",!t)}},editable:function(){if(!(0<arguments.length))return Frames.Item.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.buttonObj();if(e){var t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)}},erroranchor:function(){return this._call("showButton")?this.buttonObj():this.input()},clickable:function(){var e=this.buttonObj();return e&&document.activeElement==e[0]},processNavigationKey:function(e){if("all"===Frames.Config.get("NAVIGATION_MODE","default")&&("TAB"===e||"SHIFT+TAB"===e)){var t=this.input(),i=this.buttonObj();if(!(Frames.isVisible(i)&&!1===i[0].disabled))return!1;if("TAB"===e&&document.activeElement===t[0])return i.focus(),!0;if("SHIFT+TAB"===e&&document.activeElement===i[0])return this.input().focus(),!0}return!1}})}(jQuery),function($){$.widget("ui.buttoninput",{version:"@VERSION",options:{button:!0,action:"BUTTON_PRESSED",icon:"fa fa-ellipsis-h"},_createInput:function(){return $("input",this.element)},_createButton:function(){return $('<button type="button">&nbsp;</button>').insertAfter(this._buttonAnchor())},_createLabel:function(){return $("label",this.element)},_create:function(){this.element.addClass("ui-buttoninput ui-widget");var e=this._inp=this._createInput();this._lbl=this._createLabel();var t=this._buttonAnchor();this._inp.attr("autocomplete","false"),this._configure(e,t);var i=this.element.data("action");Frames.isUndef(i)&&this.element.data("action",this.options.action),this.refresh(),this.fixpositions()},fixpositions:function(){$.ui.textinput.prototype.fixpositions.apply(this,arguments)},_buttonAnchor:function(){return this._inp},_defaultId:function(){return"#"+Frames.uuid()},_configure:function(e,t){e.addClass("ui-widget-content ui-buttoninput").attr("autocomplete","off");var i=t.attr("id");if(Frames.isUndef(i)&&t.attr("id",this._defaultId()),this._lbl.attr("for",t.attr("id")),this.showButton()){this._inp.removeClass("ui-corner-all").addClass("ui-corner-left");var a=this.element.attr("data-icon"),s=Frames.isUndef(a)?this.options.icon:a;Frames.isUndef(this._button)&&(this._button=this._createButton().attr("tabIndex",-1).button({icon:s,text:!1}).attr("title",null).removeClass("ui-corner-all").addClass("ui-buttoninput ui-corner-right ui-button-icon").css("vertical-align","top")),Frames.isTrue(this.options.grid)&&this._button.removeClass("ui-buttoninput")}else this._button=$([]);this._configureEvents()},_configureEvents:function(){var s=this;this.showButton()&&this._button.on("mousedown",function(e){var t=(new Date).getTime(),i=s._lastt&&t-s._lastt<800;if(s._lastt=(new Date).getTime(),!i){if(document.activeElement!==s._inp[0]&&s._inp.focus(),Frames.Application.executing()){this.__cancelClick=!0;var a=this;return $(Frames).one("waitend",function(){document.activeElement===s._inp[0]&&Frames.later(function(){$(a).triggerHandler("click")})}),void e.preventDefault()}return document.activeElement!==s._inp[0]?(this.__cancelClick=!0,void e.preventDefault()):void 0}}).on("click",function(e,t){if(!0===this.__cancelClick)return delete this.__cancelClick,void e.preventDefault();s.execclick.apply(s)}),this.element.bind("action",$.proxy(this.execaction,this))},changeWidth:function(e){this._inp.css("width",e),this._size=void 0,this.refresh()},execaction:function(){Frames.Application.elemexec_format(this.element)},execclick:function(){this._inp.trigger(Frames.isTrue(this.options.grid)?"action":"btnclick")},showButton:function(){var e=this.element.data("button");return this.options.button&&(Frames.isUndef(e)||"hide"!=e)},refresh:function(e){if(this.showButton()){var t=this._inp.is(":visible")&&(0<this._inp.width()||0<this._inp.height());if(e||t){var i=this._buttonAnchor(),a=i.outerWidth(),s=i.outerHeight();Frames.isUndef(this._size)&&(this._size=i.outerHeight(),a=i.outerWidth()-this._size,s=this._size);var r={};this.options.grid?r.right=0:r.left="",this._button.css({width:this._size,height:Frames.isTrue(this.options.grid)?this.element.parent().outerHeight()-2:s}),Frames.isTrue(this.options.grid)&&this._button.css(r),this._inp.css("width",a)}}},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-buttoninput ui-widget"),this.element.find("button").remove(),this._inp.removeClass("ui-widget-content ui-corner-left"),this._inp.data("frames",null),this._inp.remove(),this._lbl.remove(),this._button.remove(),this._inp=null,this._lbl=null,this._button=null,delete this._inp,delete this._lbl,delete this._button},wrapper:function(e){this._inp.data("frames",e)},input:function(){return this._inp},labelObj:function(){return this._lbl},buttonObj:function(){return this._button},value:function(){return this._inp.val.apply(this._inp,arguments)},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},icon:function(){if(!(0<arguments.length))return this._button.button("option","icon");this._button.button("option","icon",arguments[0])},focus:function(){this.design()||("ie"==$.browsercss()[0]?(this._inp.get(0).focus(),this._inp.get(0).select()):(this._inp.focus(),this._inp.select()))},design:function(){return this._inp.data("frames").design()}})}(jQuery),function($){Frames.DateField=$.inherit(Frames.ButtonInput,{defaults:function(){Frames.TextInput.prototype.defaults.apply(this),Frames.isUndef(this.elem.data("type"))&&this.props("type","Date");var e=this.props("format");Frames.isUndef(e)?(this.props("format",Frames.Locale.formats.DATE_FORMAT),this.props("formatDefault",!0)):(this.props("format",e),this.props("formatDefault",!1))},props:function(){if(!(1<arguments.length)||"maxlength"!==arguments[0]&&"@MaxLength"!==arguments[0])return Frames.TextInput.prototype.props.apply(this,arguments)},format:function(){if(0===arguments.length)return Frames.Item.prototype.format.apply(this,arguments);this._call("format",arguments[0]),Frames.Item.prototype.format.apply(this,arguments)},showdialog:function(){this._call("showdialog")},hidedialog:function(){this._call("hidedialog")},hidedialog:function(){this._call("hidedialog")},isdialogvisible:function(){return this._call("isdialogvisible")},processNavigationKey:Frames.ButtonInput.prototype.processNavigationKey,clickable:function(){return!1}},{openInDialog:function(e){var t=Frames.MultiDateField.convertToWidgetFormats(Frames.Locale.formats.DATE_FORMAT).dateFormat;t=t.replace("yyyy","yy"),$('<div id="widget-dialog" title="Calendar" />').dialog({modal:!0,resizable:!1,autoResize:!0,width:"auto",close:function(){Frames.DateField._onWidgetClose()}}).datepicker({defaultDate:e,dateFormat:t,changeMonth:!0,changeYear:!0,onSelect:function(){Frames.DateField._onWidgetClose()}})},_onWidgetClose:function(){var e=$("#widget-dialog").datepicker().val(),t=$("#widget-dialog").datepicker("option","dateFormat"),i=Frames.Format.formatToCanonical(e,t,"Date");Frames.Application.execute({name:"WIDGET_CLOSE",params:[{name:"value",value:i,type:"String"}]})}}),Frames.regtype("datefield",Frames.DateField)}(jQuery),function($){$.widget("ui.datefield",$.ui.buttoninput,{_create:function(){this.element.addClass("ui-datefield"),$.ui.buttoninput.prototype._create.apply(this)},_configure:function(e,t){var i=this.element.data("format");!Frames.isUndef(i)&&Frames.Format.isValidFormat(i,"Date")||(i=Frames.Locale.formats.DATE_FORMAT||"dd/mm/yy"),this._datetrigger=$('<input class="ui-datefield-trigger"/>').prependTo(this.element).datepicker({dateFormat:this._convertFormat(i),changeMonth:!0,changeYear:!0,onSelect:$.proxy(this._onSelect,this),constrainInput:!1,nextText:"",prevText:""}),$.ui.buttoninput.prototype._configure.apply(this,[e,t]),this._button.addClass("ui-state-default")},_configureEvents:function(){var i=this;$.ui.buttoninput.prototype._configureEvents.apply(this),this.element.keydown(function(e){e.which!==$.ui.keyCode.DOWN&&e.which!==$.ui.keyCode.UP||!e.altKey||i._button.triggerHandler("click")}),this._closedialog=function(){var e=arguments[0];1<arguments.length&&(e=arguments[1].event);var t=Frames.isEmpty(e)?$():$(e.target).closest("[id=ui-datepicker-div]");Frames.isUndef(t[0])&&i.isdialogvisible()&&i.hidedialog()},Frames.Application.on("cancelpopups",this._closedialog)},_defaultId:function(){return this.element.attr("id")+(new Date).getTime()},destroy:function(){this.element.removeClass("ui-datefield"),this._datetrigger.removeClass("ui-datepicker-trigger"),this._datetrigger.datepicker("destroy"),this._datetrigger.remove(),this._datetrigger=null,Frames.Application.off("cancelpopups",this._closedialog),$.ui.buttoninput.prototype.destroy.apply(this)},_convertFormat:function(e){return Frames.isUndef(e)||(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.toUpperCase()).replace(/Y/g,"y")).replace(/R/g,"y")).replace(/D/g,"d")).replace(/([^D]|^)DY/gi,function(e,t){return t+"D"})).replace(/DAY/gi,"DD")).replace(/M/gi,"m")).replace(/MONTH/gi,"MM")).replace(/MON/gi,"M")).replace(/HH24/gi,"")).replace(/HH/gi,"")).replace(/J/gi,"")).replace(/N/gi,"")).replace(/MI/gi,"")).replace(/S/gi,"")).replace(/AM/gi,"")).replace(/PM/gi,"")).replace(/:/g,"")).replace(/ /g,"")).replace(/yy/gi,"y")),e},format:function(e){var t=this._inp.data("datepicker");!Frames.isUndef(e)&&t&&(this._datetrigger.data().datepicker.settings.dateFormat=this._convertFormat(e))},execaction:function(){this.isdialogvisible()?this.hidedialog():this.showdialog()},showdialog:function(){this._datetrigger.datepicker("show")},hidedialog:function(){this._datetrigger.datepicker("hide")},isdialogvisible:function(){return this._datetrigger.datepicker("widget").is(":visible")},_onSelect:function(e,t){var i=Frames.isTrue(this.options.grid);if(!i||this._inp.parent().datepicker("widget").is(":visible")){var a=new Frames.FormatDate,s=this._inp.data("frames");if(Frames.isUndef(s)&&i&&(s=this._inp.parent().data("frames")),!Frames.isUndef(s)){var r=new Date(t.selectedYear,t.selectedMonth,t.selectedDay),n=s.props("format");if(-1!=n.toLowerCase().indexOf("h")||-1===n.toLowerCase().indexOf("dd")){var o=new Date;-1!=n.toLowerCase().indexOf("h")&&(r.setHours(o.getHours()),r.setMinutes(o.getMinutes()),r.setSeconds(o.getSeconds())),-1===n.toLowerCase().indexOf("dd")&&r.setDate(1),e=a.format(r,n)}s.value(e),s.ovalue(r),i&&s.input().val(e),Frames.Validation.reset(s),this.focus(),s.input().change(),this.selectedHandler(e)}}},selectedHandler:function(e){Frames.Log.debug("datefield:selectedHandler %s",e),Frames.Log.debug("datefield:selectedHandler _inp.val() =%s",this._inp.val()),Frames.Application.elemexec(this.element)}}),$.datepicker.showDatepicker=$.datepicker._showDatepicker,$.datepicker._showDatepicker=function(e){if(this._inst=e,!$.expr.filters.hidden(e))return $.datepicker.showDatepicker(e)},$.datepicker._parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(e,t,i){if(-1===e.toLowerCase().indexOf("dd")&&!Frames.isEmpty(t)){var a=this._inst,s=$(a).val();if(!Frames.isEmpty(s)&&!this._datepickerShowing)return Frames.Format.toValue(s,e,"Date")}return $.datepicker._parseDate(e,t,i)},$.datepicker.updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(e){$.datepicker.updateDatepicker(e),e.dpDiv.find(".ui-datepicker-prev > span").removeClass("ui-icon-circle-triangle-w").addClass("fa fa-chevron-circle-left"),e.dpDiv.find(".ui-datepicker-next > span").removeClass("ui-icon-circle-triangle-e").addClass("fa fa-chevron-circle-right")},$.ui.datefield.prototype.options=$.extend({},$.ui.buttoninput.prototype.options,{grid:!1,icon:"fa fa-calendar",action:null})}(jQuery),function($){Frames.Calculator=$.inherit(Frames.TextInput,{defaults:function(){Frames.TextInput.prototype.defaults.apply(this),Frames.isUndef(this.elem.data("type"))&&this.props("type","Number")},widgetcls:function(){return"xcalculator"},buttonObj:function(){return this._call("buttonObj")},fixRtl:function(e){Frames.ButtonInput.prototype.fixRtl.apply(this,[e])},_computeLabelPosition:function(e){if(Frames.TextInput.prototype._computeLabelPosition.apply(this),!this.input().is(":visible")){var t=this.elem.closest("[data-class$=canvas]");if(t[0]){var i=this.view._CANVAS_.get(t.data("name"));if(i){var a=this;return void $(i).one("aftershow",function(e){a._call("refresh")})}}}Frames.isTrue(e)&&this._call("refresh")},enabled:function(){if(!(0<arguments.length))return Frames.Item.prototype.enabled.apply(this);Frames.Item.prototype.enabled.apply(this,arguments);var e=this.buttonObj();if(e){var t=Frames.isTrue(arguments[0])&&this.editable();e.button("option","disabled",!t)}},editable:function(){if(!(0<arguments.length))return Frames.Item.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.buttonObj(),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},clickable:function(){return!0},format:function(){if(0===arguments.length)return Frames.Item.prototype.format.apply(this,arguments);this._call("format",arguments[0]),Frames.Item.prototype.format.apply(this,arguments)},erroranchor:function(){return this.buttonObj()},showdialog:function(){this._call("showdialog")}},{isModalOpen:function(){var e=$("#widget-dialog.ui-calculator");return e.is(":visible")&&e.hasClass("widget-inline")},widgetinput:function(){return $("#widget-dialog > .calculator-keyentry")},openInDialog:function(e){var t=$('<div id="widget-dialog" title="Calculator" style="width:200px"/>');t.appendTo("body"),e=parseFloat(e),t.xcalculator({value:e,button:!1,inline:!0,onSelect:function(e,t){t.__lastButton&&t.__lastButton===t.options.closeText&&(e=void 0,delete t.__lastButton),Frames.Calculator._onWidgetClose(e)}});var i=$(window).height()/2-t.height()/2+"px",a=$(window).width()/2-t.width()/2+"px";t.modal({keyboard:!1});var s={top:i,zIndex:$(".modal-backdrop").css("zIndex")+1};Frames.Locale.formats.IS_RTL?s.right=a:s.left=a,t.css(s),t.addClass("widget-inline"),t.bind("hide",function(){Frames.Calculator._onWidgetClose()}),Frames.Calculator.widgetinput().focus()},_onWidgetClose:function(e){var t;t=Frames.isUndef(e)?{name:"WIDGET_CANCEL"}:{name:"WIDGET_OK",params:[{name:"value",value:e=Frames.Format.formatToCanonical(e,Frames.Locale.formats.NUMBER_FORMAT,"Number"),type:"String"}]},Frames.Application.execute(t,null,null,null,null,!1),$(".modal-backdrop").remove(),$("#widget-dialog").remove()}}),Frames.regtype("calculator",Frames.Calculator)}(jQuery),function($){$.widget("ui.xcalculator",{version:"@VERSION",options:{button:!0,grid:!1,calcType:"standard",layoutStandard:["  BSCECA","_7_8_9_+@X","_4_5_6_-@U","_1_2_3_*@E","_0_._=_/"],showFormula:!1,maxDigits:12,inline:!1,onSelect:void 0,value:void 0},_create:function(){Frames._Calculator.init(),this.element.addClass("ui-widget ui-calculator");var e=this.options.onSelect?this.options.onSelect:$.proxy(this._onSelect,this),t={showOn:"button",useThemeRoller:!0,layout:"standard"===this.options.calcType?this.options.layoutStandard:$.calculator[this.options.calcType+"Layout"],showFormula:this.options.showFormula,prompt:"",showAnim:"",onOpen:$.proxy(this._onOpen,this),onClose:e,onButton:$.proxy(this._onButton,this),onErase:$.proxy(this._onErase,this),onAdd:$.proxy(this._onAdd,this),onSubtract:$.proxy(this._onSubtract,this),onMultiply:$.proxy(this._onMultiply,this),onDivide:$.proxy(this._onDivide,this),constrainInput:!1},i=$.calculator.regionalOptions[Frames.Locale.lang]||$.calculator.regionalOptions[""];i.decimalChar=Frames.Locale.formats.DECIMAL_SEPARATOR,this.options.inline?(this.options.value&&(t.value=this.options.value),t.showOn="focus",this.element.calculator(t),this.element.calculator("option",i)):(this._lbl=$("label",this.element),this._inp=$("input",this.element),Frames.Locale.formats.IS_RTL&&this._inp.attr("dir","ltr"),this._inp.attr("id",this.element.attr("id")+(new Date).getTime()),this._lbl.attr("for",this._inp.attr("id")),this._inp.addClass("ui-widget-content"),this._inp.calculator(t),this._inp.calculator("option",i),this.button=this.element.find("button"),this.showButton()?(this._inp.removeClass("ui-corner-all").addClass("ui-corner-left"),this.button.attr("tabIndex",-1).button({icon:"fa fa-calculator",text:!1,classes:{"ui-button":"ui-state-default"}}).attr("title",null).removeClass("ui-corner-all").addClass("ui-corner-right ui-button-icon"),this.button.on("dblclick",function(e){e.preventDefault(),e.stopImmediatePropagation()})):this.button.hide()),this.refresh()},showButton:function(){var e=this.element.data("button");return this.options.button&&(Frames.isUndef(e)||"hide"!=e)},refresh:function(e){if(this.showButton()&&(e||this._inp.is(":visible"))){var t=this._inp.outerWidth(),i=this._inp.outerHeight();Frames.isUndef(this._size)&&(this._size=this._inp.outerHeight(),t=this._inp.outerWidth()-this._size,i=this._size);var a={};this.options.grid?a.right=0:a.left="",this.button.css({width:this._size,height:Frames.isTrue(this.options.grid)?this.element.parent().outerHeight()-2:i}),this.button.css(a),this._inp.css("width",t)}},_destroy:function(){this.element.removeClass("ui-calculator ui-widget"),this._inp.datepicker("destroy"),this._inp.removeClass("ui-widget-content ui-corner-left"),this._inp.data("frames",null),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this._inp.data("frames",e)},input:function(){return Frames.Calculator.isModalOpen()?Frames.Calculator.widgetinput():this._inp},value:function(){return this._inp.val.apply(this._inp,arguments)},format:$.noop,label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},labelObj:function(){return this._lbl},buttonObj:function(){return this.button},focus:function(){this.design()||Frames.Calculator.isModalOpen()||(this._inp.focus(),this._inp.select())},design:function(){var e=this._inp.data("frames");return e?e.design():Frames.inDesignMode},showdialog:function(){this._inp.calculator("show")},hidedialog:function(){this._inp.calculator("hide")},_onOpen:function(e,t){this._useButtonTyped=!1;var i=Frames.isTrue(this.options.grid),a=Frames.Format.unformat(e,"","Number"),s=this._inp.data("frames");Frames.isUndef(s)&&i&&(s=this._inp.parent().data("frames")),Frames.isUndef(s)||(t._mainDiv.css({zIndex:this._inp.closest(".ui-dialog").css("z-index")||Frames.Application.task.view.getCanvasCount()+1}),t._input.val(a))},_onSelect:function(e,t){var i=Frames.isTrue(this.options.grid),a=this._inp.data("frames");if(Frames.isUndef(a)&&i&&(a=this._inp.parent().data("frames")),!Frames.isUndef(a)){var s=a.props("format")||Frames.Locale.formats.NUMBER_FORMAT,r=Frames.Format.format(e,s,"Number");a.value(r),i&&a.input().val(r),this._useButtonTyped&&this.selectedHandler(e)}},_onButton:function(e,t,i){if(t.length>this.options.maxDigits){var a=t.slice(0,-1);i._formula=a,i.dispValue=a}(i.__lastButton=e)==i.options.useText&&(this._useButtonTyped=!0)},_onErase:function(e,t){$.calculator._reset(e,0),$.calculator._updateCalculator(e)},_onAdd:function(e){e.curValue=new Big(e.prevValue).add(e.curValue).toFixed()},_onSubtract:function(e){e.curValue=new Big(e.prevValue).sub(e.curValue).toFixed()},_onMultiply:function(e){e.curValue=new Big(e.prevValue).mul(e.curValue).toFixed()},_onDivide:function(e){e.curValue=new Big(e.prevValue).div(e.curValue).toFixed()},selectedHandler:function(e){Frames.Log.debug("calculator:selectedHandler %s",e),Frames.Log.debug("calculator:selectedHandler _inp.val() =%s",this._inp.val()),Frames.Application.elemexec(this.element)},processNavigationKey:function(e){if("all"===Frames.Config.get("NAVIGATION_MODE","default")&&("TAB"===e||"SHIFT+TAB"===e)){var t=this.input(),i=this.buttonObj();if("TAB"===e&&document.activeElement===t[0])return i.focus(),!0;if("SHIFT+TAB"===e&&document.activeElement===i[0])return this.input().focus(),!0}return!1}})}(jQuery),function($){var e="calculator",t=["  BSCECA","_1_2_3_+@X","_4_5_6_-@U","_7_8_9_*@E","_0_._=_/"];$.JQPlugin.createPlugin({name:e,defaultOptions:{showOn:"focus",buttonImage:"",buttonImageOnly:!1,isOperator:null,showAnim:"show",showOptions:{},duration:"normal",appendText:"",useThemeRoller:!1,calculatorClass:"",showFormula:!1,prompt:"",layout:t,value:0,base:10,precision:10,memoryAsCookie:!1,cookieName:"calculatorMemory",cookieExpires:86400,cookiePath:"",useDegrees:!1,constrainInput:!0,onOpen:null,onButton:null,onClose:null,onErase:null},regionalOptions:{"":{decimalChar:".",buttonText:"...",buttonStatus:"Open the calculator",closeText:"Close",closeStatus:"Close the calculator",useText:"Use",useStatus:"Use the current value",eraseText:"Erase",eraseStatus:"Erase the value from the field",backspaceText:"BS",backspaceStatus:"Erase the last digit",clearErrorText:"CE",clearErrorStatus:"Erase the last number",clearText:"CA",clearStatus:"Reset the calculator",memClearText:"MC",memClearStatus:"Clear the memory",memRecallText:"MR",memRecallStatus:"Recall the value from memory",memStoreText:"MS",memStoreStatus:"Store the value in memory",memAddText:"M+",memAddStatus:"Add to memory",memSubtractText:"M-",memSubtractStatus:"Subtract from memory",base2Text:"Bin",base2Status:"Switch to binary",base8Text:"Oct",base8Status:"Switch to octal",base10Text:"Dec",base10Status:"Switch to decimal",base16Text:"Hex",base16Status:"Switch to hexadecimal",degreesText:"Deg",degreesStatus:"Switch to degrees",radiansText:"Rad",radiansStatus:"Switch to radians",isRTL:!1}},_getters:["isDisabled"],_curInst:null,_disabledFields:[],_showingCalculator:!1,_showingKeystrokes:!1,_keyDefs:{},digit:"d",binary:"b",unary:"u",control:"c",space:"s",_mainDivClass:e+"-popup",_inlineClass:e+"-inline",_appendClass:e+"-append",_triggerClass:e+"-trigger",_disableClass:e+"-disabled",_inlineEntryClass:e+"-keyentry",_promptClass:e+"-prompt",_formulaClass:e+"-formula",_resultClass:e+"-result",_focussedClass:e+"-focussed",_keystrokeClass:e+"-keystroke",_rtlClass:e+"-rtl",_rowClass:e+"-row",_ctrlClass:e+"-ctrl",_baseActiveClass:e+"-base-active",_angleActiveClass:e+"-angle-active",_digitClass:e+"-digit",_operatorClass:e+"-oper",_memEmptyClass:e+"-mem-empty",_keyNameClass:e+"-keyname",_keyDownClass:e+"-key-down",_keyStrokeClass:e+"-keystroke",standardLayout:t,scientificLayout:["@X@U@E  BSCECA","DGRD    _ MC_ _7_8_9_+","SNASSRLG_ MR_ _4_5_6_-","CSACSQLN_ MS_ _1_2_3_*","TNATXYEX_ M+_ _0_.+-_/","PIRN1X  _ M-_   _%_="],addKeyDef:function(e,t,i,a,s,r,n,o){return this._keyDefs[e]=[t,"boolean"==typeof i?i?this.binary:this.unary:i,a,s,r,n,o],r&&(this[r]=e),n&&("number"==typeof n?this._keyCodes[n]=e:this._keyChars[n]=e),this},_init:function(){this.mainDiv=$('<div class="'+this._mainDivClass+'" style="display: none;"></div>').on("click."+e,this._focusEntry),this._keyCodes={},this._keyChars={},this._super()},_instSettings:function(e,t){var i="input"!==e[0].nodeName.toLowerCase();return{_input:i?$('<input type="text" class="'+this._inlineEntryClass+'"/>'):e,_inline:i,memory:0,_mainDiv:i?$('<div class="'+this._inlineClass+'"></div>'):this.mainDiv}},_postAttach:function(e,t){if(t.options.memoryAsCookie){var i=this._getMemoryCookie(t);i&&!isNaN(i)&&(t.memory=i)}!t._inline&&e.is(":disabled")&&this.disable(e[0])},_optionsChanged:function(e,a,t){if($.extend(a.options,t),this._curInst===a&&this.hide(),e.empty().off("."+a.name).siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove().end().prev("."+this._inlineEntryClass).remove(),a.options.appendText&&e.after('<span class="'+this._appendClass+'">'+a.options.appendText+"</span>"),!a._inline&&("focus"!==a.options.showOn&&"both"!==a.options.showOn||e.on("focus."+a.name,this.show),"button"===a.options.showOn||"both"===a.options.showOn||"opbutton"===a.options.showOn)){var i=$(a.options.buttonImageOnly?$("<img/>").attr({src:a.options.buttonImage,alt:a.options.buttonStatus,title:a.options.buttonStatus}):$('<button type="button" title="'+a.options.buttonStatus+'"></button>').html(""===a.options.buttonImage?a.options.buttonText:$("<img/>").attr({src:a.options.buttonImage})));e.after(i),i.addClass(this._triggerClass).on("click."+a.name,function(){return p._showingCalculator&&p._lastInput===e[0]?p.hide():p.show(e[0]),!1})}a._input.on("keydown."+a.name,this._doKeyDown).on("keyup."+a.name,this._doKeyUp).on("keypress."+a.name,this._doKeyPress),a._inline&&(e.append(a._input).append(a._mainDiv).on("click."+a.name,function(){a._input.focus()}),this._reset(a,"0"),this._setValue(a),this._updateCalculator(a),a._mainDiv.on("keydown."+a.name,this._doKeyDown).on("keyup."+a.name,this._doKeyUp).on("keypress."+a.name,this._doKeyPress),a._input.on("focus."+a.name,function(){p.isDisabled(e[0])||(a._focussed=!0,$("."+p._resultClass,a._mainDiv).addClass(p._focussedClass))}).on("blur."+a.name,function(){a._focussed=!1,$("."+p._resultClass,a._mainDiv).removeClass(p._focussedClass)})),e.addClass(this._getMarker()).on("setData."+a.name,function(e,t,i){a.options[t]=i}).on("getData."+a.name,function(e,t){return a.options[t]}).data(a.name,a),a._input.data(a.name,a),a._inline&&this._setValue(a),this._updateCalculator(a)},_preDestroy:function(e,t){t._input.off("."+t.name).removeData(t.name),e.empty().off("."+t.name).siblings("."+this._appendClass).remove().end().siblings("."+this._triggerClass).remove().end().prev("."+this._inlineEntryClass).remove()},enable:function(t){if((t=$(t)).hasClass(this._getMarker())){var e=t[0].nodeName.toLowerCase();"input"===e?t.prop("disabled",!1).siblings("button."+this._triggerClass).prop("disabled",!1).end().siblings("img."+this._triggerClass).css({opacity:"1.0",cursor:""}):"div"!==e&&"span"!==e||t.find("."+this._inlineEntryClass+",button").prop("disabled",!1).end().children("."+this._disableClass).remove(),this._disabledFields=$.map(this._disabledFields,function(e){return e===t[0]?null:e})}},disable:function(t){if((t=$(t)).hasClass(this._getMarker())){var e=t[0].nodeName.toLowerCase();if("input"===e)t.prop("disabled",!0).siblings("button."+this._triggerClass).prop("disabled",!0).end().siblings("img."+this._triggerClass).css({opacity:"0.5",cursor:"default"});else if("div"===e||"span"===e){var i=t.children("."+this._inlineClass),a=i.offset(),s={left:0,top:0};i.parents().each(function(){if("relative"===$(this).css("position"))return s=$(this).offset(),!1}),t.find("."+this._inlineEntryClass+",button").prop("disabled",!0),0===t.find("."+this._disableClass).length&&t.prepend('<div class="'+this._disableClass+'" style="width: '+i.outerWidth()+"px; height: "+i.outerHeight()+"px; left: "+(a.left-s.left)+"px; top: "+(a.top-s.top)+'px;"></div>')}this._disabledFields=$.map(this._disabledFields,function(e){return e===t[0]?null:e}),this._disabledFields[this._disabledFields.length]=t[0]}},isDisabled:function(e){return e&&-1<$.inArray(e,this._disabledFields)},show:function(e){if(e=e.target||e,!p.isDisabled(e)&&p._lastInput!==e){var t=p._getInst(e);p.hide(null,""),p._lastInput=e,p._pos=p._findPos(e),p._pos[1]+=e.offsetHeight;var i=!1;$(e).parents().each(function(){return!(i|="fixed"===$(this).css("position"))});var a={left:p._pos[0],top:p._pos[1]};p._pos=null,t._mainDiv.css({position:"absolute",display:"block",top:"-1000px",width:"auto"}),$.isFunction(t.options.onOpen)&&t.options.onOpen.apply(t._input?t._input[0]:null,[t._inline?t.curValue:t._input.val(),t]),p._reset(t,t._input.val()),p._updateCalculator(t),a=p._checkOffset(t,a,i),t._mainDiv.css({position:i?"fixed":"absolute",display:"none",left:a.left+"px",top:a.top+"px"});var s=t.options.duration;s="normal"==s&&$.ui&&8<=parseInt($.ui.version.substring(2))?"_default":s;var r=function(){p._showingCalculator=!0};if($.effects&&($.effects[t.options.showAnim]||$.effects.effect&&$.effects.effect[t.options.showAnim])){var n=t._mainDiv.data();for(var o in n)o.match(/^ec\.storage\./)&&(n[o]=t._mainDiv.css(o.replace(/ec\.storage\./,"")));t._mainDiv.data(n).show(t.options.showAnim,t.options.showOptions,s,r)}else t._mainDiv[t.options.showAnim||"show"](t.options.showAnim?s:null,r);t.options.showAnim||r(),"hidden"!==t._input[0].type&&t._input[0].focus(),p._curInst=t}},_reset:function(e,t){t=""+(t||0),t="."!==e.options.decimalChar?t.replace(new RegExp(e.options.decimalChar),"."):t,e.curValue=(10===e.options.base?parseFloat(t):parseInt(t,e.options.base))||0,e.dispValue=this._setDisplay(e),e.prevValue=e._savedValue=0,e._pendingOp=e._savedOp=this._noOp,e._formula="",e._newValue=!0},_getMemoryCookie:function(e){var t=new RegExp("^.*"+e.options.cookieName+"=([^;]*).*$");return parseFloat(document.cookie.replace(t,"$1"))},_setMemoryCookie:function(e){if(e.options.memoryAsCookie){var t=e.options.cookieExpires;if("number"==typeof t){var i=new Date;i.setTime(i.getTime()+1e3*t),t=i.toUTCString()}else t=t.constructor===Date?i.toUTCString():"";document.cookie=e.options.cookieName+"="+e.memory+"; expires="+t+"; path="+e.options.cookiePath}},_setValue:function(e){e.curValue=e.options.value||0,e.dispValue=this._setDisplay(e)},_updateCalculator:function(e){this._getBorders(e._mainDiv);if(e._mainDiv.html(this._generateHTML(e)).removeClass().addClass(e.options.calculatorClass+(e.options.useThemeRoller?" ui-widget ui-widget-content":"")+(e.options.isRTL?" "+p._rtlClass:"")+" "+(e._inline?this._inlineClass:this._mainDivClass)),1==e.options.isRTL){var t=Frames.Config.get("INPUT_DEFAULT_DIRECTION","ltr");$(".calculator-result span",e._mainDiv).attr("dir",t)}this.isDisabled(e.elem[0])&&this.disable(e.elem[0]),this._curInst===e&&e._input.focus()},_getBorders:function(e){var t=function(e){return{thin:1,medium:3,thick:5}[e]||e};return[parseFloat(t(e.css("border-left-width"))),parseFloat(t(e.css("border-top-width")))]},_checkOffset:function(e,t,i){var a=e._input?this._findPos(e._input[0]):null,s=window.innerWidth||document.documentElement.clientWidth,r=window.innerHeight||document.documentElement.clientHeight,n=document.documentElement.scrollLeft||document.body.scrollLeft,o=document.documentElement.scrollTop||document.body.scrollTop;return e.options.isRTL||t.left+e._mainDiv.outerWidth()-n>s?t.left=Math.max(i?0:n,a[0]+(e._input?e._input.outerWidth():0)-(i?n:0)-e._mainDiv.outerWidth()):t.left=Math.max(i?0:n,t.left-(i?n:0)),t.top+e._mainDiv.outerHeight()-o>r?t.top=Math.max(i?0:o,a[1]-(i?o:0)-e._mainDiv.outerHeight()):t.top=Math.max(i?0:o,t.top-(i?o:0)),t},_findPos:function(e){for(;e&&("hidden"===e.type||1!==e.nodeType);)e=e.nextSibling;var t=$(e).offset();return[t.left,t.top]},hide:function(e,t){var i=this._curInst;!i||e&&i!==p._getInst(e)||(this._showingCalculator&&(t="normal"===(t=null!=t?t:i.options.duration)&&$.ui&&8<=parseInt($.ui.version.substring(2))?"_default":t,$.effects&&($.effects[i.options.showAnim]||$.effects.effect&&$.effects.effect[i.options.showAnim])?i._mainDiv.hide(i.options.showAnim,i.options.showOptions,t):i._mainDiv["slideDown"===i.options.showAnim?"slideUp":"fadeIn"===i.options.showAnim?"fadeOut":"hide"](i.options.showAnim?t:null)),$.isFunction(i.options.onClose)&&i.options.onClose.apply(i._input?i._input[0]:null,[i._inline?i.curValue:i._input.val(),i]),this._showingCalculator&&(this._showingCalculator=!1,this._lastInput=null),this._curInst=null)},_checkExternalClick:function(e){if(p._curInst){var t=$(e.target);t.parents().andSelf().hasClass(p._mainDivClass)||t.hasClass(p._getMarker())||t.parents().andSelf().hasClass(p._triggerClass)||!p._showingCalculator||p.hide()}},_focusEntry:function(){p._curInst&&p._curInst._input&&p._curInst._input.focus()},_doKeyDown:function(e){var t=!1,i=p._getInst(e.target),a=i&&i._inline?$(e.target).parent()[0]:null;if(9===e.keyCode)p.mainDiv.stop(!0,!0),p.hide(),i&&i._inline&&i._input.blur();else if(p._showingCalculator||a&&!p.isDisabled(a))if(18===e.keyCode)p._showingKeystrokes||(i._mainDiv.find("."+p._keystrokeClass).show(),p._showingKeystrokes=!0),t=!0;else{var s=p._keyCodes[e.keyCode];s&&($('button[data-keystroke="'+s+'"]',i._mainDiv).not(":disabled").click(),t=!0)}else 36===e.keyCode&&e.ctrlKey&&i&&!i._inline&&p.show(this);return t&&(e.preventDefault(),e.stopPropagation()),!t},_doKeyUp:function(e){p._showingKeystrokes&&(p._getInst(e.target)._mainDiv.find("."+p._keystrokeClass).hide(),p._showingKeystrokes=!1)},_doKeyPress:function(e){var t=p._getInst(e.target);if(!t)return!0;var i=t&&t._inline?$(e.target).parent()[0]:null,a=String.fromCharCode(void 0===e.charCode?e.keyCode:e.charCode),s=t.options.isOperator||p.isOperator;if(p._showingCalculator||i||"operator"!==t.options.showOn&&"opbutton"!==t.options.showOn||!s.apply(t._input,[a,e,t._input.val(),t.options.base,t.options.decimalChar])||(p.show(this),p._showingCalculator=!0),p._showingCalculator||i&&!p.isDisabled(i)){var r=p._keyChars[a===t.options.decimalChar?".":a];return r&&$('button[data-keystroke="'+r+'"]',t._mainDiv).not(":disabled").click(),!1}if(" "<=a&&t.options.constrainInput){var n=new RegExp("^-?"+(10===t.options.base?"[0-9]*(\\"+t.options.decimalChar+"[0-9]*)?":"["+"0123456789abcdef".substring(0,t.options.base)+"]*")+"$");return null!=(t._input.val()+a).toLowerCase().match(n)}return!0},isOperator:function(e,t,i,a,s){return" "<e&&!("-"===e&&""===i)&&-1===("0123456789abcdef".substr(0,a)+"."+s).indexOf(e.toLowerCase())},_generateHTML:function(e){for(var t=(e.options.prompt?'<div class="'+this._promptClass+(e.options.useThemeRoller?" ui-widget-header ui-corner-all":"")+'">'+e.options.prompt+"</div>":"")+'<div class="'+this._resultClass+(e.options.useThemeRoller?" ui-widget-header":"")+(e._focussed?" "+this._focussedClass:"")+'">'+(e.options.showFormula?'<span class="'+this._formulaClass+'">'+e._formula+"</span>":"")+"<span>"+e.dispValue+"</span></div>",i=0;i<e.options.layout.length;i++){t+='<div class="'+this._rowClass+'">';for(var a=0;a<e.options.layout[i].length;a+=2){for(var s=e.options.layout[i].substr(a,2),r=this._keyDefs[s]||this._keyDefs["??"],n="#"===r[0].charAt(0)?e.options[r[0].substr(1)+"Text"]:r[0],o="#"===r[0].charAt(0)?e.options[r[0].substr(1)+"Status"]:"",l=r[3]?r[3].split(" "):[],d=0;d<l.length;d++)l[d]=e.name+"-"+l[d];l=l.join(" ");var u=e.options.useThemeRoller?" ui-state-active":"",c=e.options.useThemeRoller?" ui-state-highlight":"";t+=r[1]===this.space?'<span class="'+e.name+"-"+r[3]+'"></span>':!e._inline||"._close"!==r[2]&&"._erase"!==r[2]?'<button type="button" data-keystroke="'+s+'"'+(r[1]===this.control?' class="'+this._ctrlClass+(r[0].match(/^#base/)?r[0].replace(/^#base/,"")===e.options.base?u||" "+this._baseActiveClass:c:"#degrees"===r[0]?e.options.useDegrees?u||" "+this._angleActiveClass:c:"#radians"===r[0]?e.options.useDegrees?c:u||" "+this._angleActiveClass:c):r[1]===this.digit?(parseInt(r[0],16)>=e.options.base||10!==e.options.base&&"."===r[0]?' disabled="disabled"':"")+' class="'+this._digitClass:r[1]===this.binary?' class="'+this._operatorClass:' class="'+this._operatorClass+(r[0].match(/^#mem(Clear|Recall)$/)&&!e.memory?" "+this._memEmptyClass:""))+(e.options.useThemeRoller?" ui-state-default":"")+(l?" "+l:"")+'" '+(o?'title="'+o+'"':"")+">"+("_."===s?e.options.decimalChar:n)+(r[5]&&r[5]!==r[0]?'<span class="'+this._keystrokeClass+(e.options.useThemeRoller?" ui-state-error":"")+(r[6]?" "+this._keyNameClass:"")+'">'+(r[6]||r[5])+"</span>":"")+"</button>":""}t+="</div>"}return(t=$(t+='<div style="clear: both;"></div>')).find("button").on("mouseover."+e.name,function(){p._saveClasses=this.className}).on("mousedown."+e.name,function(){$(this).addClass(this._keyDownClass+(e.options.useThemeRoller?" ui-state-active":""))}).on("mouseup."+e.name,function(){$(this).removeClass().addClass(p._saveClasses)}).on("mouseout."+e.name,function(){$(this).removeClass().addClass(p._saveClasses)}).on("click."+e.name,function(){p._handleButton(e,$(this))}),t},_setDisplay:function(e){var t=new Number(e.curValue).toFixed(e.options.precision).valueOf(),i=t.replace(/^.+(e.+)$/,"$1").replace(/^[^e].*$/,"");return i&&(t=new Number(t.replace(/e.+$/,"")).toFixed(e.options.precision).valueOf()),parseFloat(t.replace(/0+$/,"")+i).toString(e.options.base).toUpperCase().replace(/\./,e.options.decimalChar)},_sendButton:function(e,t){$.isFunction(e.options.onButton)&&e.options.onButton.apply(e._input?e._input[0]:null,[t,e.dispValue,e])},_handleButton:function(e,t){var i=this._keyDefs[t.data("keystroke")];if(i){var a=t.text().substr(0,t.text().length-t.children("."+this._keyStrokeClass).text().length);switch(i[1]){case this.control:i[2].apply(this,[e,a]);break;case this.digit:this._digit(e,a);break;case this.binary:this._binaryOp(e,i[2],a);break;case this.unary:this._unaryOp(e,i[2],a)}(p._showingCalculator||e._inline)&&e._input.focus()}},_noOp:function(e){},_digit:function(e,t){if(e.dispValue=e._newValue?"":e.dispValue,!(t===e.options.decimalChar&&-1<e.dispValue.indexOf(t))){e.dispValue=(e.dispValue+t).replace(/^0(\d)/,"$1").replace(new RegExp("^(-?)([\\."+e.options.decimalChar+"])"),"$10$2"),e._formula+=t,"."!==e.options.decimalChar&&(e.dispValue=e.dispValue.replace(new RegExp("^"+e.options.decimalChar),"0."));var i="."!==e.options.decimalChar?e.dispValue.replace(new RegExp(e.options.decimalChar),"."):e.dispValue;e.curValue=10===e.options.base?parseFloat(i):parseInt(i,e.options.base),e._newValue=!1,this._sendButton(e,t),this._updateCalculator(e)}},_binaryOp:function(e,t,i){!e._newValue&&e._pendingOp&&(e._pendingOp(e),e.curValue=10===e.options.base?e.curValue:Math.floor(e.curValue),e.dispValue=this._setDisplay(e)),e.prevValue=e.curValue,e._newValue=!0,e._pendingOp=t,e._formula=e._formula.replace(/\D$/,"")+i,this._sendButton(e,i),this._updateCalculator(e)},_add:function(e){e.options.onAdd?e.options.onAdd.apply(e._input?e._input[0]:null,[e]):e.curValue=e.prevValue+e.curValue},_subtract:function(e){e.options.onSubtract?e.options.onSubtract.apply(e._input?e._input[0]:null,[e]):e.curValue=e.prevValue-e.curValue},_multiply:function(e){e.options.onMultiply?e.options.onMultiply.apply(e._input?e._input[0]:null,[e]):e.curValue=e.prevValue*e.curValue},_divide:function(e){e.options.onDivide?e.options.onDivide.apply(e._input?e._input[0]:null,[e]):e.curValue=e.prevValue/e.curValue},_power:function(e){e.curValue=Math.pow(e.prevValue,e.curValue)},_unaryOp:function(e,t,i){e._newValue=!0,t.apply(this,[e]),e.curValue=10===e.options.base?e.curValue:Math.floor(e.curValue),e.dispValue=this._setDisplay(e),e._formula+="="===i?"":" "+i+" ",this._sendButton(e,i),this._updateCalculator(e)},_plusMinus:function(e){e.curValue=-1*e.curValue,e.dispValue=this._setDisplay(e),e._newValue=!1},_pi:function(e){e.curValue=Math.PI},_percent:function(e){e._pendingOp===this._add?e.curValue=e.prevValue*(1+e.curValue/100):e._pendingOp===this._subtract?e.curValue=e.prevValue*(1-e.curValue/100):e._pendingOp===this._multiply?e.curValue=e.prevValue*e.curValue/100:e._pendingOp===this._divide&&(e.curValue=e.prevValue/e.curValue*100),e._savedOp=e._pendingOp,e._pendingOp=this._noOp},_equals:function(e){e._pendingOp===this._noOp?(e._savedOp,this._noOp):(e._savedOp=e._pendingOp,e._savedValue=e.curValue,e._pendingOp(e),e._pendingOp=this._noOp),e._formula=""},_memAdd:function(e){e.memory+=e.curValue,this._setMemoryCookie(e)},_memSubtract:function(e){e.memory-=e.curValue,this._setMemoryCookie(e)},_memStore:function(e){e.memory=e.curValue,this._setMemoryCookie(e)},_memRecall:function(e){e.curValue=e.memory},_memClear:function(e){e.memory=0,this._setMemoryCookie(e)},_sin:function(e){this._trig(e,Math.sin)},_cos:function(e){this._trig(e,Math.cos)},_tan:function(e){this._trig(e,Math.tan)},_trig:function(e,t,i){e.curValue=t(e.curValue*(e.options.useDegrees?Math.PI/180:1))},_asin:function(e){this._atrig(e,Math.asin)},_acos:function(e){this._atrig(e,Math.acos)},_atan:function(e){this._atrig(e,Math.atan)},_atrig:function(e,t,i){e.curValue=t(e.curValue),e.options.useDegrees&&(e.curValue=e.curValue/Math.PI*180)},_inverse:function(e){e.curValue=1/e.curValue},_log:function(e){e.curValue=Math.log(e.curValue)/Math.log(10)},_ln:function(e){e.curValue=Math.log(e.curValue)},_exp:function(e){e.curValue=Math.exp(e.curValue)},_sqr:function(e){e.curValue*=e.curValue},_sqrt:function(e){e.curValue=Math.sqrt(e.curValue)},_random:function(e){e.curValue=Math.random()},_base2:function(e,t){this._changeBase(e,t,2)},_base8:function(e,t){this._changeBase(e,t,8)},_base10:function(e,t){this._changeBase(e,t,10)},_base16:function(e,t){this._changeBase(e,t,16)},_changeBase:function(e,t,i){e.options.base=i,e.curValue=10===i?e.curValue:Math.floor(e.curValue),e.dispValue=this._setDisplay(e),e._newValue=!0,this._sendButton(e,t),this._updateCalculator(e)},_degrees:function(e,t){this._degreesRadians(e,t,!0)},_radians:function(e,t){this._degreesRadians(e,t,!1)},_degreesRadians:function(e,t,i){e.options.useDegrees=i,this._sendButton(e,t),this._updateCalculator(e)},_undo:function(e,t){e.dispValue=e.dispValue.substr(0,e.dispValue.length-1)||"0",e.curValue=10===e.options.base?parseFloat(e.dispValue):parseInt(e.dispValue,e.options.base),e._formula=e._formula.replace(/[\.\d]$/,""),this._sendButton(e,t),this._updateCalculator(e)},_clearError:function(e,t){e.dispValue="0",e.curValue=0,e._formula=e._formula.replace(/[\.\d]+$/,""),e._newValue=!0,this._sendButton(e,t),this._updateCalculator(e)},_clear:function(e,t){this._reset(e,0),this._sendButton(e,t),this._updateCalculator(e)},_close:function(e,t){this._finished(e,t,e._input.val())},_use:function(e,t){e._pendingOp!==this._noOp&&this._unaryOp(e,this._equals,t),this._finished(e,t,e.dispValue)},_erase:function(e,t){e.options.onErase?e.options.onErase.apply(e._input?e._input[0]:null,[e,t]):(this._reset(e,0),this._updateCalculator(e),this._finished(e,t,""))},_finished:function(e,t,i){e._inline?this._curInst=e:e._input.val(i),this._sendButton(e,t),this.hide(e._input[0])}});var p=$.calculator,i=[["_0","0",p.digit,null,"","0","0"],["_1","1",p.digit,null,"","1","1"],["_2","2",p.digit,null,"","2","2"],["_3","3",p.digit,null,"","3","3"],["_4","4",p.digit,null,"","4","4"],["_5","5",p.digit,null,"","5","5"],["_6","6",p.digit,null,"","6","6"],["_7","7",p.digit,null,"","7","7"],["_8","8",p.digit,null,"","8","8"],["_9","9",p.digit,null,"","9","9"],["_A","A",p.digit,null,"hex-digit","A","a"],["_B","B",p.digit,null,"hex-digit","B","b"],["_C","C",p.digit,null,"hex-digit","C","c"],["_D","D",p.digit,null,"hex-digit","D","d"],["_E","E",p.digit,null,"hex-digit","E","e"],["_F","F",p.digit,null,"hex-digit","F","f"],["_.",".",p.digit,null,"decimal","DECIMAL","."],["_+","+",p.binary,p._add,"arith add","ADD","+"],["_-","-",p.binary,p._subtract,"arith subtract","SUBTRACT","-"],["_*","*",p.binary,p._multiply,"arith multiply","MULTIPLY","*"],["_/","/",p.binary,p._divide,"arith divide","DIVIDE","/"],["_%","%",p.unary,p._percent,"arith percent","PERCENT","%"],["_=","=",p.unary,p._equals,"arith equals","EQUALS","="],["+-","",p.unary,p._plusMinus,"arith plus-minus","PLUS_MINUS","#"],["PI","",p.unary,p._pi,"pi","PI","p"],["1X","1/x",p.unary,p._inverse,"fn inverse","INV","i"],["LG","log",p.unary,p._log,"fn log","LOG","l"],["LN","ln",p.unary,p._ln,"fn ln","LN","n"],["EX","e",p.unary,p._exp,"fn exp","EXP","E"],["SQ","x",p.unary,p._sqr,"fn sqr","SQR","@"],["SR","",p.unary,p._sqrt,"fn sqrt","SQRT","!"],["XY","x^y",p.binary,p._power,"fn power","POWER","^"],["RN","rnd",p.unary,p._random,"random","RANDOM","?"],["SN","sin",p.unary,p._sin,"trig sin","SIN","s"],["CS","cos",p.unary,p._cos,"trig cos","COS","o"],["TN","tan",p.unary,p._tan,"trig tan","TAN","t"],["AS","asin",p.unary,p._asin,"trig asin","ASIN","S"],["AC","acos",p.unary,p._acos,"trig acos","ACOS","O"],["AT","atan",p.unary,p._atan,"trig atan","ATAN","T"],["MC","#memClear",p.unary,p._memClear,"memory mem-clear","MEM_CLEAR","x"],["MR","#memRecall",p.unary,p._memRecall,"memory mem-recall","MEM_RECALL","r"],["MS","#memStore",p.unary,p._memStore,"memory mem-store","MEM_STORE","m"],["M+","#memAdd",p.unary,p._memAdd,"memory mem-add","MEM_ADD",">"],["M-","#memSubtract",p.unary,p._memSubtract,"memory mem-subtract","MEM_SUBTRACT","<"],["BB","#base2",p.control,p._base2,"base base2","BASE_2","B"],["BO","#base8",p.control,p._base8,"base base8","BASE_8","C"],["BD","#base10",p.control,p._base10,"base base10","BASE_10","D"],["BH","#base16",p.control,p._base16,"base base16","BASE_16","H"],["DG","#degrees",p.control,p._degrees,"angle degrees","DEGREES","G"],["RD","#radians",p.control,p._radians,"angle radians","RADIANS","R"],["BS","#backspace",p.control,p._undo,"undo","UNDO",8,"BSp"],["CE","#clearError",p.control,p._clearError,"clear-error","CLEAR_ERROR",36,"Hom"],["CA","#clear",p.control,p._clear,"clear","CLEAR",35,"End"],["@X","#close",p.control,p._close,"close","CLOSE",27,"Esc"],["@U","#use",p.control,p._use,"use","USE",13,"Ent"],["@E","#erase",p.control,p._erase,"erase","ERASE",46,"Del"],["  ","",p.space,null,"space","SPACE"],["_ ","",p.space,null,"half-space","HALF_SPACE"],["??","??",p.unary,p._noOp]];$.each(i,function(e,t){p.addKeyDef.apply(p,t)}),Frames._Calculator={},Frames._Calculator.init=function(){0===p.mainDiv.parent().length&&$("body").append(p.mainDiv).on("mousedown."+e,p._checkExternalClick)}}(jQuery),function($){$.extend($.ui.autocomplete.prototype.options,{position:{my:"left top",at:"left bottom",collision:"flip",within:".workspace-container"}}),Frames.ComboBox=$.inherit(Frames.ButtonInput,{fixRtl:function(e){Frames.ButtonInput.prototype.fixRtl.apply(this,[e]),"rtl"===this.elem.css("direction")&&$.extend($.ui.autocomplete.prototype.options,{position:{my:"right top",at:"right bottom",collision:"flip",within:".workspace-container"}})},initInputMask:$.noop,_applyDirection:$.noop,props:function(){return 1<arguments.length&&"required"==arguments[0]&&Frames.isTrue(arguments[1])&&this._call("handleEmptyRow",Frames.isTrue(arguments[1])),Frames.TextInput.prototype.props.apply(this,arguments)},rules:function(){return{restrict:!0,required:"true"===Frames.Config.get("VALIDATE_REQUIRED","true")}},validable:function(){return this._call("input")},editable:function(){if(!(0<arguments.length))return Frames.Item.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments),Frames.isTrue(arguments[0])&&!1===this._call("option").search&&this.input().attr("readonly","readonly");var e=this.buttonObj(),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},mapvalue:function(){return this._call("mapvalue",arguments[0])},dynmodel:function(e){if(e&&(Frames.isTrue(e["@hasChanges"])||e.listElement)){var t,i=this._call("value");if(this._call("clear"),this._call("handleEmptyRow",this.props("required")),e.listElement)for(t=0;t<e.listElement.length;t++){var a=e.listElement[t],s=a["@label"],r=Frames.isTrue(a["@dataIsNull"])?null:a["@data"];this._call("newoption",s,r)}this._call("clearselection"),this._call("value",i),this._call("checkWidth")}},dvalue:function(){return $("option:selected",this.elem).text()},dataModel:function(){return this._call("dataModel")},restrictCase:$.noop,_applyAutoskip:$.noop,clickable:function(){return!1}});var e=$.ui.autocomplete.prototype._resizeMenu;$.ui.autocomplete.prototype._resizeMenu=function(){e.apply(this,arguments),this._trigger("preopen",null,{content:this.menu.element})},Frames.regtype("combobox",Frames.ComboBox)}(jQuery),function($){$.widget("ui.combobox",$.ui.buttoninput,{_createInput:function(){return $('<input type="text" class="ui-autocomplete-input">').insertAfter(this._select)},_create:function(){this._select=$("select",this.element),this.element.addClass("ui-combobox"),$.ui.buttoninput.prototype._create.apply(this),this._container=Frames.Application.task.view.container()},_configure:function(e,t){Frames.Config.getbool("COMBOBOX_EMPTY_LABELS",!1)||this._select.children("option").each(function(e,t){Frames.isEmpty(t.text)&&(t.text=_("COMBOBOX_EMPTY_OPTION"))}),$.ui.buttoninput.prototype._configure.apply(this,[e,t]),this._inp.attr("style",this._select.attr("style")).attr("role","combobox"),this._select.hide();var i=this.element.data("search");Frames.isUndef(i)||(this.options.search=Frames.isTrue(i)),this.options.search||e.attr("readonly","readonly"),this._button.attr("aria-label",_("SELECT")),Frames.browser.mobile||this._select.addClass("is-desktop"),this.checkWidth()},_defaultId:function(){return this.element.attr("id")+"_ac"},_configureEvents:function(){var l=this;this._inp.keyup(function(e){var t=$(this).autocomplete("widget");if(t.is(":visible")&&(delete Frames.FocusManager.disabled,l.options.search||$(this).autocomplete().attr("readonly","readonly")),Frames.Config.getbool("COMBOBOX_AUTOSELECT_ENABLED",!1)){var i=String.fromCharCode(e.charCode?e.charCode:e.which);if(new RegExp("^[a-zA-Z0-9]+$").test(i))if(1==t.find("li").length){var a=t.find("li").text();if(a.match(this.value))return $(this).val(a),$(this).autocomplete("close"),void e.stopPropagation()}}}).keydown(function(e){var t=e.which===$.ui.keyCode.DOWN||e.which===$.ui.keyCode.UP,i=$(this).autocomplete("widget").is(":visible");if(t){if(e.altKey)return i?$(this).autocomplete("close"):$(this).autocomplete("search",""),e.stopImmediatePropagation(),!1;if(i)return l.options.search||$(this).autocomplete().removeAttr("readonly"),!(Frames.FocusManager.disabled=!0)}if((e.which===$.ui.keyCode.TAB||e.which===$.ui.keyCode.ENTER)&&i){var a;if($(this).autocomplete("widget").find("#ui-active-menuitem")[0]&&l._highlighted)a=l._highlighted;else if(1==$(this).autocomplete("widget").find("li").length){var s=$(this).autocomplete("widget").find("li").text();l._select.children("option").each(function(){var e=$(this);if(e.text()==s)return!(a={value:e.val(),option:e.get(0)})})}return void 0!==a&&(l._select.val(a.option.value),l._trigger("selected",e,{item:a.option}),l.selectedHandler(a.option,!1)),void $(this).autocomplete("close")}var r=Frames.Config.haskeys(e);if(!i||r){var n=Frames.FocusManager._itemKeyboardNavigation(e);if(!n&&!e.isImmediatePropagationStopped()){var o=l.options.grid?Frames.Application.current().block:$(this).data("frames").block;o?n=o._keyEventHandler(e):t&&e.stopImmediatePropagation()}if(!1===n)return e.stopImmediatePropagation(),!1}else e.stopPropagation();if(18===e.which||16===e.which)return e.stopImmediatePropagation(),!1}).focus(function(){l._init_autocomplete()});var i="autocomplete_"+this._inp.attr("id");this._inp.on("autocompletecreate",function(e,t){$(this).attr("role","combobox").attr("aria-owns",i),$(this).autocomplete("widget").attr("id",i).removeAttr("aria-activedescendant")}).on("autocompleteopen",function(e,t){$(this).autocomplete("widget").children("li").attr("role","option").each(function(e){$(this).attr("id",i+"_"+e)}).children("a").attr("role","presentation")}).on("autocompleteclose",function(e,t){$(this).removeAttr("aria-activedescendant")}).on("autocompletefocus",function(e,t){$(this).attr("aria-activedescendant",$("#ui-active-menuitem",$(this).autocomplete("widget")).parent().attr("id"))}),this.showButton()&&this._button.on("mousedown",function(e){if(document.activeElement!==l._inp[0]&&l._inp.focus(),Frames.Application.executing()){this.__cancelClick=!0;var t=this;return $(Frames).one("waitend",function(){document.activeElement===l._inp[0]&&Frames.later(function(){$(t).triggerHandler("click",{force:!0})})}),void e.preventDefault()}}).on("click",function(e,t){return t&&t.force||!0!==this.__cancelClick?(l._init_autocomplete(),l._inp.autocomplete("widget").is(":visible")?l._inp.autocomplete("close"):l._inp.autocomplete("search",""),void l._inp.focus()):(delete this.__cancelClick,void e.preventDefault())}),Frames.browser.mobile&&this._select.addClass("is-native").on("change",function(){var e=$("option:selected",this);l._inp.val(e.text()),l._inp.triggerHandler("valuechange")})},_reopen_options:function(){var e=this._inp.autocomplete("widget").is(":visible");if(document.activeElement===this._inp[0]&&e){var t=this._inp.autocomplete("widget").find("li").size()===this._select.children("option").size();this._inp.autocomplete("close"),t&&this._inp.autocomplete("search","")}},_init_autocomplete:function(){if(!this._autocomplete){this._autocomplete=!0;var n=this;n.element.width();this._inp.autocomplete({delay:0,minLength:0,appendTo:this._container,source:function(i,e){var a=Frames.Config.get("COMBOBOX_SEARCH_MODE","contains"),t=$.ui.autocomplete.escapeRegex(i.term),s={contains:["\\B"+t+"|\\b"+t,""],startswith:["^"+t,"^"]},r=new RegExp(s[a][0],"i");e(n._select.children("option").map(function(){var e=$(this).text();this.value;if(Frames.isEmpty(i.term)||r.test(e)){var t=$.escapeHtml(e);return this.value&&!Frames.isEmpty(i.term)&&(t=$.escapeHtml(e).replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+s[a][1]+$.ui.autocomplete.escapeRegex(i.term)+")(?![^<>]*>)(?![^&;]+;)","gi"),"<strong>$1</strong>")),{label:t,value:e,option:this}}}))},select:function(e,t){t.item&&(n._select.val(t.item.option.value),n._trigger("selected",e,{item:t.item.option}),n.selectedHandler(t.item.option))},change:function(e,t){if(!t.item){var i=new RegExp("^"+$.ui.autocomplete.escapeRegex($(this).val())+"$","i"),a=!1;n._select.children("option").each(function(){var e=$(this).val();if($(this).text().match(i)||Frames.isEmpty($.trim(e)))return this.selected=a=!0,!1}),a||(n.clearselection(),n._inp.data(Frames.get_fullname("autocomplete")).term="")}},focus:function(e,t){n._highlighted=t.item},close:function(e,t){delete n._highlighted},preopen:function(e,t){var i=t.content,a=n.element.find("button");i[0].scrollHeight-4>i[0].clientHeight?i.css("overflow-y","scroll"):i.css("overflow-y","hidden");var s={width:Math.round(n.input().outerWidth())+a.outerWidth(),zIndex:$(this).closest(".ui-dialog").css("z-index")||Frames.Application.task.view.getCanvasCount()+1,paddingBottom:i[0].scrollWidth>i[0].clientWidth?$.position.scrollbarWidth()+"px":""};if(i.css(s),!Frames.isTrue(n._inp.data("frames").props("Navigable"))){var r=function(){var e=n._inp;e.autocomplete("widget").is(":visible")&&e.autocomplete().trigger("blur")};Frames.Application.one("endbind",r),setTimeout(function(){$(document).one("click",r)},1)}}});var e=this._inp.data(Frames.get_fullname("autocomplete"));Frames.isUndef(e)||(e.menu._isDivider=function(e){return!Frames.isEmpty(e.text())&&!/[^\-\u2014\u2013]/.test(e.text())},e._renderItem=function(e,t){return $("<li></li>").data("item.autocomplete",t).append("<a>"+t.label+"</a>").appendTo(e)}),this._resize_fn=function(e){n._reopen_options()},this._container.on("resize",this._resize_fn),this._scroll_fn=function(e){e.target.scrollHeight>$(e.target).height()&&!Frames.isTrue($(e.target).is(".ui-autocomplete"))&&n._reopen_options()},document.addEventListener("scroll",this._scroll_fn,!0)}},selectedHandler:function(e,t){var i=this._inp.data("frames"),a=this.options.grid?i.context._last_value:i._last_value;if(!Frames.Format.equals(a,$(e).val())||!1===t){this._inp.val($(e).text()),this._inp.triggerHandler("valuechange"),Frames.Validation.reset(i);var s=this.element.data("action")||this.element.data("change");Frames.Application.elemexec(this.element,void 0,s)}},refresh:function(e){if(this.showButton()){var t=this._inp.is(":visible")&&(0<this._inp.width()||0<this._inp.height());(e||t)&&(this._select.hasClass("form-control")?(this._inp.addClass("form-control"),this._button.wrap('<span class="input-group-addon ui-combobox-button"></span>')):$.ui.buttoninput.prototype.refresh.apply(this,[e]))}},destroy:function(){this._container.off("resize",this._resize_fn),document.removeEventListener("scroll",this._scroll_fn,!0),this.element.removeClass("ui-combobox"),$.ui.buttoninput.prototype.destroy.apply(this),this.element.show()},selectObj:function(){return this._select},mapvalue:function(e){var t=Frames.Config.getbool("MAPVALUES_ENABLED",!0),i=Frames.get_frames(this.element),a=i&&i.block?i.block:void 0;if(!t||!Frames.isUndef(a)&&"SEARCH"==a.props("blockMode"))return e;var s=Frames.isUndef(e)?e:String(e).toUpperCase(),r=this._select.children("option").filter(function(){return Frames.isTrue($(this).data("valueisnull"))?null===s:String($(this).val()).toUpperCase()===s});if(0===r.length){var n=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(this.element.data("unvalueisnull")),o=n?null:this.element.data("unvalue");if(void 0!==o){var l=n?o:String(o).toUpperCase();e=0<(r=this._select.children("option").filter(function(){return Frames.isTrue($(this).data("valueisnull"))?null===l:String($(this).val()).toUpperCase()===l})).length?o:""}}return e},value:function(){var e,t;if(0===arguments.length){var i=this._inp.val(),a=this._select.val();return Frames.isEmpty(i)&&Frames.isEmpty(a)?"":1<(e=this._select.children("option").filter(function(){return $(this).text()==i})).length&&i===this._select.find(":selected").text()?this._select.find(":selected").val():(t=i,e[0]&&(t=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(e.first().data("valueisnull"))?null:e.first().val()),t)}this.clearselection(),t=arguments[0];var s=Frames.get_frames(this.element),r=s&&s.block?s.block:void 0;if(Frames.isUndef(r)||"SEARCH"!=r.props("blockMode")||this._inp.val(t),0===(e=this._select.children("option").filter(function(){return Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue($(this).data("valueisnull"))?null===t:String($(this).val()).toUpperCase()===String(t).toUpperCase()})).length){if(t=this.mapvalue(t),Frames.isUndef(t))return;e=this._select.children("option").filter(function(){return String($(this).val()).toUpperCase()===String(t).toUpperCase()})}if(0<e.length){var n=e.first().text();this._select.val(t),this._inp.val(n).attr("title",n)}},clear:function(){this._select.find("option").remove()},newoption:function(e,t){if(this._select.get(0)){var i=Frames.Config.getbool("COMBOBOX_EMPTY_LABELS",!1)?"":_("COMBOBOX_EMPTY_OPTION"),a=new Option(Frames.isEmpty(e)?i:e,Frames.isEmpty(t)?"":t);Frames.isTrue(Frames.Application._supportnulls)&&null===t&&a.setAttribute("data-valueisnull",!0);var s=this._select.get(0).options;s[s.length]=a}},dataModel:function(){var a=[];return $("option",this._select).each(function(){var e=$(this),t=e.val();Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(e.data("valueisnull"))&&(t=null);var i={};i.value=t,i.label=e.text(),a.push(i)}),a},opts:function(){return $("option",this._select)},clearselection:function(){this._inp.val(null),this._select.val([])},checkWidth:function(){if(!this.options.grid&&!this._select.hasClass("form-control")){var e=!Frames.isEmpty(this._select[0].style.width),t=!Frames.isEmpty(this.element[0].style.left)&&!Frames.isEmpty(this.element[0].style.right);e||t||this.changeWidth(this._select.outerWidth()+6,!0)}},changeWidth:function(e,t){1<arguments.length&&!Frames.isTrue(t)&&this._select.css("width",e),$.ui.buttoninput.prototype.changeWidth.apply(this,[e])},handleEmptyRow:function(e){if(Frames.Config.getbool("COMBOBOX_EMPTY_ROW",!1)&&!Frames.inDesignMode&&this._select.get(0)){var t=new Option("",""),i=this._select.get(0).options;0<i.length&&Frames.isTrue(e)&&Frames.isEmpty(i[0].label)?i.remove(0):!Frames.isTrue(e)&&(0<i.length&&!Frames.isEmpty(i[i.length-1].label)||0===i.length)&&i.add(t,i[0])}}}),$.ui.combobox.prototype.options=$.extend({},$.ui.buttoninput.prototype.options,{search:!0,grid:!1,icon:"fa fa-caret-down",action:null})}(jQuery),function($){Frames.ListBox=$.inherit(Frames.TextInput,{init:function(e){Frames.TextInput.prototype.init.apply(this,[e]),this.props("formatEnabled",!1)},initInputMask:$.noop,_setAutoAlignment:$.noop,props:function(){if(!(1<arguments.length&&"formatEnabled"==arguments[0]&&Frames.isTrue(arguments[1])))return Frames.TextInput.prototype.props.apply(this,arguments)},dynmodel:function(e){if(e&&(Frames.isTrue(e["@hasChanges"])||e.listElement)){var t,i=this._call("value");if(this._call("clear"),e.listElement)for(t=0;t<e.listElement.length;t++){var a=e.listElement[t],s=Frames.Model.attr(a,"label"),r=Frames.Model.attr(a,"data");this._call("newoption",s,r)}this._call("refresh"),Frames.isUndef(i)||this._call("value",[i])}},clickable:function(){return!0},rules:function(){return{required:"true"===Frames.Config.get("VALIDATE_REQUIRED","true")}},optmodel:function(){var e=this._call("lvalue");return Frames.Model.createItem(this.member,e)}}),Frames.regtype("listbox",Frames.ListBox)}(jQuery),function($){$.widget("ui.listbox",{version:"@VERSION",options:{ui:!0},_create:function(){var o=this;this._select=$("select",this.element);var e=this._select.children(":selected");e.val()&&e.text();this.options.ui?this._create_ui():this._menu=$([]),this._inp=this._select,this._inp.keydown(function(e){if(e.keyCode==$.ui.keyCode.DOWN||e.keyCode==$.ui.keyCode.UP)return e.preventDefault(),!1}),this.element.keydown(function(e){var t=e.keyCode==$.ui.keyCode.DOWN,i=e.keyCode==$.ui.keyCode.UP;if(t||i){e.preventDefault(),e.stopImmediatePropagation();var a,s=o._selected();if(0===s.length){var r=o._inp.find("option").first();0<r.length&&(a=r.value())}else{var n;t?0===(n=s.next()).length&&(n=s.siblings().first()):0===(n=s.prev()).length&&(n=s.siblings().last()),a=n.val()}Frames.isUndef(a)||o.value(a)}}),this.element.addClass("ui-listbox ui-widget"),this._inp.addClass("ui-widget-content ui-corner-all"),this._lbl=$("label",this.element),this._lbl.attr("for",this._inp.attr("id"))},_create_ui:function(){var t=this,e=$('<div class="ui-listbox-container ui-widget ui-widget-content ui-corner-all" tabindex="0"><ul></ul></div>').css(Frames.css(this._select)).insertAfter(this._select);this._menu=e.children("ul"),this._select.children("option").each(function(){var e=$(this).text();t._menu.append($('<li data-value="'+this.value+'" enabled="true"><a href="#'+this.value+'">'+e+"</a></li>"))}),this._select.hide(),this._menu.list().attr("tabindex",0).show(),this.element.click($.proxy(this._disableClickHandler,this)),this.element.bind("action",$.proxy(this._selectedHandler,this))},refresh:function(){var t=this;this._menu.children().remove(),this._select.children("option").each(function(){var e=$(this).text();t._menu.append($('<li data-value="'+this.value+'" enabled="true"><a href="#'+this.value+'">'+e+"</a></li>"))}),this._menu.list("refresh")},_disableClickHandler:function(e){this._lval=$(e.target).is("a")?$(e.target).parent().data("value"):this._selected().val(),Frames.isUndef(this._lval)&&(this._lval=this._inp.find("option").first().val()),this._inp.trigger("btnclick"),e.preventDefault()},_selectedHandler:function(){this._lval&&this.value(this._lval),Frames.Application.elemexec(this.element)},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-listbox ui-widget"),this._inp.data("frames",null),this._lbl=null},wrapper:function(e){this._inp.data("frames",e)},input:function(){return this._inp},labelObj:function(){return this._lbl},buttonObj:function(){return this.button},lvalue:function(){return this._lval},value:function(){var e=$("select",this.element);if(0===arguments.length){var t=e.val();return e.children("option:selected").text()!=this._inp.val()&&(t=this._inp.val(),$.isArray(t)&&(t=0<t.length?t[0]:"")),t}var i=arguments[0],a=e.children("option").filter(function(){return $(this).val()==i});this._menu.children("li").children("a").removeClass("ui-state-hover"),0<a.length?(a=a.eq(0),e.val(i),e.triggerHandler("valuechange"),0<(a=this._menu.children("li").filter(function(){return $(this).data("value")==i})).length&&a.eq(0).children("a").addClass("ui-state-hover")):e.val("")},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},focus:function(){this._menu.parent().focus()},clear:function(){$("select",this.element).find("option").remove()},newoption:function(e,t){var i=$("select",this.element),a=new Option(Frames.isUndef(e)&&$.browser.mozilla?"":e,Frames.isUndef(t)&&$.browser.mozilla?"":t);if(i.get(0)){var s=i.get(0).options;s[s.length]=a}},_selected:function(){return this._inp.children("option:selected")}})}(jQuery),function($){Frames.Stepper=$.inherit(Frames.ButtonInput,{initInputMask:$.noop,clickable:function(){return!1}}),Frames.regtype("stepper",Frames.Stepper)}(jQuery),function($){function e(t){return function(){var e=this._inp.val();t.apply(this,arguments),this._update(),e!==this._inp.val()&&this._trigger("change")}}$.widget("ui.stepper",$.ui.buttoninput,{defaultElement:"<input>",widgetEventPrefix:"spin",options:{grid:!1,culture:null,icon:{down:"fa fa-caret-down",up:"fa fa-caret-up"},incremental:!0,max:null,min:0,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_delay:function(e,t){var i=this;return setTimeout(function(){return("string"==typeof e?i[e]:e).apply(i,arguments)},t||0)},_createInput:function(){return $("input",this.element)},_createButton:function(){return $("<span><a class='ui-spinner-up ui-corner-tr'><span class='ui-icon "+this.options.icon.up+"'></span></a><a class='ui-spinner-down ui-corner-br'><span class='ui-icon "+this.options.icon.down+"'></span></a></span>").insertAfter(this._buttonAnchor())},_create:function(){this.element.addClass("ui-stepper"),$.ui.buttoninput.prototype._create.apply(this),this._update()},_configure:function(e,t){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),this.showButton()&&(this._button=this._createButton().addClass("ui-buttoninput"),this._button.children("a").attr("tabIndex",-1).attr("aria-hidden",!0).attr("aria-disabled",!1).attr("role","button").removeClass("ui-corner-all").addClass("ui-button ui-spinner-button ui-state-default ui-button-icon"),this._buttonUp=this._button.children(".ui-spinner-up"),this._buttonDown=this._button.children(".ui-spinner-down")),""!==this.value()&&this._value(this._inp.val(),!0),$.ui.buttoninput.prototype._configure.apply(this,[e,t]),this._inp.addClass("ui-spinner-input").attr("role","spinbutton")},_getCreateOptions:function(){var a=$.ui.stepper.prototype.options,s=this.element;return $.each(["min","max","step"],function(e,t){var i=s.attr(t);null!=i&&i.length&&(a[t]=i)}),a},_events:{mouseenter:function(e){e&&e.currentTarget&&$(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){e&&e.currentTarget&&$(e.currentTarget).removeClass("ui-state-hover")},keydown:function(e){if(!this._start(e)||!this._keydown(e))return!0;e.preventDefault(),e.stopImmediatePropagation()},keyup:function(){this._stop()},focus:function(){this.previous=this.element.val()},mousewheel:function(e,t){},mousedown:function(e){e.preventDefault(),!1!==this._start(e)&&this._repeat(null,$(e.currentTarget).hasClass("ui-spinner-up")?1:-1,e)},mouseup:function(){this._stop()}},_configureEvents:function(){this._inp.on("keydown",this._events.keydown.bind(this)).on("keyup",this._events.keyup.bind(this)),this._buttonUp.on("mousedown .ui-spinner-button",this._events.mousedown.bind(this)).on("mouseenter",this._events.mouseenter.bind(this)).on("mouseleave",this._events.mouseleave.bind(this)).on("mouseup",this._events.mouseup.bind(this)),this._buttonDown.on("mousedown .ui-spinner-button",this._events.mousedown.bind(this)).on("mouseenter",this._events.mouseenter.bind(this)).on("mouseleave",this._events.mouseleave.bind(this)).on("mouseup",this._events.mouseup.bind(this))},_keydown:function(e){var t=this.options,i=$.ui.keyCode;switch(e.keyCode){case i.UP:return this._repeat(null,1,e),!0;case i.DOWN:return this._repeat(null,-1,e),!0;case i.PAGE_UP:return this._repeat(null,t.page,e),!0;case i.PAGE_DOWN:return this._repeat(null,-t.page,e),!0}return!1},_start:function(e){return!(!this.spinning&&!1===this._trigger("start",e))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(e,t,i){e=e||500,this._spin(t*this.options.step,i)},_spin:function(e,t){var i=this.value()||0;i="string"==typeof i?parseFloat(i):i,this.counter||(this.counter=1),i=this._adjustValue(i+e*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",t,{value:i})||(this._value(i),this.counter++)},_increment:function(e){var t=this.options.incremental;return t?$.isFunction(t)?t(e):Math.floor(e*e*e/5e4-e*e/500+17*e/200+1):1},_precision:function(){var e=this._precisionOf(this.options.step);return null!==this.options.min&&(e=Math.max(e,this._precisionOf(this.options.min))),e},_precisionOf:function(e){var t=e.toString(),i=t.indexOf(".");return-1===i?0:t.length-i-1},_adjustValue:function(e){var t,i,a=this.options;return i=e-(t=null!==a.min?a.min:0),e=t+(i=Math.round(i/a.step)*a.step),e=parseFloat(e.toFixed(this._precision())),null!==a.max&&e>a.max?a.max:null!==a.min&&e<a.min?a.min:e},_stop:function(e){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",e))},_setOption:function(e,t){var i,a,s;if("culture"===e||"numberFormat"===e)return i=this._parse(this._inp.val()),this.options[e]=t,void this._inp.val(this._format(i));"max"!==e&&"min"!==e&&"step"!==e||"string"==typeof t&&(t=this._parse(t)),"icon"===e&&(a=this._button.first().find(".ui-icon"),$(a).removeClass(this.options.icon.up),$(a).removeClass(t.up),s=this._button.last().find(".ui-icon"),$(s).removeClass(this.options.icon.down),$(s).addClass(this.options.icon.down))},_setOptionDisabled:function(e){this._toggleClass(this._button,null,"ui-state-disabled",!!e),this._inp.prop("disabled",!!e),this._button.children("a").button(e?"disable":"enable")},_setOptions:e(function(e){}),_parse:function(e){return Frames.isEmpty(e)?"0":e},_format:function(e){return""===e?"0":parseFloat(e)},_update:function(){this._inp.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this._inp.val())})},isValid:function(){var e=this.value();return null!==e&&e===this._adjustValue(e)},_value:function(e,t){var i;Frames.isUndef(this._inp)||(""!==e&&null!==(i=this._parse(e))&&(t||(i=this._adjustValue(i)),e=this._format(i)),this._inp.val(e),this._inp.triggerHandler("valuechange"),this._update())},_destroy:function(){this._inp.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),this._button.replaceWith(this._inp)},destroy:function(){this.element.removeClass("ui-stepper"),$.ui.buttoninput.prototype.destroy.apply(this)},stepUp:e(function(e){this._stepUp(e)}),_stepUp:function(e){this._start()&&(this._spin((e||1)*this.options.step),this._stop())},stepDown:e(function(e){this._stepDown(e)}),_stepDown:function(e){this._start()&&(this._spin((e||1)*-this.options.step),this._stop())},pageUp:e(function(e){this._stepUp((e||1)*this.options.page)}),pageDown:e(function(e){this._stepDown((e||1)*this.options.page)}),value:function(){if(!(0<arguments.length))return this._parse(this._inp.val());this._inp.val.apply(this._inp,arguments)}})}(jQuery),function($){Frames.Progressbar=$.inherit(Frames.Item,{init:function(e){Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this)},value:function(){if(!(0<arguments.length))return this._call("value");this._call("value",arguments[0])},updateValue:function(){if(!(0<arguments.length))return this._call("updateValue");this._call("updateValue",arguments[0])},ended:function(){return this._call("ended")}}),Frames.regtype("progressbar",Frames.Progressbar)}(jQuery),function($){$.widget("ui.progressbar",{options:{value:0,max:100},min:0,_create:function(){this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role:"progressbar","aria-valuemin":this.min,"aria-valuemax":this.options.max,"aria-valuenow":this._value()});var e=this.element.attr("width")&&0<this.element.attr("width").length?this.element.attr("width").replace("px",""):"0";Frames.isUndef(e)||"0"==e?this.element.css("width","100%"):this.element.width(e),this.valueDiv=$('<div class="ui-progressbar-value ui-widget-header ui-corner-left "></div>').appendTo(this.element),this.overlayDiv="",this.oldValue=this._value(),this._refreshValue()},destroy:function(){this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"),this.valueDiv.remove(),$.Widget.prototype.destroy.apply(this,arguments)},value:function(e){return 0<arguments.length?void 0===e?this._value():void this._setOption("value",e):this.options.value},updateValue:function(e){e=parseInt(e)||0;var t=this._value()+e;t>this.options.max&&(t=this.options.max),t<this.min&&(t=this.min),this.value(t)},ended:function(){return this.options.value===this.options.max},_setOption:function(e,t){"value"===e&&(this.options.value=t,this._refreshValue(),this._value()===this.options.max&&this._trigger("complete")),$.Widget.prototype._setOption.apply(this,arguments)},_value:function(){var e=this.options.value;return e=parseInt(e),isNaN(e)&&(e=0),Math.min(this.options.max,Math.max(this.min,e))},_percentage:function(){return 100*this._value()/this.options.max},_refreshValue:function(){var e=this.value(),t=this._percentage();this.oldValue!==e&&(this.oldValue=e,this._trigger("change")),this.valueDiv.attr("value",e),this.valueDiv.toggle(e>this.min).toggleClass("ui-corner-right",e===this.options.max).css("width",t.toFixed(0)+"%"),this.element.attr("aria-valuenow",e),e<0||void 0===typeof e?(this.valueDiv.css("width","100%"),this.valueDiv.css("width","100%"),this.element.addClass("ui-progressbar-indeterminate"),this.valueDiv.show(),this.overlayDiv=$("<div class='ui-progressbar-overlay' />").appendTo(this.valueDiv)):(this.element.remove("ui-progressbar-indeterminate"),this.overlayDiv instanceof jQuery&&this.overlayDiv.remove())}})}(jQuery),function($){$.widget("ui.editinput",$.ui.buttoninput,{_init:function(){return this.element.data("buttoninput",this.element.data("editinput")),this.options.action=this.element.attr("data-action"),$.ui.buttoninput.prototype._init.apply(this,arguments)},_createInput:function(){var e=$("input",this.element),t=e;return Frames.isTrue(this.options.grid)||($("<textarea></textarea>").attr("style",e.attr("style")).insertAfter(e),t=$("textarea",this.element),e.hide()),t},_create:function(){$.ui.buttoninput.prototype._create.apply(this,arguments),this.element.addClass("ui-editinput")},execaction:function(){Frames.isUndef(this.options.action)?Frames.Dialog.Edit.load():Frames.Application.elemexec(this.element)},execclick:function(){var e=this._inp;Frames.isTrue(this.options.grid)&&($("<textarea></textarea>").insertAfter(this._inp),e=$("textarea",this.element)),e.trigger(Frames.isTrue(this.options.grid)?"action":"btnclick")}}),$.ui.editinput.prototype.options=$.extend({},$.ui.buttoninput.prototype.options,{icon:"fa fa-pencil"})}(jQuery),function($){Frames.EditInput=$.inherit(Frames.ButtonInput,{editable:Frames.Item.prototype.editable,enterHasTab:function(){return!1},mapvalue:function(){return Frames.Item.prototype.mapvalue.apply(this,arguments)},clickable:function(){return!1}}),Frames.regtype("editinput",Frames.EditInput)}(jQuery),function($){Frames.FileInput=$.inherit(Frames.ButtonInput,{editable:function(){if(!(0<arguments.length))return Frames.Item.prototype.editable.apply(this);Frames.ButtonInput.prototype.editable.apply(this,arguments),Frames.Item.prototype.editable.apply(this,[!1]);var e=this._call("fileObj");Frames.isTrue(arguments[0])&&this.enabled()?(e.css("cursor","pointer"),e.removeAttr("disabled")):(e.css("cursor",""),e.attr("disabled","disbaled"))},focus:function(){this._call("focus")}}),Frames.regtype("fileinput",Frames.FileInput)}(jQuery),function($){$.widget("ui.fileinput",$.ui.buttoninput,{options:{icon:"fa fa-folder-open"},_init:function(){return this.element.data("buttoninput",this.element.data("fileinput")),$.ui.buttoninput.prototype._init.apply(this,arguments)},_create:function(){var o=this;this.file=$('<input name="file[]" type="file" class="cancel ui-fileupload" formnovalidate />'),$.ui.buttoninput.prototype._create.apply(this,arguments),this.element.addClass("ui-fileinput"),Frames.isTrue(this.element.data("multiple"))&&this.file.attr("multiple",!0);var e=this._inp.outerWidth(),t=this._inp.outerHeight();this._inp.css("display","none");var i=this.element.data("input");Frames.isUndef(i)||(this.options.input="show"==i),this._button.css("left",e).on("keydown",function(e){e.keyCode==$.ui.keyCode.ENTER&&o.file.click()});var a=$("<span></span>").insertAfter(this._inp).css({display:"inline-block",width:e,height:t,overflow:"hidden"});this._fileInput=$('<input type="text" class="filename" readonly="readonly"/>'),this._fileInput.appendTo(a).css({width:0,height:0,display:"none"}),Frames.Config.getbool("FILEBOX_INPUT",!1)?(this._fileInput.css({width:e,height:t,display:"inline-block"}),Frames.Locale.formats.IS_RTL?this.file.css("left",0):this.file.css("right",0)):this._button.removeClass("ui-corner-right").addClass("ui-corner-all").css({left:0,top:0,width:e+this._button.outerWidth(),height:t}),this.file.insertAfter(this._button).css({position:"absolute",top:0,margin:0,opacity:0,overflow:"hidden",cursor:"pointer",left:this._button.position().left,width:this._button.outerWidth(),height:this._button.outerHeight()}).attr("title",this.element.data("tooltip")).on("mouseenter",function(){o._button.addClass("ui-state-hover")}).on("mouseleave",function(){o._button.removeClass("ui-state-hover")}),this.file.change(function(){Frames.wait("uploading file...",0);var r=$(this);1==r.parent("form").length&&r.unwrap();var n=r.parent();r.appendTo(document.body),r.upload(Frames.Config.get("UPLOAD_URL"),function(e){Frames.waitEnd(),1==r.parent("form").length&&r.unwrap(),r.appendTo(n);var t=null;try{t=$.xmlToJSON(e)}catch(e){}if(null!=t&&null!=t.msg){t.id[0].Text;var i=t.msg[0].Text;Frames.Workspace&&Frames.Workspace.showMessage?Frames.Workspace.showMessage(i,"error"):Frames.StatusBar.message(i)}var a=t&&t.name?t.name[0].Text:"";o._inp.val(a),o._inp.triggerHandler("valuechange");var s=o.file.val().replace("C:\\fakepath\\","");o._fileInput.val(s),Frames.isEmpty(a)||Frames.Application.elemexec(o.element),$("input.ui-fileupload").val("")},"html")})},fileObj:function(){return this.file},destroy:function(){$.ui.buttoninput.prototype.destroy.apply(this,arguments),this.file.remove(),delete this.file},execclick:function(){},focus:function(){Frames.Config.getbool("FILEBOX_INPUT",!1)?this._inp.focus():this.buttonObj().focus()}}),delete $.ui.fileinput.prototype.options.action}(jQuery),function($){Frames.LOVInput=$.inherit(Frames.ButtonInput,{clickable:function(){return!1}}),Frames.regtype("lovinput",Frames.LOVInput)}(jQuery),function($){$.widget("ui.lovinput",$.ui.buttoninput,{_init:function(){return this.element.data("buttoninput",this.element.data("lovinput")),$.ui.buttoninput.prototype._init.apply(this,arguments)},_create:function(){$.ui.buttoninput.prototype._create.apply(this,arguments),this.element.addClass("ui-lovinput")},execclick:function(){this._inp.trigger(Frames.isTrue(this.options.grid)?"action":"btnclick")}}),$.ui.lovinput.prototype.options=$.extend({},$.ui.buttoninput.prototype.options,{action:"LIST_VALUES"})}(jQuery),function($){Frames.RadioGroup=$.inherit(Frames.TextInput,{_initUserEvents:$.noop,optmodel:function(){var e=this._call("lastClickedValue");return Frames.Model.createItem(this.member,e)},rules:function(){return null},_computeLabelPosition:function(){this._parseLabelText()},_parseLabelText:function(){this._call("parseLabels")},refresh:function(){this._call("refresh")},buttons:function(){return this._call("buttons")},name:function(){var e=Frames.Item.prototype.name.apply(this,arguments);if(0<arguments.length){var t,i=this.buttons();for(t=0,len=i.length;t<len;t++)i[t].group(arguments[0]);Frames.isTrue(this.inDesignMode)&&Frames.Designer.Dialog._dlg_radio_props.find(".pdialog-property[data-property=group] .pdialog-widget").pproperty("refresh",!0)}return e},_preModelControlInfo:function(e,t){Frames.Item.prototype._preModelControlInfo.apply(this,[e,t]),this.controlInfo(e,t,!0)},controlInfo:function(e,t,i){if(Frames.Item.prototype.controlInfo.apply(this,[e,t]),e){var a=Frames.Model.findExp(e,"item[@name="+this.member+"]");if(a){var s=a[0];if(i&&s.properties){var r="UnmatchedValueIsNull",n=Frames.Model.attr(s.properties[0],r);Frames.isUndef(n)||this.props("UnvalueIsNull",n),r="UnmatchedValue",n=Frames.Model.attr(s.properties[0],r),Frames.isUndef(n)||this.props(r,n)}var o,l=Frames.Model.findExp(s,"buttons/button");if(l&&0<l.length)for(o=0;o<l.length;o++){var d=l[o];if(d.properties){var u=Frames.Model.attr(d,"name"),c=Frames.Model.attr(d,"index");$.isNumeric(c)&&(c=parseInt(c,10));var p=this._call("get",u);if(!Frames.isUndef(p)&&0!==p.length||Frames.isUndef(c)||(p=this._call("get",c)),!Frames.isUndef(p)&&0!==p.length){if(!$.isNumeric(c)){var m=p.parent();c=m.parent().children("div").index(m)}if($.isNumeric(c)&&-1!=c){var h=d.properties[0];if(Frames.isTrue(i))this._call("props",c,d.properties[0]);else{var f=Frames.Model.attr(h,"Enabled");Frames.isUndef(f)||this._call("enable",c,Frames.isTrue(f)),f=Frames.Model.attr(h,"Visible"),Frames.isUndef(f)||this._call("visible",c,Frames.isTrue(f)),f=Frames.Model.attr(h,"Label"),Frames.isUndef(f)||this._call("labelbutton",c,f)}}}}}}}},clickable:function(){return!0},mapvalue:function(){return this._call("mapvalue",arguments[0])},dataModel:function(e){for(var t=[],i=this.buttons(),a=0,s=i.length;a<s;a++){var r=i[a];if(!Frames.isTrue(e)||Frames.isTrue(r.visible())){var n={};n.value=r.value(),n.label=r.label(),t.push(n)}}return t},editable:function(){var e=this.buttons(),t=0<arguments.length&&Frames.isTrue(arguments[0]);if(Frames.isUndef(e.jquery)){var i;for(i=e.length-1;0<=i;i--){var a=e[i];0<arguments.length?a.editable(t):t=t||a.editable()}return t}},_populateList:function(e){var t=this,i=this.buttons();e.children().remove(),t._CTX_=new Frames.HashMap,$.each(i,function(){t._CTX_.put("item"+e.get(0).options.length,this),t._newoption(e,this.name(),this.name(),this)})},_newoption:function(e,t,i,a){var s=new Option(Frames.isUndef(t)&&$.browser.mozilla?"":t,Frames.isUndef(i)&&$.browser.mozilla?"":i);if(e.get(0)){var r=e.get(0).options;r[r.length]=s,$(r[r.length]).data("props",a)}},design_create_children:function(){var e;for(e in this.buttons()){var t=this.buttons()[e];Frames.Designer.add({type:"radiobox",name:t.rbName,label:Frames.isUndef(t.labelObj())?null:t.label(),labeloffset:Frames.isUndef(t.labelObj())?null:t.props("LabelOffset"),labelposition:Frames.isUndef(t.labelObj())?null:t.props("LabelPosition"),top:t.elem.prop("style").top,left:t.elem.prop("style").left,container:Frames.Designer.toXPath(this.elem),framesClass:t.data("class"),ns:null});var i=this.elem.data("name");Frames.Designer.update(Frames.Designer.toXPath(t.elem),"group",i)}},dvalue:$.noop,_applyAutoskip:$.noop,api_mouse_target:function(e){return Frames.isUndef(e)&&(e=0),this.buttons()[e].elem.find("button")}}),Frames.regtype("radiogroup",Frames.RadioGroup)}(jQuery),function($){$.widget("ui.radiogroup",{version:"@VERSION",options:{clickModel:"action"},_create:function(){var t=this;this.element.addClass("ui-radiogroup ui-widget").attr("role","radiogroup"),this._input=$('<input id="'+this.element.attr("id")+'_inp" style="visibility: hidden; width: 1px; height: 1px; border: none !important;" />'),this._input.appendTo(this.element),this._input.data("frames",this),this._lbl=$("> label",this.element),this._lbl.attr("aria-hidden",!0),this._lbl.attr("id","l:"+this.element.attr("id")),this.element.attr("aria-labelledby",this._lbl.attr("id")),this.element.bind("action",function(e){Frames.isUndef(t._last_button)||t._last_button.trigger("action",e)}),this.refresh()},fixpositions:function(){},refresh:function(){var o=this,l=o.element.data("name");this._radios=[];var e=$(".ui-radiobox").has("input[name="+l+"]").add("> .ui-radiobox",this.element);0===$("> .ui-radiobox",this.element).length&&this.element.addClass("hidden");var d=[];e.each(function(e){var t=$(this),i=new Frames.RadioBox(t),a=t.find("label");if(i.rbName=l,o._radios.push(i),!(0<t.find("button").length)){var s=t.children("input").attr("name",l).hide(),r=s.attr("id");Frames.isUndef(r)&&(r=Frames.uuid(),s.attr("id","#"+r),a.attr("id","#"+r)),t.addClass("ui-radiobox"),t.attr("aria-hidden",!0);var n=$('<button id="'+(s.parent().data("name")||s.attr("id"))+'_btn" type="button"></button>').insertAfter(s).button({icon:"ui-icon-none",text:!1}).attr("role","radio").attr("aria-labelledby",a.attr("id")).click($.proxy(o._clickHandler,o)).bind("action",$.proxy(o._toggleValue,o)).bind("keydown.nav",$.proxy(o._keydownHandler,o));n.removeAttr("title"),d.push(n.attr("id"))}}),this.element.attr("aria-owns",d.join(" ")),this._inp=this.element.find("button"),this._inp.bind(Frames.Repeater.EVENTS.join(" "),function(e){return o._input.eq(0).triggerHandler(e)})},_keydownHandler:function(e){if(e.keyCode===$.ui.keyCode.LEFT||e.keyCode===$.ui.keyCode.RIGHT){if(!1===$(e.currentTarget).data("editable"))return!1;e.preventDefault(),e.stopImmediatePropagation();var t=e.keyCode===$.ui.keyCode.LEFT?-1:1,i=this._focusedOrFirst(),a=this._inp.index(i);if(0<=(a+=t)&&a<this._inp.length){if("disabled"===(s=this._inp.eq(a)).attr("disabled")){if(s.attr("aria-disabled",!0),!(0<=(a+=t)&&a<this._inp.length))return!1;var s=this._inp.eq(a)}this.selected(s),s.focus(),this.input().triggerHandler("valuechange"),Frames.Application.elemexec(this.element)}return!1}},_clickHandler:function(e){!1!==$(e.currentTarget).data("editable")&&(this._last_button=$(e.currentTarget),"standalone"===this.options.clickModel&&this.element.trigger("action"))},lastClickedValue:function(){var e="";if(!Frames.isUndef(this._last_button)){var t=this._last_button.parent().find("input");e=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(t.data("valueisnull"))?null:t.val()}return e},_toggleValue:function(e){var t=$(e.currentTarget);if(!1!==t.data("editable")){var i=this.selected();i&&i[0]!==t[0]&&(this.selected(t),this.input().triggerHandler("valuechange"),Frames.Application.elemexec(this.element)),e.stopImmediatePropagation()}return!1},get:function(i){return"string"!=typeof i?this._inp.eq(i):this._inp.filter(function(e){var t=$(this).attr("data-name");return Frames.isUndef(t)?$(this).attr("id")==i+"_btn":$(this).attr("data-name")==i})},selected:function(){var e;if(!(0<arguments.length))return e=this._inp.filter(function(e){return"checked"===$(this).attr("state")});if(e=arguments[0],this._inp.button("option",{icon:"ui-icon-none"}).attr("state","").attr("aria-checked","false"),this._inp.each(function(e){var t=$(this).parent();t.find("input").prop("checked",null),t.find("button").attr("state","unchecked")}),e){e.button("option",{icon:"fa fa-circle"}).attr("state","checked").attr("aria-checked","true"),e.parent().find("input").prop("checked","checked");var t=e.parent().find("input").val();this._input.val(t)}},_selectedOrFirst:function(){var e=this.selected();return 0<e.length?e:this._inp.eq(0)},_focusedOrFirst:function(){var e=this._inp.filter(":focus");return 0<(e=0<e.length?e:this.selected()).length?e:this._inp.eq(0)},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-radiogroup ui-widget"),this._inp.data("frames",null),this._inp.remove(),$("input",this.element).show(),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this._inp.data("frames",e),this._input.data("frames",e)},input:function(){return this._input},framesObj:function(){return this.input().data("frames")},__match:function(e){var i=Frames.isUndef(e)?e:String(e).toUpperCase();return this._inp.filter(function(e){var t=$(this).parent().find("input");return Frames.isTrue(t.data("valueisnull"))?Frames.isTrue(Frames.Application._supportnulls)&&null===i:String(t.val()).toUpperCase()===i})},mapvalue:function(e){if(!Frames.Config.getbool("MAPVALUES_ENABLED",!0))return e;var t=Frames.isUndef(e)?e:String(e).toUpperCase(),i=this.__match(t);if(0===i.length){var a=this.framesObj(),s=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(a.props("unvalueisnull")),r=s?null:a.props("unvalue");if(void 0!==r){var n=s?r:String(r).toUpperCase();e=0<(i=this.__match(n)).length?r:void Frames.Log.error("Couldn't match value.")}}return e},value:function(){var e,t=this.framesObj(),i=Frames.Application.current(),a=t&&t.block?t.block:i?i.block:void 0,s=!Frames.isUndef(a)&&"SEARCH"==a.props("blockMode");if(!(0<arguments.length)){e="",s&&(e=this.input().val());var r=this.selected();if(0!==r.length){var n=r.parent().find("input");e=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(n.data("valueisnull"))?null:n.val()}return e}if(e=arguments[0],s){var o=this.__match(e);this.selected(0<o.length?o:void 0),this.input().val(e)}else{var l=this.__match(e);if(0===l.length){if(void 0===(e=this.mapvalue(e)))return;l=this.__match(e)}this.selected(l)}},parseLabels:function(){this._inp.each(function(e){var t=$(this).parent().find("label"),i=t.text(),a=i.indexOf("&");if(-1!=a){var s=i.substr(a+1,1);" "!==s&&(i=i.split("&"+s).join("<u>"+s+"</u>"),t.html(i))}})},props:function(e,t){if(t&&!Frames.isUndef(e)){var i=this.get(e).parent().find("input");if(0<i.length){var a=Frames.Model.attr(t,"ValueIsNull");Frames.isUndef(a)||i.data("valueisnull",a),a=Frames.Model.attr(t,"Value"),Frames.isUndef(a)||i.val(a)}}},labelObj:function(){return 0<this._lbl.length?this._lbl:null},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},focus:function(){Frames.isUndef(this._inp)||this._selectedOrFirst().eq(0).focus()},visible:function(e,t){var i=this.get(e);Frames.isTrue(t)?i.parent().show():i.parent().hide()},enable:function(e,t){var i=this.get(e).parent();i.children().attr("disabled",!Frames.isTrue(t)),Frames.isTrue(t)?i.removeClass("ui-state-disabled"):i.addClass("ui-state-disabled")},buttons:function(){if(!(0<arguments.length))return this._radios},labelbutton:function(e,t){var i=this.get(e).parent().find("label");if(Frames.isUndef(t))return i.html();i.html(t)}})}(jQuery),function($){Frames.RadioBox=$.inherit(Frames.Item,{__constructor:function(e){this.rbName="",this.div=e,this.elem=e,this.elem.attr("data-widget","radiobox"),Frames.isUndef(this.div),this.member=e.data("member")},name:function(){this.div.data("name");if(!(0<arguments.length))return this.div.data("name");this.div.data("name",arguments[0])},value:function(){var e=this.div.find("input");if(!(0<arguments.length)){var t=e.val();return Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(e.data("valueisnull"))&&(t=null),t}e.val(arguments[0])},label:function(){var e=this.elem.find("label");if(!(0<arguments.length))return e.text();e.text(arguments[0])},group:function(){var e=$("> input",this.elem);if(0===arguments.length)return e.attr("name");e.attr("name",arguments[0])},labelObj:function(){var e=this.elem.find("label");if(!(0<arguments.length))return e},x:function(){if(!(0<arguments.length))return this.div.position().left;this.div.css("left",arguments[0]+"px")},y:function(){if(!(0<arguments.length))return this.div.position().top;this.div.css("top",arguments[0]+"px")},editable:function(){if(!(0<arguments.length))return!1!==$(".ui-button",this.elem).data("editable");var e=Frames.isTrue(arguments[0]),t=$(".ui-button",this.elem);t.data("editable",e),e?t.removeAttr("readonly"):t.attr("readonly","readonly")}}),Frames.regtype("radiobox",Frames.RadioBox)}(jQuery),jQuery.widget("ui.radiobox",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-radiobox ui-widget")}}),function($){Frames.FramePanel=$.inherit(Frames.Canvas,{init:function(e){Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this),this._computeLabelStyle()},labelObj:function(){return this._call("labelObj")},label:function(){if(!(0<arguments.length))return this._call("label");this._call("label",arguments[0]),this._computeLabelStyle()}}),Frames.regtype("framepanel",Frames.FramePanel)}(jQuery),function($){$.widget("ui.framepanel",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-framepanel ui-widget"),this._lbl=this.element.children("legend"),0<this._lbl.length&&Frames.isEmpty(this._lbl.text())&&(this._lbl.addClass("empty"),this.element.addClass("ui-nolegend")),0===this.element.children(".ui-framepanel-content").length&&this.element.children().not("legend").wrapAll('<div class="ui-framepanel-content"></div>');var e=this.element.find(".ui-framepanel-content").children();(e.is(".ui-layout-grid")||e.is(".ui-layout-gridflow"))&&this.element.addClass("ui-panel-layout-grid")},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-framepanel ui-widget"),delete this._lbl,this.element.children().not("legend").unwrap()},wrapper:function(e){},input:function(){return this.element},value:function(){},labelObj:function(){return this._lbl},label:function(){if(!(0<arguments.length))return this.labelObj().text();this.labelObj().text(arguments[0])},focus:function(){this.element.focus()}})}(jQuery),function($){Frames.TabPanel=$.inherit(Frames.Canvas,{init:function(e){Frames.Canvas.prototype.init.apply(this,[e]),this.root=this._call("wrapperObj")||this.elem;var t=this.elem.data("eventchange");Frames.isUndef(t)||this.elem.data("action",t),$(this).on("aftershow",$.proxy(this.onAfterShow,this))},destroy:function(){$(this).off("aftershow","**")},onAfterShow:function(e){this._call("refreshTabs",!1);var t=$("> .ui-tabs-nav > li.ui-tabs-active",$(this.elem));t.parent().is(":visible")&&Frames.arianotify(t.children("a").text())},controlInfo:function(){var e,t;if(Frames.Canvas.prototype.controlInfo.apply(this,arguments),!(0<arguments.length))return e=this._call("selected"),t=this._call("get",e).data("name"),Frames.Model.create("canvas",void 0,{name:this.name,tabPage:t});var i=arguments[0],a=Frames.Model.findExp(i,"canvas[@name="+this.name+"]");if(a){i=a[0];var s=Frames.Model.attr(i,"tabPage");Frames.isUndef(s)||(e=this._call("get",s).index()-1,this._call("enabled",e)?this._call("selected",e):(this._call("enabled",e,!0),this._call("selected",e),this._call("enabled",e,!1)));var r,n=Frames.Model.findExp(i,"pages/page");if(n&&0<n.length)for(r=0;r<n.length;r++){var o=n[r];if(t=Frames.Model.attr(o,"name"),0<=(e=this._call("get",t).index()-1)&&o.properties){var l=o.properties[0],d=Frames.Model.attr(l,"Enabled");Frames.isUndef(d)||this._call("enabled",e,Frames.isTrue(d)),d=Frames.Model.attr(l,"Visible"),Frames.isUndef(d)||this._call("visible",e,Frames.isTrue(d)),d=Frames.Model.attr(l,"Title"),Frames.isUndef(d)||this._call("label",e,d),d=Frames.Model.attr(l,"Label"),Frames.isUndef(d)||this._call("label",e,d)}}}},selected:function(){if(0<arguments.length){var e=arguments[0];return this._call("selected",e)}return this._call("selected")},tabenabled:function(e,t){if(Frames.isTrue(this.inDesignMode)){var i=$("> .ui-tabs-panel",$(this.elem)).eq(e),a=$("> ul.ui-tabs-nav > li",$(this.elem)).eq(e);if(void 0===t)return void 0===i.data("x-design-enabled")||i.data("x-design-enabled");Frames.isTrue(t)?(i.removeClass("ui-state-disabled").data("x-design-enabled",!0),a.removeClass("ui-state-disabled")):(i.addClass("ui-state-disabled").data("x-design-enabled",!1),a.addClass("ui-state-disabled"))}else{if(void 0===t)return this._call("enabled",e);this._call("enabled",e,t)}},tabvisible:function(e,t){if(Frames.isTrue(this.inDesignMode)){var i=$("> .ui-tabs-panel",$(this.elem)).eq(e),a=$("> ul.ui-tabs-nav > li",$(this.elem)).eq(e);if(void 0===t)return void 0===i.data("x-design-visible")||i.data("x-design-visible");Frames.isTrue(t)?(i.removeClass("ui-designer-invisible").data("x-design-visible",!0),a.removeClass("ui-designer-invisible")):(i.addClass("ui-designer-invisible").data("x-design-visible",!1),a.addClass("ui-designer-invisible"))}else{if(void 0===t)return this._call("visible",e);this._call("visible")}},tablabel:function(e,t){if(void 0===t)return this._call("label",e);this._call("label",e,t)},_initUserEvents:$.noop}),Frames.regtype("tabpanel",Frames.TabPanel),Frames.TabPanel.TabItemContext=$.inherit(Frames.Item,{__constructor:function(e,t){this._tabpanel=e,this.elem=this._elem=$(t)},labelObj:function(){if(Frames.isTrue(this._tabpanel.inDesignMode))return this.elem},label:function(){var e=$("> .ui-tabs-panel",this.elem.parent()).index(this.elem);if(0===arguments.length)return this._tabpanel.tablabel(e);this._tabpanel.tablabel(e,arguments[0])},enabled:function(){var e=$("> .ui-tabs-panel",this.elem.parent()).index(this.elem);if(0===arguments.length)return this._tabpanel.tabenabled(e);this._tabpanel.tabenabled(e,Frames.isTrue(arguments[0]))},visible:function(){var e=$("> .ui-tabs-panel",this.elem.parent()).index(this.elem);if(0===arguments.length)return this._tabpanel.tabvisible(e);this._tabpanel.tabvisible(e,Frames.isTrue(arguments[0]))},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1,caseRestriction:!1}}},designprops:function(e){return delete e.general.properties.position,delete e.general.properties.size,delete e.general.properties.font,delete e.general.properties.style,delete e.general.properties.menu,delete e.data,delete e.validation,e},_initUserEvents:$.noop})}(jQuery),function($){$.widget("ui.tabpanel",{version:"@VERSION",options:{scrollable:!0},_create:function(){var i=this,e=this.element[0].style.position;this.element.css("position","relative"),this.element.tabs({scrollable:this.options.scrollable,active:0,beforeActivate:$.proxy(this._selectHandler,this),activate:$.proxy(this._activateHandler,this),icons:this.options.icons,text:this.options.text,isRTL:Frames.Locale.formats.IS_RTL}),this.id=this.element.attr("id")||Frames.uuid();var a=$("> .ui-tabs-nav",this.element).attr("role","tablist").attr("aria-multiselectable","true");$("> li",a).attr("role","presentation").find("> a").attr("role","tab").on("dragstart",function(e){return!1}),this.element.on("keyup",function(e){if((48<e.keyCode&&e.keyCode<57||96<e.keyCode&&e.keyCode<105)&&e.shiftKey&&e.ctrlKey){var t=parseInt(String.fromCharCode(e.keyCode),10);$.isNumeric(t)&&(t=i.element.find(".ui-tabs-nav > li:visible").eq(t-1).index(),i.element.tabs("option","active",t))}}),this.element.css("position",e),this.element.addClass("ui-tabpanel ui-widget"),this.element.children(".ui-tabs-panel").each(function(e){var t=a.find("> li").eq(e);t.find("a").attr("id",i.id+"_tab"+e).attr("tabindex","-1"),i._initPanel(this,t)});var t=i.element.children(".ui-tabs-panel:eq(0)").attr("class");if(i._layout_match=void 0!==t?t.match(/(?:\s+|^)(ui-layout-\w+)(?:\s+|$)/):void 0,this.element.bind("tabsadd",function(e,t){i._layout_match&&($(t.panel).css("position","relative"),$(t.panel).addClass(i._layout_match[1])),$(t.tab).text($(t.tab).text()),i._initPanel(t.panel,t.tab),i._refresh()}),this._initializing=!0,this._last_idx=0,this.$wrapper=this.element,this.element.parent().is(".ui-scrollable-tabs")){this.$wrapper=this.element.parent();var s=this.$wrapper[0],r=this.element[0];s.style.top=r.style.top,s.style.left=r.style.left,s.style.right=r.style.right,s.style.bottom=r.style.bottom,s.style.width=r.style.width,s.style.height=r.style.height,"none"==r.style.display&&(s.style.display=r.style.display,r.style.display=""),r.style.top="",r.style.left="",r.style.right="",r.style.bottom="",r.style.width="",this.$wrapper.parent().hasClass("ui-layout-positional")?r.style.height="100%":r.style.height="",r.style.position=""}this._refresh(),this._resizeTabpanel=function(){i.refreshTabs()},this.element.on("resize.tabpanel",this._resizeTabpanel),delete this._initializing},_refresh:function(){if(!this._layout_match&&this.element.css("height")){var e=this.element.children(".ui-tabs-panel"),t=this.element.height(),i=Math.max.apply(Math,e.filter(":visible").map(function(){return $(this).width()}).get());this.element.children().not(e).each(function(){t-=$(this).outerHeight(!0)}),e.each(function(){var e=$(this);e.height(Math.max(0,t-e.innerHeight()+e.height())),e.width(i)}).css("overflow","auto")}},_initPanel:function(e,t){var i=$(e),a=$(t);Frames.isUndef(i.data("name"))&&i.data("name",i.attr("id")),Frames.Config.getbool("DEFERRED_INITIALIZATION",!1)&&Frames.deferred($.proxy(this._deferredInitializing,e));var s=i.attr("id"),r=a.children("a").attr("id");i.attr("aria-labelledby",r).attr("role","tabpanel"),a.children("a").attr("aria-controls",s)},_deferredInitializing:function(){var e=$(this),t=$(e).data("deferred");Frames.isUndef(t)&&(Frames.repaint(e,!0),$(e).data("deferred",!0))},_selectHandler:function(e,t){if(!Frames.validate(void 0,{block:{}}))return!1;if(Frames.isUndef(this._disableChange)){if(this._tab_idx=t.newTab.index(),!Frames.inDesignMode&&!Frames.Application.executing()&&Frames.Application.valexec(this.element.data("action")))return!1;delete this._tab_idx}},_activateHandler:function(e,t){var i=t.newTab.index();if(!Frames.isUndef(this._last_idx)&&this._last_idx!==i&&(this.get(this._last_idx).trigger("tabhide"),this._last_idx=i,this.get(i).trigger("tabshow"),Frames.isUndef(this._tab_idx)&&Frames.isUndef(this._initializing))){var a=t.newPanel,s=a.data("initialized");Frames.isUndef(s)&&(Frames.repaint(a),a.data("initialized",!0)),a.is(":visible")&&this.element.triggerHandler("frames:show",{container:a})}},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.off("resize.tabpanel"),this.element.off("keyup"),this.element.removeClass("ui-tabpanel ui-widget"),this.element.data("frames",null)},refreshTabs:function(e){this.options.scrollable&&this.element.tabs("redraw",e)},wrapper:function(e){this.element.data("frames",e)},wrapperObj:function(){return this.$wrapper},input:function(){return this.element},value:function(){},labelObj:function(){return null},label:function(e,t){var i=this.element.children("ul").children("li").eq(e).find("a");if(Frames.isUndef(t))return i.html();i.html(t)},focus:function(){this.element.focus()},selected:function(){var e=this.element.tabs("option","active");if(!(0<arguments.length))return Frames.isUndef(this._tab_idx)||(e=this._tab_idx,delete this._tab_idx),e;arguments[0]!==e&&(this._disableChange=!0,this.element.tabs("option","active",arguments[0]),delete this._disableChange),$("> .ui-tabs-nav > li",this.element).each(function(){var e=$(this);e.hasClass("ui-tabs-active")?Frames.isTrue(e.children("a").attr("aria-selected"))||(e.children("a").attr("aria-selected","true"),e.parent().is(":visible")&&Frames.arianotify(e.children("a").text())):e.children("a").attr("aria-selected","false")})},get:function(t){var e=this.element.children(".ui-tabs-panel");return"string"==typeof t?e.filter(function(e){return $(this).data("name")===t}):e.eq(t)},enable:function(e,t){this.element.tabs(Frames.isTrue(t)?"enable":"disable",e)},enabled:function(e,t){if(void 0===t)return $("> ul.ui-tabs-nav > li",this.element).eq(e).is(":not(.ui-state-disabled)");this.enable(e,t);var i=$("> .ui-tabs-panel",$(this.element)).eq(e),a=$("> ul.ui-tabs-nav > li",$(this.element)).eq(e);Frames.isTrue(t)?(i.removeClass("ui-state-disabled"),a.removeClass("ui-state-disabled")):(i.addClass("ui-state-disabled"),a.addClass("ui-state-disabled"))},visible:function(e,t){var i=this.element.children("ul").children("li").eq(e);Frames.isTrue(t)?i.show():i.hide()}})}(jQuery),function($){Frames.CollapsiblePanel=$.inherit(Frames.FramePanel,{init:function(){!Frames.isUndef(this.elem)&&this.elem.jquery&&(this.elem.children("div:first").data("initialized",!0),Frames.repaint(this.elem.children("div:first"),!1))},show:function(e){this._call("show")},toggle:function(){this._call("toggle")},headers:function(){return this.elem.children().find(".ui-collapsiblepanel-header")}}),Frames.regtype("collapsiblepanel",Frames.CollapsiblePanel),Frames.Application.registerActionHandler("PanelAction",function(e){if("FRAMES:PANEL_TOGGLE"==e.name){var t=Frames.Application.current();if(!Frames.isUndef(t)){var i=t.bindable().elem.closest(".ui-accordion-widget, .ui-collapsiblepanel").data("frames");Frames.isUndef(i)||i.toggle()}}}),Frames.ready(function(){Frames.Config.regaction({name:"FRAMES:PANEL_TOGGLE",accesskey:"CTRL+SHIFT+E",type:"PanelAction"})})}(jQuery),function($){$.widget("ui.collapsiblepanel",{version:"@VERSION",options:{hide:{effect:"blind",duration:400},show:{effect:"blind",duration:400}},_create:function(){var t=this;this._lbl=this.element.children("h3").addClass("ui-collapsiblepanel-header ui-helper-reset ui-state-default ui-state-active ui-corner-top"),0<this._lbl.length&&Frames.isEmpty(this._lbl.text())&&(this._lbl.addClass("empty"),this.element.addClass("ui-nolegend")),this.element.children().wrapAll('<div class="ui-collapsiblepanel-child"></div>'),this._widget=this.element.children().first(),this._div=this._widget.children("div").removeClass("ui-collapsiblepanel-content"),this._div.wrap('<div class="ui-collapsiblepanel-content ui-widget-content ui-collapsiblepanel-content-active"></div>'),this._content=this._div.parent(),this._lbl.append('<span class="ui-icon fa fa-caret-down"></span>'),this._widget.data("frames",this);var e=this.element.attr("id")+"_content";this._lbl.attr("role","tab").attr("aria-expanded","true").attr("aria-selected","true").attr("aria-controls",e).attr("tabindex",0),this._widget.attr("role","tablist"),this._content.attr("role","tabpanel").attr("id",e),$(this._lbl).click(function(){t.toggle()}),this.element.parents(".ui-tabpanel").bind("frames:show",function(e){t._content.is(":visible")&&t.element.triggerHandler("frames:show",{container:t._content})})},_show:function(e,t){$(e).show(this.options.show.effect,this.options,this.options.show.duration,t)},_hide:function(e,t){$(e).hide(this.options.hide.effect,this.options,this.options.hide.duration,t)},show:function(){if(!this._content.is(":visible")){var e=$.fx.off;$.fx.off=!0,this.toggle(),$.fx.off=e}},toggle:function(){var t=this;t._content.is(":visible")?t._hide(t._content,function(){var e=$(this);e.prev().removeClass("ui-state-active"),e.removeClass("ui-collapsiblepanel-content-active").hide(),e.prev().find(".ui-icon").removeClass("fa fa-caret-down").addClass("fa fa-caret-right"),e.prev().attr("aria-expanded","false"),e.prev().attr("aria-selected","false"),e.prev().attr("tabindex",-1),e.prev().focus(),t.element.triggerHandler("frames:hide",{container:e})}):t._show(t._content,function(){var e=$(this);e.prev().addClass("ui-state-active"),e.addClass("ui-collapsiblepanel-content-active").show().focus(),e.prev().find(".ui-icon").removeClass("fa fa-caret-right").addClass("fa fa-caret-down"),e.prev().attr("aria-expanded","true"),e.prev().attr("aria-selected","true"),e.prev().attr("tabindex",0),e.prev().focus(),Frames.isTrue(e.data("initialized"))?t.element.triggerHandler("frames:show",{container:e}):(Frames.repaint(e,!1),e.data("initialized",!0))})},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-collapsiblepanel ui-widget"),delete this._lbl},wrapper:function(e){},input:function(){return this.element},value:function(){},labelObj:function(){return this._lbl},label:function(){if(!(0<arguments.length))return this.labelObj().text();this.labelObj().contents()[0].textContent=arguments[0]},focus:function(){this.element.focus()}})}(jQuery),function($){Frames.ColorPicker=$.inherit(Frames.ButtonInput,{rgbToHex:function(e){if(!e||""===e)return"";var t=/^r([0-9]*)g([0-9]*)b([0-9]*)$/i.exec(e);return t?"#"+((1<<24)+(parseInt(t[1])<<16)+(parseInt(t[2])<<8)+parseInt(t[3])).toString(16).slice(1):e},hexToRgb:function(e){if(!e||""===e)return"";var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);if(!t)return e;var i=parseInt(t[1],16),a=parseInt(t[2],16),s=parseInt(t[3],16);return t?"r"+i+"g"+a+"b"+s:null}}),Frames.regtype("colorpicker",Frames.ColorPicker)}(jQuery),function($){$.widget("ui.colorpicker",$.ui.buttoninput,{options:{icon:"fa fa-eyedropper"},_init:function(){return this.element.data("buttoninput",this.element.data("colorpicker")),$.ui.buttoninput.prototype._init.apply(this,arguments)},_create:function(){$.ui.buttoninput.prototype._create.apply(this,arguments),this.element.addClass("ui-colorpicker");var t=this;this._inp.colorPicker({showOn:"button",useRgbFormat:!0}),this._inp.on("change.color",function(){$(this).triggerHandler("valuechange")}),this._hide_picker=function(e){t._inp.colorPicker("hidePalette")},document.addEventListener("scroll",this._hide_picker,!0),$(window).on("resize",this._hide_picker)},execclick:function(){this._inp.colorPicker("showPalette")},value:function(){var e=this._inp.val();return this._button.css("background",Frames.ColorPicker.prototype.rgbToHex(e)),this._inp.val.apply(this._inp,arguments)},destroy:function(){$.ui.buttoninput.prototype.destroy.apply(this,arguments),$(window).off("resize",this._resize_fn),document.removeEventListener("scroll",this._scroll_fn,!0),this._inp.colorPicker("destroy")}})}(jQuery),function($,e){var r=0,t=window.navigator.userAgent,c=0<t.indexOf("MSIE "),p=c?"-ie":"",l=(!c&&(/mozilla/.test(t.toLowerCase())&&/webkit/.test(t.toLowerCase())),[]),d=["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],u=["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada","d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5","bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f","a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09","7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"],m=["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],h=[["003366","336699","3366cc","003399","000099","0000cc","000066"],["006666","006699","0099cc","0066cc","0033cc","0000ff","3333ff","333399"],["669999","009999","33cccc","00ccff","0099ff","0066ff","3366ff","3333cc","666699"],["339966","00cc99","00ffcc","00ffff","33ccff","3399ff","6699ff","6666ff","6600ff","6600cc"],["339933","00cc66","00ff99","66ffcc","66ffff","66ccff","99ccff","9999ff","9966ff","9933ff","9900ff"],["006600","00cc00","00ff00","66ff99","99ffcc","ccffff","ccccff","cc99ff","cc66ff","cc33ff","cc00ff","9900cc"],["003300","009933","33cc33","66ff66","99ff99","ccffcc","ffffff","ffccff","ff99ff","ff66ff","ff00ff","cc00cc","660066"],["333300","009900","66ff33","99ff66","ccff99","ffffcc","ffcccc","ff99cc","ff66cc","ff33cc","cc0099","993399"],["336600","669900","99ff33","ccff66","ffff99","ffcc99","ff9999","ff6699","ff3399","cc3399","990099"],["666633","99cc00","ccff33","ffff66","ffcc66","ff9966","ff6666","ff0066","d60094","993366"],["a58800","cccc00","ffff00","ffcc00","ff9933","ff6600","ff0033","cc0066","660033"],["996633","cc9900","ff9900","cc6600","ff3300","ff0000","cc0000","990033"],["663300","996600","cc3300","993300","990000","800000","993333"]],n="#0000ffff",i=function(e){var t=e.toString(16);return 1==t.length&&(t="0"+t),t},s=function(e){return i(Number(e))},f=function(e){var t=i(e);return t+t+t},o=function(e){if(10<e.length){var t=1+e.indexOf("("),i=e.indexOf(")"),a=e.substring(t,i).split(",");return["#",s(a[0]),s(a[1]),s(a[2])].join("")}return e};$.widget("evol.colorPicker",{version:"3.2.1",options:{color:null,showOn:"button",hideButton:!1,displayIndicator:!0,transparentColor:!1,history:!0,useRgbFormat:!1,isRTL:!1,hijackPositionLogic:!0,defaultPalette:"theme",strings:"Theme Colors,Standard Colors,Web Colors,Theme Colors,Back to Palette,History,No history yet."},_active:!1,_create:function(){var i=this;switch(this._paletteIdx="theme"==this.options.defaultPalette?1:2,this._id="evo-cp"+r++,this._enabled=!0,this.options.showOn=this.options.hideButton?"focus":this.options.showOn,this.element.get(0).tagName){case"INPUT":var e=this.options.color,t=this.element;this.options.showOn,this.options.hideButton;if(this._isPopup=!0,(this._palette=null)!==e)t.val(e);else{var a=t.val();""!==a&&(e=this.options.color=a)}e===n?" evo-transparent":null!==e?"background-color:"+e:"",t.addClass("colorPicker "+this._id).on("keyup onpaste",function(e){var t=$(this).val();t!=i.options.color&&i._setValue(t,!0)});var s=this.options.showOn;"both"!==s&&"focus"!==s||t.on("focus",function(){i.showPalette()}),"both"!==s&&"button"!==s||t.next().on("click",function(e){e.stopPropagation(),i.showPalette()});break;default:this._isPopup=!1,this._palette=this.element.html(this._paletteHTML()).attr("aria-haspopup","true"),this._bindColors()}e&&this.options.history&&this._add2History(e)},_paletteHTML:function(){var e=this._paletteIdx=Math.abs(this._paletteIdx),t=this.options,i=t.strings.split(","),a='<div class="evo-pop'+p+' ui-widget ui-widget-content ui-corner-all"'+(this._isPopup?' style="position:absolute"':"")+"><span>"+this["_paletteHTML"+e]()+'</span><div class="evo-more"><a href="javascript:void(0)">'+i[1+e]+"</a>";return t.history&&(a+='<a href="javascript:void(0)" class="evo-hist">'+i[5]+"</a>"),a+="</div>",t.displayIndicator&&(a+=this._colorIndHTML(this.options.color)+this._colorIndHTML("")),a+="</div>"},_colorIndHTML:function(e){var t=c?"evo-colorbox-ie ":"",i="";return e?e===n?t+="evo-transparent":i="background-color:"+e:i="display:none",'<div class="evo-color" style="float:left"><div style="'+i+'" class="'+t+'"></div><span>'+(e||"")+"</span></div>"},_paletteHTML1:function(){for(var e=this.options,t=e.strings.split(","),i='<td style="background-color:#',a=c?'"><div style="width:2px;"></div></td>':'"><span/></td>',s='<tr><th colspan="10" class="ui-widget-content">',r='<table class="evo-palette'+p+'">'+s+t[0]+"</th></tr><tr>",n=0;n<10;n++)r+=i+d[n]+a;for(r+="</tr>",c||(r+='<tr><th colspan="10"></th></tr>'),r+='<tr class="top">',n=0;n<10;n++)r+=i+u[n]+a;for(var o=1;o<4;o++)for(r+='</tr><tr class="in">',n=0;n<10;n++)r+=i+u[10*o+n]+a;for(r+='</tr><tr class="bottom">',n=40;n<50;n++)r+=i+u[n]+a;for(r+="</tr>"+s,e.transparentColor&&(r+='<div class="evo-transparent evo-tr-box"></div>'),r+=t[1]+"</th></tr><tr>",n=0;n<10;n++)r+=i+m[n]+a;return r+="</tr></table>"},_paletteHTML2:function(){for(var e,t,i='<td style="background-color:#',a=c?'"><div style="width:5px;"></div></td>':'"><span/></td>',s='<table class="evo-palette2'+p+'"><tr>',r="</tr></table>",n='<div class="evo-palcenter">',o=0,l=h.length;o<l;o++){n+=s;var d=h[o];for(e=0,t=d.length;e<t;e++)n+=i+d[e]+a;n+=r}n+='<div class="evo-sep"/>';var u="";for(n+=s,e=255;10<e;e-=10)n+=i+f(e)+a,u+=i+f(e-=10)+a;return n+=r+s+u+r+"</div>"},_switchPalette:function(e){if(this._enabled){var t,i,a,s=this.options.strings.split(",");if($(e).hasClass("evo-hist")){var r=['<table class="evo-palette"><tr><th class="ui-widget-content">',s[5],"</th></tr></tr></table>",'<div class="evo-cHist">'];if(0===l.length)r.push("<p>&nbsp;",s[6],"</p>");else for(var n=l.length-1;-1<n;n--)9===l[n].length?r.push('<div class="evo-transparent"></div>'):r.push('<div style="background-color:',l[n],'"></div>');r.push("</div>"),t=-this._paletteIdx,i=r.join(""),a=s[4]}else this._paletteIdx<0?(t=-this._paletteIdx,this._palette.find(".evo-hist").show()):t=2==this._paletteIdx?1:2,i=this["_paletteHTML"+t](),a=s[t+1],this._paletteIdx=t;this._paletteIdx=t;var o=this._palette.find(".evo-more").prev().html(i).end().children().eq(0).html(a);t<0&&o.next().hide()}},showPalette:function(){if(this._enabled&&(this._active=!0,$(".colorPicker").not("."+this._id).colorpicker("hidePalette"),null===this._palette)){if(this._palette=this.element.next().after(this._paletteHTML()).next().on("click",function(e){e.stopPropagation()}),this._bindColors(),this.options.hijackPositionLogic){var e="colorpickerContainer";$("#"+e).remove(),$(document).find("body").append($("<div id='"+e+"'></div>"));var t=$("#"+e);t.append($(".evo-pop,.evo-pop-ie").detach()),t.css("position","absolute"),t.css("width","210px"),t.css("height","220px"),t.css("top",Math.max(0,($(window).height()-t.outerHeight())/2+$(window).scrollTop())+"px"),t.css("left",Math.max(0,($(window).width()-t.outerWidth())/2+$(window).scrollLeft())+"px");var i=this.element,a=$(window).height()-$("#footerApplicationBar").outerHeight(),s=$(window).width(),r=$(i).offset(),n=$(i).outerHeight(),o=$(i).outerWidth(),l=$("#"+e).height(),d=$("#"+e).outerWidth(),u=this.options.isRTL&&!0===this.options.isRTL;r.top+n+l>=a&&r.top>l?$("#"+e).css({top:r.top-l+"px"}):$("#"+e).css({top:r.top+n+"px"});var c=u?"right":"left",p=u?"left":"right",m={};(r=$.extend({},r,{right:s-r.left-o}))[c]+d>=s?m[p]=s-r[c]-o+"px":m[c]=r[c]+"px",$("#"+e).css(m)}var h=this;this._isPopup&&$(document.body).on("click."+h._id,function(e){e.target!=h.element.get(0)&&h.hidePalette()}).on("keyup."+h._id,function(e){27===e.keyCode&&h.hidePalette()})}return this},hidePalette:function(){if(this._isPopup&&this._palette){$(document.body).off("click."+this._id);var e=this;this._palette.off("mouseover click scroll resize","td,.evo-transparent").fadeOut(function(){e._palette&&(e._palette.remove(),e._palette=e._cTxt=null)}).find(".evo-more a").off("click")}return this},_bindColors:function(){var a=this,e=this.options,t=this._palette.find("div.evo-color"),i=e.history?"td,.evo-cHist>div":"td";e.transparentColor&&(i+=",.evo-transparent"),this._cTxt1=t.eq(0).children().eq(0),this._cTxt2=t.eq(1).children().eq(0),this._palette.on("click",i,function(e){if(a._enabled){var t=$(this);a._setValue(t.hasClass("evo-transparent")?n:o(t.attr("style").substring(17))),a._active=!1}}).on("mouseover",i,function(e){if(a._enabled){var t=$(this),i=t.hasClass("evo-transparent")?n:o(t.attr("style").substring(17));a.options.displayIndicator&&a._setColorInd(i,2),a._active&&a.element.trigger("mouseover.color",i)}}).find(".evo-more a").on("click",function(){a._switchPalette(this)})},val:function(e){return void 0===e?this.options.color:(this._setValue(e),this)},_setValue:function(e,t){e=e.replace(/ /g,""),this.options.color=e,cVal=e,this.options.useRgbFormat&&(cVal=Frames.ColorPicker.prototype.hexToRgb(e)),this._isPopup?(t||this.hidePalette(),this._setBoxColor(this.element.val(cVal).next(),e)):this._setColorInd(e,1),this.options.history&&0<this._paletteIdx&&this._add2History(e),this.element.trigger("change.color",e)},_setColorInd:function(e,t){var i=this["_cTxt"+t];this._setBoxColor(i,e),i.next().html(e)},_setBoxColor:function(e,t){t===n?e.addClass("evo-transparent").css("background-color",""):e.removeClass("evo-transparent").css("background-color",t)},_setOption:function(e,t){"color"==e?this._setValue(t,!0):this.options[e]=t},_add2History:function(e){for(var t=l.length,i=0;i<t;i++)if(e==l[i])return;27<t&&l.shift(),l.push(e)},clear:function(){this.hidePalette().val("")},enable:function(){var e=this.element;return this._isPopup?e.removeAttr("disabled"):e.css({opacity:"1","pointer-events":"auto"}),"focus"!==this.options.showOn&&this.element.next().addClass("evo-pointer"),e.removeAttr("aria-disabled"),this._enabled=!0,this},disable:function(){var e=this.element;return this._isPopup?e.attr("disabled","disabled"):(this.hidePalette(),e.css({opacity:"0.3","pointer-events":"none"})),"focus"!==this.options.showOn&&this.element.next().removeClass("evo-pointer"),e.attr("aria-disabled","true"),this._enabled=!1,this},isDisabled:function(){return!this._enabled},destroy:function(){$(document.body).off("click."+this._id),this._palette&&(this._palette.off("mouseover click scroll resize","td,.evo-cHist>div,.evo-transparent").find(".evo-more a").off("click"),this._isPopup&&this._palette.remove(),this._palette=this._cTxt=null),this._isPopup&&this.element.next().off("click").remove().end().off("focus").unwrap(),this.element.removeClass("colorPicker "+this.id).empty(),$.Widget.prototype.destroy.call(this)}})}(jQuery),function($){Frames.Panel=$.inherit(Frames.Canvas,{}),Frames.regtype("panel",Frames.Panel)}(jQuery),function($){$.widget("ui.panel",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-panel ui-widget");var e=this.element.children().first();(e.is(".ui-layout-grid")||e.is(".ui-layout-gridflow"))&&this.element.addClass("ui-panel-layout-grid")},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-panel ui-widget ui-panel-layout-grid")},wrapper:function(e){},input:function(){return this.element},value:function(){},labelObj:function(){return this._lbl},focus:function(){this.element.focus()}})}(jQuery),function($){Frames.Image=$.inherit(Frames.Item,{init:function(e){Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this)},destroy:function(){this.autounregister(),delete this.view,delete this.elem},model:function(){var e;if(0===arguments.length)return null;var t=arguments[0];if(t){var i=t.record;if(i){var a=this.block.index();(Frames.isUndef(a)||-1==a||a>i.length-1)&&(a=0);var s=Frames.find(i[a],"item",this.member);if(s)e=Frames.Model.text(s[0]);else{var r=Frames.find(this.block._ctrinf,"item",this.member,!0);e=r&&r[0].properties&&r[0].properties[0]["@ImageFile"]?r[0].properties[0]["@ImageFile"]:""}this.convertValue(e),this._last=null}}},labelObj:function(){return this._call("labelObj")},label:function(){if(!(0<arguments.length))return this._call("label");this._call("label",arguments[0]),this.visible()&&this._label_position(),this._label_changed=!0},value:function(){if(!(0<arguments.length))return null;this._call("value",arguments[0])},convertValue:function(e){Frames.isEmpty(e)?this._call("value",""):e.length%4==0||Frames.Image.BASE64_RE.test(e)?this._call("value","data:image/jpeg;base64,"+e):this._call("value",e)},url:function(){if(!(0<arguments.length))return this._call("value");this._call("value",arguments[0])},focus:function(){this._call("focus")},image:function(){return this._call("image")},_computeLabelPosition:$.noop}),Frames.Image.BASE64_RE=/^[A-Za-z0-9+/]+[=]{0,3}$/,Frames.Item.PROP_MAP.ImageFile={method:"url"},Frames.regtype("image",Frames.Image)}(jQuery),function($){$.widget("ui.image",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-image ui-widget"),this._inp=$([]),this._img=$("img",this.element);var e=this._img.attr("src");this.value(e),this.element.css(Frames.css(this._img))},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-image ui-widget"),this._inp=null,delete this._inp},wrapper:function(e){this._img.data("frames",e)},value:function(){if(!(0<arguments.length))return this._img.attr("src")||"";var e=this.url(arguments[0]);this._img.attr("src",e),Frames.isEmpty(e)?this._img.hide():this._img.show()},url:function(){var e="";if(0<arguments.length&&!Frames.isEmpty(arguments[0])){if(e=arguments[0],Frames.isAbsoluteUrl(e)){if(/^data:image\/.*;base64.*/.test(e))return e}else e=Frames.Config.get("IMAGES_URL","img")+"/"+e;if(-1===e.indexOf(".")&&"/"!==e[e.length-1])e+="."+Frames.Config.get("IMAGES_EXTENSION","png")}return e},image:function(){return this._img},labelObj:function(){return Frames.isUndef(this._lbl)&&(this._lbl=$("label",this.element)),this._lbl},label:function(){if(!(0<arguments.length))return this.labelObj().text();this.labelObj().text(arguments[0])},focus:function(){}})}(jQuery),function($){Frames.Tree=$.inherit(Frames.Item,{init:function(e){Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this)},_initUserEvents:$.noop,destroy:function(){this.autounregister(),delete this.view,delete this.elem},rules:function(){return null},value:function(){return this._call("value")},model:function(){if(0===arguments.length){var e=this.hasChanges(!0),t=this.value();if(e){var i=Frames.Model.createBlock(this.block.name),a=Frames.Model.createRecord(this.selid),s=Frames.Model.createItem(this.member,t);return Frames.Model.append(a,s),Frames.Model.attr(a,"status","C"),Frames.Model.append(i,a),i}return null}var r=arguments[0];if(r){var n=r.record;if(n){this.selid=Frames.Model.attr(r.record[0],"id");var o=[],l=Frames.find(n[0],"data",this.member);l||(l=Frames.find(n[0],"item",this.member)),this._call("clear"),l&&(r=l[0].node?l[0].node:l[0].tree?l[0].tree[0].node:void 0,this._add_nodes(o,r)),this._call("refresh",o)}}},_add_nodes:function(e,t){var i,a,s,r,n;if(t)if(t.length)for(i=0;i<t.length;i++){var o=t[i];if(o)if(a=Frames.Model.attr(o,"label"),s=Frames.Model.attr(o,"action"),r=Frames.Model.attr(o,"id"),n=Frames.Model.attr(o,"icon"),o.node&&0<o.node.length){var l=Frames.isTrue(Frames.Model.attr(o,"isOpen")),d=this._call("addnode",e,a,s,r,l,n);this._add_nodes(d.children,o.node)}else this._call("addleaf",e,a,s,r,n)}else{var u=t;a=Frames.Model.attr(u,"label"),s=Frames.Model.attr(u,"action"),r=Frames.Model.attr(u,"id"),n=Frames.Model.attr(u,"icon"),this._call("addleaf",e,a,s,r,n)}},input:function(){return this._call("input")},focus:function(){this._call("focus")},select:function(){var e=arguments[0];return this._last=e,this._last_value=e,this._call("select",e)},hasChanges:function(){return Frames.Item.prototype.hasChanges.apply(this)}}),Frames.Tree.execute=function(e,t,i){var a=e.data("frames");if(!Frames.isUndef(t)&&!Frames.isUndef(a)){var s={name:t,params:[{name:"id",value:i,type:"string"}]};Frames.Application.execute(s,void 0,void 0,a.block.name,a.member)}},Frames.regtype("tree",Frames.Tree),Frames.Item.PROP_MAP.SelectedNode={method:"select"}}(jQuery),function($){$.widget("ui.tree",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-tree ui-widget ui-widget-content ui-corner-all"),this.$inp=$('<input type="hidden">').appendTo(this.element),this.$tree=this._addtree()},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-tree ui-widget ui-widget-content ui-corner-all")},wrapper:function(e){this.element.data("frames",e),this.$inp.data("frames",e)},refresh:function(e){var t=this.$tree.jstree(!0);t.settings.core.data=e,t.refresh(!0,!0)},clear:function(){},_addevent:function(e,t,r){var n=this;e.on(t+".jstree",function(e,t){var i,a,s=$(e.target).closest(".jstree-node").attr("id");t&&t.node&&!Frames.isUndef(t.node.id)&&(s=t.node.id),Frames.isUndef(s)||(i=s),a="open_node"==e.type||"close_node"!=e.type&&null,Frames.isUndef(r)||Frames.Tree.execute(n.element,r,i,a)})},_addtree:function(e){var a=this,t=Frames.Config.get("INPUT_DEFAULT_DIRECTION","ltr"),i=$('<div class="ui-treemenu"></div>').appendTo(this.element).on("keydown.jstree",".jstree-anchor",function(e){if(a.element.data("executing_tree_action"))return e.preventDefault(),e.stopImmediatePropagation(),!1}).jstree({core:{dblclick_toggle:!1}}),s={dblclick:"doubleclick",open_node:"itemopen",close_node:"itemclose"};for(var r in s)if(s.hasOwnProperty(r)){var n=s[r],o=a.element.data("event"+n);Frames.isEmpty(o)||a._addevent(i,r,o)}return i.on("changed.jstree",function(e,t){var i=a.element.data("action")||a.element.data("eventitemselected")||a.element.data("eventclick");Frames.isUndef(t.event)||Frames.isUndef(i)||a._last_id!=t.node.id&&(a._last_id=t.selected.join(";"),a.$inp.triggerHandler("valuechange"),Frames.Tree.execute(a.element,i,a._last_id,null))}).on("refresh.jstree",function(){i.find("li > a").attr("dir",t),Frames.isCurr(a.element.data("frames"))&&$("#"+a._id+"_anchor").focus(),a._last_id!=a._id&&(a._last_id=a._id,i.jstree("activate_node",a._id,!0))}),i},addnode:function(e,t,i,a,s,r){i=Frames.isUndef(i)?this.element.data("action"):i;var n={id:a,text:t,icon:r=this.parseIcon(r),state:{opened:s,selected:this._last_id===a},children:[],li_attr:{},a_attr:{}};return Frames.isEmpty(i)||(n.a_attr["data-action"]=i,n.action=i),e.push(n),n},addleaf:function(e,t,i,a,s){i=Frames.isUndef(i)?this.element.data("action"):i;var r={id:a,text:t,icon:s=this.parseIcon(s),state:{selected:this._last_id===a},children:[],li_attr:{},a_attr:{}};return Frames.isEmpty(i)||(r.a_attr["data-action"]=i),e.push(r),r},parseIcon:function(e){return!e||-1===e.indexOf(".")&&-1===e.indexOf("/")?e:$.ui.image.prototype.url.apply(this,[e])},input:function(){return this.$inp},value:function(){return Frames.isUndef(this._last_id)?"":this._last_id},focus:function(){},select:function(){if(0===arguments.length)return this.value();this._id=arguments[0],this.$tree.jstree("select_node",this._id,!0),$("#"+this._id+"_anchor").focus()}})}(jQuery),function($){Frames.Repeater=$.inherit(Frames.Item,{init:function(e){var i=this;this.view=e;var t=this.props("block"),a=Frames.Application.task.get(t);a&&(this.block=a,this.autoregister(),this.block.bindable(this));var s=this.elem.data("pager");this.pager=Frames.isUndef(s)?Frames.Config.getbool("REPEATER_PAGER",!1):Frames.isTrue(s);var r=this.elem.closest(".ui-widget-content");if(r[0]){var n=r.closest("[data-widget]").data("frames");n&&n.bind("frames:show",function(e,t){r[0]===t.container[0]&&i._onParentShowTab()})}Frames.inDesignMode&&this._call("design")},getItemRowIndex:function(e){return e.elem.closest(".ui-repeater-row").data("rowidx")},_onParentShowTab:function(){$(":input:visible",this.elem).filter(function(){return void 0!==$(this).data("frames")}).each(function(){var e=$(this).data("frames");$.isFunction(e._computeLabelPosition)&&e._computeLabelPosition(!0)})},autoregister:function(){if(this._CTX_=new Frames.HashMap,this.block){var s=this;this._call("template").find("[data-widget]").each(function(){s.registerRepeaterItemContext($(this))}),Frames.isUndef(this.block._last_model)||this.model(this.block._last_model),this.elem.on(Frames.Repeater.EVENTS.join(" "),function(e){var t=$(e.target).data("frames");if(t&&t!=s&&t.member){var i=s._CTX_.get(t.member);if(!Frames.isUndef(i)){if(s._curr==t&&s._lastev==e.type&&-1==e.type.indexOf("key"))return!1;if(s._curr=t,s._lastev=e.type,"focuschange"==e.type){var a=t.elem.closest(".ui-repeater-row");s._call("select",a),s.selid=a.data("rowid"),s.selidx=a.data("rowidx"),t.block.index(s.selid),Frames.Application.task.block!=t.block&&(Frames.Application.task.block=t.block)}"focuschange"!==e.type&&"focusin"!==e.type||(t.block._item=t),i.triggerInstance(t,e)}}}),Frames._currentItemAndFocus()}},registerRepeaterItemContext:function(e){var t=e?e.data("member"):void 0;if(!Frames.isUndef(t)){var i=new Frames.Repeater.RepeaterItemContext(this,e);i.init(this.view),this._CTX_.put(t,i)}},getItemContext:function(e){return this._CTX_.get(e)},selected:function(){if(0===arguments.length)return this.selidx;var e=arguments[0],t=this._call("select",e);"string"==typeof e?(this.selidx=t.data("rowidx"),this.selid=e):(this.selidx=e,this.selid=t.data("rowid"))},recordHasChanges:function(){var e=this._call("rowlist")[this.selidx];if(!Frames.isUndef(e))for(e._ITEMS_.reset();e._ITEMS_.hasNext();)if(e._ITEMS_.next().hasChanges())return!0;return!1},autounregister:function(){for(this._call("removeallrows"),this._CTX_.reset();this._CTX_.hasNext();){this._CTX_.next().destroy()}this._CTX_.clear(),Frames.Item.prototype.autounregister.apply(this),this.elem.off(Frames.Repeater.EVENTS.join(" "))},destroy:function(){this.block.remove(this),this.autounregister(),delete this._CTX_,delete this.view,delete this.elem,this._destroyed=!0},rules:function(){return null},_preModelControlInfo:function(e){for(this._CTX_.reset();this._CTX_.hasNext();){this._CTX_.next()._preModelControlInfo(e)}},controlInfo:function(e,t){if(!Frames.isUndef(e))for(this._CTX_.reset();this._CTX_.hasNext();){this._CTX_.next()._itemControlInfo(e)}this._call("refresh")},query:function(e,t){var i=this._call("rowlist")[0];if(i&&e){var a=[];for(i._ITEMS_.reset();i._ITEMS_.hasNext();)a.push(i._ITEMS_.next());Frames.Query.applyValues(e,a),!1!==t&&Frames.Application.valexec("EXECUTE_QUERY")}},model:function(){var e,t,i,a="SEARCH"==this.block.props("blockMode");if(0===arguments.length){var s=Frames.Model.createBlock(this.block.name);e=this._call("rowlist");for(var r=0;r<e.length;r++){var n=e[r];for(i=Frames.Model.createRecord(n.id),Frames.Model.attr(i,"status","C"),n._ITEMS_.reset();n._ITEMS_.hasNext();){var o=(t=n._ITEMS_.next()).model();o&&Frames.Model.append(i,o)}Frames.Model.hasChildren(i)&&Frames.Model.append(s,i)}return Frames.Model.hasChildren(s)||(s=null),s}var l=arguments[0];if(l){if(!(Frames.isUndef(Frames.Model.attr(l,"hasChanges"))||Frames.isTrue(Frames.Model.attr(l,"hasChanges"))))return;var d=Frames.Model.attr(l,"selected");!Frames.isUndef(this.block.paging)&&this.block.paging.enabled&&this.pager&&(Frames.isUndef(this._pager)&&(this.elem.parent().find(".ui-grid-pager").remove(),this._pagEl=$('<div class="ui-grid-pager" style="width:100%;"></div>'),this.elem.after(this._pagEl),this._pager=new Frames.DataGrid.Pager(this.block.paging,this._pagEl,{pages:Frames.Repeater.PAGES}),this._pager.init()),this._pager.update(),a?(this.elem.removeClass("ui-pager"),this._pagEl.css("display","none")):(this.elem.addClass("ui-pager"),this._pagEl.css("display",""))),this.block.master=Frames.isTrue(Frames.Model.attr(l,"master"));var u=l.record;if(u){if(Frames.isUndef(d)&&(d=Frames.Model.attr(u[0],"id")),"true"===Frames.Config.get("OPTIMIZATION.MODEL","true")){if((e=this._call("rowlist")).length>u.length)this._call("clear");else for(var c=0;c<e.length;c++)if(void 0!==u[c]){if(e[c].id!==u[c]["@id"]){this._call("clear");break}}else this._call("removerow",c)}else this._call("clear");e=this._call("rowlist");for(var p=0;p<u.length;p++){i=u[p];var m=e[p],h=Frames.isTrue(Frames.Model.attr(i,"hasChanges")),f=!1,g=this.block.index();if(this.block.selidx=p,void 0===m&&(m=this._call("addrow",l),f=!0),f||h)for(this._CTX_.reset();this._CTX_.hasNext();){var _=this._CTX_.next(),v=_.member;if(t=m._ITEMS_.get(v),!Frames.isUndef(t)){f&&t.props(_._props);var b=t.block.idOf(this.rowidx());t._preModelControlInfo(this.block._ctrinf,b),t.block._model_item(t,l),f&&t.refresh()}}this.block.selidx=g}this.selected(d)}else this._call("clear")}},getItem:function(e){var t=this._call("indexOf",this.selected());return Frames.isUndef(e)&&(e=0),t._ITEMS_?t._ITEMS_.get(e):void 0},getItems:function(){var e=[],t=this._call("indexOf",this.selected());if(t._ITEMS_)for(t._ITEMS_.reset();t._ITEMS_.hasNext();)e.push(t._ITEMS_.next());return e},input:function(e){if("string"!=typeof e)return this.elem;var t=this.getItem(e);return t?t.input():void 0},erroranchor:function(e){if("string"==typeof e){var t=this.getItem(e);return t?t.erroranchor():void 0}},focus:function(e){var t=this.getItem(e);t&&t.focus()},value:function(e,t){var i=this.getItem(e);return void 0===i?null:void 0===t?i?i.value():"":void(i&&i.value(t))},isContext:function(){return!0},label:function(e,t){var i=this.getItem(e);return void 0===i?null:void 0===t?i?i.label():"":void(i&&i.label(t))}}),Frames.Repeater.PAGES=[1,2,3,4,5],Frames.Repeater.EVENTS=["blur","focus","focusin","focusout","focuschange","click","dblclick","keydown","keypress","keyup"],Frames.regtype("repeater",Frames.Repeater)}(jQuery),function($){$.widget("ui.repeater",{version:"@VERSION",options:{},_create:function(){var d=this;this.element.addClass("ui-repeater ui-widget ui-widget-content ui-corner-all"),"vertical"==this.element.data("layout")&&this.element.addClass("ui-repeater-vertical"),this._template=this.element.children(".ui-repeater-render"),this._template.children().css({top:"",left:"",position:""}),this.rows=[],this._template.is(".ui-layout-positional")&&(this._rowheight=this._template.children().first().outerHeight()),this._rowsnum=0,this._template.css("display","none"),this.element.on("click",function(e){var t=$(e.target),i=t.closest(".ui-repeater-row"),a=d.element.data("frames"),s=(t=t.closest(".ui-widget")).is(".ui-widget")&&!t.is(".ui-panel"),r=0<t.children(":focusable").length;if((!s||!r)&&a.block){var n=a.block.item?a.block.item:void 0;if(Frames.isUndef(n)){Frames.Application.task.block!=a.block&&(Frames.Application.task.block=a.block),a.block.index(i.data("rowidx")),Frames.isUndef(a._pager)||a._pager.update()}else{var o=i.find("[data-member="+n.member+"]");if(0<o.length)if(o.closest(".ui-repeater").is(d.element)){var l=Frames.get_frames(o);Frames.isUndef(l)||l.focus()}}}})},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-repeater ui-widget ui-widget-content ui-corner-all")},wrapper:function(e){this.element.data("frames",e)},template:function(){return this._template},refresh:function(){for(i=0;i<this.rows.length;i++){var e=this.rows[i];for(e._ITEMS_.reset();e._ITEMS_.hasNext();){e._ITEMS_.next().refresh()}}},removeallrows:function(){for(i=0;i<this.rows.length;i++)this.removerow(i)},removerow:function(e){var t=this.rows[e];for(var i in t._OBJS_)if(t._OBJS_.hasOwnProperty(i)){var a=t._OBJS_[i];"function"==typeof a.destroy&&a.destroy()}delete t._OBJS_,t.elem.remove(),delete t.elem,t._ITEMS_.clear(),delete t._ITEMS_,this.rows.splice(e,1)},clear:function(){for(this._rowsnum=0,i=0;i<this.rows.length;i++){var e=this.rows[i];for(var t in e._OBJS_)if(e._OBJS_.hasOwnProperty(t)){var a=e._OBJS_[t];"function"==typeof a.destroy&&a.destroy()}delete e._OBJS_,e._ITEMS_.clear(),delete e._ITEMS_,delete e.elem}this.element.children(".ui-repeater-row").remove(),this.rows=[]},addrow:function(e,t){var i=null;if(e){var a=this.element.data("frames"),s=e.record[a.block.index()]["@id"],r=a.block.indexOf(s);i=this._createrow(s,r,e,t)}return i},_createrowelement:function(e,t,i,a){return this._template.clone()},_createrow:function(e,t,a,i){var s=this,r=null,n=s.element.data("frames"),o=this._createrowelement(e,t,a,i);return o.css("display","").data("rowid",e).data("rowidx",t).removeClass("ui-repeater-render").addClass("ui-repeater-row").find("[id]").each(function(){var e=$(this),t=e.attr("id");""===t&&(t=Frames.uuid()),t=t+"_"+s._rowsnum,e.attr("id",t)}).end().find("[for]").each(function(){$(this).attr("for",$(this).attr("for")+"_"+s._rowsnum)}).end().find("[name]").each(function(){$(this).attr("name",$(this).attr("name")+"_"+s._rowsnum)}).end().find("[data-name]").each(function(){$(this).data("name",$(this).data("name")+"_"+s._rowsnum)}).end().appendTo(this.element),void 0!==this._rowheight&&o.css("top",this._rowheight*(o.index()-1)+"px"),r={id:e,elem:o,_OBJS_:{},_ITEMS_:new Frames.HashMap},this.rows.push(r),o.attr("rowid",e).data("rowidx",this._rowsnum++),o.find("[data-widget]").each(function(){var e=$(this).attr("id")||Frames.uuid(),t=Frames.create(e,$(this),Frames.Application.task.view,r,{repeater:!0}),i=t.member;Frames.isUndef(i)||(a&&t.props("serverStatus",Frames.Model.attr(a,"serverStatus")),Frames.isUndef(t.block)&&(t.block=n.block),$.extend(t,Frames.Repeater.ItemExtender),t._bindable=n,r._ITEMS_.put(i,t))}),o.triggerHandler("frames:rowcreated"),r},rowlist:function(){return this.rows},indexOf:function(e){if("string"!=typeof e)return this.rows[e];var t;for(t=0;t<this.rows.length;t++){var i=this.rows[t];if(i.id==e)return i}},select:function(e){var t=null;if("object"==typeof e?t=e:void 0!==this.indexOf(e)&&(t=this.indexOf(e).elem),null!==t){t.parent().children(".ui-repeater-row").removeClass("ui-state-default"),t.addClass("ui-state-default");var i=parseInt(t.css("top"),10),a=i+t.outerHeight()-2>this.element.innerHeight()-this.element.scrollTop(),s=i<this.element.scrollTop();return(a||s)&&this.element.scrollTop(i),t}},design:function(){this._createrow(Frames.uuid(),1)}})}(jQuery),function($){Frames.Repeater.RepeaterItemContext=$.inherit(Frames.Item,{__constructor:function(e,t){this._repeater=e;var i=(this.elem=t).attr("data-block");void 0===i&&(i=e.props("block")),this.props("block",i),this.member=t.data("member");var a,s=this.props("formatEnabled");for(a in this.props("formatEnabled",!1),t.data())this.props(a,t.attr("data-"+a));this.props("formatEnabled",s);try{var r=t.data("widget"),n=Frames.gettype(r).prototype,o=n?n.defaults:void 0;void 0!==o&&o.apply(this)}catch(e){0}this.elem.data("frames",this);var l=Frames.getplugs(Frames.PLUGIN_WIDGET);for(l.reset();l&&l.hasNext();)l.next().register(this)},editable:function(){var e=this.resolve();if(0===arguments.length)return e===this?Frames.Item.prototype.editable.apply(this):e.editable();e!==this?e.editable(arguments[0]):Frames.Item.prototype.editable.apply(this,arguments)},enabled:function(){var e=this.resolve();if(0===arguments.length)return e===this?Frames.Item.prototype.enabled.apply(this):e.enabled();e!==this?e.enabled(arguments[0]):Frames.Item.prototype.enabled.apply(this,arguments)},resolve:function(){return this.bindable().getItem(this.member)||this},input:function(){return this.bindable().input(this.member)},erroranchor:function(){return this.bindable().erroranchor(this.member)},triggerInstance:function(e,t){var i=e.input(!0);if("action"==t)i.triggerHandler(t);else{var a=$.Event(t.type,{target:i,keyCode:t.keyCode,which:t.which,altKey:t.altKey,shiftKey:t.shiftKey,ctrlKey:t.ctrlKey});this.elem.triggerHandler(a)}},bindable:function(){return this._repeater},model:$.noop,focus:function(){var e=this.bindable();e.selected(this.block.selidx),e.focus(this.member)},recordHasChanges:function(){return this.bindable().recordHasChanges()},value:function(){if(0===arguments.length)return this.bindable().value(this.member);this.bindable().value(this.member,arguments[0])},hasChanges:function(){var e=this.resolve();return e===this?Frames.Item.prototype.hasChanges.apply(this):e.hasChanges()},isContext:function(){return!0},validate:function(){var e=this.input();return!!Frames.isUndef(e)||!(!Frames.isTrue(this.props("ValidationEnabled"))||0<e.parents().not(":visible").length)},widget:function(){var e=this.resolve();return e!==this?e.widget():void 0},label:function(){if(0===arguments.length)return this.bindable().label(this.member);this.bindable().label(this.member,arguments[0])},api_mouse_target:function(e){var t,i=this.bindable(),a=i._call("rowlist");return Frames.isUndef(e)||e<a.length&&(t=a[e]),Frames.isUndef(t)&&(t=a[i.getItemRowIndex(i._curr)]),t._ITEMS_.get(this.member).api_mouse_target()},_itemInstanceControlInfo:$.noop,controlInfo:$.noop,_model_item:$.noop})}(jQuery),jQuery,Frames.Repeater.ItemExtender={bindable:function(){return this._bindable},container:function(){return Frames.isUndef(this._container)&&(this._container=this.elem.closest(".ui-repeater-row")),this._container},inSelectedRow:function(){var e=this.container();if(e&&this.block){var t=e.data("rowid");return this.block.selid==t}return!1},rowidx:function(){var e=this.container();if(e)return e.data("rowidx")},rowid:function(){var e=this.container();if(e)return e.data("rowid")},context:function(){return this.bindable()._CTX_.get(this.member)},refresh:function(){var e=this.bindable().block,t=e._ctrinf,i=this.container().data("rowid");e!==this.block&&void 0!==this.block&&(t=this.block._ctrinf),this._refreshing=!0,this.controlInfo(t,i),this._refreshing=!1}},function($){$.extend($.ui.accordion.prototype.options,{heightStyle:!0===Frames.inDesignMode?"fill":"content",collapsible:!0}),Frames.Accordion=$.inherit(Frames.Item,{__constructor:function(e){var r=this;if(!Frames.isUndef(e)&&e.jquery){r.elem=e,r.elem.removeClass("ui-accordion").addClass("ui-accordion-widget"),r.obj=r.elem.children("div").accordion({activate:function(e,t){var i=t.newPanel;Frames.isTrue(i.data("initialized"))||(Frames.repaint(i,!1),i.data("initialized",!0)),r._check_initialization(i,!0);var a=t.oldHeader;0<a.length&&(a.hasClass(".ui-state-active")||(a.attr("aria-expanded","false"),a.attr("aria-selected","false"),a.attr("tabindex",-1)));var s=t.newHeader;0<s.length&&s.hasClass(".ui-state-active")&&(s.attr("aria-expanded","true"),s.attr("aria-selected","true"),s.attr("tabindex",0))}}),r.elem.data("frames",this);var t=r.obj.children("div:first");r._check_initialization(t,!1)}r._props=null,this._show_fn=function(e){r._refresh()},this.elem.parents(".ui-tabpanel").bind("frames:show",this._show_fn)},init:function(e){var t=this;Frames.Item.prototype.init.apply(this,arguments);var i=this.elem.closest('[data-class$="canvas"]');if(i[0]){var a=this.view._CANVAS_.get(i.data("name"));a&&$(a).on("aftershow",function(e){t._refresh()})}},_refresh:function(){var e=this.obj.children(".ui-accordion-content-active").eq(0);this._check_initialization(e,!0)},_check_initialization:function(e,t){e.is(":visible")&&(t?(0===e.height()&&(e.css("height",""),Frames.repaint(e,!1)),this.elem.triggerHandler("frames:show",{container:e})):Frames.repaint(e,!1))},show:function(e){if(this.obj.accordion("option","active")!==e){this.obj.accordion("option","animate");var t=$.fx.off;$.fx.off=!0,this.obj.accordion("option","active",e),$.fx.off=t}},toggle:function(){!1===this.obj.accordion("option","active")?this.obj.accordion("option","active",0):this.obj.accordion("option","active",-1)},containers:function(){return this.obj.children("div")},headers:function(){return this.obj.children(".ui-accordion-header")},destroy:function(){this.elem.hide(),this.obj.accordion("destroy"),this.elem.parents(".ui-tabpanel").off("frames:show",this._show_fn),delete this.view,delete this._show_fn},rules:function(){return null},props:function(){if(Frames.isUndef(this._props)&&(this._props={},this.props("Valid","true"),this.props("ValidationEnabled","false")),2==arguments.length){var e=arguments[0].replace("@",""),t=arguments[1];if(!Frames.isUndef(t)&&"object"==typeof t||"function"==typeof t)return;if("ValidationEnabled"==e)return}return Frames.Item.prototype.props.apply(this,arguments)},model:function(){return null},input:function(){return null},labelObj:function(){return null},label:function(){},value:function(){return null}}),Frames.regtype("accordion",Frames.Accordion)}(jQuery),function($){Frames.Component=$.inherit(Frames.Item,{init:function(e){var i=this;this.view=e,this.fixRtl(),Frames.Item.prototype.init.apply(this,arguments),this._computeLabelStyle(),e.initialized?this.trigger("frames:refresh"):$(e).on("initialized",function(){i.trigger("frames:refresh")});var t=this.elem.closest(".ui-repeater-row, [data-class$='canvas'], [data-widget='tabpanel']");if(t[0]){if(t.is(".ui-repeater-row"))this._call("option",{repeater:!0}),this._compute_el=t,this._compute_ev="frames:rowcreated";else{var a=this.view._CANVAS_.get(t.data("name"));a&&(this._compute_el=$(a),this._compute_ev="aftershow")}this._compute_el&&(this._compute_fn=function(e,t){i.trigger("frames:refresh",{repaint:!0})},this._compute_el.on(this._compute_ev,this._compute_fn))}},destroy:function(){this._call("dodestroy"),this._compute_el&&(this._compute_el.off(this._compute_ev,this._compute_fn),delete this._compute_el,delete this._compute_fn,delete this._compute_ev),Frames.Item.prototype.destroy.apply(this,arguments)},_computeLabelStyle:function(){var e=this.labelObj();if(!Frames.isUndef(e)){var t=this.elem.children("[data-widget]").first();if(0<e.length&&Frames.isEmpty(e.text())?(e.addClass("empty"),t.hasClass("ui-nolabel")&&this.elem.addClass("ui-nolabel")):(e.removeClass("empty"),this.elem.removeClass("ui-nolabel")),!Frames.isEmpty(e.text())){var i=t.children("input");t.children("label").attr("for",null);var a=i.attr("id");e.attr("for",a)}}},fixRtl:function(){Frames.TextInput.prototype.fixRtl.apply(this,arguments)},labelObj:function(){return this._call("labelObj")},label:function(){if(!(0<arguments.length))return this._call("label");this._call("label",arguments[0]),this._computeLabelStyle()}}),Frames.regtype("component",Frames.Component)}(jQuery),function($){$.widget("ui.component",{version:"@VERSION",options:{repeater:!1},_create:function(){var s=this;if(this.element.addClass("ui-component ui-widget"),this.element.attr("role","group"),Frames.Application.task){var r=s.element.children("[data-widget]").first();this._endbind_fn=function(){r.hasClass("ui-state-readonly")?s.element.addClass("ui-state-readonly"):s.element.removeClass("ui-state-readonly"),r.hasClass("ui-state-disabled")?s.element.addClass("ui-state-disabled"):s.element.removeClass("ui-state-disabled"),r.hasClass("ui-required")||r.data("required")?s.element.addClass("ui-required"):s.element.removeClass("ui-required"),"none"!=r.css("display")?s.element.removeClass("ui-nolabel")&&s.element.removeClass("ui-hidelabel"):s.element.addClass("ui-nolabel")&&s.element.addClass("ui-hidelabel");Frames.isEmpty(s.labelObj().text())&&"none"!=r.css("display")?s.labelObj().addClass("empty"):s.labelObj().removeClass("empty"),s.updateComponents()};r.on("frames:init",function(e){var t=r.data("widget"),i=r.data(Frames.get_fullname(t));if(void 0!==i){var a=i.input().data("frames");void 0!==a&&void 0!==a.elem&&s.register(a)}});this.instanceid=this.element.attr("id")||Frames.uuid(),Frames.Application.on("endbind.component-"+this.instanceid,this._endbind_fn),this._endbind_fn()}this.fixpositions()},fixpositions:function(){$.ui.textinput.prototype.fixpositions.apply(this,arguments)},updateComponents:$.noop,register:function(e){var t=this;if(this.item=e,Frames.isEmpty(this.label())?Frames.isEmpty(e.label())||(e.labelObj().attr("id","l:"+e.elem.attr("id")),e.input().attr("aria-labelledby",e.labelObj().attr("id")),e.labelObj().attr("for",e.input().attr("id"))):(this._lbl.attr("id","l:"+e.elem.attr("id")),e.elem.attr("aria-labelledby",this._lbl.attr("id")),this.element.attr("aria-labelledby",this._lbl.attr("id")),Frames.isEmpty(e.label())&&(e.input().attr("aria-labelledby",this._lbl.attr("id")),this._lbl.attr("for",e.input().attr("id")))),"checkbox"!=e.widgetcls()){Frames.isEmpty(this.label())?t.labelObj().addClass("empty"):Frames.isEmpty(e.label())||e.elem.addClass("ui-hidelabel");var i=e.label;e.label=function(){if(!(0<arguments.length))return i.apply(e,arguments);t.labelObj().removeClass("empty"),t.label(arguments[0]),this.elem.addClass("ui-hidelabel"),i.apply(e,arguments)}}},_destroy:function(){Frames.Application.off("endbind.component-"+this.instanceid,this._endbind_fn),delete this._endbind_fn},dodestroy:function(){this._destroy()},wrapper:function(e){},input:function(){return this.element},value:function(){},label:function(){if(!(0<arguments.length))return this.labelObj().text();this.labelObj().text(arguments[0])},labelObj:function(){return Frames.isUndef(this._lbl)&&(this._lbl=$("> label",this.element)),this._lbl},focus:function(){this.element.focus()}})}(jQuery),function($){Frames.CheckBox=$.inherit(Frames.TextInput,{init:function(e){Frames.TextInput.prototype.init.apply(this,[e]),this.props("formatEnabled",!1)},initInputMask:$.noop,_setAutoAlignment:$.noop,mapvalue:function(){return this._call("mapvalue",arguments[0])},tvalue:function(){return this._call("tvalue")},fvalue:function(){return this._call("fvalue")},props:function(){if(!(1<arguments.length&&"formatEnabled"==arguments[0]&&Frames.isTrue(arguments[1])))return Frames.TextInput.prototype.props.apply(this,arguments)},rules:function(){return null},clickable:function(){return!0},optmodel:function(){if(this.editable()){var e=this._call("tvalue"),t=this._call("fvalue");return e=this._call("checked")?t:e,Frames.Model.createItem(this.member,e)}},_preModelControlInfo:function(e,t){if(Frames.Item.prototype._preModelControlInfo.apply(this,[e,t]),e){var i=Frames.Model.findExp(e,"item[@name="+this.member+"]");if(i){var a=i[0];Frames.isUndef(a)||Frames.isUndef(a.properties)||(a=a.properties[0],Frames.isUndef(a)||(this.setProp(a,"Value"),this.setProp(a,"FalseValue"),this.setProp(a,"UnmatchedValue"),Frames.isTrue(Frames.Application._supportnulls)&&(this.setProp(a,"ValueIsNull"),this.setProp(a,"FalseValueIsNull"),this.setProp(a,"UnmatchedValueIsNull"))))}}},setProp:function(e,t){var i=Frames.Model.attr(e,t);Frames.isUndef(i)||this.props(t,i)},editable:function(){if(Frames.isUndef(this.elem))return!1;if(!(0<arguments.length))return!1!==$(".ui-button",this.elem).data("editable");var e=Frames.isTrue(arguments[0]),t=$(".ui-button",this.elem);t.data("editable",e),e?t.removeAttr("readonly"):t.attr("readonly","readonly")},dvalue:$.noop,_applyAutoskip:$.noop}),Frames.regtype("checkbox",Frames.CheckBox)}(jQuery),function($){$.widget("ui.checkbox",{version:"@VERSION",options:{clickModel:"action"},_create:function(){this.element.addClass("ui-checkbox ui-widget"),this._inp=$("input",this.element).hide(),this._lbl=$("label",this.element),this.button=$("button",this.element);var e=this.checked();this.checkid(),0===this.button.length&&(this.button=$('<button id="'+this._inp.attr("id")+'_btn" type="button">&nbsp;</button>').insertAfter(this._inp).button({icons:"ui-icon-none",classes:{"ui-button":"ui-state-default ui-button-text-only"},text:!1}).attr("aria-labelledby",this._lbl.attr("id")).attr("role","checkbox").attr("aria-checked",e).bind("action",$.proxy(this._clickHandler,this)).click($.proxy(this._disableClickHandler,this)),this.button.removeAttr("title"),this.element.bind("action",$.proxy(this._clickHandler,this)),this._lbl.attr("for",this.button.attr("id"))),Frames.isUndef(this.data("value"))&&this._inp.data("value",""),Frames.isUndef(this.data("fvalue"))&&this._inp.data("fvalue",""),this.fixpositions()},checkid:function(){$.ui.textinput.prototype.checkid.apply(this,arguments)},fixpositions:function(){$.ui.textinput.prototype.fixpositions.apply(this,arguments)},_disableClickHandler:function(){return!1!==this.button.data("editable")&&(this.input().triggerHandler("valuechange"),"standalone"===this.options.clickModel&&this.element.trigger("action")),!1},_clickHandler:function(e){return!1!==this.button.data("editable")&&(this._toggleValue(),Frames.Application.elemexec(this.element)),!1},_toggleValue:function(){var e=this.checked(),t={icon:e?"ui-icon-none":"fa fa-check"};return this.button.button("option",t).attr("aria-checked",!e).data("state",e?"":"checked"),this._inp.prop("checked",e?null:"checked"),this.input().triggerHandler("valuechange"),this.button.removeAttr("title"),Frames.Application.elemexec(this.button),!1},destroy:function(){$.Widget.prototype.destroy.call(this),this.element.removeClass("ui-checkbox ui-widget"),this.button.data("frames",null),this.button.remove(),this._inp.show(),this._inp=null,this._lbl=null,delete this._inp,delete this._lbl},wrapper:function(e){this.button.data("frames",e)},input:function(){return this.button},labelObj:function(){return this._lbl},checked:function(){return"checked"===this.button.data("state")},tvalue:function(){return Frames.isTrue(Frames.Application._supportnulls)&&this.valueisnull()?null:this.data("value")},fvalue:function(){return Frames.isTrue(Frames.Application._supportnulls)&&this.fvalueisnull()?null:this.data("fvalue")},valueisnull:function(){return Frames.isTrue(this.data("valueisnull"))},fvalueisnull:function(){return Frames.isTrue(this.data("fvalueisnull"))},data:function(e){var t=this.framesObj();return val=(t?t.props(e):void 0)||this._inp.data(e),val=Frames.isUndef(val)?this._inp.attr(e):val,Frames.isUndef(val)?val:String(val)},framesObj:function(){return this.button.data("frames")},inSearchMode:function(){var e=this.framesObj();return"SEARCH"==(e.mode?e.mode.name:e.block?e.block.props("blockMode"):void 0)&&Frames.isTrue(e.props("AllowSearch"))},mapvalue:function(e){if(!Frames.Config.getbool("MAPVALUES_ENABLED",!0)||this.inSearchMode())return e;var t=this.tvalue(),i=this.fvalue(),a=Frames.isUndef(e)?e:String(e).toUpperCase(),s=Frames.isUndef(t)?t:String(t).toUpperCase(),r=Frames.isUndef(i)?i:String(i).toUpperCase();if(!(a===s||a===r)){var n=this.data("unvalue"),o=Frames.Config.getbool("CHECKBOX_DEFAULT_VALUE",!1)?t:i;e=Frames.isUndef(n)?o:(n=String(n).toUpperCase())===s?t:n===r?i:o}return e},value:function(){var e=this.checked(),t=this.tvalue(),i=this.fvalue();if(0===arguments.length)return this._inp.prop("indeterminate")?this.element.data("indeterminate-value"):e?t:i;var a=this.mapvalue(arguments[0]),s=String(a).toUpperCase();t=Frames.isUndef(t)?t:String(t).toUpperCase(),i=Frames.isUndef(i)?i:String(i).toUpperCase();var r=!1;s===t?(r=!0,e||this._toggleValue()):s===i&&(r=!0,e&&this._toggleValue()),r?(this.element.data("indeterminate-value",null),this.element.removeClass("ui-indeterminate-state"),this._inp.prop("indeterminate",!1)):(e&&this._toggleValue(),this.element.data("indeterminate-value",a),this.element.addClass("ui-indeterminate-state"),this._inp.prop("indeterminate",!0))},label:function(){if(!(0<arguments.length))return this._lbl.text();this._lbl.text(arguments[0])},focus:function(){this.button.focus()}})}(jQuery),function($){Frames.Pager=$.inherit(Frames.Item,{init:function(e){this.view=e;var t=this.props("block"),i=Frames.Application.task.get(t);i&&(this.block=i,this.autoregister(),this.block.bindable(this))},destroy:function(){Frames.Item.prototype.destroy.apply(this,[]),Frames.isUndef(this._pager)||this._pager.destroy()},model:function(){var e="SEARCH"==this.block.props("blockMode");if(0===arguments.length)return Frames.Model.createBlock(this.block.name);if(arguments[0]&&!Frames.isUndef(this.block.paging)&&this.block.paging.enabled){var t=this.elem.children(".ui-grid-pager");0===t.length&&(delete this._pager,t.remove(),this.elem.css("width","100%"),this._pagEl=$('<div class="ui-grid-pager" style="width:100%;"></div>'),this.elem.append(this._pagEl),this._pager=new Frames.DataGrid.Pager(this.block.paging,this._pagEl),this._pager.init()),this._pager&&this._pager.update(),e?this.elem.css("display","none"):this.elem.css("display","")}}}),Frames.regtype("pager",Frames.Pager)}(jQuery),function($){Frames.Dialog.LOV={viewName:"LOVDialog",autofilter:!1,load:function(e,t){var i=Frames.Application.task,a=Frames.Config.getbool("LOV_TITLE",!0),s=Frames.Application.mainTask.view.id,r=(s=s.substring(0,s.lastIndexOf("/")))+"/"+this.viewName;Frames.Dialog.LOV.autofilter=Frames.Config.getbool("LOV_AUTOFILTER",!1);var n={name:Frames.Model.attr(e[0],"name"),title:Frames.Model.attr(e[0],"title"),width:Frames.Model.attr(e[0],"width"),height:Frames.Model.attr(e[0],"height"),criteria:Frames.Model.attr(e[0],"criteria"),last:i.view,columns:this._parseCols(Frames.findExp(e[0],"columns/column")),autofilter:this.autofilter};if(Frames.isEmpty(n.title)&&a){var o=Frames.Application.current(),l=$.isFunction(o.label)?o.label():void 0;Frames.isEmpty(l)||(0===l.indexOf("{")&&(l=_(l.substring(1,l.length-1))),n.title=l)}var d=Frames.Config.get("GRID_FITCOLS","false"),u=!1;if("auto"==d)try{var c=parseInt(n.width,10);$.isNumeric(c)&&c>this._w&&(u=!0)}catch(e){}else u=Frames.isTrue(d);if(n.autofit=u,Frames.focus.callback=$.noop,!Frames.isUndef(i.block)&&!Frames.isUndef(i.block.item))try{Frames.Validation.hideError(i.block.item)}catch(e){}i.openView(r,!0,$.proxy(this._viewReady,this)),i.view._LOV_=n;Frames.Application.blockExecution("lov",["LOV_OK","LOV_CLOSE","LOV_FILTER","WHEN-WINDOW-CLOSED","NEXT_RECORD","PREVIOUS_RECORD","LOV_SETUP_PAGE","FIRST_PAGE","NEXT_PAGE","PREVIOUS_PAGE","LAST_PAGE","GOTO_PAGE"],!1)},_parseCols:function(e){var t,i=[];if(this._w=0,e&&0<e.length)for(t=0;t<e.length;t++){var a=e[t],s=parseInt(Frames.Model.attr(a,"width"),10);$.isNaN(s)&&(s=parseInt(Frames.Model.attr(a,"witdh"),10));var r={member:Frames.Model.attr(a,"name"),type:Frames.Model.attr(a,"dataType"),title:Frames.Model.attr(a,"label"),width:s,editor:"none",format:Frames.Model.attr(a,"formatMask")};$.isNaN(s)||0===s||(i.push(r),this._w+=s)}return i},_viewReady:function(e,t,i){var a=this,s=t._LOV_;delete t._LOV_,t.title(s.title),t.show();var r=(this.view=t)._container,n=r.parent(),o=Frames.get("grdLov");o._grid.setOptions({autoHeight:!1,forceFitColumns:s.autofit,editable:!1,enableCellNavigation:!0}),o.columns(s.columns);var l={},d=!1;if(s.width&&(l.minwidth=Math.max(s.width,425),d=!0),s.height&&(l.height=s.height,d=!0),r.parent().find(".ui-dialog-title").css("width",l.width),d){o.elem.css("height",l.height),o.elem.css("width","100%"),n.css("min-width",l.minwidth),r.css("min-width",l.minwidth);var u=Frames.Dialog.container();if(r.parent().height()>$(u).height()){var c=r.parent().height()-.85*$(u).height(),p=o.elem.height()-c;o.elem.css("height",p)}o._grid.resizeCanvas(),r.dialog("option","position","center")}var m=e.get("LOVDIAG"),h=Frames.get("filterLov"),f=h.elem.next(),g=$("#btok",r),_=$("#btclose",r);s.autofilter&&f.hide(),h.enterHasTab=function(){return!1},h.elem.keydown($.proxy(this.filterInputKeyDownHandler,this)),f.keydown(this.filterButtonHandler),_.keydown(this.cancelButtonHandler),g.keydown(this.okButtonHandler),s.autofilter&&h.value(""),s.criteria&&h.value(s.criteria),m.name=s.name,m.item=h,Frames.focus.callback=a.focus,Frames.Application._viewReady(e,t,i),a.focus(),r.parent().find(".slick-pager").css("width","100%"),r.trap(),o._grid.autosizeColumns(),e.view=s.last,$("#grdLov .grid-canvas",r).on("dblclick",".slick-row",this.gridDblClickHandler),r.on("click",function(){h.input().focus()}),this.selectLovRow(0),o._grid.onClick.subscribe(this.onClickHandler),Frames.Application.on("endbind",this._endBind),r.off("dialogbeforeclose").on("dialogbeforeclose",function(e,t){a.view&&Frames.Dialog.LOV.execute("LOV_CLOSE",!0)})},gridDblClickHandler:function(e){Frames.Dialog.LOV.execute("LOV_OK",!0)},okButtonHandler:function(e){var t=Frames.Dialog.LOV.view._container,i=$("#filterLov input",t),a=$("#btclose",t),s=Frames.Keys.string(e);return"TAB"==s?(i.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(a.focus(),e.stopPropagation(),!1):void 0},cancelButtonHandler:function(e){var t=Frames.Dialog.LOV.view._container,i=$("#filterLov input",t),a=$("#btfilter",t),s=$("#btok",t),r=a.is(":visible")?a:i,n=Frames.Keys.string(e);return"TAB"==n?(s.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==n?(r.focus(),e.stopPropagation(),!1):void 0},filterButtonHandler:function(e){var t=Frames.Dialog.LOV.view._container,i=$("#filterLov input",t),a=$("#btclose",t),s=Frames.Keys.string(e);return"TAB"==s?(a.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(i.focus(),e.stopPropagation(),!1):void 0},filterInputKeyDownHandler:function(e){if(!Frames.Application.executing()){var t=Frames.Dialog.LOV.view._container,i=$("#grdLov",t).data("frames"),a=i.block.paging,s=Frames.Keys.string(e),r=Frames.Config.getaction(s);r&&-1!=$.inArray(r.name,["NEXT_PAGE","PREVIOUS_PAGE","FIRST_PAGE","LAST_PAGE"])&&(Frames.Dialog.LOV.execute(r.name),e.stopPropagation());var n=Frames.Config.getaction_name("NEXT_RECORD").accesskey,o=Frames.Config.getaction_name("PREVIOUS_RECORD").accesskey;if(s==n||s==o){rowChanged=!0,clearTimeout(this._timer);var l=s==o?-1:1,d=i._grid.getSelectedRows()[0]+l,u=i._grid.getDataLength()-1,c=a.size,p=a.number;a.records;if($.isNumeric(d)||(d=0),u<d){if(p<c)return Frames.Dialog.LOV.execute("NEXT_RECORD"),e.stopPropagation(),!1;d=u}if(d<0){if(1!=p)return Frames.Dialog.LOV.execute("PREVIOUS_RECORD"),e.stopPropagation(),!1;d=0}var m=p*c-c+(d+1);return this.selectLovRow(d),i._grid.scrollRowIntoView(d,!1),a.record=m,i._pager.update(),e.stopPropagation(),!1}if(e.keyCode==$.ui.keyCode.ENTER){if(clearTimeout(this._timer),0!==a.records){var h=rowChanged||Frames.Dialog.LOV.autofilter;Frames.Dialog.LOV.execute(h?"LOV_OK":"LOV_FILTER",h)}return e.stopPropagation(),!1}rowChanged=!1;var f=$("#btfilter",t),g=$("#btok",t),_=$("#btclose",t),v=f.is(":visible")?f:_,b=g;return r&&"TAB"!=s&&"SHIFT+TAB"!=s?(e.stopPropagation(),!1):"TAB"==s?(v.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(b.focus(),e.stopPropagation(),!1):void(Frames.Dialog.LOV.autofilter&&this._autofilterHandler(e))}},onClickHandler:function(e,t){rowChanged=!0;var i=t.grid._frames,a=t.row;Frames.Dialog.LOV.selectLovRow(a),i._grid.scrollRowIntoView(a,!1);var s=i.block.paging,r=s.size,n=s.number,o=(s.records,n*r-r+(a+1));s.record=o,i._pager.update()},_endBind:function(){var e=Frames.Dialog.LOV.view._container,t=$("#grdLov",e).data("frames");if(void 0!==t){var i=t.block.paging.index;Frames.Dialog.LOV.selectLovRow(i),t._grid.scrollRowIntoView(i,!1)}},_autofilterHandler:function(e){clearTimeout(this._timer),e.keyCode!=$.ui.keyCode.ENTER&&e.keyCode!=$.ui.keyCode.TAB&&e.keyCode!=$.ui.keyCode.ESCAPE&&17!=e.keyCode&&16!=e.keyCode&&(this._timer=setTimeout(function(){Frames.Dialog.LOV.execute("LOV_FILTER",!1)},300))},execute:function(e,t){Frames.isTrue(t)||(Frames.focus.callback=this.focus),Frames.Application.execute(e,null,null,null,null,!1),Frames.isTrue(t)&&this.close()},focus:function(){var e=Frames.get("filterLov",null,Frames.Dialog.LOV.view);Frames.isUndef(e)||(Frames.Dialog.LOV.autofilter?$(e.input()).is(":focus")||e.input().select():e.focus())},close:function(){if(!Frames.isUndef(this.view)){var e=this.view,t=Frames.Application.task;delete this.view,delete this._w,t.closeView(e),Frames.Application.off("endbind",this._endBind),Frames.Application.unblockExecution()}},selectLovRow:function(e){var t=Frames.Dialog.LOV.view._container,i=$("#grdLov",t).data("frames");i.block.select(e);for(var a="",s=i.columns(),r=(i._grid.getData().getItem(e),0);r<s.length;r++){a+=s[r].title+": "+$('#grdLov div.selected div[data-member="'+s[r].field+'"]').text()+". "}Frames.arianotify(a)}},Frames.Dialog.LOVBlock=$.inherit(Frames.Block,{__constructor:function(e){Frames.Block.prototype.__constructor.apply(this,[e]),this.props("IgnoreNavigation",!0)},controlInfo:function(e){Frames.Block.prototype.controlInfo.apply(this,[e]),this.props("IgnoreNavigation",!0)},select:function(e){e=String(e),this.selid=this.idOf(e),this.selidx=e,this._last_id=this.selid,this.refresh()},model:function(){var e,t=Frames.get("grdLov",null,Frames.Dialog.LOV.view),i=Frames.get("filterLov",null,Frames.Dialog.LOV.view);if(0===arguments.length){var a=t.selected();(Frames.isUndef(a)||-1==a)&&(a=0);var s=i.value(),r=Frames.Model.create("list",null,{name:this.name}),n=Frames.Model.create("item",s,{name:"searchText"}),o=Frames.Model.create("data",null,{selected:a});return Frames.Model.append(r,n),Frames.Model.append(r,o),r}if(e=arguments[0],this._recs=new Frames.HashMap,e){var l,d=Frames.find(e,"list",this.name);if(d){var u=d[0].data;if(!u)return;e=u[0],Frames.get("btok",null,Frames.Dialog.LOV.view).enabled(!!e.record);var c,p=e.page;for(Frames.isUndef(p)||(Frames.isUndef(this.paging)&&(this.paging=new Frames.Dialog.LOVPaging(this)),t.pager=!0,this.paging.controlInfo(p[0])),this._BINDS_.reset();this._BINDS_.hasNext();){this._BINDS_.next().model(e)}if((c=e.record)&&0<c.length)for(this.selid=Frames.Model.attr(c[0],"id"),l=this.selidx=0;l<c.length;l++)this._recs.put(Frames.Model.attr(c[l],"id"),l);this.selid=Frames.Model.attr(e,"selected"),(Frames.isUndef(this.selid)||""===this.selid)&&t.selected(0)}}}}),Frames.Dialog.LOVPaging=$.inherit(Frames.Paging,{execute:function(e,t){Frames.focus.callback=Frames.Dialog.LOV.focus;var i=this.block.item;Frames.isUndef(i)&&(i=this.block.get(0)),Frames.isUndef(t)&&(t=[{name:"pageSize",value:0,type:"int"}]),Frames.Application.execute({name:e,params:t},void 0,void 0,this.block.name,i.member,!1)}})}(jQuery),function($){Frames.Dialog.Edit={load:function(e,t){var i=Frames.Application.task,a=Frames.Application.mainTask.view.id,s=(a=a.substring(0,a.lastIndexOf("/")))+"/EditDialog";Frames.Dialog.Edit.maxlength=Frames.Config.getbool("DIALOG_MAX_LENGHT",!1);var r={name:"editDialog",title:_(Frames.Locale.messages.EDIT_DIALOG),last:i.view,block:Frames.isUndef(e)?i.block:i._BLOCKS_.get(e),item:Frames.isUndef(t)?i.block.item:Frames.isUndef(e)?i.block.get(t):i._BLOCKS_.get(e).get(t)};Frames.focus.callback=$.noop,i.openView(s,!0,Frames.Dialog.Edit._viewReady),i._EDIT_=r,Frames.Application.mainTask._EDIT_=r;Frames.Application.blockExecution("edit",["EDIT_OK","EDIT_CANCEL","WHEN-WINDOW-CLOSED"],!1)},_viewReady:function(e,t,i){var a=e._EDIT_,s=(Frames.Dialog.Edit.view=t)._container,r=Frames.get("editinput",null,t);Frames.Dialog.Edit._edit_item_=r;var n=a.item.value(),o=a.item.defaultValue;if(Frames.isUndef(o)?r.value(n):n===o.replace(/\r?\n|\r/g,"")?r.value(o):r.value(n),r.props("maxlength",a.item.props("maxlength")),Frames.Dialog.Edit.maxlength){var l=Frames.get("maxlength",null,t),d=a.item.props("maxlength");Frames.isUndef(l)||Frames.isUndef(d)||l.value(_("DIALOG_MAX_LENGHT",d))}var u=a.item.context?a.item.context:a.item;t.title(a.title);var c=u.label();Frames.isEmpty(c)&&0===(c=t._container.dialog("option","title")).indexOf("{")&&(c=_(c.substring(1,c.length-1))),t._container.dialog("option","title",c),e.view=a.last,Frames.Dialog.Edit.focus(),s.off("dialogbeforeclose").on("dialogbeforeclose",function(e,t){Frames.Dialog.Edit.view&&Frames.Dialog.Edit.execute("EDIT_CANCEL",!0)}),s.on("click",function(){r.focus()});var p=$("#editinput textarea",s),m=$("#btok",s),h=$("#btclose",s);p.keydown(Frames.Dialog.Edit.inputHandler),m.keydown(Frames.Dialog.Edit.okButtonHandler),h.keydown(Frames.Dialog.Edit.cancelButtonHandler)},execute:function(e,t){Frames.isTrue(t)?delete Frames.focus.callback:Frames.focus.callback=Frames.Dialog.Edit.focus;var i=null;if("EDIT_OK"==e){var a=Frames.Application.task.block,s=Frames.Dialog.Edit._edit_item_,r=Frames.Application.mainTask._EDIT_,n=r.item.context?r.item.context:r.item;i=Frames.Model.create("model");var o=Frames.Model.create("block",null,{name:a.name,selected:a.selid}),l=Frames.Model.create("record",null,{id:a.selid,status:"C"}),d=Frames.Model.create("item",s.value(),{name:n.member});Frames.Model.append(i,o),Frames.Model.append(o,l),Frames.Model.append(l,d)}delete Frames.Dialog.Edit._edit_item_,Frames.Application.execute(e,null,i,null,null,!1),Frames.isTrue(t)&&Frames.Dialog.Edit.close()},focus:function(){var e=Frames.Application.task;if(e._EDIT_){var t=e._EDIT_;delete e._EDIT_,e.block=t.block,e.block.item=t.item}var i=Frames.get("editinput",null,Frames.Dialog.Edit.view);if(!Frames.isUndef(i)){var a=e.block.item.context?e.block.item.context:e.block.item;i.editable(a.editable()),i.focus()}},close:function(){if(!Frames.isUndef(Frames.Dialog.Edit.view)){var e=Frames.Dialog.Edit.view,t=Frames.Application.task;delete Frames.Dialog.Edit.view,t.closeView(e),Frames.Application.unblockExecution()}},inputHandler:function(e){var t=Frames.Dialog.Edit.view._container,i=$("#btok",t),a=$("#btclose",t),s=Frames.Keys.string(e);return"TAB"==s?(a.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(i.focus(),e.stopPropagation(),!1):void 0},okButtonHandler:function(e){var t=Frames.Dialog.Edit.view._container,i=$("#editinput textarea",t),a=$("#btclose",t),s=Frames.Keys.string(e);return"TAB"==s?(i.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(a.focus(),e.stopPropagation(),!1):void 0},cancelButtonHandler:function(e){var t=Frames.Dialog.Edit.view._container,i=$("#editinput textarea",t),a=$("#btok",t),s=Frames.Keys.string(e);return"TAB"==s?(a.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(i.focus(),e.stopPropagation(),!1):void 0}}}(jQuery),function($){Frames.Dialog.Editor={load:function(e,t){var i=Frames.Application.task,a=Frames.Application.mainTask.view.id,s=(a=a.substring(0,a.lastIndexOf("/")))+"/EditorDialog",r={name:"editDialog",title:e||_(Frames.Locale.messages.EDIT_DIALOG),last:i.view,msgin:t};i.openView(s,!0,Frames.Dialog.Editor._viewReady),i._EDITOR_=r,Frames.Application.mainTask._EDITOR_=r;Frames.Application.blockExecution("editor",["EDITOR_OK","EDITOR_CANCEL","WHEN-WINDOW-CLOSED"],!1)},_viewReady:function(e,t,i){var a=e._EDITOR_,s=(Frames.Dialog.Editor.view=t)._container,r=Frames.get("editinput",null,t);(Frames.Dialog.Editor.value=r).value(a.msgin),t.title(a.title);var n=t._container.dialog("option","title");0===n.indexOf("{")&&(n=_(n.substring(1,n.length-1))),t._container.dialog("option","title",n),e.view=a.last,Frames.Dialog.Editor.focus(),s.off("dialogbeforeclose").on("dialogbeforeclose",function(e,t){Frames.Dialog.Editor.view&&Frames.Dialog.Editor.execute("EDITOR_CANCEL",!0)}),s.on("click",function(){r.focus()});var o=$("#editinput textarea",s),l=$("#btok",s),d=$("#btclose",s);o.keydown(Frames.Dialog.Editor.inputHandler),l.keydown(Frames.Dialog.Editor.okButtonHandler),d.keydown(Frames.Dialog.Editor.cancelButtonHandler)},execute:function(e,t){Frames.isTrue(t)||(Frames.focus.callback=Frames.Dialog.Editor.focus);var i="";if("EDITOR_OK"==e){var a=Frames.get("editinput",null,Frames.Dialog.Editor.view);i=Frames.Model.encode(a.value(),!0)}Frames.Application.execute({name:e,params:[{name:"messageOut",value:i,type:"String"}]},void 0,void 0,void 0,void 0,!1),Frames.isTrue(t)&&Frames.Dialog.Editor.close()},focus:function(){var e=Frames.Application.task;e._EDITOR_&&delete e._EDITOR_;var t=Frames.get("editinput",null,Frames.Dialog.Editor.view);Frames.isUndef(t)||t.focus()},close:function(){if(!Frames.isUndef(Frames.Dialog.Editor.view)){var e=Frames.Dialog.Editor.view,t=Frames.Application.task;delete Frames.Dialog.Editor.view,t.closeView(e),Frames.Application.unblockExecution()}},inputHandler:function(e){var t=Frames.Dialog.Editor.view._container,i=$("#btok",t),a=$("#btclose",t),s=Frames.Keys.string(e);return"TAB"==s?(a.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(i.focus(),e.stopPropagation(),!1):void 0},okButtonHandler:function(e){var t=Frames.Dialog.Editor.view._container,i=$("#editinput textarea",t),a=$("#btclose",t),s=Frames.Keys.string(e);return"TAB"==s?(i.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(a.focus(),e.stopPropagation(),!1):void 0},cancelButtonHandler:function(e){var t=Frames.Dialog.Editor.view._container,i=$("#editinput textarea",t),a=$("#btok",t),s=Frames.Keys.string(e);return"TAB"==s?(a.focus(),e.stopPropagation(),!1):"SHIFT+TAB"==s?(i.focus(),e.stopPropagation(),!1):void 0}}}(jQuery),function($){$.widget("ui.chart",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-chart ui-widget ui-widget-content ui-corner-all")},_destroy:function(){this.element.removeClass("ui-chart ui-widget ui-widget-content ui-corner-all")},wrapper:function(e){this.element.data("frames",e)},refresh:function(){self=this},clear:function(){},value:function(){return null}}),Frames.Chart=$.inherit(Frames.Item,{__constructor:function(e){this.elem=e,this.canvas=$("<canvas>").appendTo(e),this.canvas.width(e.width()),this.canvas.height(e.height()),this.dataSourceStrategy=this.recordsToSeriesStrategy;var t={type:"bar",options:{maintainAspectRatio:!1,scales:{yAxes:[{ticks:{beginAtZero:!0}}]}}};Frames.isEmpty(this.data("title"))||(t.options.title={display:!0,text:this.data("title")}),Frames.isEmpty(this.data("sort"))||(t.options.sort=this.data("sort")),Frames.isEmpty(this.data("suffix"))||(t.options.suffix=this.data("suffix"));var a=$("script",this.elem);if(!Frames.isUndef(a)&&0<a.length)if(t.data=$.parseJSON(a.text()),!t.data||Frames.isUndef(t.data.series)||Frames.isUndef(t.data.series.items)){if(t.data&&!Frames.isUndef(t.data.series)&&1<t.data.series.length)for(i=0;i<t.data.series.length;i++){s=1==t.data.series[i].items.length,r=0<t.data.series[i].items.length&&void 0!==t.data.series[i].items[0].values&&0<t.data.series[i].items[0].values.length;this.dataSourceStrategy=s&&r?this.recordsToSeriesStrategy:this.itemsToSeriesStrategy}}else{var s=1==t.data.series.items.length,r=void 0!==t.data.series.items[0].values&&0<t.data.series.items[0].values.length;s&&r?(this.dataSourceStrategy=this.recordsToSeriesStrategy,this.seriesValues(t.data.series)):(this.dataSourceStrategy=this.itemsToSeriesStrategy,this.itemsSeries(t.data.series))}this.opts=t,this.initChartOptions()},initChartOptions:function(){},seriesValues:function(e){this.data("labelitem",e.items[0].member),this.data("valueitems",e.items[0].values);var t=e.items[0].values.map(function(e){return e.color}).filter(function(e){return void 0!==e});t&&0<t.length?this.data("colors",t):Frames.isUndef(this.data("colors"))&&e.colors&&this.data("colors",e.colors.split(","))},recordsToSeriesStrategy:function(e){if(1<this.opts.data.series.length){var t=[],a=this.opts.data.series;for(i=0;i<a.length;i++)"bar"==a[i].type?(this.opts.type="horizontal"===this.data("orientation")?"horizontalBar":"bar",this.dataSourceStrategy=Frames.BarChart.prototype.recordsToSeriesStrategy,this.seriesValues(a[i]),this.dataSourceStrategy(e)):"line"==a[i].type&&(this.dataSourceStrategy=Frames.LineChart.prototype.recordsToSeriesStrategy,this.seriesValues(a[i]),this.dataSourceStrategy(e)),t.push(this.opts.data);this.dataSourceStrategy=Frames.Chart.prototype.recordsToSeriesStrategy,this.opts.data.datasets=[].concat(t[0].datasets,t[1].datasets),this.opts.data.series=a}},itemsToSeriesStrategy:function(e){if(1<this.opts.data.series.length){var t=[],a=this.opts.data.series;for(i=0;i<a.length;i++)"bar"==a[i].type?(this.opts.type="horizontal"===this.data("orientation")?"horizontalBar":"bar",this.dataSourceStrategy=Frames.BarChart.prototype.itemsToSeriesStrategy,this.itemsSeries(a[i]),this.dataSourceStrategy(e)):"line"==a[i].type&&(this.dataSourceStrategy=Frames.LineChart.prototype.itemsToSeriesStrategy,this.itemsSeries(a[i]),this.dataSourceStrategy(e)),t.push(this.opts.data);this.dataSourceStrategy=Frames.Chart.prototype.itemsToSeriesStrategy,this.opts.data.datasets=[].concat(t[0].datasets,t[1].datasets),this.opts.data.series=a}},itemsSeries:function(e){this.data("labelitem",e.member),this.data("valueitems",e.items),e.colors&&this.data("colors",e.colors.split(","))},init:function(e){Frames.Item.prototype.init.apply(this,[e]),this.block&&this.block.bindable(this)},destroy:function(){this.autounregister(),Frames.isUndef(this._chart)||(this._chart.destroy(),delete this._chart),delete this.view,delete this.elem},rules:function(){return null},model:function(){if(0===arguments.length)return null;var e=arguments[0];Frames.isUndef(this._chart)||this._chart.destroy(),e&&this.dataSourceStrategy(e),this._chart=new Chart(this.canvas,this.opts)},selected:function(){if(0===arguments.length)return this.block.selidx},describe:function(){var e=Frames.Item.prototype.describe.apply(this);return e.group="_ignore_",e}}),Frames.regtype("chart",Frames.Chart)}(jQuery),jQuery.extend(Frames.Chart.prototype,{describe:function(){return{draggable:this.elem,resizable:this.elem}}}),function($){$.widget("ui.barchart",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-chart ui-widget ui-widget-content ui-corner-all")},_destroy:function(){this.element.removeClass("ui-chart ui-widget ui-widget-content ui-corner-all")},wrapper:function(e){this.element.data("frames",e)},refresh:function(){self=this},clear:function(){},value:function(){return null}}),Frames.BarChart=$.inherit(Frames.Chart,{initChartOptions:function(){this.opts.type="horizontal"===this.data("orientation")?"horizontalBar":"bar"},widgetcls:function(){return"barchart"},recordsToSeriesStrategy:function(e){var n=this,o=e.record;o&&("DESC"==this.opts.options.sort?e.record.sort():"ASC"==this.opts.options.sort&&e.record.reverse());var i=this.data("labelitem"),t=this.data("valueitems"),l=this.data("colors"),d=this.data("orientation"),a=o.map(function(e){var t=e.find("item[@name="+i+"]");return t&&0<t.length?t[0].Text:""}),s=t.map(function(e,t){var i=e.label,a=e.member,s=[];if(l&&!Frames.isEmpty(l[t]))s=o.map(function(e){return l[t]});else{var r="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")";l=n.data("colors")||[],t<l.length?l[t]=r:l.push(r),n.data("colors",l),s=o.map(function(e){return r})}return{label:Frames.isEmpty(i)?a:i,data:o.map(function(e){var t=e.find("item[@name="+a+"]");return t&&0<t.length?t[0].Text:""}),backgroundColor:s,type:"horizontal"===d?"horizontalBar":"bar"}});this.opts.data={labels:a,datasets:s}},itemsToSeriesStrategy:function(e){var n=this,t=e.record,o=this.data("labelitem"),l=this.data("valueitems"),d=this.data("colors"),u=this.data("orientation"),i=l.map(function(e,t){var i=e.label;return Frames.isEmpty(i)?e.member:i}),a=t.map(function(a,t){var e=a.find("item[@name="+o+"]"),i=e&&0<e.length?e[0].Text:"",s=[];if(d&&!Frames.isEmpty(d[t]))s=l.map(function(e){return d[t]});else{var r="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")";d=n.data("colors")||[],t<d.length?d[t]=r:d.push(r),n.data("colors",d),s=l.map(function(e){return r})}return{label:i,data:l.map(function(e){var t=e.member,i=a.find("item[@name="+t+"]");return i&&0<i.length?i[0].Text:""}),backgroundColor:s,type:"horizontal"===u?"horizontalBar":"bar"}});this.opts.data={labels:i,datasets:a}},xvcName:function(){return"barchart"},buildXvcPropsMap:function(){var e=Frames.Chart.prototype.buildXvcPropsMap.apply(this,arguments);return $.extend(e,{orientation:{type:"data"}}),e}}),Frames.regtype("barchart",Frames.BarChart)}(jQuery),jQuery.extend(Frames.BarChart.prototype,{template:function(){return'<div data-widget="barchart" id="{{=data.uuid}}" data-name="{{=data.uuid}}" style="height:140px; width:300px;" data-block="{{=data.block}}" class="ui-widget ui-chart ui-widget-content"></div>'}}),function($){$.widget("ui.linechart",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-chart ui-widget ui-widget-content ui-corner-all")},_destroy:function(){this.element.removeClass("ui-chart ui-widget ui-widget-content ui-corner-all")},wrapper:function(e){this.element.data("frames",e)},refresh:function(){self=this},clear:function(){},value:function(){return null}}),Frames.LineChart=$.inherit(Frames.Chart,{initChartOptions:function(){this.opts.type="line"},widgetcls:function(){return"linechart"},recordsToSeriesStrategy:function(e){var r=this,n=e.record;n&&("DESC"==this.opts.options.sort?e.record.sort():"ASC"==this.opts.options.sort&&e.record.reverse());var a=this.data("labelitem"),t=this.data("valueitems"),o=this.data("colors"),i=n.map(function(e){var t=Frames.Model.findSingle(e,"item",a),i=Frames.Model.text(t);return Frames.isUndef(i)?"":i}),s=t.map(function(e,t){var i=e.label,a=e.member,s="";o&&!Frames.isEmpty(o[t])?s=o[t]:(s="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")",t<(o=r.data("colors")||[]).length?o[t]=s:o.push(s),r.data("colors",o));return{label:Frames.isEmpty(i)?a:i,fill:!1,data:n.map(function(e){var t=Frames.Model.findSingle(e,"item",a),i=Frames.Model.text(t);return Frames.isUndef(i)?void 0:i}),borderColor:s,backgroundColor:s,type:"line"}});this.opts.data={labels:i,datasets:s}},itemsToSeriesStrategy:function(e){var n=this,t=e.record,o=this.data("labelitem"),l=this.data("valueitems"),d=this.data("colors"),i=l.map(function(e,t){var i=e.label;return Frames.isEmpty(i)?e.member:i}),a=t.map(function(s,e){var t=Frames.Model.findSingle(s,"item",o),i=Frames.Model.text(t),a=Frames.isUndef(i)?"":i,r="";d&&!Frames.isEmpty(d[e])?r=d[e]:(r="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")",e<(d=n.data("colors")||[]).length?d[e]=r:d.push(r),n.data("colors",d));return{label:a,fill:!1,data:l.map(function(e){var t=e.member,i=Frames.Model.findSingle(s,"item",t),a=Frames.Model.text(i);return Frames.isUndef(a)?"":a}),borderColor:r,backgroundColor:r,type:"line"}});this.opts.data={labels:i,datasets:a}},xvcName:function(){return"linechart"}}),Frames.regtype("linechart",Frames.LineChart)}(jQuery),jQuery.extend(Frames.LineChart.prototype,{template:function(){return'<div data-widget="linechart" id="{{=data.uuid}}" data-name="{{=data.uuid}}" style="height:140px; width:300px;" data-block="{{=data.block}}" class="ui-widget ui-chart ui-widget-content"></div>'}}),function($){$.widget("ui.piechart",{version:"@VERSION",options:{},_create:function(){this.element.addClass("ui-chart ui-widget ui-widget-content ui-corner-all")},_destroy:function(){this.element.removeClass("ui-chart ui-widget ui-widget-content ui-corner-all")},wrapper:function(e){this.element.data("frames",e)},refresh:function(){self=this},clear:function(){},value:function(){return null}}),Frames.PieChart=$.inherit(Frames.Chart,{initChartOptions:function(){this.opts.type="pie"},widgetcls:function(){return"piechart"},itemsToSeriesStrategy:function(e){var a=this,s=e.record,i=this.data("labelitem"),t=this.data("valueitems"),r=this.data("colors"),n=s.map(function(e){var t=e.find("item[@name="+i+"]");return t&&0<t.length?t[0].Text:""}),o=s.map(function(e,t){var i="";r&&!Frames.isEmpty(r[t])?i=r[t]:(i="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")",t<(r=a.data("colors")||[]).length?r[t]=i:r.push(i),a.data("colors",r));return i})||[],l=t.map(function(e){return e.label}),d=t.map(function(e,t){var i=e.member;return{data:s.map(function(e){var t=e.find("item[@name="+i+"]");return t&&0<t.length?t[0].Text:""}),backgroundColor:o,label:l,suffix:Frames.isUndef(a.opts.options.suffix)?"":a.opts.options.suffix}});this.opts.data={labels:n,datasets:d},this.opts.options.tooltips={callbacks:{label:function(e,t){return" ("+t.labels[e.index]+") "+t.datasets[e.datasetIndex].label[e.datasetIndex]+": "+t.datasets[e.datasetIndex].data[e.index]+t.datasets[e.datasetIndex].suffix}}}},recordsToSeriesStrategy:function(e){var s=this,t=e.record,i=this.data("labelitem"),r=this.data("valueitems"),n=this.data("colors"),a=r.map(function(e,t){var i=e.label;return Frames.isEmpty(i)?e.member:i}),o=(r.map(function(e,t){var i="";n&&!Frames.isEmpty(n[t])?i=n[t]:(i="rgb("+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+","+Math.floor(256*Math.random())+")",t<(n=s.data("colors")||[]).length?n[t]=i:n.push(i),s.data("colors",n));return i}),t.map(function(e){var t=e.find("item[@name="+i+"]");return t&&0<t.length?t[0].Text:""})),l=t.map(function(a){a.find("item[@name="+i+"]");return{data:r.map(function(e){var t=e.member,i=a.find("item[@name="+t+"]");return i&&0<i.length?i[0].Text:""}),backgroundColor:n,label:o,suffix:Frames.isUndef(s.opts.options.suffix)?"":s.opts.options.suffix}});this.opts.data={labels:a,datasets:l},this.opts.options.tooltips={callbacks:{label:function(e,t){return" ("+t.datasets[e.datasetIndex].label[e.datasetIndex]+") "+t.labels[e.index]+": "+t.datasets[e.datasetIndex].data[e.index]+t.datasets[e.datasetIndex].suffix}}}}}),Frames.regtype("piechart",Frames.PieChart)}(jQuery),jQuery.extend(Frames.PieChart.prototype,{template:function(){return'<div data-widget="piechart" id="{{=data.uuid}}" data-name="{{=data.uuid}}" style="height:140px; width:300px;" data-block="{{=data.block}}" class="ui-widget ui-chart ui-widget-content"></div>'}}),function($){Frames.DataGrid=$.inherit(Frames.Item,{__constructor:function(e){var s=this;e.addClass("ui-datagrid ui-widget"),this.elem=e;var t=$("script",this.elem);this._GROUPTOTALS_=new Frames.HashMap,this._CTX_=new Frames.HashMap,this._w=0,this._columns=[],this._headerCheckboxState={};try{var i=(1<t.length?t.filter("[data-role='columns']"):t).text();if(!Frames.isEmpty(i)){var a=$.parseJSON(i);if(this._parseColumns(a),1<t.length){var r=t.filter("[data-role='grouping']").text();Frames.isEmpty(r)||(a=$.parseJSON(r),this._parseGrouping(a)),r=t.filter("[data-role='totals']").text(),Frames.isEmpty(r)||(a=$.parseJSON(r),this._parseTotals(a))}}}catch(e){0}var n=this.elem.data("editable");this._force_editable=!!Frames.isUndef(n)||Frames.isTrue(n),this._rtl="rtl"===this.elem.css("direction"),this._gridFitCols=Frames.Config.get("GRID_FITCOLS",!1);var o=this.elem.data("pager");this.pager=Frames.isUndef(o)?Frames.Config.getbool("GRID_PAGER",!1):Frames.isTrue(o);var l=this.elem[0].style.bottom;l=Frames.isEmpty(l)?void 0:l;var d=Frames.isEmpty(this.elem[0].style.height)&&Frames.isEmpty(l),u={editable:!0,enableCellNavigation:!0,enableColumnReorder:this._columnReorder(),asyncEditorLoading:!1,enableAsyncPostRender:!0,asyncPostRenderDelay:1,autoEdit:!0,autoHeight:d,rowHeight:this._rowH,headerHeight:this.elem.data("header-height"),multiColumnSort:!0,multiSelect:!1,rtl:this._rtl};if(this._parentResize_fn=function(e){s._grid&&s._grid.resizeCanvas(e)},Frames.isFalse(d)&&!Frames.isUndef(l)&&(this.elem.css("height",this.elem.height()),this.elem.parent().bind("resize",this._parentResize_fn)),this._fixedCols=0,$.isNumeric(this.elem.data("fixedcols"))){var c=parseInt(this.elem.data("fixedcols"),10);0<=c&&(this._fixedCols=c,$(".ui-gridview").closest(".ui-panel").removeClass("ui-panel-layout-grid"))}this._createCssRules(u);var p=this._getColumnsInfo();u.frozenColumn=p.frozenColumn,u.forceFitColumns=this._calculateForceFitColumns(p.columns),void 0===Frames.DataGrid._cfggroup&&(Frames.DataGrid._cfggroup=Frames.Config.getbool("GRID_GROUPING",!1));var m,h=[];Frames.DataGrid._cfggroup&&(m=new Slick.Data.GroupItemMetadataProvider({groupFocusable:!1,enableExpandCollapse:!1}),this._dataView=new Slick.Data.DataView({groupItemMetadataProvider:m,inlineFilters:!0}),h=this._dataView),this._grid=new Slick.Grid(e,h,p.columns,u),Frames.DataGrid._cfggroup&&(this._dataView.onRowCountChanged.subscribe(function(e,t){s._grid.updateRowCount(),s._grid.render()}),this._dataView.onRowsChanged.subscribe(function(e,t){s._grid.invalidateRows(t.rows),s._grid.render()}),this._grid.registerPlugin(m)),this._grid.onKeyDown.subscribe(function(e){if(Frames.DataGrid.handleButton(e))return!1;e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.which=$.ui.keyCode.TAB)}),this._grid.onClick.subscribe(this.onClickHandler),this._grid.onDblClick.subscribe(this.onDblClickHandler),this._grid.onSort.subscribe(this.onSortHandler),this._grid._resetActiveCell=this._grid.resetActiveCell,this._grid.resetActiveCell=function(){var e=s._grid.getSelectedRows();s._grid._resetActiveCell.apply(s._grid),s._grid.setSelectedRows(e)};var f,g=this.elem.find(".grid-canvas");for(g.dblclick(function(e){if(!Frames.Application.executing()){var t=s._grid.getActiveCell();if(!Frames.isUndef(t)){var i=s._CTX_.get(s._grid.getColumns()[t.cell].field);if(i){i._elem.data("member",i.member);var a=i._col.events.dblclick;Frames.isUndef(a)&&(a=i._col.events.doubleclick),!0!==Frames.FocusManager._itemUnknownNavigation(e)||Frames.isUndef(a)||Frames.DataGrid.execute(i._elem,a,s.elem.attr("id"),t.row)}}}}),f=this._columns.length-1;0<=f;f--){var _=this._columns[f];_.headerSelection&&"checkbox"===_.editorType&&g.on("toggle",".ui-checkbox[data-member='"+_.field+"']",function(e,t){var i=s.elem.find("[id$="+t.colid+"] .ui-checkbox").eq(0);$(".ui-button-icon",i).is(".fa fa-check")&&!t.checked&&Frames.DataGrid.HeaderCheckBoxFormatter.click(i,!0)})}this._grid.setSelectionModel(new Slick.RowSelectionModel),(this._grid._frames=this).elem.data("frames",this),this.elem.parents(".ui-tabpage").bind("tabshow",function(e){s._grid.createCssRules()}).bind("tabhide",function(e){s._grid.removeCssRules()});var v=this.elem.closest(".ui-widget-content");if(v[0]){var b=v.closest("[data-widget]").data("frames");b&&b.bind("frames:show",function(e,t){v[0]===t.container[0]&&s._onParentContainerShow()})}u.autoHeight&&!e.parent().hasClass("ui-layout-positional")&&e.css("overflow","")},_columnReorder:function(){var e=this.elem;return!e.hasClass("ui-datagrid-colorder-disabled")&&(!!e.hasClass("ui-datagrid-colorder-enabled")||Frames.Config.getbool("GRID_COLUMN_REORDER",!1))},_calculateForceFitColumns:function(e){var t,i=0;if("auto"==this._gridFitCols){t=!1;for(var a=e.length-1;0<=a;a--)!1===e[a].visible||isNaN(e[a].width)||"number"!=typeof e[a].width||(i+=e[a].width);try{i<parseInt(this.elem.width(),10)&&(t=!0)}catch(e){}}else t=Frames.isTrue(this._gridFitCols);return t},_parseGrouping:function(e){$.isArray(e)&&(this._grouping=e)},_parseTotals:function(e){if($.isArray(e)){var t=e.map(function(e){return{columns:[],totals:e.totals}});this._grouping=this._grouping||[];for(var i=0,a=t.length;i<a;i++)this._grouping.push(t[i])}},updateTotalLabel:function(e,t,i){for(var a=this._grouping.length,s=0;s<a;s++){var r=this._grouping[s].totals;if(r)for(var n=r.length,o=0;o<n;o++){var l=r[o];Frames.isUndef(l.member)||"member"==l.type||l.member==t&&l.block==e&&(l.label=i)}}},setGrouping:function(i){var x=this;$.isArray(i)||(i=[i]),this.elem.addClass("ui-datagrid-grouping");for(var e=[],t=i.length,k=0;k<t;k++){var T;!function(){var e=i[k],s=e.columns,r=s.length;T={getter:function(e){for(var t="",i=0;i<r;i++)t+=(0<i?":":"")+e[s[i].member];return t},comparer:function(e,t){return 0==e.rows.length||0==t.rows.length?-1:e.rows[0].__idx__!=t.rows[0].__idx__?e.rows[0].__idx__<t.rows[0].__idx__?-1:1:0},formatter:function(e){for(var t=e.rows[0],i="",a=0;a<r;a++){i+=(0<a?", ":"")+t[s[a].member]}return i},aggregators:[],aggregateCollapsed:!1,lazyTotalsCalculation:!0,displayGroupRow:0<r};var F=e.totals;if(F){for(var y,t=F.length,w=new Frames.HashMap,C=0;C<t;C++)!function(){var e=F[C],t=e.ref,i=e.type,a=e.block,s=e.member,r=e.source;if(t)for(var n=x._columns.length-1;0<=n;n--){var o=x._columns[n];if(o.column_name===t){"member"!==i&&Frames.isUndef(s)||(r=(a?a+".":"")+s,a=void 0),s=o.field;break}}var l=x.elem.attr("id")+"_grouptotal_"+k+"_"+C,d={id:l,field:s,label:e.label,clazz:e.style,textalign:e.textalign,source:r,type:e.datatype,format:e.format};if("sum"===i)T.aggregators.push(new Slick.Data.Aggregators.Sum(d.field));else if("count"===i)T.aggregators.push(new Frames.DataGrid.CountAggregator(x,d));else if("member"===i){T.aggregators.push(new Frames.DataGrid.MemberAggregator(x,d));var u=r.split(".");if(0<u.length){var c=x._GROUPTOTALS_.get(r);if(c){var p=c.props("format");Frames.isEmpty(p)||(d.format=p);var m=c.props("StyleClass");Frames.isEmpty(m)||(d.clazz=m);var h=c.props("Label");Frames.isEmpty(h)||(d.label=h)}if(!c){var f=Frames.Application.task.get(u[0]),g=new Frames.DataGrid.GroupTotal(x,l,f,u[1]),_=w.get(r);Frames.isUndef(_)||g.labelid(_),x._GROUPTOTALS_.put(r,g)}}}else{if(!Frames.isUndef(s)){var v=x._GROUPTOTALS_.get(r);Frames.isUndef(v)?w.put(r,d.id):v.labelid(d.id)}T.aggregators.push(new Frames.DataGrid.NullAggregator(x,d))}for(var b=x._columns.length-1;0<=b;b--)if((y=x._columns[b]).field===s){y.groupTotalsFormatter=Frames.DataGrid.wrapGroupTotalFormatter(x,Frames.DataGrid.GroupTotalFormatter);break}}();w.clear()}}(),e.push(T)}this._dataView.setGrouping(e.reverse())},getItemRowIndex:function(e){try{var t=e.input(),i=t.data("row");if(void 0===i&&void 0!==e.selidx)i=e.selidx;else if(void 0===(i=t.attr("row"))){var a=t.data("rowid"),s=e.bindable(),r=s?s._grid:void 0;r&&"function"==typeof r.getData().getIdxById&&(i=r.getData().getIdxById([a]))}return i}catch(e){}},_createCssRules:function(e){var t=[];if(void 0!==e.headerHeight&&t.push("#"+this.elem.attr("id")+" .slick-header-column.ui-state-default { height:"+e.headerHeight+"px; }"),0<t.length){var i=$("<style type='text/css' rel='stylesheet' />").appendTo($("head"));i[0].styleSheet?i[0].styleSheet.cssText=t.join(" "):i[0].appendChild(document.createTextNode(t.join(" "))),this.$style=i}},_removeCssRules:function(){this.$style&&this.$style[0]&&this.$style.remove()},onEndBind:function(){if(!this._rerender){var i=$.unique($.map(this._GROUPTOTALS_.keys(),function(e){return e.substring(0,e.indexOf("."))}));if(0<i.length)0<$.map($.grep(this.block.task.data.block||{},function(e){var t=Frames.Model.attr(e,"name");return Frames.isTrue(Frames.Model.attr(e,"hasChanges"))&&-1!==$.inArray(t,i)}),function(e){return Frames.Model.attr(e,"name")}).length&&(this._rerender=!0)}if(this._rerender){this._grid.invalidate();var e=this._grid.getColumns();this._initCells(e),delete this._rerender}this._grid.getOptions().autoHeight,this._forceRefresh&&this.elem.is(":visible")&&this._onParentContainerShow();var t=this._getColumnsInfo();this._setStyles(t.columns)},_getItemFromDataEvent:function(e){var t,i=e.grid.getCellNode(e.row,e.cell);if(!Frames.isUndef(i)){var a=$(i).children(0).data("member");t=e.grid._frames._CTX_.get(a)}return Frames.isUndef(t)&&(t=e.grid._frames._CTX_.get(e.cell)),{item:t,cell:i}},onDblClickHandler:function(e,t){this._frames.onClickHandler.apply(this,arguments)},onClickHandler:function(e,t){Frames.Application.executing()&&(e.preventDefault(),e.stopImmediatePropagation());var i,a=this._frames._getItemFromDataEvent(t),s=a.cell,r=a.item;if(!Frames.isUndef(r)&&(Frames.isUndef(s)||(i=$(s).children(0).data("rowid")),"function"==typeof t.grid.getData().getIdxById&&(t.row=t.grid.getData().getIdxById([i])),!this._frames._testFocus(r,i,t.row,t).result))return e.preventDefault(),e.stopImmediatePropagation(),!1},_testFocus:function(e,t,i,a){if(!Frames.isUndef(t)){e.selid=t,e.selidx=i,e.block._selid_click=t;var s=e.block.item;!Frames.isUndef(s)&&s.bindable()==this&&s.hasChanges()&&(this._changed=s.block.selid)}if(!1===Frames.isTrue(e.resolve().props("Enabled"),!0))return{result:!1};var r=e.trigger(e,"focusin",null,a);if(Frames.isTrue(r.result)){var n=Frames.FocusManager._itemUnknownNavigation($.Event("focus",{target:r.target}));Frames.isTrue(n)&&Frames.FocusManager._itemUnknownNavigation($.Event("focuschange",{target:r.target}))}return delete e.selid,delete e.selidx,delete e.block._selid_click,delete this._changed,r},translateSort:function(e,t){if(Frames.Config.getbool("GRID_SORT_NONE",!1)){var i=t?"asc":"desc";return"desc"==e.sortorder&&(i="none"),e.sortorder=i}return String(t)},onSortHandler:function(e,t){var i=[],a=t.sortCols[0].sortCol.field,s=this;$.each(t.sortCols,function(e,t){i.push(t.sortCol.field+":"+s._frames.translateSort(t.sortCol,t.sortAsc)),s._frames._CTX_.get(t.sortCol.field)._col.sortorder=t.sortCol.sortorder}),Frames.Application.execute({name:"SORT",params:[{name:"members",value:i.join(","),type:"string"}]},void 0,void 0,this._frames.block.name,a,!1)},uuid:function(){if(Frames.isUndef(this._uuid)){var e,t=this.elem.attr("class").split(" ");for(e=0;e<t.length;e++)if(-1!=t[e].indexOf("slickgrid")){this._uuid=t[e];break}}return this._uuid},columns:function(){if(0===arguments.length)return this._columns;this._parseColumns(arguments[0]);var e=this._getColumnsInfo();this._setWidgetColumns(e.columns)},_setWidgetColumns:function(e){var t=this._getColumnsInfo(),i=this._grid.getOptions();i.frozenColumn!==t.frozenColumn&&(i.frozenColumn=t.frozenColumn,i.forceFitColumns=this._calculateForceFitColumns(e),this._grid.setOptions(i)),this._grid.onActiveCellChanged.unsubscribe(this._readonly_onActiveCellChangedHandler),this._grid.setColumns(e);for(var a=e.length-1;0<=a;a--)if(!0!==e[a].readonly)return;this._grid.onActiveCellChanged.subscribe(this._readonly_onActiveCellChangedHandler)},_readonly_onActiveCellChangedHandler:function(e,t){if(void 0!==t.row&&void 0!==t.cell){t.grid.scrollRowIntoView(t.row,!1);var i=t.grid.getColumns()[t.cell],a=t.grid._frames._CTX_.get(i.field),s=t.grid.getDataItem(t.row);(a.block.item=a).block.index(s.__id__),a.block.commitChanges()}},_parseColumns:function(e){if(this._columns=[],this._rowH=this.elem.data("row-height")||Frames.DataGrid.ROW_HEIGHT,!Frames.isUndef(e)){this._colw=120;var t,i=this.elem.width(),a=e.length*this._colw;for(t in i<a&&(this._colw=Math.round(i/e.length)),e){var s=e[t],r=this._parseColumn(t,s);if(this._columns.push(r),!Frames.isUndef(s.height)){var n=parseInt(s.height,10);n>this._rowH&&(this._rowH=n)}}delete this._colw}return this._columns},_parseColumn:function(e,t){var i={};if(t.columns){var a;for(a in i={id:this.elem.attr("id")+"_header"+e,name:t.title,columns:[]},t.columns){var s=t.columns[a],r=this._parseColumn(e+"_"+a,s);i.columns.push(r)}}else{if(i={id:this.elem.attr("id")+"_col"+e,column_name:t.name||"col"+e,name:t.title,field:t.member,editorType:"textinput",editor:Frames.DataGrid.TextCellEditor,editorIsDefault:!0,formatter:Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.CellFormatter),width:this._colw,visible:!0,title:t.title,editorDataType:t["editor-type"]||"",headerTooltip:t["data-headertooltip"]||"",enabled:!0!==t.readonly,asyncPostRender:$.proxy(Frames.DataGrid.PostRender,this),readonly:!0===t.readonly},!Frames.isEmpty(i.headerTooltip)&&0<=i.headerTooltip.indexOf("&")&&(i.headerTooltip=$("<div />").html(i.headerTooltip).text()),!Frames.isUndef(t.editor))switch(i.editorType=t.editor,i.editor=this._getEditor(t.editor),i.editorIsDefault=!1,t.editor){case"button":i.editable=!1,i.action=t.action,i.label=t.label,delete i.editor,i.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.ButtonFormatter);break;case"checkbox":var n=Frames.isTrue(Frames.Application._supportnulls),o=n&&Frames.isTrue(t.valueisnull),l=n&&Frames.isTrue(t.fvalueisnull),d=n&&Frames.isTrue(t.unvalueisnull);i.editable=!1,i.action=t.action,i.label=t.label,i.value=o?null:t.value?t.value:"",i.fvalue=l?null:t.fvalue?t.fvalue:"",i.unvalue=d?null:t.unvalue?t.unvalue:Frames.Config.getbool("CHECKBOX_DEFAULT_VALUE",!1)?i.value:i.fvalue,delete i.editor,i.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.CheckBoxFormatter),t.headerselection&&(i.headerSelection=!0,i.headerEditable=!0,i.label=i.name,i.html=$.proxy(Frames.DataGrid.HeaderCheckBoxFormatter,this)(i));break;case"combobox":d=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(t.unvalueisnull);i.unvalue=d?null:t.unvalue?t.unvalue:i.value;break;case"image":i.editable=!1,delete i.editor,i.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.ImageFormatter);break;case"filebox":i.editable=!1,i.action=t.action,delete i.editor,i.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.FileInputFormatter);break;case"textlink":i.editable=!1,i.action=t.action,i.label=t.label,delete i.editor,i.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.TextLinkFormatter)}var u,c,p;if(Frames.isUndef(t.width)||(u=parseInt(t.width,10),isNaN(u)||(i.width=u,i.minWidth=u)),isNaN(u)||(this._w+=i.width),Frames.isUndef(t.data)||(i.data=t.data),Frames.isUndef(t.format)||(i.format=t.format),Frames.isUndef(t.type))if(Frames.isUndef(t.editor))i.type="String";else switch(t.editor){case"calendar":i.type="Date";break;case"calculator":i.type="Number";break;default:i.type="String"}else i.type=t.type;for(c in void 0===i.format&&void 0!==i.type?(i.format=Frames.Locale.formats[i.type.toUpperCase()+"_FORMAT"],i.formatDefault=!0):i.formatDefault=!1,Frames.isUndef(t.resizable)||(i.resizable=Frames.isTrue(t.resizable)),Frames.isUndef(t.enabled)||(i.enabled=Frames.isTrue(t.enabled)),Frames.isUndef(t.visible)||(i.visible=Frames.isTrue(t.visible)),Frames.isUndef(t.labelstyle)||(i.headerCssClass=t.labelstyle),Frames.isUndef(t.style)||(i.style=t.style),Frames.isUndef(t.textalign)||(i.textalign=t.textalign),i.props={},t)"string"==typeof c&&0===c.indexOf("data-")&&(i.props[c.substr(5)]=t[c]);for(p in Frames.isUndef(t.action)||(i.props.action=t.action),i.events={},t)"string"==typeof p&&0===p.indexOf("data-event")&&(i.events[p.substr(10)]=t[p]);Frames.isUndef(t.keyactions)||(i.props.keyactions=t.keyactions),Frames.Config.getbool("FIELD_AUTO_ALIGNMENT",!0)&&this._setAutoAlignment(i),Frames.isTrue(i.props.required)&&(i.headerCssClass=void 0===i.headerCssClass?"ui-required":i.headerCssClass+" ui-required")}return i},_setColumnEditorType:function(e,t){switch(e.editorType=t,e.editor=this._getEditor(t),t){case"button":e.editable=!1,delete e.editor,e.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.ButtonFormatter);break;case"checkbox":e.editable=!1,delete e.editor,e.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.CheckBoxFormatter);break;case"image":e.editable=!1,delete e.editor,e.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.ImageFormatter);break;case"fileinput":e.editable=!1,delete e.editor,e.formatter=Frames.DataGrid.wrapFormatter(this,Frames.DataGrid.FileInputFormatter)}},_setAutoAlignment:function(e){if(e.headerCssClass=void 0===e.headerCssClass?"ui-center":e.headerCssClass+" ui-center",void 0===e.textalign){var t=this.elem.css("direction"),i=Frames.Item.prototype._getDataDirection.apply(e,[void 0,t]),a=i!==t;switch(e.type){case"Number":case"Integer":e.textalign="right";break;default:a&&"ltr"==i&&(e.textalign="right")}e.readonly||"checkbox"!==e.editorType||(e.textalign="center")}},_getColumnsInfo:function(){var e=this._fixedCols-1,t=[];if(this._columns){var i,a,s,r=new Frames.HashMap;for(var n in this._columns)(a=this._columns[n]).column_name&&Frames.isTrue(a.visible)&&0<a.width?r.put(a.column_name,this._columns[n]):n<this._fixedCols&&e--;if(this._grid){var o=this._grid.getColumns();if(o){var l,d=o.length!=r.size();if(!d)for(var u in o)(l=o[u].column_name)&&void 0===r.get(l)&&(d=!0);0<o.length&&!d&&(s=o)}}for(Frames.isUndef(s)&&(s=r.values()),i=0;i<s.length;i++){var c=r.get(s[i].column_name);(!Frames.isUndef(c.columns)||Frames.isTrue(c.visible)&&0<c.width)&&t.push(c)}}return{columns:t,frozenColumn:e}},_updateColumns:function(){this.elem.is(":visible")||(this._forceRefresh=!0);var e=this._getColumnsInfo().columns;if(this._setStyles(e),this._setSortColumns(e),this._rerender_columns){var t;for(t=e.length-1;0<=t;t--){var i=e[t];i.headerSelection&&"checkbox"===i.editorType&&(i.html=$.proxy(Frames.DataGrid.HeaderCheckBoxFormatter,this)(i))}this._setWidgetColumns(e),delete this._rerender_columns,delete this._rerender}else this._rerender&&(this._grid.invalidate(),delete this._rerender);this._initCells(e,!0),$(".slick-header-column",this.elem).removeClass("ui-sortable").addClass("slick-disabled-sort").has(".slick-sort-indicator").addClass("slick-sortable")},_setSortColumns:function(e){if(Frames.Config.getbool("GRID_SORT_ORDER",!1)){for(var t=[],i=0,a=e.length;i<a;i++){var s=e[i],r=this._CTX_.get(s.field).props("Sort");if(r){r=r.toLowerCase();var n=this._grid.getColumns()[i].sort=r;if("asc"==n?n=!0:"desc"==n&&(n=!1),s.sortable){var o={columnId:s.id,sortAsc:n};t.push(o)}}}0<t.length&&this._grid.setSortColumns(t)}},_setStyles:function(e){if(0!==this._CTX_.size()){var t=Frames.Item.PROP_MAP.StyleClass;if(t&&"css"===t.method&&"class"===t.arg){var i,a,s={};for(i=this._grid.getDataLength()-1;0<=i;i--){var r={};for(a=e.length-1;0<=a;a--){var n=e[a],o=this._CTX_.get(n.field),l=Frames.Item.prototype.props.apply(o,["StyleClass"]);if(o._control){var d=Frames.findSingle(o._control,"item",n.field);d&&(d=o.__getInstance(d,this._grid.getDataItem(i).__id__))&&d.properties&&void 0!==d.properties[0]["@StyleClass"]&&(l=d.properties[0]["@StyleClass"])}void 0!==l&&(r[n.id]=l)}s[i]=r}this._grid.setCellCssStyles("StyleClass",s)}}},_initItem:function(e,t,i,a){if(void 0===i.editor&&!i.readonly){var s=e.find("button");if(s[0]){var r=new Frames.Item;if(r.props=function(){if(!(1<arguments.length&&"formatEnabled"==arguments[0]&&Frames.isTrue(arguments[1])))return Frames.Item.prototype.props.apply(this,arguments)},r.props("formatEnabled",!1),r.elem=e,r._inp=s,r._lbl=$([]),r.member=i.field,r.context=a,r.input=function(){return this._inp},"checkbox"===i.editorType?(r.editable=function(){if(!(0<arguments.length))return!1!==this.elem.data("editable");var e=Frames.isTrue(arguments[0]),t=this.elem;t.data("editable",e),e?t.removeAttr("readonly"):t.attr("readonly","readonly")},r._applyAutoskip=Frames.CheckBox.prototype._applyAutoskip):"button"!==i.editorType&&(r.editable=Frames.Item.prototype.enabled),r.widget=$.noop,r.args={column:i,grid:this._grid,item:t},r.data("widget","button"===i.editorType?"button":"checkbox"),s.data("frames",r),"checkbox"===i.editorType){var n=this._grid,o=n.getDataItem(n.getSelectedRows()[0]);r.elem=s,r.optmodel=$.proxy(Frames.DataGrid.CheckBoxFormatter.optmodel,r),r._last_value=Frames.isUndef(o)?"":o[i.field+":last"],r.value=function(){if(0===arguments.length){var e=n.getDataItem(n.getSelectedRows()[0]);return Frames.isUndef(e)?"":e[i.field]}},r.bind("action",$.proxy(function(){Frames.DataGrid.CheckBoxFormatter.toggle(this)},s)),s.bind("mouseenter",function(){$(this).addClass("ui-state-hover")}).bind("mouseleave",function(){$(this).removeClass("ui-state-hover")}),this._checkboxItemInstances||(this._checkboxItemInstances=new Frames.HashMap);var l=this._checkboxItemInstances.get(r.member);l||(l=[],this._checkboxItemInstances.put(r.member,l)),l.push(r)}else r.data("action",s.data("action")),r.bind("action",$.proxy(function(){Frames.DataGrid.execute(this)},s));s.bind("keydown.nav",$.proxy(function(e){if(Frames.DataGrid.handleButton(e))return!1;e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),Frames.isUndef(this.context)||this.context.trigger(this,"keydown.navigation",e)},r)),s.bind("focuschange",$.proxy(function(e){Frames.isUndef(this.context)||this.context.trigger(e)},r)),r.elevate=Frames.DataGrid.TextCellEditor.prototype.elevate,r.bindable=Frames.DataGrid.TextCellEditor.prototype.bindable,r.defaults(),Frames.DataGrid.TextCellEditor.prototype.update.apply(r,[])}}},_initCells:function(e,t){var i,a=this._grid.getRenderedRange();for(i=e.length-1;0<=i;i--){var s,r=e[i],n=this._CTX_.get(r.field);for(s=a.bottom;s>=a.top;s--){var o=$(this._grid.getCellNode(s,i));this._initCell(s,o,this._grid.getDataItem(s),r,n,t)}}},_initCell:function(e,t,i,a,s,r){this._rendered[e]=this._rendered[e]||{},this._rendered[e][a.field]=this._rendered[e][a.field]||{},!0!==this._rendered[e][a.field].item&&(this._initItem(t,i,a,s),this._rendered[e][a.field].item=!0),!0!==r&&!0===this._rendered[e][a.field].css||(this._setCellCss(t,i,a,s),this._rendered[e][a.field].css=!0),Frames.Config.getbool("FIELD_AUTO_ALIGNMENT",!0)&&this._setCellAutoAlignment(t,i,a,s)},_setCellCss:function(e,t,i,a){if(!Frames.isUndef(a)&&a._control){var s=Frames.findSingle(a._control,"item",i.field);s&&(!Frames.isUndef(s)&&$.isArray(s.properties)&&this._setCellCssProperties(e,s.properties[0]),s=a.__getInstance(s,t.__id__),!Frames.isUndef(s)&&$.isArray(s.properties)&&this._setCellCssProperties(e,s.properties[0]))}},_setCellAutoAlignment:function(e,t,i,a){if(!Frames.isUndef(a)&&a._control){var s=Frames.findSingle(a._control,"item",i.field);if(s&&(s=a.__getInstance(s,t.__id__))){var r=Frames.Model.attr(s.properties[0],"DataType"),n=Frames.Model.attr(s.properties[0],"Editor");if(r!=i.type||n!=i.editorType){var o=this.elem.css("direction"),l=Frames.Item.prototype._getDataDirection.apply(i,[e,o]),d=Frames.Format.getAlignment(o,l,r);Frames.isUndef(d)||e.css("text-align",d)}}}},_setCellCssProperties:function(e,t){var i,a=null;for(i in Frames.Item.PROP_MAP)if(void 0!==t["@"+i]){var s=Frames.Item.PROP_MAP[i],r=t["@"+i];switch(s.method){case"css":"class"!==s.arg&&((a=a||{})[s.arg]=r);break;case"url":if("ImageFile"===i){var n=$.ui.image.prototype.url(r),o=e.children(0);o.attr("src",n),Frames.isEmpty(n)?o.hide():o.show()}}}null!==a&&e.css(a)},_getEditor:function(e){var t;switch(e){case"combobox":t=Frames.DataGrid.ComboBoxCellEditor;break;case"lovbox":t=Frames.DataGrid.LOVInputCellEditor;break;case"editbox":t=Frames.DataGrid.EditInputCellEditor;break;case"calendar":t=Frames.DataGrid.DateFieldCellEditor;break;case"calculator":t=Frames.DataGrid.CalculatorCellEditor;break;case"editinput":t=Frames.DataGrid.TextAreaCellEditor;break;case"colorpicker":case"textlink":t=Frames.DataGrid.ColorPickerCellEditor;break;case"none":t=null;break;default:t=Frames.DataGrid.TextCellEditor}return t},init:function(e){var i=this;this.view=e;var t=this.props("block"),a=Frames.Application.task.get(t);a&&(this.block=a,this.autoregister(),this.block.bindable(this));var s=this.elem.closest("[data-class$='canvas'], [data-widget='tabpanel']");if(s[0]){var r=this.view._CANVAS_.get(s.data("name"));r&&$(r).on("aftershow",function(e,t){i._onParentContainerShow(!0)})}this._endbind_fn=function(){i.onEndBind()},this._execute_fn=function(){i.closeEditor()},this._item_activated_fn=function(e,t){t.block!==i.block&&Frames.Config.getbool("GRID_DISABLED_ONBLUR",!0)?i.elem.find(".slick-header-column").addClass("slick-disabled-sort").find(".slick-sort-indicator").removeClass("slick-sort-indicator-asc slick-sort-indicator-desc"):i.elem.find(".slick-header-column").removeClass("slick-disabled-sort")},Frames.Application.on("endbind",this._endbind_fn),Frames.Application.on("execute",this._execute_fn),Frames.Application.on("itemactivated",this._item_activated_fn)},_onParentContainerShow:function(e){this._forceRefresh&&!$.resize&&this._grid.resizeCanvas(),e&&this._grid.resetScrollPosition(),delete this._forceRefresh},destroy:function(){Frames.Item.prototype.destroy.apply(this,[]),this._removeCssRules(),this._grid.destroy(),Frames.isUndef(this._pager)||this._pager.destroy(),this._GROUPTOTALS_.clear(),delete this._GROUPTOTALS_,this.elem.parent().unbind("resize",this._parentResize_fn),Frames.Application.off("endbind",this._endbind_fn),Frames.Application.off("execute",this._execute__fn),Frames.Application.off("itemactivated",this._item_activated_fn),delete this._endbind_fn},autoregister:function(){this._CTX_=new Frames.HashMap;var e=this.props("block"),t=Frames.Application.task.get(e);if(t){var i;for(i in this._colparent=$('<div style="display: none"></div>').appendTo(this.elem),this._columns){var a=this._columns[i],s=new Frames.DataGrid.ColumnItemContext(this,a);s.view=this.view,t.register(s)}this.view.initialized&&this._updateColumns(),this._rerender&&this.onEndBind()}},getItemContext:function(e){return this._CTX_.get(e)},autounregister:function(){for(this._CTX_.reset();this._CTX_.hasNext();){var e=this._CTX_.next();Frames.isUndef(e.block)||e.block.remove(e)}for(this._CTX_.clear(),this._GROUPTOTALS_.reset();this._GROUPTOTALS_.hasNext();){var t=this._GROUPTOTALS_.next();Frames.isUndef(t.block)||t.block.remove(t)}this._GROUPTOTALS_.clear()},_preModelControlInfo:function(e,t){var i;for(this._CTX_.reset();this._CTX_.hasNext();){var a,s,r,n,o;if("checkbox"==(i=this._CTX_.next())._col.editorType)if((a=(a=Frames.Model.findExp(e,"item[@name="+i.member+"]"))?a[0]:a)&&a.properties)s=a.properties[0],Frames.isTrue(Frames.Application._supportnulls)&&(r=Frames.Model.attr(s,"ValueIsNull"),n=Frames.Model.attr(s,"fvalueisnull"),o=Frames.Model.attr(s,"unvalueisnull")),r=Frames.isTrue(r)?null:Frames.Model.attr(s,"Value"),n=Frames.isTrue(n)?null:Frames.Model.attr(s,"FalseValue"),o=Frames.isTrue(o)?null:Frames.Model.attr(s,"UnmatchedValue"),void 0!==r&&(i._col.value=r),void 0!==n&&(i._col.fvalue=n),void 0!==o&&(i._col.unvalue=o)}},controlInfo:function(d,e,u){if(!Frames.isUndef(d)){for(this._CTX_.reset();this._CTX_.hasNext();){var t=this._CTX_.next();if(t.elem=$([]),delete t._error,delete t._props.Error,delete t._props.ValidationMessage,t._itemControlInfo(d),t._control=t.block?t.block._ctrinf:d,"checkbox"==t._col.editorType&&this._checkboxItemInstances&&!this._datachanged&&u.item){var c=this;$.each(u.item,function(e){var t=u.item[e],i=!1;if(t.properties){var a=Frames.Model.keys([0]);$.each(a,function(e){if(-1!==$.inArray(e,["Enabled","ReadOnly","AllowInsert","AllowUpdate"]))return!(i=!0)})}if(i||t.instance){var s=Frames.Model.attr(t,"name"),r=c._checkboxItemInstances.get(s);if(r)for(var n in r){var o=r[n],l=(o.block.props("blockMode"),o.args.item.id);o.itemControlInfo(d,l),Frames.Modes.enter(Frames.isTrue(o._force_editable)?"READ":o.block.props("blockMode"),o)}}})}}if(d.properties&&"true"===d.properties[0]["@ClearSort"]&&this._grid.setSortColumns({}),d.item&&0<d.item.length)this._updateColumns();else if(void 0!==this._grid.getCellCssStyles("StyleClass")){var i=this._getColumnsInfo().columns;this._setStyles(i)}this._datachanged=!1}},query:function(e,t){var a=Frames.DataGrid._cfggroup?this._dataView.getItems():this._grid.getData();if(this._last_query=e,a&&0<a.length&&e){a=a[0];var s={};this.closeEditor();for(var i=this._grid.getColumns(),r=0,n=i.length;r<n;r++){var o=i[r];s[o.field]=o,a[o.field]=""}$.each(e,function(e,t){if(!Frames.isUndef(a[t.field])){var i=t.value;s[t.field]&&"upper"==s[t.field].props.case&&(i=i.toUpperCase()),a[t.field]=i}}),Frames.DataGrid._cfggroup?this._dataView.setItems([a]):this._grid.setData([a]),!1!==t&&Frames.Application.valexec("EXECUTE_QUERY")}},closeEditor:function(){try{this._grid.getEditController().commitCurrentEdit(),this._grid.resetActiveCell()}catch(e){}},hasChanges:function(e){for(this._CTX_.reset();this._CTX_.hasNext();){if(this._CTX_.next().resolve().hasChanges(e))return!0}return!1},model:function(){var e,t,i,a,s,r,n,o="SEARCH"==this.block.props("blockMode"),l=o;if(0===arguments.length){this.closeEditor(),e=Frames.DataGrid._cfggroup?this._dataView.getItems():this._grid.getData();var d,u=Frames.Model.createBlock(this.block.name);for(d in e){i=e[d];var c=Frames.Model.createRecord(i.__id__);for(t=0;t<this._columns.length;t++)if(n=i[r=(a=this._columns[t]).field],o||n!==i[r+":last"]){if(o){var p=Frames.DataGrid.getInstanceData(this._CTX_.get(a.field),a,i).type;n=Frames.Item.formatToCanonical(n,o,l,a.format,p)}s=Frames.Model.createItem(r,n),Frames.Model.append(c,s)}Frames.Model.hasChildren(c)&&(Frames.Model.attr(c,"status","C"),Frames.Model.append(u,c))}return Frames.Model.hasChildren(u)?u:null}this._clearHeaderSelectionUpdateCache(),this._dynmodel(),Frames.isUndef(this._formattercache)&&(this._formattercache=new Frames.HashMap);var m=arguments[0];if(m){var h=Frames.Model.attr(m,"selected");this._datachanged=Frames.isUndef(Frames.Model.attr(m,"hasChanges"))||Frames.isTrue(Frames.Model.attr(m,"hasChanges"));var f=-1;if(!Frames.isUndef(this.block.paging)&&this.block.paging.enabled&&this.pager){if(Frames.isUndef(this._pager)){var g=this.elem.parent().hasClass("ui-layout-positional")?this.elem:this.elem.parent();g.find(".ui-grid-pager").remove(),this._pagEl=$('<div class="ui-grid-pager" style="width:100%;"></div>'),g.append(this._pagEl),this._pager=new Frames.DataGrid.Pager(this.block.paging,this._pagEl),this._pager.init()}this._pager.update(),o?(this.elem.removeClass("ui-pager"),this._pagEl.addClass("ui-pager-search")):(this.elem.addClass("ui-pager"),this._pagEl.removeClass("ui-pager-search"))}this.block.master=Frames.isTrue(Frames.Model.attr(m,"master"));var _=m.record,v=0===this._grid.getDataLength()&&!Frames.isEmpty(_);if(this._datachanged||v){var b;if(e=[],_)for(b=0;b<_.length;b++){var F=_[b],y=Frames.Model.attr(F,"id");Frames.isUndef(h)||y!=h||(f=b);var w=Frames.Model.attr(F,"serverStatus"),C=Frames.Model.attr(F,"new");for(Frames.isUndef(C)&&(C="INSERTED"===w),i={__id__:y,id:y,__status__:w,__idx__:b,__changed__:!1,__isnew__:Frames.isTrue(C)},t=0;t<this._columns.length;t++){if(a=this._columns[t],s=Frames.findSingle(F,"item",a.field),r=a.field,n=s?Frames.isTrue(Frames.Model.attr(s,"valueIsNull"))?null:Frames.Model.text(s):"",o){var x=Frames.DataGrid.getInstanceData(this._CTX_.get(r),a,i).type;n=Frames.Item.formatFromCanonical(n,!1,n,o,l,a.format,x).value}i[r]=n,i[r+":last"]=n,i[r+":last_value"]=n,this._updateHeaderSelection(n,a)}e.push(i)}this._rendered={},Frames.DataGrid._cfggroup?(this._dataView.beginUpdate(),this._dataView.setItems(e),this._grouping&&(this.setGrouping(o?[]:this._grouping),this._setWidgetColumns(this._getColumnsInfo().columns)),this._dataView.endUpdate()):this._grid.setData(e),this._rerender=!0}else{var k=this.block.indexOf(h);Frames.isEmpty(k)||(f=k)}-1!=f&&this.selected()!==f&&(this.selected(f),this._grid.scrollRowIntoView(f))}},_dynmodel:function(){for(this._CTX_.reset();this._CTX_.hasNext();){var e=this._CTX_.next(),t=this.block.name+"."+e.member,i=this.block.task.list(t);Frames.isUndef(i)||e.dynmodel(i)}},_clearHeaderSelectionUpdateCache:function(){this.__headerSelectionUpdateCache={}},_updateHeaderSelection:function(e,t){if(t.headerSelection&&"checkbox"===t.editorType){if(this.__headerSelectionUpdateCache[t.id])return;if(e!=t.value&&(t.unvalue!=t.value||t.fvalue==e)){var i=this.elem.find("[id$="+t.id+"] .ui-checkbox").eq(0);$(".ui-button-icon",i).is(".fa fa-check")&&Frames.DataGrid.HeaderCheckBoxFormatter.click(i,!0),this.__headerSelectionUpdateCache[t.id]=!0}}},selected:function(){var e=-1;if(0===arguments.length){var t=this._grid.getSelectedRows();if("function"==typeof this._grid.getData().getIdxById){var i=this._grid.getCellNode(t[0],0);e=this._grid.getData().getIdxById($(i).children(0).data("rowid"))}else e=t[0];return e}if("function"==typeof this._grid.getData().getRowById)e="string"==typeof arguments[0]?this._grid.getData().getRowById(arguments[0]):this._grid.getData().getRowById(this.block.idOf(arguments[0]));else if("string"==typeof arguments[0])for(var a=this._grid.getDataLength()-1;0<=a;a--){if(this._grid.getDataItem(a).__id__==arguments[0]){e=a;break}}else e=arguments[0];this._grid.setSelectedRows([e])},data:function(){return this.elem.data(arguments)},editable:function(){if(0===arguments.length)return this._grid.getOptions().editable;this._grid.setOptions({editable:arguments[0]})},isContext:function(){return!0},colvisible:function(){var e=arguments[0],t=this._columns[e];if(t)if(Frames.isTrue(this.inDesignMode)){var i=this._CTX_.get(e).elem;if(1===arguments.length)return void 0===i.data("design-visible")||i.data("design-visible");i.data("design-visible",arguments[1]),Frames.isTrue(arguments[1])?i.removeClass("ui-designer-invisible"):i.addClass("ui-designer-invisible")}else{if(1==arguments.length){var a=t.visible;return Frames.isUndef(a)||Frames.isTrue(a)}var s=t.visible;t.visible=Frames.isTrue(arguments[1]),s!==t.visible&&(this._rerender_columns=!0)}},colenabled:function(){var e=arguments[0],t=this._columns[e];if(t){if(1==arguments.length){var i=t.enabled;return Frames.isUndef(i)||Frames.isTrue(i)}var a=t.enabled;t.enabled=Frames.isTrue(arguments[1]),a!==t.enabled&&(this._rerender_columns=!0),Frames.isTrue(this.inDesignMode)&&this._updateColumns()}},colfield:function(){var e=arguments[0],t=this._columns[e];if(t){if(1===arguments.length)return t.field;var i=t.field;t.field=arguments[1],i!==t.field&&(this._rerender_columns=!0),Frames.isTrue(this.inDesignMode)&&this._updateColumns()}},collabel:function(){var e=arguments[0],t=this._columns[e];if(t){if(1==arguments.length)return t.name;var i=t.name;t.name=arguments[1],t.title=arguments[1],i!==t.name&&(this._rerender_columns=!0),Frames.isTrue(this.inDesignMode)&&this._updateColumns()}},colformat:function(){var e=arguments[0],t=this._columns[e];if(t){if(1==arguments.length)return t.format;var i=t.format;t.format=arguments[1],i!==t.format&&(this._rerender_columns=!0)}},colsort:function(){var e=arguments[0],t=this._columns[e];if(t){if(1==arguments.length)return t.sortable;var i=t.sortable;t.sortable=arguments[1],i!==t.sortable&&(this._rerender_columns=!0)}},coleditor:function(){var e=arguments[0],t=this._columns[e];if(t)return 1==arguments.length?t.editorType:void(t.editorType!==arguments[1]&&(this._setColumnEditorType(t,arguments[1]),this._rerender_columns=!0))},colAllowUpdate:function(){var e=arguments[0],t=this._columns[e];if(t&&t.headerSelection){var i=t.headerEditable;t.headerEditable=arguments[1],i!==t.headerEditable&&(this._rerender_columns=!0)}},editpanel:function(){if(!(0<arguments.length))return this.elem.data("editpanel");this.elem.data("editpanel",arguments[0])}},{ROW_HEIGHT:25}),Frames.regtype("datagrid",Frames.DataGrid),Frames.DataGrid.handleButton=function(e){var t=$(e.target),i=e.keyCode==$.ui.keyCode.ENTER&&t.parent().is(":not(.ui-checkbox)");return!(!t.is(":button")||e.keyCode!=$.ui.keyCode.SPACE&&!i)&&(t.triggerHandler("click"),e.stopImmediatePropagation(),!0)},Frames.DataGrid.NullAggregator=function(e,t){this.field_=t.field,this.options_=t,this.init=$.noop,this.accumulate=function(e){},this.storeResult=function(e){e.mem||(e.mem={}),e.mem[this.field_]={val:null,options:this.options_}}},Frames.DataGrid.MemberAggregator=function(e,t){this.grid_=e,this.options_=t,this.field_=t.field,this.source_=t.source,this.init=function(){this.mem_=null},this.accumulate=function(e){null===this.mem_&&(-1!==this.source_.indexOf(".")?this.mem_=null:this.mem_=e[this.source_])},this.storeResult=function(e){e.mem||(e.mem={}),-1!==this.source_.indexOf(".")?e.mem[this.field_]={val:$.proxy(function(){return this.grid_._GROUPTOTALS_.get(this.source_).value()},this),options:this.options_}:e.mem[this.field_]={val:this.mem_,options:this.options_}}},Frames.DataGrid.CountAggregator=function(e,t){this.grid_=e,this.options_=t,this.field_=t.field,this.source_=t.source,this.init=function(){this.mem_=0},this.accumulate=function(e){this.mem_=this.mem_+1},this.storeResult=function(e){e.mem||(e.mem={}),e.mem[this.field_]={val:this.mem_,options:this.options_}}},Frames.DataGrid.GroupTotal=$.inherit(Frames.Item,{__constructor:function(e,t,i,a){this.grid=e,this.view=e.view,this._id=t,this.block=i,this.member=a,this._value="",this._lbl_ids=[],this._props={AllowSearch:!0,Visible:!0,type:"String",block:i.name,member:a},this.elem=$("#"+t),i.register(this),i.bindable(this),i._last_model&&this.model(i._last_model)},bind:$.noop,trigger:$.noop,labelid:function(e){this._lbl_ids.push("#"+e)},labelObj:function(){return $(this._lbl_ids.join(", ")).find(".ui-total-label")},label:function(){var e=this.labelObj();if(0===arguments.length)return e.text();var t=arguments[0];return this.grid.updateTotalLabel(this.block.name,this.member,t),e.html(t)},objid:function(){return this.view.id+":"+this._id},model:function(){if(0!==arguments.length){var e=arguments[0];if(e){var t=e.record;if(t){var i=this.block.index();(Frames.isUndef(i)||-1==i||i>t.length-1)&&(i=0),this._block_selid=this.block.idOf(i);var a=Frames.find(t[i],"item",this.member);this.value(a?Frames.Model.text(a[0]):"")}else Frames.isTrue(Frames.Model.attr(e,"hasChanges"))&&this.value("")}}},value:function(){if(0===arguments.length)return this._value;this._last_can=arguments[0],this._value=arguments[0]}}),Frames.DataGrid.PostRender=function(e,t,i,a){var s=i.__idx__,r=this._CTX_.get(a.field),n=$(e);this._initCell(s,n,i,a,r)},Frames.DataGrid.wrapFormatter=function(n,o){return function(e,t,i,a,s){var r=o.apply(n,arguments);return n._rendered[e]=n._rendered[e]||{},n._rendered[e][a.field]={css:!1,item:!1},r}},Frames.DataGrid.wrapGroupTotalFormatter=function(i,a){return function(e,t){return a.apply(i,arguments)}},Frames.DataGrid.GroupTotalFormatter=function(e,t){var i,a,s,r=e.mem&&e.mem[t.field];if("object"==typeof r?(i="function"==typeof r.val?r.val():r.val,a=r.options.label):e.sum&&e.sum[t.field]&&(i=e.sum[t.field]),(r=r||{}).options=r.options||{},"string"==typeof i){var n=t.type,o=r.options.format||t.format;r.options.type&&(n=r.options.type,void 0===(o=r.options.format||t.format)&&void 0!==n&&(o=Frames.Locale.formats[n.toUpperCase()+"_FORMAT"])),i=Frames.Format.formatFromCanonical(i.toString(),o,n),i=$.escapeHtml(i)}var l=t.textalign;Frames.isUndef(r)||Frames.isUndef(r.options)||(s=r.options.clazz,l=r.options.textalign?r.options.textalign:l);var d,u=l?' style="text-align: '+l+'"':"";return"Date"!=t.type&&(d=Frames.Item.prototype._getDataDirection.apply(t)),'<div id="'+r.options.id+'" class="ui-text'+(s?" "+s:"")+'"'+u+">"+(a?'<span class="ui-total-label">'+$.escapeHtml(a)+"</span>":"")+(i?'<span title="'+i+'" class="ui-total-value"'+(Frames.isEmpty(d)?"":' dir="'+d+'"')+">"+i+"</span>":"")+"</div>"},String.prototype.format=function(){var e,t=this;for(e=0;e<arguments.length;e++){var i=new RegExp("\\{"+e+"\\}","gi");t=t.replace(i,arguments[e])}return t},Frames.DataGrid.execute=function(elem,action,grdid,rowid,validation){if(elem=$(elem),Frames.isUndef(grdid)){if(Frames.isUndef(elem.data("column")))return;var col=elem.data("column"),p="";grdid="string"==typeof col?(p=col.lastIndexOf("_"),col.substr(0,p)):(p=col.id.lastIndexOf("_"),col.id.substr(0,p))}var grid=Frames.get(grdid);if(Frames.isUndef(rowid)){var idx=parseInt(elem.data("row"),10);grid.selected(idx),grid.block.select(elem.data("rowid"))}if(elem.hasClass("ui-fileinput")){var file=elem.parent().find("input");file.click()}else if(action=Frames.isUndef(action)?elem.data("action"):action,!Frames.isUndef(action))if("script:"==action.substring(0,7))try{eval(action.substring(7))}catch(e){0}else Frames.Application.execute(action,null,null,grid.block.name,grid.block.get(elem.data("member")).member,validation)},Frames.DataGrid.isDisplayAsPassword=function(e,t,i){if(e){var a=e.props("DisplayAsPassword")||"password"===t.editorDataType,s=Frames.findSingle(e.block._ctrinf,"item",t.field);if(s){var r=e.__getInstance(s,i.__id__);if(r&&r.properties){var n=r.properties[0]["@DisplayAsPassword"];Frames.isUndef(n)||(a=n)}}return Frames.isTrue(a)}},Frames.DataGrid.getInstanceProperty=function(e,t,i,a){var s=Frames.DataGrid.getInstanceProperties(e,t,i);if(!Frames.isUndef(s))return s["@"+a]},Frames.DataGrid.getInstanceProperties=function(e,t,i){var a=Frames.findSingle(e.block._ctrinf,"item",t);if(a){var s=e.__getInstance(a,i);if(s&&s.properties)return s.properties[0]}},Frames.DataGrid.getInstanceData=function(e,t,i){if(!e)return{type:t.type,enabled:!0,readonly:!1};var a=e.props("ReadOnly")||e.props("readonly"),s={type:e.props("type")||t.type||"String",enabled:void 0!==e.props("Enabled")?Frames.isTrue(e.props("Enabled")):t.enabled,readonly:void 0!==a?Frames.isTrue(a):t.readonly},r=void 0===e.props("AllowInsert")||Frames.isTrue(e.props("AllowInsert")),n=void 0===e.props("AllowUpdate")||Frames.isTrue(e.props("AllowUpdate"));s.icon=e.props("Icon");var o=i.__status__,l=Frames.DataGrid.getInstanceProperties(e,t.field,i.__id__);if(!Frames.isUndef(l)){var d=l["@DataType"];Frames.isUndef(d)||(s.type=d),d=l["@Enabled"],Frames.isUndef(d)||(s.enabled=Frames.isTrue(d)),d=l["@ReadOnly"],Frames.isUndef(d)||(s.readonly=Frames.isTrue(d)),d=l["@AllowInsert"],Frames.isUndef(d)||(r=Frames.isTrue(d)),d=l["@AllowUpdate"],Frames.isUndef(d)||(n=Frames.isTrue(d)),d=l["@FormatMask"],Frames.isUndef(d)||(s.format=d),d=l["@Icon"],Frames.isUndef(d)?s.icon=void 0:s.icon=d}var u=void 0!==o&&"INSERTED"===o?r:n;return s.readonly=s.readonly?s.readonly:!Frames.isTrue(u),s},Frames.Item.PROP_MAP.AllowSort={method:"sort"},Frames.Item.PROP_MAP.AllowUpdate={method:"allowUpdate"}}(jQuery),Frames.DataGrid.Pager=$.inherit({defaults:{pages:[10,20,30,40,50]},__constructor:function(e,t,i){this.paging=e,this.elem=t,this.options=$.extend({},this.defaults,i||{})},init:function(){this._constructPagerUI()},getNavState:function(){var e=this.paging.pages;return{canGotoFirst:0!==this.paging.size&&1<this.paging.number,canGotoLast:0!==this.paging.size&&this.paging.number<e,canGotoPrev:0!==this.paging.size&&1<this.paging.number,canGotoNext:0!==this.paging.size&&this.paging.number<e,pagingInfo:this.paging,lastPage:e}},_constructPagerUI:function(){var i=this;this.elem.empty();var e=$('<span class="slick-pager-nav" />').appendTo(this.elem);this.status=$('<span class="slick-pager-status" />').appendTo(this.elem),this.selectedRecord=$('<span class="slick-pager-selected-record ui-state-disabled" />').appendTo(this.elem);var t=$('<span class="slick-pager-controls"></span>').appendTo(e),a="rtl"===this.elem.css("direction");Frames.Template.transform('{{~data.array :value:index}}<span class="slick-pager-control ui-state-default ui-corner-all ui-icon-container ui-grid-pager-{{=value.actionName}}"><span class="{{=value.iconClass}}" aria-label="{{=value.label}}" role="button"/></span>{{~}}',{array:[{actionName:"first",label:_("FIRST_PAGE"),iconClass:"first-grid-page fa "+(a?"fa-step-forward":"fa-step-backward")},{actionName:"previous",label:_("PREVIOUS_PAGE"),iconClass:"previous-grid-page fa fa-play"+(a?"":" fa-rotate-180")},{actionName:"next",label:_("NEXT_PAGE"),iconClass:"next-grid-page fa fa-play"+(a?" fa-rotate-180":"")},{actionName:"last",label:_("LAST_PAGE"),iconClass:"last-grid-page fa "+(a?"fa-step-backward":"fa-step-forward")}]}).appendTo(t),e.on("click",".ui-icon-container",function(){var e=$(this);e.is(".ui-state-disabled")||(e.is(".ui-grid-pager-first")&&i.paging.first.apply(i.paging),e.is(".ui-grid-pager-previous")&&i.paging.previous.apply(i.paging),e.is(".ui-grid-pager-next")&&i.paging.next.apply(i.paging),e.is(".ui-grid-pager-last")&&i.paging.last.apply(i.paging))}),e.find(".ui-icon-container").on("mouseenter",function(){$(this).is(".ui-state-disabled")||$(this).addClass("ui-state-hover")}).on("mouseleave",function(){$(this).removeClass("ui-state-hover")});var s=Frames.uuid();$('<div class="paging-separator slick-pager-controls-separator"></div><select id="'+s+'" class="ui-select-paging"></select><label for="'+s+'" class="ui-label-paging">'+_("PER_PAGE")+"</label>").appendTo(e),$('<input class="ui-input-paging ui-corner-all" value="1" aria-label="'+_("PAGE")+'"></input><span class="ui-label-paging">'+_("OF")+'</span> <span class="ui-label-paging ui-total-pages">'+this.paging.pages+"</span>").insertAfter(e.find(".ui-grid-pager-previous")),$(".ui-input-paging, .ui-select-paging",e).on("click",function(e){e.stopPropagation()}),0<this.paging.size&&e.find(".ui-select-paging").val(this.paging.size),e.find(".ui-input-paging").on("keydown",function(e){if(e.keyCode==$.ui.keyCode.ENTER||e.keyCode==$.ui.keyCode.TAB){var t=$(this).val();return $.isNumeric(t)&&0<t<i.paging.pages&&$.proxy(i.paging.page(t),i.paging),e.stopPropagation(),!1}}),this.elem.children().wrapAll('<div class="slick-pager"></div>');var r=$(".ui-select-paging",this.elem);this.options&&this.options.pages&&$.each(this.options.pages,function(){var e=new Option(this,this),t=r.get(0).options;t[t.length]=e});var n=Math.min.apply(Math,this.options.pages);r.data("minrec",n),$(".ui-select-paging",this.elem).change(function(){var e=0<$(this).parents(".ui-lovdialog").length,t=$(this).find("option:selected").val();i.paging.setup(t,e),i.update()}),this._refresh_fn=function(e,t){i.update()},Frames.Application.on("viewready toolbarrefresh",this._refresh_fn)},update:function(){Frames.Application.task.view;var e=Frames.Application.task.block,t=-1!==this.paging.view.id.indexOf("LOVDialog")||this.paging.block==e,i=this.getNavState(),a=Frames.Config.getbool("GRID_DISABLED_ONBLUR",!0),s=$(".ui-select-paging",this.elem);if((t||!a)&&1<this.paging.pages?(s.removeAttr("disabled").removeClass("ui-state-disabled"),$(".slick-pager-controls, .slick-pager-controls-separator",this.elem).removeClass("ui-state-disabled"),this.elem.find(".slick-pager-nav span").removeClass("ui-state-disabled"),i.canGotoFirst||this.elem.find(".first-grid-page").parent().addClass("ui-state-disabled"),i.canGotoLast||this.elem.find(".last-grid-page").parent().addClass("ui-state-disabled"),i.canGotoNext||this.elem.find(".next-grid-page").parent().addClass("ui-state-disabled"),i.canGotoPrev||this.elem.find(".previous-grid-page").parent().addClass("ui-state-disabled"),this.elem.find(".slick-pager-selected-record").addClass("ui-state-disabled"),this.elem.find(".ui-input-paging").prop("disabled",!1)):(s.attr("disabled","disabled").addClass("ui-state-disabled"),$(".slick-pager-controls, .slick-pager-controls-separator",this.elem).addClass("ui-state-disabled"),$(".slick-pager-control",this.elem).addClass("ui-state-disabled"),this.elem.find(".ui-input-paging").prop("disabled",!0)),$(".ui-input-paging",this.elem).val(this.paging.number),$(".ui-total-pages",this.elem).html(this.paging.pages),this.paging.pages){var r=10*(this.paging.pages+"").length+5;$(".ui-input-paging",this.elem).css("width",r)}if(0<s.find('option[value="'+this.paging.size+'"]').length)t&&s.val(this.paging.size);else if(0<this.paging.size){var n=new Option(this.paging.size,this.paging.size),o=s.get(0).options;o[o.length]=n,(o=s.find("option")).sort(function(e,t){return(e=e.value)-(t=t.value)}),s.html(o),s.val(this.paging.size);var l=Math.min(this.paging.size,s.data("minrec"));s.data("minrec",l)}if(!t&&a||!1===this.paging.multiple)s.attr("disabled","disabled").addClass("ui-state-disabled"),$("label.ui-label-paging",this.elem).attr("disabled","disabled").addClass("ui-state-disabled");else{var d=s.data("minrec");d>=this.paging.records?(s.attr("disabled","disabled").addClass("ui-state-disabled"),$("label.ui-label-paging",this.elem).attr("disabled","disabled").addClass("ui-state-disabled"),s.val(d)):(s.removeAttr("disabled").removeClass("ui-state-disabled"),$("label.ui-label-paging",this.elem).attr("disabled","disabled").removeClass("ui-state-disabled"))}$(".slick-pager-selected-record",this.elem).text(_("SELECTED_RECORD",this.paging.record,this.paging.records)).removeClass("ui-state-disabled")},destroy:function(){this.elem.empty(),Frames.Application.off("viewready toolbarrefresh",this._refresh_fn)}}),Frames.Application.registerActionHandler("PagerAction",function(e){var t=Frames.Application.current();if(!Frames.isUndef(t)){var i=t.bindable()._pagEl;Frames.isUndef(i)||("FRAMES:PAGER_CURRENT_PAGE"==e.name?i.find(".ui-input-paging").focus():"FRAMES:PAGER_RECORDS_PER_PAGE"==e.name&&i.find(".ui-select-paging").focus())}}),Frames.ready(function(){Frames.Config.regaction({name:"FRAMES:PAGER_CURRENT_PAGE",accesskey:"ALT+N",type:"PagerAction"}),Frames.Config.regaction({name:"FRAMES:PAGER_RECORDS_PER_PAGE",accesskey:"ALT+P",type:"PagerAction"})}),function($){Frames.DataGrid.ColumnItemContext=$.inherit(Frames.Item,{__constructor:function(e,t){this._grid=e,this._col=t;var i,a=this.uuid();for(i in this._colev=$('<div id="'+a+'_ev"></div>').appendTo(e._colparent),this.elem=this._elem=$("#"+a,e.elem),this._elem.bind=$.proxy(this.bind,this),e._CTX_.put(t.field,this),this.props("member",t.field),this.props("readonly",t.readonly),this.member=t.field,this.props("block",e.props("block")),this.props("ValidationEnabled",Frames.Config.get("VALIDATION_ENABLED","true")),t.format&&this.props("format",t.format),this.props("formatDefault",t.formatDefault),t.type&&this.props("type",t.type),t.props)this.props(i,t.props[i]);Frames.isUndef(t.style)||this.props("StyleClass",t.style),e._CTX_.put(t.field,this);var s=Frames.getplugs(Frames.PLUGIN_WIDGET);for(s.reset();s&&s.hasNext();)s.next().register(this)},erroranchor:function(){if(!Frames.isTrue(this._grid.inDesignMode))return this._curr&&$.isFunction(this._curr.erroranchor)?this._curr.erroranchor():this.input()},uuid:function(){return Frames.isUndef(this._uuid)&&(this._uuid=this._grid.uuid()+this._col.id),this._uuid},rules:function(){return Frames.isUndef(this._col.editor)?{}:this._col.editor.prototype.rules.apply(this,arguments)},controlInfo:function(e){this.view.initialized&&this.itemControlInfo(e),this._control=this.block?this.block._ctrinf:e},__getInstance:function(e,t){var i;if(e.instance)for(i=e.instance.length-1;0<=i;i--)if(t===e.instance[i]["@row"])return e.instance[i]},props:function(){if(1===arguments.length){var e=arguments[0],t=this._grid.getItemRowIndex(this.resolve());if(!Frames.isUndef(t)){var i=this.block.idOf(t),a=Frames.DataGrid.getInstanceProperty(this,this.member,i,e),s=Frames.Item.PROP_OVERRIDE[e];if(Frames.isUndef(s)){if(!Frames.isUndef(a))return a}else if(this._props[e]===s)return s}}return Frames.Item.prototype.props.apply(this,arguments)},_set_prop:function(e,t){Frames.Item.prototype._set_prop.apply(this,[e,t]),-1!=$.inArray(e,["Valid","ValidationMessage","Error"])&&!Frames.isUndef(this._curr)&&$.isFunction(this._curr._set_prop)&&this._curr._set_prop(e,t)},_itemInstanceControlInfo:$.noop,labelObj:function(){if(Frames.isTrue(this._grid.inDesignMode))return this.elem},input:function(){if(!Frames.isTrue(this._grid.inDesignMode))return this._curr?this._curr.input():this._elem},visible:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return this._grid.colvisible(e);this._grid.colvisible(e,arguments[0])},enabled:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return this._grid.colenabled(e);this._grid.colenabled(e,arguments[0])},field:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return this._grid.colfield(e);this.member=value,this._grid.colfield(e,arguments[0])},sort:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return this._grid.colsort(e);this._grid.colsort(e,Frames.isTrue(arguments[0]))},editor:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return this._grid.coleditor(e);this._grid.coleditor(e,arguments[0])},allowUpdate:function(){if(this._grid&&this._grid._CTX_){var e=this._grid._CTX_.indexOf(this);-1!=e&&this._grid.colAllowUpdate(e,"true"===arguments[0])}},label:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return this._grid.collabel(e);this._grid.collabel(e,arguments[0])},format:function(){var e=this._grid._CTX_.indexOf(this);if(0===arguments.length)return-1!=e?this._grid.colformat(e):void 0;-1!=e&&this._grid.colformat(e,arguments[0])},_getRowIndex:function(){var e=this._grid._grid,t=this._grid.block,i=-1;return i="function"==typeof e.getData().getRowById?e.getData().getRowById(t.selid):t.indexOf(t.selid),(Frames.isUndef(i)||-1==i)&&(i=e.getSelectedRows()[0],(Frames.isUndef(i)||-1==i)&&(i=t.selidx)),i},focus:function(e){var t=this._grid._grid,i=this,a=$.map(this._grid._columns,function(e){return i.member==e.field?e:void 0}),s={cell:0<a.length?t.getColumnIndex(a[0].id):void 0};if(void 0!==s.cell&&!Frames.isFalse(i.props("Enabled"))){e&&this._grid._last_editor?s.row=parseInt(this._grid._last_editor.$input.attr("row"),10):s.row=this._getRowIndex();try{Frames.isTrue(this.props("Enabled"),!0)&&this._focusOnCell(s)}catch(e){var r=t.getEditController();t.getEditorLock().isActive(r)&&t.getEditorLock().deactivate(r)}}},_focusOnCell:function(e){var t=this._grid._grid;if(t.gotoCell(e.row,e.cell,!0),void 0===t.getColumns()[e.cell].editor){var i=$(t.getCellNode(e.row,e.cell)).find("button");i.focus();var a=i.data("frames");void 0!==a&&Frames.DataGrid.TextCellEditor.prototype.focusin.apply(a)}else{var s=t.getCellEditor();if(!Frames.FocusManager.equals(Frames.Application.current(),s)){var r=$.Event("focuschange",{target:s.input()}),n=s.input()?s.input():s;n&&n.trigger(r)}}},bindable:function(){return this._grid},resolve:function(){return this._editor||this._curr||this},isContext:function(){return!0},leave:function(e){(this._grid.block._item=e).selid=e.args.item.__id__,this.trigger(e,"focusout"),this._grid._last_id=this._grid.block.selid,this._grid._last_editor=this._editor,delete this._editor,delete this._last_value,this._curr===e&&delete this._curr},hasChanges:function(){var e=this.value(),t=this._getData(),i=Frames.isUndef(t)?"":t[this._col.field+":last_value"],a=this.props("format"),s=this.props("type");return!Frames.Format.equals(e,i,a,s)},recordHasChanges:function(){var e=this.resolve();return e!==this&&$.isFunction(e.recordHasChanges)?e.recordHasChanges():Frames.DataGrid.TextCellEditor.prototype.recordHasChanges.apply(this)},enter:function(e){this._last_value=e.defaultValue;var t=e.args.item.__id__,i=this._grid.block.indexOf(t);this._grid.selected(i),this._grid.block.selid=t,this._grid.block.selidx=i;var a=this._grid.block;$(a).trigger("indexchange",{selidx:a.selidx,selid:a.selid,record:(a.paging.number-1)*a.paging.size+a.selidx+1}),this._editor&&(this._grid.block._item=this._editor),this._editor=e;this.trigger(e,"focusin");delete this._grid._last_id,delete this._grid._last_editor,this._grid.block.refresh()},validate:function(){return!0},bind:function(){this._colev.bind.apply(this._colev,arguments)},trigger:function(e,t,i,a){var s,r=e.timeStamp?e:i;if(Frames.isUndef(r))"string"==typeof e&&Frames.isUndef(t)&&(t=e),this._elem.data("frames",e),this._colev.data("frames",e),s=this.input(),Frames.isUndef(s)||s.data("frames",this._curr||this),r=$.Event(t);else if("focuschange"==r.type||"keydown.navigation"==t){if(s=this.input(),!Frames.isUndef(s))if(s.data("frames",this._curr||this),i)$(i.target).data("frames")||$(i.target).data("frames",this._curr||this)}return this._colev.trigger(r,a),r},_hasEditor:function(){return!Frames.isUndef(this._col.editor)},applyformat:function(){},_getData:function(){return this._grid._grid.getDataItem(this._grid._grid.getSelectedRows()[0])},value:function(){var e=this._getData();if(0===arguments.length){var t=Frames.isUndef(e)?"":e[this._col.field];try{if(!this._col.readonly&&!Frames.isUndef(this.input())&&this._hasEditor()){var i=this.input().val();t.replace(/\r?\n|\r/g,"")!=i&&(t=i)}}catch(e){}return t}var a=arguments[0],s="SEARCH"==(this.mode?this.mode.name:this.block?this.block.props("blockMode"):void 0)&&Frames.isTrue(this.props("AllowSearch")||!0);Frames.isUndef(e)||(e[this._col.field]=s?a:Frames.Format.formatToCanonical(a,this.props("format"),this.props("type"))),this._col.readonly||Frames.isUndef(this.input())||this.input().val(a)},model:function(){this._grid.model.apply(this._grid,arguments)},dataModel:function(){return this._col.data},dynmodel:function(e){if(e&&(Frames.isTrue(e["@hasChanges"])||e.listElement)){var t=this._grid._grid,i=t.getColumns()[t.getColumnIndex(this._col.id)];if(!Frames.isUndef(i)){var a;if(this._col.data=[],e.listElement)for(a=0;a<e.listElement.length;a++){var s=e.listElement[a],r=Frames.Model.attr(s,"label"),n=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(Frames.Model.attr(s,"dataIsNull"))?null:Frames.Model.attr(s,"data"),o={};o.value=n,o.label=r,this._col.data.push(o)}i.data=this._col.data}}},css:function(){var e=arguments[0],t=e.indexOf(":");-1!=t&&"label"==e.substr(0,t)&&Frames.Item.prototype.css.apply(this,arguments)},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1,caseRestriction:!1},data:{block:!1,member:!0,datatype:!0,value:!1},validation:null}},designprops:function(e){return delete e.general.properties.position,delete e.general.properties.font,delete e.general.properties.style,delete e.general.properties.menu,e},api_mouse_target:function(e){var t=this._grid._CTX_.indexOf(this),i=this._grid._grid,a=null;if(Frames.isUndef(e)){if(this._editor)return this.input();a=i.getCellNode(this._getRowIndex(),t)}else a=i.getCellNode(e,t);var s=$(a).find("button");return 1==s.length?s:a}})}(jQuery),function($){Frames.DataGrid.ButtonFormatter=function(e,t,i,a,s){var r=Frames.DataGrid.getInstanceData(this._CTX_.get(a.field),a,s),n=!Frames.isTrue(r.enabled),o=Frames.isTrue(r.readonly),l=r.icon,d=(a.label,[]),u=[];!Frames.isUndef(l)||Frames.isUndef(a.props)||Frames.isUndef(a.props.icon)||(l=a.props.icon),Frames.isUndef(l)?d.push("ui-button-text-only"):(a.label?d.push("ui-button-text-icon"):d.push("ui-button-icon-only"),-1===l.indexOf(".")&&-1===l.indexOf("/")||(l=$.ui.image.prototype.url(l),u.push("ui-icon-image")));var c=a.props.tooltip?a.props.tooltip:a.title?a.title:"",p='<span class="'+(l?"ui-button-icon ui-icon "+(0<u.length?u.join(" ")+'" style="background-image: url(\''+l+"')":l)+'">':'ui-button-text">'+a.label)+"</span>";return'<button class="ui-button ui-widget ui-state-default '+d.join(" ")+(n?" ui-state-disabled":"")+(o?" ui-state-readonly":"")+(a.style?" "+a.style:"")+'" onclick="Frames.DataGrid.CheckBoxFormatter.click(this); return false;" '+(Frames.isUndef(a.action)?"":'data-action="'+a.action.replace(/"/g,"'")+'" ')+'data-member="'+a.field+'" data-row="'+e+'" title="'+c+'" data-rowid="'+s.__id__+'" data-column="'+a.id+'"'+(n?'disabled="disabled"':"")+">"+p+"</button>"}}(jQuery),function($){Frames.DataGrid.CellFormatter=function(e,t,n,i,a){var s,r=Frames.DataGrid.getInstanceData(this._CTX_.get(i.field),i,a);switch(i.editorType){case"combobox":var o=n,l=i.unvalue;$.each(i.data,function(e,t){var i,a,s=t.value;if(void 0===s)for(a in t)i=t[s=a];var r=s==n;if((r||l===s)&&(o=t.label||i||""),r)return!1}),s=o;break;default:var d=r.type,u=Frames.DataGrid.isDisplayAsPassword(this._CTX_.get(i.field),i,a);s=Frames.isUndef(i.editor)||"SEARCH"!=this.block.props("blockMode")?Frames.Format.formatFromCanonical(n,r.format||i.format,d):n,u&&(s=s.replace(/(.)/g,"*"))}var c,p="",m=[];"combobox"!==i.editorType&&i.props&&"upper"==i.props.case&&m.push("text-transform: uppercase"),i.textalign&&m.push("text-align: "+i.textalign),0<m.length&&(p+=' style="'+m.join(";")+'"'),""!==s&&(s=$.escapeHtml(s)),"Date"!=i.type&&"combobox"!=i.editorType?c=Frames.Item.prototype._getDataDirection.apply(i):"Date"==i.type&&Frames.Locale.formats.IS_RTL&&!Frames.Locale.formats.DATE_IS_RTL&&(c="ltr");var h=!Frames.isTrue(r.enabled);return'<div class="ui-text'+(Frames.isTrue(r.readonly)?" ui-state-readonly":"")+(h?" ui-state-disabled":"")+'"  data-member="'+i.field+'" data-row="'+e+'"  data-rowid="'+a.__id__+'" '+p+(Frames.isEmpty(c)?"":' dir="'+c+'"')+(Frames.isTrue(u)?"":'title="'+s+'"')+(h?'disabled="disabled"':"")+">"+s+"</div>"}}(jQuery),function($){Frames.DataGrid.CheckBoxFormatter=function(e,t,i,a,s){var r=this._formattercache.get(a.field),n=Frames.DataGrid.getInstanceData(this._CTX_.get(a.field),a,s);if(Frames.isUndef(r)){var o=Frames.DataGrid.CheckBoxFormatter._align(a);r='<div class="ui-checkbox" onclick="Frames.DataGrid.CheckBoxFormatter.focus(this); return false;" data-member="'+a.field+'" data-row="{0}" data-rowid="{1}"><button '+(Frames.isEmpty(o)?"":'style="'+o+'" ')+'data-row="{0}" data-rowid="{1}" class="ui-button ui-widget ui-state-default ui-button-icon-only{2}{8}" onclick="Frames.DataGrid.CheckBoxFormatter.click(this); return false;" '+(Frames.isUndef(a.action)?"":'data-action="'+a.action+'" ')+'data-member="'+a.field+'" data-column="'+a.id+'"data-value="{10}"data-fvalue="{11}"data-unvalue="{12}"title="'+a.title+'" {3} {9}role="checkbox" aria-label="{6}" aria-checked="{7}" state="{5}"><span class="ui-button-icon ui-icon{4}"></span><span class="ui-button-text">&#160;</span></button></div>',this._formattercache.put(a.field,r)}var l=i==a.value||a.unvalue==a.value&&a.fvalue!=i,d=!Frames.isTrue(n.enabled),u=Frames.isTrue(n.readonly);return r=r.format(e,s.__id__,d?" ui-state-disabled":"",d?'disabled="disabled"':"",l?" fa fa-check":" fa ui-icon-none",l?"checked":"unchecked",a.label,l,u?" ui-state-readonly":"",u?'readonly="readonly"':"",a.value,a.fvalue,a.unvalue)},Frames.DataGrid.HeaderCheckBoxFormatter=function(e){var t=!Frames.isTrue(e.enabled),i=!0===this._headerCheckboxState[e.field]?"fa fa-check":"fa ui-icon-none",a=!0===this._headerCheckboxState[e.field]?"checked":"unchecked",s=Frames.DataGrid.CheckBoxFormatter._align(e);return'<div class="ui-checkbox"><button '+(Frames.isEmpty(s)?"":'style="'+s+'" ')+'class="ui-button ui-widget ui-state-default ui-button-icon-only'+(t?" ui-state-disabled":"")+'" data-block="'+this.elem.data("block")+'" data-member="'+e.field+'" data-editable="'+e.headerEditable+'" '+(e.headerEditable?"":'readonly="readonly" ')+(t?'disabled="disabled" ':"")+'role="checkbox" state="'+a+'"onclick="Frames.DataGrid.HeaderCheckBoxFormatter.click(this); return false;"><span class="ui-button-icon ui-icon '+i+'"></span><span class="ui-button-text">$#160;</span></button>'+(e.label?"<span>"+e.label+"</span>":"")+"</div>"},Frames.DataGrid.HeaderCheckBoxFormatter.click=function(e,t){var i=$(e),a=i.find(".ui-button-icon");if("disabled"!=i.attr("disabled")&&!1!==i.data("editable")){var s=a.hasClass("ui-icon-none"),r=s?"fa fa-check":"fa ui-icon-none",n=s?"fa ui-icon-none":"fa fa-check";i.attr("state",s?"checked":"unchecked"),$(e).closest(".ui-gridview").data("frames")._headerCheckboxState[i.data("member")]=s,a.removeClass(n).addClass(r),t||Frames.Application.execute({name:s?"SELECT_ALL":"CLEAR_SELECTION"},void 0,void 0,i.data("block"),i.data("member"),!1)}},Frames.DataGrid.CheckBoxFormatter._align=function(e){if(!Frames.isUndef(e)){var t="";switch(e.textalign){case"left":t="margin-right: auto; margin-left: 0px";break;case"right":t="margin-left: auto; margin-right: 0px";break;case"center":t="margin-left: auto; margin-right: auto"}return t}},Frames.DataGrid.CheckBoxFormatter.value=function(e){var t=e.data("value");return null!==t?String(t):t},Frames.DataGrid.CheckBoxFormatter.fvalue=function(e){var t=e.data("fvalue");return null!==t?String(t):t},Frames.DataGrid.CheckBoxFormatter.optmodel=function(){if(this.editable()){var e=this._inp,t=e.find(".ui-button-icon"),i=Frames.DataGrid.CheckBoxFormatter.value(e),a=Frames.DataGrid.CheckBoxFormatter.fvalue(e);return i=t.hasClass("fa fa-check")?a:i,Frames.Model.createItem(this.member,i)}},Frames.DataGrid.CheckBoxFormatter.click=function(e){var t=$(e).data("frames");Frames.isUndef(t)||((t.context.block._item=t).context.trigger(t,"btnclick").isDefaultPrevented()||t.context.enter(t))},Frames.DataGrid.CheckBoxFormatter.focus=function(e){var t=$("button",$(e)).data("frames");Frames.isUndef(t)||((t.context.block._item=t).context.trigger(t,"focus").isDefaultPrevented()||t.context.enter(t))},Frames.DataGrid.CheckBoxFormatter.toggle=function(e){var t=(e=$(e)).find(".ui-button-icon");if("disabled"!=e.attr("disabled")&&!1!==e.data("editable")){var i=t.hasClass("ui-icon-none"),a=i?"fa fa-check":"fa ui-icon-none",s=i?"fa ui-icon-none":"fa fa-check";e.parent().trigger("toggle",{checked:i,colid:e.data("column")}),t.removeClass(s).addClass(a);var r=e.data("column").lastIndexOf("_"),n=e.data("column").substr(0,r),o=Frames.get(n),l=o._grid,d=parseInt(e.data("row"),10),u=i?Frames.DataGrid.CheckBoxFormatter.value(e):Frames.DataGrid.CheckBoxFormatter.fvalue(e);l.getDataItem(d)[e.data("member")]=u,e.triggerHandler("valuechange");var c=e.data("rowid");o.block.select(c),o.block.dirty(!0),Frames.DataGrid.execute(e,null,n,c,null)}}}(jQuery),function($){Frames.DataGrid.FileInputFormatter=function(e,t,i,a,s){var r=Frames.DataGrid.getInstanceData(this._CTX_.get(a.field),a,s),n=!Frames.isTrue(r.enabled),o=Frames.isTrue(r.readonly),l=$.ui.fileinput.prototype.options.icon;return'<button class="ui-button ui-fileinput ui-widget ui-state-default ui-button-text-icon-primary'+(n?" ui-state-disabled":"")+(o?" ui-state-readonly":"")+(a.style?" "+a.style:"")+'" onclick="Frames.DataGrid.execute(this); return false;" '+(Frames.isUndef(a.action)?"":'data-action="'+a.action+'" ')+'data-member="'+a.field+'" data-row="'+e+'" data-rowid="'+s.__id__+'" data-column="'+a.id+'"'+(n?'disabled="disabled"':"")+'><span class="ui-button-icon ui-icon '+l+' "></span><span class="ui-button-text">&nbsp;</span></button><input name="file" type="file" style="display:none;" onchange="Frames.DataGrid.FileInputFormatter.change(this); return false;"/>'},Frames.DataGrid.FileInputFormatter.change=function(s){var e,r=(s=$(s)).parent().find("button"),t=r.data("column");if(!Frames.isUndef(t)){var i="";e="string"==typeof t?(i=t.lastIndexOf("_"),t.substr(0,i)):(i=t.id.lastIndexOf("_"),t.id.substr(0,i));var n=Frames.get(e),o=parseInt(r.data("row"),10);n.selected(o),n.block.select(r.data("rowid")),1==s.parent("form").length&&s.unwrap();var l=s.parent();s.appendTo(document.body),s.upload(Frames.Config.get("UPLOAD_URL"),function(e){Frames.waitEnd(),1==s.parent("form").length&&s.unwrap(),s.appendTo(l);var t=null;try{t=$.xmlToJSON(e)}catch(e){}var i=t&&t.name?t.name[0].Text:"";t=n._grid.getDataItem(o),Frames.isUndef(t)||(t[r.data("member")]=i),n.block.dirty(!0);var a=r.data("action");Frames.isEmpty(i)||Frames.isUndef(a)||Frames.Application.execute(a,null,null,n.block.name,n.block.get(r.data("member")).member)},"html")}}}(jQuery),function($){Frames.DataGrid.ImageFormatter=function(e,t,i,a,s){var r=a.field,n=$.ui.image.prototype.url(i);return'<img class="ui-image ui-widget'+(a.style?" "+a.style:"")+'" data-member="'+r+'" data-row="'+e+'" data-rowid="'+s.__id__+'" data-column="'+a.id+'" src="'+n+'" style="display: '+(Frames.isEmpty(n)?"none":"block")+'; height: 100%; width: 100%;"></img>'}}(jQuery),jQuery,Frames.DataGrid.TextLinkFormatter=function(e,t,i,a,s){var r=Frames.DataGrid.getInstanceData(this._CTX_.get(a.field),a,s);return'<div class="ui-textlink ui-widget ui-state-default'+(Frames.isTrue(r.enabled)?"":" ui-state-disabled")+(Frames.isTrue(r.readonly)?" ui-state-readonly":"")+(a.style?" "+a.style:"")+'" ><a href="#" onclick="Frames.DataGrid.execute(this); return false;" data-member="'+a.field+'" data-row="'+e+'" data-rowid="'+s.__id__+'" data-column="'+a.id+'"'+(Frames.isUndef(a.action)?"":'data-action="'+a.action.replace(/"/g,"'")+'" ')+">"+i+"</a></div>"},function($){Frames.DataGrid.TextCellEditor=$.inherit({__constructor:function(e){this.$input=null,this.defaultValue=null,this.args=e,this.init()},_isDisplayAsPassword:function(){return Frames.DataGrid.isDisplayAsPassword(this.context,this.args.column,this.args.item)},_isEditable:function(){var e=this.args.item.__status__,t=this.context.props("AllowInsert"),i=this.context.props("AllowUpdate"),a=this.context.props("ReadOnly")||this.context.props("readonly"),s=Frames.findSingle(this.context.block._ctrinf,"item",this.args.column.field);if(s&&(data=this.context.__getInstance(s,this.args.item.__idx__+1),data&&data.properties)){var r=data.properties[0]["@AllowInsert"];Frames.isUndef(r)||(t=r),r=data.properties[0]["@AllowUpdate"],Frames.isUndef(r)||(i=r),r=data.properties[0]["@ReadOnly"],Frames.isUndef(r)||(a=r)}return!Frames.isTrue(a)&&(void 0!==e&&"INSERTED"==e?Frames.isTrue(t):Frames.isTrue(i))},_createEditor:function(){var e=this.args.item[this.args.column.field]||"",t=Frames.isTrue(Frames.Config.get("GRID_MULTILINE"),!1)&&-1!=e.indexOf("\n"),i=Frames.isTrue(this._force_editable)?"READ":this.args.grid._frames.block.props("blockMode"),a=this._isEditable();if(t)return $('<textarea class="editor-text" '+("READ"!=i&&a?"":'readonly="readonly"')+' row="'+this.args.item.__idx__+'"></textarea>');var s="text",r=this.args.column.editorType,n=this._isDisplayAsPassword();return Frames.isUndef(r)||"calendar"==r&&(s="date"),n&&(s="password"),$('<INPUT type="'+s+'" class="editor-text" '+("READ"!=i&&a?"":'readonly="readonly"')+(Frames.isTrue(n)?"":'title="'+e+'"')+' row="'+this.args.item.__idx__+'"/>')},_resizeEditor:function(e){var t=$(e.currentTarget).find("button");Frames.isVisible(t)?$(e.currentTarget).find("input").css("width",$(e.currentTarget).width()-$(e.currentTarget).find("button").width()-1):$(e.currentTarget).find("input").css("width",$(e.currentTarget).width())},init:function(){var t=this.context=this.args.grid._frames._CTX_.get(this.args.column.field),i=this,e=this.args.container,a=Frames.uuid();this.elem=this.$input=this._createEditor(),(t._curr=this).$input.appendTo(e).bind("keydown.nav",function(e){if((e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),!Frames.isUndef(t))&&t.trigger(i,"keydown.navigation",e).isDefaultPrevented())return e.preventDefault(),e.stopImmediatePropagation(),!1;e.keyCode===$.ui.keyCode.ESCAPE&&e.stopImmediatePropagation()}).bind("dblclick",$.proxy(this._onDblClick,this)).bind("focusout",$.proxy(function(e){Frames.isUndef(t)||t.trigger(this,"focusout",e)},this)).bind("focuschange",$.proxy(function(e){Frames.isUndef(t)||t.trigger(e)},this));var s=$(e);e.attr("id",a),this.$input.attr("row",this.args.item.__idx__).attr("id","#"+a),this.$input.css("height",s.outerHeight()-2),this.applyFocus(),this.$input.parent().css("overflow","hidden"),this.update(),this.defaults()},defaults:function(){this._checkFormat(),this._listenChanges(),this._applyDirection()},applyFocus:function(){this.focusin(),this.$input.focus()},_checkFormat:Frames.Item.prototype._checkFormat,_listenChanges:Frames.Item.prototype._listenChanges,dirty:Frames.Item.prototype.dirty,_applyAutoskip:Frames.Item.prototype._applyAutoskip,_autoskipNavigate:Frames.Item.prototype._autoskipNavigate,_getDataDirection:Frames.Item.prototype._getDataDirection,_applyDirection:Frames.Item.prototype._applyDirection,_ev_obj:Frames.Item.prototype._ev_obj,on:Frames.Item.prototype.on,one:Frames.Item.prototype.one,off:Frames.Item.prototype.off,trigger:Frames.Item.prototype.trigger,_onDblClick:function(e){if(!Frames.Application.executing()&&!Frames.isUndef(this.context)){var t=this.context._col.events.dblclick;Frames.isUndef(t)&&(t=this.context._col.events.doubleclick),Frames.isUndef(t)?this.context.trigger(this,"dblclick",e):(Frames.Application.valexec(t,null,null,this.context.block.name,this.context.member),e.stopImmediatePropagation())}},update:function(){if(!Frames.isUndef(this.context)){var e=this.context;this.block=this.args.grid._frames.block,this.member=e.props("member"),this.view=e.view,this._updating=!0;var t=e._control;if(this.props(e.props()),this.props("serverStatus",this.args.item.__status__),Frames.isUndef(this.props("InputTransform"))&&this.props("InputTransform",Frames.Config.get("INPUT_DEFAULT_FORMAT","none")),t){var i,a,s={};if(Frames.Modes.leave(this),e.props("format")&&(s.format=e.props("format"),s.formatDefault=e.props("formatDefault")),e.props("type")&&(s.type=e.props("type")),e.props("keyactions")&&(s.keyactions=e.props("keyactions")),t.properties)for(i in a=t.properties[0])"string"==typeof i&&-1!==i.indexOf("@Allow")&&(s[i]=a[i]);var r=Frames.findSingle(t,"item",this.member);if(r){if(r.properties)for(i in a=r.properties[0])"string"==typeof i&&-1===i.lastIndexOf("@",0)||"@StyleClass"===i||(s[i]=a[i]);if(r.instance){var n=e.__getInstance(r,this.args.item.__id__);if(n&&n.properties)for(i in a=n.properties[0])"string"==typeof i&&-1===i.lastIndexOf("@",0)||"@StyleClass"===i||(s[i]=a[i])}}for(i in s)s.hasOwnProperty(i)&&this.props(i,s[i]);this.props("Error")&&this.props("Valid","false"),this.$input&&"upper"==this.props("InputTransform")&&this.restrictCase("upper"),this.elevate();var o=Frames.getplugs(Frames.PLUGIN_CONTROLINFO);for(o.reset();o&&o.hasNext();)o.next().apply(e,t);Frames.Modes.enter(Frames.isTrue(this._force_editable)?"READ":this.block.props("blockMode"),this)}var l=this.args.column.textalign;Frames.isUndef(l)||Frames.isUndef(this.$input)?Frames.TextInput.prototype._setAutoAlignment.apply(this):this.$input.css("text-align",l),Frames.TextInput.prototype.initInputMask.apply(this,[!0]),delete this._updating}},restrictCase:function(){if(!(0<arguments.length))return"uppercase"==this.$input.css("text-transform")?"upper":void 0;"upper"==arguments[0]&&this.$input.css("text-transform","uppercase")},elevate:function(){this.input().css("z-index",$.ui.dialog.maxZ+20)},focusin:function(){Frames.isUndef(this.context)||this.context.enter(this)},focusout:function(){Frames.isUndef(this.context)||this.context.leave(this)},data:Frames.Item.prototype.data,props:Frames.Item.prototype.props,_set_prop:function(e,t){if(Frames.Item.prototype._set_prop.apply(this,[e,t]),!this._updating&&-1!=$.inArray(e,["Valid","ValidationMessage","Error"])){var i=Frames.findSingle(this.context.block._ctrinf,"item",this.args.column.field);if(i){var a=this.args.item.__id__,s=this.context.__getInstance(i,a);if(!s){var r=$.xmlToJSON('<instance row="'+a+'"><properties /></instance>');(r.parent=i).instance||(i.instance=[]),i.instance.push(r),s=r}s.properties&&(s.properties[0]["@"+e]=t)}}},editable:Frames.Item.prototype.editable,enabled:Frames.Item.prototype.enabled,valid:Frames.Item.prototype.valid,enterHasTab:Frames.Item.prototype.enterHasTab,processNavigationKey:Frames.Item.prototype.processNavigationKey,rules:Frames.Item.prototype.rules,_call:$.noop,widget:$.noop,tooltip:Frames.Item.prototype.tooltip,updateshortcut:Frames.Item.prototype.updateshortcut,_updateshortcut:Frames.Item.prototype._updateshortcut,_getaction:Frames.Item.prototype._getaction,toValidate:Frames.Item.prototype.toValidate,clickable:function(){return!1},bindable:function(){return this.args.grid._frames},resolve:function(){return this.context?this.context.resolve():this},widgetcls:function(){return"textfield"},ovalue:Frames.Item.prototype.ovalue,commitChanges:function(e){0!==this.elem.parent().length&&(e&&!this.hasChanges()||(this.args.item[this.member]=this.serializeValue()))},hasChanges:function(){return this.isValueChanged(!1)},label:function(){return this.context.label()},input:function(){return!this.context._grid._last_editor||this.context._grid._last_editor==this||0!==this.$input.parent().length&&0!==this.elem.parent().length?this.$input:this.context._curr&&this.context._curr.$input.parent()&&0!==this.context._curr.$input.parent().length&&this.context._curr.$input.parent().parent()&&0!==this.context._curr.$input.parent().parent().length?this.context._curr.$input:this._col||$([])},erroranchor:function(){return this.input()},destroy:function(){this.focusout(),Frames.Validation.hideError(this),this.elem.remove(),this.props("ValidationEnabled",!1)},focus:function(){0===this.$input.parent().length||0===this.elem.parent().length?this.context.focus():this.$input.focus()},value:function(){if(0===arguments.length)return this.getValue();this.setValue(arguments[0])},getValue:function(){return this.$input.val()},setValue:function(e){this.$input.val(e)},loadValue:function(e){var t=e[this.args.column.field],i=(Frames.isUndef(t),t||""),a="SEARCH"==(this.mode?this.mode.name:this.block?this.block.props("blockMode"):void 0)&&Frames.isTrue(this.props("AllowSearch")||!0),s=this.props("format"),r=this.props("type"),n=i,o=Frames.Format.formatFromCanonical(i,s,r);this.ovalue(Frames.Format.toValueFromCanonical(i,r)),Frames.isTrue(this.editable())||(i=o),this.defaultValue=i,a||(n=Frames.Format.unformat(o,s,r)),this.$input.val(n),this.$input[0].defaultValue=this.defaultValue},serializeValue:function(){var e,t="SEARCH"==(this.mode?this.mode.name:this.block?this.block.props("blockMode"):void 0)&&Frames.isTrue(this.props("AllowSearch")||!0),i=(Frames.isTrue(this.props("formatEnabled")||!0),this.getValue());if(e=t?i:(i=Frames.Format.formatToCanonical(i,this.props("format"),this.props("type")),Frames.Format.toValueFromCanonical(i,this.props("type"))),this.ovalue(e),"upper"!=this.props("InputTransform")||$.isFunction(this.optmodel)||(i=i.toUpperCase()),!Frames.isUndef(this.context)){var a=this.context._getData();Frames.isUndef(a)||(a[this.context._col.field+":last_value"]=i),this.context._last_value=i}return i},applyValue:function(e,t){this.editable()&&(this.isValueChanged(!0)&&(this.bindable()._changed=e.__id__),e[this.args.column.field]=t)},isValueChanged:function(){if(0===arguments.length&&!Frames.isTrue(arguments[0])&&Frames.isEmpty(this.$input.val())&&Frames.isTrue(this.props("required")))return!0;var e=this._removeBreakLines(this.getValue()),t=this._removeBreakLines(this.defaultValue);return!(Frames.isEmpty(e)&&Frames.isUndef(t))&&e!=t},_removeBreakLines:function(e){return Frames.isUndef(e)||"string"!=typeof e||(e=e.replace(/\r?\n|\r/g,"")),e},recordHasChanges:function(){var e=this.resolve(),t=this.bindable()._changed;return!Frames.isUndef(e.args)&&t==e.args.item.__id__},validate:function(){if(1==arguments.length)return Frames.Item.prototype.validate.apply(this,arguments);if(this.args.column.validator){var e=this.args.column.validator(this.$input.val());if(!e.valid)return e}return Frames.Validation.validateFormat(this)?{valid:!0,msg:null}:(Frames.isUndef(this.context)||(this.context._has_error=!0),{valid:!1,msg:null})},design:function(){return!1},api_mouse_target:function(e){return e?this._CTX_.api_mouse_target(e):this.input()}})}(jQuery),function($){Frames.DataGrid.CalculatorCellEditor=$.inherit(Frames.DataGrid.TextCellEditor,{init:function(){var t=this.context=this.args.grid._frames._CTX_.get(this.args.column.field),e=this.args.column,i=this;t._curr=this;var a,s=$(this.args.container);for(a in s.on("resize",this._resizeEditor),s.css({paddingLeft:0,paddingRight:0}),this.elem=$('<div><input type="text" /></div>').appendTo(s).bind("dblclick",$.proxy(this._onDblClick,this)).bind("focusout",$.proxy(function(e){return i._inbutton?(delete i._inbutton,e.stopImmediatePropagation(),!1):i.elem.xcalculator("isdialogvisible")?(e.preventDefault(),!1):void 0},this)).bind("focuschange",$.proxy(function(e){Frames.isUndef(t)||t.trigger(e)},this)),this.elem.width(s.width()+1).attr("id",Frames.uuid()),this.$input=this.elem.find("input"),this.$input.attr("row",this.args.item.__idx__),this.elem.data("format",t.props("format")),this.elem.xcalculator({grid:!0}),this.$input.css("height",s.outerHeight()-2),this.update(),this.defaults(),e.props)this.elem.data(a,e.props[a]);var r=this._btn=this.elem.find("button");Frames.isVisible(r)||this.$input.css("width","100%"),this.elem.bind("keydown.nav",function(e){if(Frames.DataGrid.handleButton(e))return!1;if((i.enterHasTab()&&e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.which=$.ui.keyCode.TAB),e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),!Frames.isUndef(t))&&t.trigger(i,"keydown.navigation",e).isDefaultPrevented())return e.preventDefault(),e.stopImmediatePropagation(),!1}),r.mousedown(function(e){i._inbutton=!0}).mouseup(function(e){delete i._inbutton}).focusout(function(e){return e.preventDefault(),!1}),this.$input.focusout(function(e){return i._inbutton?(delete i._inbutton,e.preventDefault(),!1):i.elem.xcalculator("isdialogvisible")?(e.preventDefault(),!1):void 0}),this.applyFocus(),Frames.TextInput.prototype.initInputMask.apply(this,[!0])},editable:function(){if(!(0<arguments.length))return Frames.Calculator.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.elem.xcalculator("buttonObj"),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},enabled:function(){if(!(0<arguments.length))return Frames.Calculator.prototype.enabled.apply(this);Frames.Calculator.prototype.enabled.apply(this,arguments)},widgetcls:function(){return"ui.xcalculator"},erroranchor:function(){return this.buttonObj()},buttonObj:function(){return this._btn},destroy:function(){$(this.args.container).off("resize",this._resizeEditor),Frames.DataGrid.TextCellEditor.prototype.destroy.apply(this)},processNavigationKey:Frames.ButtonInput.prototype.processNavigationKey,clickable:Frames.ButtonInput.prototype.clickable,design:function(){return!1}})}(jQuery),function($){Frames.DataGrid.ColorPickerCellEditor=$.inherit(Frames.DataGrid.TextCellEditor,{init:function(){var t=this.context=this.args.grid._frames._CTX_.get(this.args.column.field),i=this.args.column,a=this;t._curr=this;var e,s=$(this.args.container);for(e in s.on("resize",this._resizeEditor),s.css({paddingLeft:0,paddingRight:0}),this.elem=$('<div><input type="text" /></div>').appendTo(s).bind("dblclick",$.proxy(this._onDblClick,this)).bind("focusout",$.proxy(function(e){if(a._inbutton)return delete a._inbutton,e.stopImmediatePropagation(),!1;Frames.isUndef(t)||t.trigger(this,"focusout",e)},this)).bind("focuschange",$.proxy(function(e){Frames.isUndef(t)||t.trigger(e)},this)),this.elem.width(s.width()+1),this.$input=this.elem.find("input"),this.$input.attr("row",this.args.item.__idx__),this.$input.css("height",s.outerHeight()-2),Frames.isUndef(i.action)||this.elem.data("action",i.action),i.props)this.elem.data(e,i.props[e]);this.elem[this.widgetcls()]({grid:!0}),this.update();var r=this._btn=this.elem.find("button");Frames.isVisible(r)||this.$input.css("width","100%"),this.elem.bind("keydown.nav",function(e){if(Frames.DataGrid.handleButton(e))return!1;if((a.enterHasTab()&&e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.which=$.ui.keyCode.TAB),e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),!Frames.isUndef(t))&&t.trigger(a,"keydown.navigation",e).isDefaultPrevented())return e.preventDefault(),e.stopImmediatePropagation(),!1}),this.elem.data("column",i.id),this.elem.data("member",i.field),this.$input.bind("action",function(){var e=a.args.grid._frames.block;Frames.DataGrid.execute(a.elem,i.action,void 0,e.selid,!1)}),r.mousedown(function(e){a._inbutton=!0}).mouseup(function(e){delete a._inbutton}).focusout(function(e){return e.preventDefault(),!1}),this.$input.focusout(function(e){if(a._inbutton)return delete a._inbutton,e.preventDefault(),!1}),this.applyFocus(),this.defaults()},loadValue:function(e){var t=e[this.args.column.field]||"",i=Frames.ColorPicker.prototype.rgbToHex(t);this.defaultValue=t,this.$input.val(this.defaultValue),this.$input[0].defaultValue=this.defaultValue,this.$input.colorPicker("val",this.defaultValue),this.elem.find("button").css("background",i)},editable:function(){if(!(0<arguments.length))return Frames.ButtonInput.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.elem[this.widgetcls()]("buttonObj"),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},enabled:function(){if(!(0<arguments.length))return Frames.ButtonInput.prototype.enabled.apply(this);Frames.ButtonInput.prototype.enabled.apply(this,arguments)},widgetcls:function(){return"colorpicker"},erroranchor:function(){return this.buttonObj()},buttonObj:function(){return this._btn},destroy:function(){this.focusout(),$(this.args.container).off("resize",this._resizeEditor),Frames.Validation.hideError(this),this.elem.remove()},processNavigationKey:Frames.ButtonInput.prototype.processNavigationKey,clickable:Frames.ButtonInput.prototype.clickable})}(jQuery),function($){Frames.DataGrid.ComboBoxCellEditor=$.inherit(Frames.DataGrid.TextCellEditor,{init:function(){var i=this,t=this.context=this.args.grid._frames._CTX_.get(this.args.column.field),a=this;t._curr=this;var e=$(this.args.container);e.on("resize",this._resizeEditor),e.css({paddingLeft:0,paddingRight:0}),this.elem=$("<div><select></select></div>").appendTo(e).bind("keydown.nav",function(e){e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.which=$.ui.keyCode.TAB),e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),Frames.isUndef(t)||t.trigger(a,"keydown.navigation",e)}).bind("dblclick",$.proxy(this._onDblClick,this)).bind("focuschange",$.proxy(function(e){Frames.isUndef(t)||t.trigger(e)},this)).focus(),this.args.column.props.action&&this.elem.data("action",this.args.column.props.action);var s=this.args.column.events;Frames.isUndef(s)||$.each(s,function(e,t){i.elem.data(e,t)});var r=t.dataModel(),n=Frames.isUndef(r)?this.args.column.data:r;if(!Frames.isUndef(n)){var o,l,d=$("select",this.elem).get(0).options;$.each(n,function(e,t){var i;if(l=t.label,o=t.value,Frames.isUndef(l)&&void 0===o)for(i in t)t.hasOwnProperty(i)&&(l=t[o=i]);var a=new Option(Frames.isUndef(l)&&$.browser.mozilla?"":l,Frames.isUndef(o)&&$.browser.mozilla?"":o);Frames.isTrue(Frames.Application._supportnulls)&&null===o&&a.setAttribute("data-valueisnull",!0),d[d.length]=a})}this.elem.width(e.width()+1),this.elem.combobox({grid:!0}),this.$input=this.elem.find("input"),this.$input.attr("row",this.args.item.__idx__),this.update(),this.$input.css({height:this.elem.parent().outerHeight()-2});var u=this.elem.find("button");Frames.isVisible(u)||this.$input.css("width","100%");var c=this.$input.css("padding-left")?this.$input.css("padding-left").replace("px",""):"";c=0<c.length?(c=parseInt(c),Frames.isUndef(c)?0:c):0,this.$input.css({width:this.elem.width()-u.width()-c}),u.mousedown(function(e){a._inbutton=!0}).mouseup(function(e){delete a._inbutton}).focusout(function(e){return e.preventDefault(),!1}),this.$input.autocomplete(),this.$input.autocomplete("widget").mousedown(function(e){a._inbutton=!0}).mouseup(function(e){delete a._inbutton}),this.$input.focusout(function(e){if(a._inbutton)return delete a._inbutton,e.preventDefault(),!1}),this.applyFocus(),this.defaults()},_applyDirection:$.noop,restrictCase:$.noop,_applyAutoskip:$.noop,_widget:function(){if(this.elem){var e=this.elem.data(Frames.get_fullname("combobox"));if(e){var t=Array.prototype.slice.call(arguments);return e[t.shift()].apply(e,t)}}},dataModel:function(){return this._widget("dataModel")||[]},editable:function(){if(0===arguments.length)return Frames.ComboBox.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.elem.combobox("buttonObj"),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},enabled:function(){if(0===arguments.length)return Frames.ComboBox.prototype.enabled.apply(this);Frames.ComboBox.prototype.enabled.apply(this,arguments)},rules:Frames.ComboBox.prototype.rules,widgetcls:function(){return"combobox"},getValue:function(){return this._widget("value")},setValue:function(e){this._widget("value",e)},loadValue:function(e){this.defaultValue=e[this.args.column.field]||"";var t=this.elem.children("select"),i=t.children('option[value="'+this.defaultValue+'"]');if(0===i.length){var a=this.args.column.unvalue;void 0!==a&&(i=t.children("option").filter(function(){return Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue($(this).attr("valueisnull"))?null===a:String($(this).val()).toUpperCase()===String(a).toUpperCase()}))}if(0<i.length){var s=Frames.isTrue(Frames.Application._supportnulls)&&Frames.isTrue(i.attr("valueisnull"));this.defaultValue=s?null:i.val(),this.elem.combobox("value",this.defaultValue),this.$input[0].defaultValue=this.defaultValue}this.focus(),this.enabled()&&this.editable()&&this.$input.select()},serializeValue:function(){return this.getValue()},validate:function(){return{valid:!0,msg:null}},erroranchor:function(){return this.buttonObj()},buttonObj:function(){return this._widget("buttonObj")},destroy:function(){$(this.args.container).off("resize",this._resizeEditor),Frames.DataGrid.TextCellEditor.prototype.destroy.apply(this)}})}(jQuery),function($){Frames.DataGrid.DateFieldCellEditor=$.inherit(Frames.DataGrid.TextCellEditor,{init:function(){var t=this.context=this.args.grid._frames._CTX_.get(this.args.column.field),e=this.args.column,i=this;t._curr=this;var a,s=$(this.args.container);for(a in s.on("resize",this._resizeEditor),s.css({paddingLeft:0,paddingRight:0}),this.elem=$('<div><input type="text" /></div>').appendTo(s).bind("dblclick",$.proxy(this._onDblClick,this)).bind("focusout",$.proxy(function(e){return i._inbutton?(delete i._inbutton,e.stopImmediatePropagation(),!1):i.elem.hasClass("ui-datefield")&&i.elem.datefield("isdialogvisible")?(e.preventDefault(),!1):void 0},this)).bind("focuschange",$.proxy(function(e){Frames.isUndef(t)||t.trigger(e)},this)),this.elem.width(s.width()+1).attr("id",Frames.uuid()),this.$input=this.elem.find("input"),this.$input.attr("row",this.args.item.__idx__),this.$input.css("height",s.outerHeight()-2),this.elem.data("format",t.props("format")),this.elem.datefield({grid:!0}),this.update(),this.defaults(),e.props)this.elem.data(a,e.props[a]);var r=this._btn=this.elem.find("button");Frames.isVisible(r)||this.$input.css("width","100%"),this.elem.bind("keydown.nav",function(e){if(Frames.DataGrid.handleButton(e))return!1;if((i.enterHasTab()&&e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.which=$.ui.keyCode.TAB),e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),!Frames.isUndef(t))&&t.trigger(i,"keydown.navigation",e).isDefaultPrevented())return e.preventDefault(),e.stopImmediatePropagation(),!1}),r.mousedown(function(e){i._inbutton=!0}).mouseup(function(e){delete i._inbutton}).focusout(function(e){return e.preventDefault(),!1}),this.$input.focusout(function(e){return i._inbutton?(delete i._inbutton,e.preventDefault(),!1):i.elem.datefield("isdialogvisible")?(e.preventDefault(),!1):void 0}),this.applyFocus(),Frames.TextInput.prototype.initInputMask.apply(this,[!0])},serializeValue:function(){var e;if("SEARCH"==(this.mode?this.mode.name:this.block?this.block.props("blockMode"):void 0)&&Frames.isTrue(this.props("AllowSearch")||!0))e=this.value();else if(this._differentValues()){e=Frames.Format.formatToCanonical(this.value(),this.props("format"),this.props("type"));var t=Frames.Format.toValueFromCanonical(e,this.props("type"));this.ovalue(t)}else e=Frames.Format.formatToCanonical(this.ovalue(),this.props("format"),this.props("type"));if("upper"==this.props("InputTransform")&&(e=e.toUpperCase()),!Frames.isUndef(this.context)){var i=this.context._getData();Frames.isUndef(i)||(i[this.context._col.field+":last_value"]=e),this.context._last_value=e}return e},isValueChanged:function(){if(0===arguments.length&&!Frames.isTrue(arguments[0])&&Frames.isEmpty(this.$input.val())&&Frames.isTrue(this.props("required")))return!0;var e=this._differentValues()?this.value():Frames.Format.formatToCanonical(this.ovalue(),this.props("format"),this.props("type")),t=Frames.Format.formatToCanonical(this.defaultValue,this.props("format"),this.props("type"));return!(Frames.isEmpty(e)&&Frames.isUndef(this.defaultValue))&&e!=t},_differentValues:function(){return Frames.Format.format(this.ovalue(),this.props("format"),this.props("type"))!==this.value()},editable:function(){if(!(0<arguments.length))return Frames.DateField.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.elem.datefield("buttonObj"),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},enabled:function(){if(!(0<arguments.length))return Frames.DateField.prototype.enabled.apply(this);Frames.DateField.prototype.enabled.apply(this,arguments)},widgetcls:function(){return"datefield"},erroranchor:function(){return this.buttonObj()},buttonObj:function(){return this._btn},isdialogvisible:function(){return this.elem.datefield("isdialogvisible")},showdialog:function(){this.elem.datefield("showdialog")},hidedialog:function(){this.elem.datefield("hidedialog")},processNavigationKey:Frames.ButtonInput.prototype.processNavigationKey,clickable:Frames.ButtonInput.prototype.clickable})}(jQuery),function($){Frames.DataGrid.LOVInputCellEditor=$.inherit(Frames.DataGrid.TextCellEditor,{init:function(){var t=this.context=this.args.grid._frames._CTX_.get(this.args.column.field),i=this.args.column,a=this;t._curr=this;var e,s=$(this.args.container);for(e in s.on("resize",this._resizeEditor),s.css({paddingLeft:0,paddingRight:0}),this.elem=$('<div><input type="text" /></div>').appendTo(s).bind("dblclick",$.proxy(this._onDblClick,this)).bind("focusout",$.proxy(function(e){if(a._inbutton)return delete a._inbutton,e.stopImmediatePropagation(),!1;Frames.isUndef(t)||t.trigger(this,"focusout",e)},this)).bind("focuschange",$.proxy(function(e){Frames.isUndef(t)||t.trigger(e)},this)),this.elem.focus(),this.elem.width(s.width()+1),this.$input=this.elem.find("input"),this.$input.attr("row",this.args.item.__idx__),this.$input.css("height",s.outerHeight()-2),Frames.isUndef(i.action)||this.elem.data("action",i.action),i.props)this.elem.data(e,i.props[e]);this.elem[this.widgetcls()]({grid:!0}),this.update();var r=this._btn=this.elem.find("button");r.attr("aria-label",Frames.Locale.messages.OPEN_LOV),Frames.isVisible(r)||this.$input.css("width","100%"),this.elem.bind("keydown.nav",function(e){if(Frames.DataGrid.handleButton(e))return!1;if((a.enterHasTab()&&e.keyCode==$.ui.keyCode.ENTER&&(e.keyCode=$.ui.keyCode.TAB,e.which=$.ui.keyCode.TAB),e.keyCode!==$.ui.keyCode.LEFT&&e.keyCode!==$.ui.keyCode.RIGHT||e.stopImmediatePropagation(),!Frames.isUndef(t))&&t.trigger(a,"keydown.navigation",e).isDefaultPrevented())return e.preventDefault(),e.stopImmediatePropagation(),!1}),this.elem.data("column",i.id),this.elem.data("member",i.field),this.$input.bind("action",function(){var e=a.args.grid._frames.block;Frames.DataGrid.execute(a.elem,i.action,void 0,e.selid)}),r.mousedown(function(e){a._inbutton=!0}).mouseup(function(e){delete a._inbutton}).focusout(function(e){return e.preventDefault(),!1}),this.$input.focusout(function(e){if(a._inbutton)return delete a._inbutton,e.preventDefault(),!1}),this.applyFocus(),this.defaults()},editable:function(){if(!(0<arguments.length))return Frames.ButtonInput.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments);var e=this.elem[this.widgetcls()]("buttonObj"),t=Frames.isTrue(arguments[0])&&this.enabled();e.button("option","disabled",!t)},enabled:function(){if(!(0<arguments.length))return Frames.ButtonInput.prototype.enabled.apply(this);Frames.ButtonInput.prototype.enabled.apply(this,arguments)},widgetcls:function(){return"lovinput"},erroranchor:function(){return this.buttonObj()},buttonObj:function(){return this._btn},destroy:function(){$(this.args.container).off("resize",this._resizeEditor),Frames.DataGrid.TextCellEditor.prototype.destroy.apply(this)},processNavigationKey:Frames.ButtonInput.prototype.processNavigationKey,clickable:Frames.ButtonInput.prototype.clickable})}(jQuery),function($){Frames.DataGrid.TextAreaCellEditor=$.inherit(Frames.DataGrid.TextCellEditor,{_createEditor:function(){var e=Frames.isTrue(this._force_editable)?"READ":this.args.grid._frames.block.props("blockMode");return $('<textarea class="editor-text" '+("READ"==e?'readonly="readonly"':"")+' row="'+this.args.item.__idx__+'"></textarea>')}})}(jQuery),Frames.DataGrid.EditInputCellEditor=$.inherit(Frames.DataGrid.LOVInputCellEditor,{widgetcls:function(){return"editinput"},editable:function(){if(!(0<arguments.length))return Frames.ButtonInput.prototype.editable.apply(this);Frames.Item.prototype.editable.apply(this,arguments)}}),function($){Frames.Menu=$.inherit(Frames.Item,{widgetcls:function(){return"xmenu"},init:function(e){this.view=e,Frames.Menu.register(this),Frames.Application.on("cancelpopups",Frames.Menu.hide)},destroy:function(){delete this.view,this._call("wrapper",null),Frames.Application.off("cancelpopups",Frames.Menu.hide),delete this.elem},model:function(){return null},input:function(){return this._call("input")},focus:function(){this._call("focus")}},{_MENUS_:new Frames.HashMap,register:function(e){var t=e.view.id+"-"+(e.elem.attr("name")||e.elem.attr("id"));Frames.Menu._MENUS_.put(t,e)},hide:function(){var e=Frames.Menu._MENUS_;for(e.reset();e.hasNext();){var t=e.next();Frames.isUndef(t.elem)||t.elem.hide()}},_getMousePos:function(e,t){var i,a,s={},r=t.parents(".ui-view-window");return self.innerHeight?(s.pageYOffset=self.pageYOffset,s.pageXOffset=self.pageXOffset,s.innerHeight=self.innerHeight,s.innerWidth=self.innerWidth):document.documentElement&&document.documentElement.clientHeight?(s.pageYOffset=document.documentElement.scrollTop,s.pageXOffset=document.documentElement.scrollLeft,s.innerHeight=document.documentElement.clientHeight,s.innerWidth=document.documentElement.clientWidth):document.body&&(s.pageYOffset=document.body.scrollTop,s.pageXOffset=document.body.scrollLeft,s.innerHeight=document.body.clientHeight,s.innerWidth=document.body.clientWidth),i=e.pageX?e.pageX:e.clientX+s.scrollLeft,a=e.pageY?e.pageY:e.clientY+s.scrollTop,!Frames.isUndef(r)&&0<r.length&&(i-=r.offset().left,a-=r.offset().top),{x:i,y:a}},toggle:function(e){var t=$(e).children(),i=t.hasClass("fa fa-check");t.hasClass("ui-check")&&(i?t.closest(".ui-check").removeClass("fa fa-check"):t.closest(".ui-check").addClass("fa fa-check"))},bind:function(n,o){var e=n.elem;if(void 0===n._menu_){n._menu_=!0,$.isFunction(o)||(o=Frames.Menu.execute);var l=$(e),d=l.offset(),u=this;l.mousedown(function(e){var t=e,i=n.view.id+"-"+n.props("menu"),a=Frames.Menu._MENUS_.get(i);if(!Frames.isUndef(a)){var s=a._call("option"),r=a.elem;$(this).mouseup(function(e){var i=$(this);if($(this).unbind("mouseup"),2==t.button){if(e.preventDefault(),Frames.Menu.hide(),$(r).find("LI.hover").removeClass("hover"),$(r).find("LI UL").hide(),l.hasClass("disabled"))return!1;var a=u._getMousePos(e,l);$(document).unbind("click"),$(r).css({top:a.y,left:a.x}).fadeIn(s.inSpeed,function(){$(r).find("a:first").focus()}),$(r).find("A").mouseover(function(e){0===$(this).parent().find("UL.hover").length&&($(r).find("LI.hover").removeClass("hover"),0===$(this).parents("UL.hover").length&&$(r).find("UL.hover").removeClass("hover").fadeOut(s.outSpeed)),$(this).parent().addClass("hover")}).mouseout(function(){$(r).find("LI.hover").removeClass("hover")}),$(r).find("LI UL").mouseout(function(){}).parent().children("A").mouseover(function(e){var t=$(this).parent().children("UL");t.position();t.addClass("hover").css({top:$(this).position().top+2,left:t.outerWidth()-6}).fadeIn(s.inSpeed)}),$(document).keypress(function(e){switch(e.keyCode){case 38:0===$(r).find("LI.hover").size()?$(r).find("LI:last").addClass("hover"):($(r).find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover"),0===$(r).find("LI.hover").size()&&$(r).find("LI:last").addClass("hover"));break;case 40:0===$(r).find("LI.hover").size()?$(r).find("LI:first").addClass("hover"):($(r).find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover"),0===$(r).find("LI.hover").size()&&$(r).find("LI:first").addClass("hover"));break;case 13:$(r).find("LI.hover A").trigger("click");break;case 27:$(document).trigger("click")}}),r.find("A").unbind("click"),r.find("LI:not(.disabled) A").click(function(){if(Frames.Menu.toggle(this),$(document).unbind("click").unbind("keypress"),Frames.Menu.hide(),$.isFunction(o)){var e=$(this).parent().parent(),t=e.attr("name")||e.attr("id");o($(this).data("action"),t,$(i),{x:a.x-d.left,y:a.y-d.top,docX:a.x,docY:a.y})}return!1}),setTimeout(function(){$(document).click(function(){return $(document).unbind("click").unbind("keypress"),$(r).fadeOut(s.outSpeed),!1})},0)}})}})}},execute:function(e,t,i,a){if(!Frames.isUndef(e)){var s=Frames.Application.task,r=s.model(),n=Frames.Model.create("menu",null,{kind:"Context",item:e,name:t});Frames.Model.append(r,n);var o=Frames.Config.getaction_name(e);Frames.Application.execute(e,s,r,void 0,void 0,void 0,Frames.isUndef(o)?"Menu":"Action"),Frames.Application.one("cancelpopups",Frames.Menu.hide)}}}),Frames.regtype("menu",Frames.Menu),Frames.Item.prototype.menu=function(e){Frames.Menu.bind(this)},Frames.DataGrid.TextCellEditor.prototype.menu=Frames.Item.prototype.menu,Frames.Item.PROP_MAP.menu={method:"menu"},$(document).bind("contextmenu",function(){return!1})}(jQuery),function($){$.widget("ui.xmenu",{version:"@VERSION",options:{inSpeed:150,outSpeed:75},_create:function(){this.element.addClass("dropdown-menu"),this._calculateWidths(),this.element.hide(),this.element.find("LI UL").addClass("dropdown-submenu").parent().addClass("dropdown-submenu").children("A").append('<span class="ui-icon"></span>'),this.element.find('LI[data-type~="separator"]').addClass("divider"),this.element.find('LI[data-type~="check"]').addClass("check").children().append('<span class="ui-check"></span>'),$.browser.mozilla?this.element.each(function(){$(this).css({MozUserSelect:"none"})}):$.browser.msie?this.element.each(function(){$(this).bind("selectstart.disableTextSelect",function(){return!1})}):this.element.each(function(){$(this).bind("mousedown.disableTextSelect",function(){return!1})})},_calculateWidths:function(){this.element.show(),this.element.find("A").wrapInner("<span></span>").css("white-space","nowrap"),this.element.children("LI").children("A").each(function(){var e=$(this).parent().parent(),t=parseInt($(this).css("padding-left"),10),i=parseInt($(this).css("padding-right"),10),a=$(this).find("span").outerWidth()+t+i;e.outerWidth()<a&&e.width(a)}),this.element.find("A").css("white-space","").parent().css("overflow","hidden")},_setOption:function(e,t){"inSpeed"!==e&&"outSpeed"!==e||0!==t||(t=-1),this.options[e]=t},_destroy:function(){},wrapper:function(e){this.element.data("frames",e)},input:function(){return this.element},focus:function(){this.element.focus()},deactivate:function(){},refresh:function(){}})}(jQuery),function($){$.extend(Frames.DataGrid.prototype,{describe:function(){return{draggable:this.elem,resizable:this.elem}},design:function(){if(!(0<arguments.length))return Frames.Item.prototype.design.apply(this);Frames.Item.prototype.design.apply(this,arguments);var e=[];Frames.isTrue(arguments[0])?this._last_data=this._grid.getData():Frames.isUndef(this._last_data)||(e=this._last_data,delete this._last_data),this._grid.setActiveCell(null),this._grid.setData(e),this._grid.invalidate()},design_deselect:function(e){"datagrid"==(null!==e?e.widgetcls():null)||Frames.isUndef(Frames.Designer.Dialog._dlg_column_props)||(Frames.Designer.Dialog._dlg_column_props.dialog("destroy"),Frames.Designer.Dialog._dlg_column_props.remove(),Frames.Designer.Dialog._dlg_column_props=null)},designprops:function(e){var m=this;return delete e.model.properties["model:member"],e.datagrid={label:"Grid",properties:{columns:{type:Frames.Designer.GridColumnsDialogPropertyWidget,dialog:{name:this.widgetcls(),width:550,height:"auto",create:function(e){var i=$(e.target),t=i.find("button").button().removeClass("ui-ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"),a=i.find(".pdialog-content"),p=i.find(".collist");m._populateList(p),$(".column-props",a).remove();var s=Frames.Designer._curr,r=Frames.Designer._selected;$.each($("option",p),function(){var e=m._CTX_.get($(this).index());e.elem.data("name",e._col.id),Frames.Designer._curr=e;var t=$("<div />");t.data("idx",$(this).index()),t.addClass("column-props"),t.hide(),a.append(t),Frames.Designer._select_properties($(this),Frames.Designer.GridColumnInspector,t),i.find('button[name="remove"]').button("disable")}),a.children().first().show(),Frames.Designer._curr=s,Frames.Designer._selected=r,p.off("change").on("change",function(){this.options[this.selectedIndex],m._CTX_.get(this.selectedIndex);var e=this.selectedIndex;a.children().each(function(){$(this).data("idx")==e?$(this).show():$(this).hide()}),i.find('button[name="remove"]').button(1<$("option",p).length?"enable":"disable")}),t.off("click").on("click",function(e){var t=e.currentTarget;if("add"==t.name){var i,a=Frames.Designer._curr,s=m._columns,r=0;for(i=0,len=s.length;i<len;i++){var n=s[i].id.match(/^.*?(\d+)$/);+n[1]>r&&(r=+n[1])}r++;var o=m._parseColumn(r,{title:"Column"+(r+1)});o.id=m.elem.attr("id")+"_col"+r,o.width=120;var l=a.elem.width();l<s.length*o.width&&(o.width=Math.round(l/s.length)),s.push(o),m._columns=s,m._setWidgetColumns(s),Frames.Designer.add({type:"viewcolumn",name:"column"+r,label:o.name,labeloffset:null,labelposition:null,top:null,left:null,width:o.width+"px",height:null,container:Frames.Designer.toXPath(m.elem)+"/xv:viewheader",framesClass:null,ns:null,item:null}),m.design(!0),p.val($("option:last-child",p).val()).trigger("change"),Frames.Designer._selected=$([]),Frames.Designer.select(a)}else if("remove"==t.name){var d=p.get(0).selectedIndex,u=(m._CTX_.get(d),Frames.Designer.toXPath(m.elem)+"/xv:viewheader/xv:viewcolumn["+(d+1)+"]"),c=m._getColumnsInfo().columns;c.splice(d,1),m._columns=c,m._setWidgetColumns(c),Frames.Designer.remove(u),Frames.Designer._selected=$([]),Frames.Designer.select(Frames.Designer._curr)}});var n=$(".pdialog-property[data-property=label\\:text] input",a);n.data("grid-editor")||n.data("grid-editor",!0).on("change",function(){var e=$(this).val(),t=$(":selected",p),i=$("option",p).index(t);e=""!==e?e:"[Column "+(i+1)+"]",$(":selected",p).text(e)})},close:function(){Frames.Log.debug("save data...")}},label:"Columns",name:"columns",get:function(){return[]},set:function(e){}},editpanel:{type:Frames.Designer.InputLinkPropertyWidget,label:"Editpanel",name:"editpanel",get:function(){return m.editpanel()},set:function(e,t){var i=Frames.Designer.toXPath(m.elem),a=i+"/xv:editpanel";Frames.isEmpty(e)?Frames.Designer.remove(a):(Frames.isEmpty(m.editpanel())&&Frames.Designer.add({type:"editpanel",name:null,label:null,labeloffset:null,labelposition:null,top:null,left:null,width:null,height:null,container:i,framesClass:null,ns:null,item:null}),Frames.Designer.update(a,"src",e)),m.editpanel(e),t.stopImmediatePropagation()}}}},e},_populateList:function(i){var a=this,e=a._columns;i.children().remove(),a._CTX_=new Frames.HashMap;var s=1;$.each(e,function(){var e=new Frames.DataGrid.ColumnItemContext(a,this),t=""!==this.name?this.name:"[Column "+s+"]";a._CTX_.put(this.field||"item"+i.get(0).options.length,e),a._newoption(i,t,this.id,this),s++})},_newoption:function(e,t,i,a){var s=new Option(Frames.isUndef(t)&&$.browser.mozilla?"":t,Frames.isUndef(i)&&$.browser.mozilla?"":i);if(e.get(0)){var r=e.get(0).options;r[r.length]=s,$(r[r.length]).data("props",a)}},design_create_children:function(){var i=this,e=Frames.Designer.toXPath(i.elem);Frames.Designer.add({type:"viewheader",name:null,label:null,labeloffset:null,labelposition:null,top:null,left:null,width:null,height:null,container:e,framesClass:null,ns:null});var t=i.columns(),a=e+"/xv:viewheader",s=0;$.each(t,function(){var e=void 0!==i._CTX_?i._CTX_.get(this.field):void 0;Frames.isUndef(e)&&(e=new Frames.DataGrid.ColumnItemContext(i,this)),Frames.Designer.add({type:"viewcolumn",name:"column"+s,label:this.name,labeloffset:null,labelposition:null,top:null,left:null,width:this.width+"px",height:null,container:a,framesClass:null,ns:null,item:e.props("member")});var t=a+"/xv:viewcolumn["+s+"]";Frames.isUndef(this.editorType)||"textinput"==this.editorType||"undefined"==this.editorType||(Frames.Designer.add({type:"editor",name:null,label:null,labeloffset:null,labelposition:null,top:null,left:null,width:null,height:null,container:t,framesClass:null,ns:null}),Frames.Designer.add({type:this.editorType,name:null,label:null,labeloffset:null,labelposition:null,top:null,left:null,width:null,height:null,container:t+"/xv:editor",framesClass:null,ns:null})),s++})},template:function(){return'<div id="{{=data.uuid}}" class="ui-widget ui-gridview" style="height:140px; width:400px;" data-widget="datagrid"><script type="application/json">[{ "title": "Column1" },{ "title": "Column2" },{ "title": "Column3" }]<\/script></div>'}})}(jQuery),jQuery.extend(Frames.Accordion.prototype,{describe:function(){return{draggable:this.elem,resizable:this.elem}}}),jQuery.extend(Frames.Button.prototype,{describe:function(){return{draggable:this._wrapper,draghandle:"button",resizable:this.elem,group:"misc"}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!0},data:{block:!0,member:!0,datatype:!1,value:!1},validation:null}},design:function(){if(0===arguments.length)return Frames.Item.prototype.design.apply(this);var e=Frames.isTrue(arguments[0]);if(this.elem.position(),e){if(!this._wrapper){this.elem.wrap('<div class="ui-wrapper-button"></div>'),this._wrapper=this.elem.parent();var t=this.elem.prop("style");this._wrapper.css({top:t.top?t.top:"",left:t.left?t.left:"",right:t.right?t.right:"",bottom:t.bottom?t.bottom:""}),this.elem.css({top:"",left:"",right:"",bottom:""})}Frames.Item.prototype.design.apply(this,arguments)}else Frames.Item.prototype.design.apply(this,arguments),this.elem.css({top:"auto"!==this._wrapper.css("top")?this._wrapper.css("top"):"",left:"auto"!==this._wrapper.css("left")?this._wrapper.css("left"):""}),this.elem.unwrap(),delete this._wrapper},template:function(){return'<button type="button" data-widget="button" class="ui-widget ui-button" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}" style="width: 80px; height: 28px;">{{=data.label}}</button>'}}),function($){$.extend(Frames.ButtonInput.prototype,{describe:function(){return{draggable:this.elem,draghandle:"input",resizable:this._resizable,group:"input"}},design:function(){if(0===arguments.length)return Frames.Item.prototype.design.apply(this);if(Frames.isTrue(arguments[0])){var i=this,a=this.input(),s=this.buttonObj();this.labelObj();return s&&!this._resizable&&(a.wrap('<div class="ui-resizable-wrapper"/>'),this._resizable=a.parent(),this._resizable.append(s),this._resizable.css({height:a.outerHeight()+"px",width:a.outerWidth()+(s.is(":visible")?s.outerWidth():0)+"px"}),this._resizable.on("designer.resize",function(){var e=$(this).outerWidth()-(s.is(":visible")?s.outerWidth():0)+"px",t=$(this).outerHeight()+"px";s.css("height",t),"absolute"===i.css("position")&&s.css("left",e),a.css({width:e,height:t})})),Frames.Item.prototype.design.apply(this,arguments)}},designprops:function(e){var t=this,i=this.widgetcls();return e.custom={label:Frames.isUndef(i)?"Custom":i,properties:{icon:{type:Frames.Designer.StringPropertyWidget,label:"Icon",name:"icon",get:function(){return t._call("icon")},set:function(e){t._call("icon",e)}}}},e},design_refresh:function(){this._call("refresh",!0),Frames.Item.prototype.design_refresh.apply(this,arguments)}})}(jQuery),function($){$.extend(Frames.CheckBox.prototype,{describe:function(){return{draggable:this.elem,draghandle:"button",resizable:!1,group:"input"}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!0},data:{block:!0,member:!0,datatype:!1,value:!1},validation:null}},design:function(){if(0===arguments.length)return Frames.Item.prototype.design.apply(this);Frames.isTrue(arguments[0])?(this.enabled(!0),this._editable=this.editable,this.editable=$.noop,Frames.Item.prototype.design.apply(this,arguments)):(Frames.Item.prototype.design.apply(this,arguments),this.editable=this._editable,delete this._editable)},designprops:function(e){return delete e.general.properties.font,delete e.general.properties.size,e.model.properties.tvalue={type:Frames.Designer.StringPropertyWidget,label:"Value when Checked",name:"value",get:function(){return Frames.Designer._curr.data("value")},set:function(e){Frames.Designer._curr.data("value",e)}},e.model.properties.fvalue={type:Frames.Designer.StringPropertyWidget,label:"Value when Unchecked",name:"falsevalue",get:function(){return Frames.Designer._curr.data("fvalue")},set:function(e){Frames.Designer._curr.data("fvalue",e)}},e},template:function(){return'<div class="ui-widget ui-label-position-right ui-checkbox" data-widget="checkbox" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><input type="check" class="ui-widget-content ui-corner-all" autocomplete="off" name="{{=data.uuid}}" style="width: 210px; height: 22px;"><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}})}(jQuery),function($){$.extend(Frames.CollapsiblePanel.prototype,{describe:function(){var e=Frames.Canvas.prototype.describe.apply(this,arguments);return this.elem&&(e.container=$(".ui-collapsiblepanel-content > :first-child",this.elem),e.droppable=this.elem),e},template:function(){return'<div data-widget="collapsiblepanel" class="ui-widget ui-collapsiblepanel" id="{{=data.uuid}}" style="width: 480px;"><h3>{{=data.label}}</h3><div class="ui-collapsiblepanel-content {{=data.layout}}"></div></div>'}})}(jQuery),jQuery.extend(Frames.ColorPicker.prototype,{describe:function(){return{draggable:this.elem,draghandle:"input",resizable:this._resizable,group:"input"}},design:function(){return Frames.ButtonInput.prototype.design.apply(this,arguments)},design_refresh:function(){this._call("refresh",!0),Frames.Item.prototype.design_refresh.apply(this,arguments)},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!0,format:!0,action:!1,caseRestriction:!1},data:{block:!0,member:!0,datatype:!1,value:!1},validation:{required:!0,maxlength:!1,minlength:!1,maxvalue:!1,minvalue:!1}}}}),function($){$.extend(Frames.ComboBox.prototype,{describe:function(){return{draggable:this.elem,draghandle:"input",resizable:this._resizable,group:"input"}},design:function(){return Frames.ButtonInput.prototype.design.apply(this,arguments)},design_refresh:function(){this._call("refresh",!0),Frames.Item.prototype.design_refresh.apply(this,arguments)},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!0,format:!1,action:!0},data:{block:!0,member:!0,datatype:!1,value:!1},validation:null}},designprops:function(e){var l=this,t=this.widgetcls();return e.custom={label:Frames.isUndef(t)?"Custom":t,properties:{options:{type:Frames.Designer.ComboboxOptsDialogPropertyWidget,label:"Options",name:"options",get:function(){return[]},set:function(e){},dialog:{name:this.widgetcls(),width:550,height:"auto",create:function(e){var i=$(e.target),t=i.find("button").button().removeClass("ui-ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"),n=i.find(".pdialog-content"),o=i.find(".optlist");l._populateList(o);var a=Frames.Designer._curr,s=Frames.Designer._selected;$.each($("option",o),function(){var e=l._CTX_.get($(this).index());if(Frames.Designer._curr=e,Frames.isTrue(e.initialized))return!0;var t=$("<div />");t.data("idx",$(this).index()),t.hide(),n.append(t),Frames.Designer._select_properties(e.elem,Frames.Designer.Dialog.OptionInspector,t),e.initialized=!0,i.find('button[name="remove"]').button("disable")}),o.trigger("change"),Frames.Designer._curr=a,Frames.Designer._selected=s,o.off("change").on("change",function(){var e=this.selectedIndex,t=!1;n.children().each(function(){$(this).data("idx")==e?(t=!0,$(this).show()):$(this).hide()}),Frames.isTrue(t)||n.children().first().show(),i.find('button[name="remove"]').button(1<$("option",o).length?"enable":"disable")}),t.off("click").on("click",function(e){var t=e.currentTarget;if("add"==t.name){var i=Frames.Designer._curr;l.elem.find("select").append("<option/>"),l._addDesignerOption(),Frames.Designer.select(i)}else if("remove"==t.name){var a=o.get(0).selectedIndex,s=l._CTX_.get(a),r=Frames.Designer.toXPath(s.elem);for(Frames.Designer.remove(r),s.elem.remove(),l._CTX_.remove(a),o.children().eq(a).remove(),l._CTX_.reset();l._CTX_.hasNext();)l._CTX_.next().initialized=!1;n.children().slice(1).remove(),Frames.Designer.select(Frames.Designer._curr)}})},close:function(){Frames.Log.debug("save data...")}}}}},e},_populateList:function(t){var i,a=this;t.children().remove(),Frames.isUndef(a._CTX_)&&(a._CTX_=new Frames.HashMap);var e=this._call("opts");$.each(e,function(){var e="item"+t.get(0).options.length;i=a._CTX_.get(e),Frames.isUndef(i)&&((i=new Frames.ComboboxOption($(this))).value(this.value),i.label(this.label)),a._newoption(t,e,this.value),a._CTX_.put(e,i)})},_newoption:function(e,t,i,a){var s=new Option(Frames.isUndef(t)&&$.browser.mozilla?"":t,Frames.isUndef(i)&&$.browser.mozilla?"":i);if(e.get(0)){var r=e.get(0).options;r[r.length]=s,$(r[r.length]).data("props",a)}return s},design_create_children:function(){var e;Frames.Designer.add({type:"model",container:Frames.Designer.toXPath(this.elem),ns:null});var t=this._call("opts");if(0===t.length)this.elem.find("select").append("<option/>"),this._addDesignerOption();else for(e in t){var i=t[e];this._addDesignerOption(i)}},_addDesignerOption:function(e){var t=e&&e.label||null;Frames.Designer.add({type:"item",name:t,label:t,container:Frames.Designer.toXPath(this.elem)+"/xv:model[1]",ns:null})},_getSelect:function(){return this.elem.find("select")},template:function(){return'<div class="ui-widget ui-combobox ui-label-position-left" data-widget="combobox" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><select class="ui-widget-content ui-corner-all"  name="{{=data.uuid}}" style="width: 210px; height: 22px;" id="#{{=data.uuid}}"></select><label for="#{{=data.uuid}}.filter">{{=data.label}}</label></div>'}}),Frames.ComboboxOption=$.inherit(Frames.Item,{__constructor:function(e,t){this.elem=e},value:function(){if(0===arguments.length)return this.value;this.value=arguments[0]},label:function(){if(0===arguments.length)return this.label;this.label=arguments[0]},name:function(){if(0===arguments.length)return this.name;this.name=arguments[0]},describe:function(){return{draggable:this.elem.find("div"),draghandle:"label",resizable:!1,group:"input"}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1},data:{block:!1,member:!1,datatype:!1,value:!0},validation:null}},designprops:function(e){var t=this;return e.label={label:"Label",properties:{"label:text":{type:Frames.Designer.StringPropertyWidget,label:"Text",name:"label",get:function(){return t.label()},set:function(e){t.label(e)}}}},e.group={label:"Group",properties:{group:{type:Frames.Designer.StringReadOnlyPropertyWidget,label:"Value",name:"group",get:function(){},set:function(e){}}}},e}})}(jQuery),jQuery.extend(Frames.Component.prototype,{describe:function(){return{draggable:this.elem,resizable:this.elem,droppable:this.elem}},design:function(){if(0===arguments.length)return Frames.Item.prototype.design.apply(this);Frames.isTrue(arguments[0])&&this.elem.addClass("ui-component-board"),Frames.Item.prototype.design.apply(this,arguments)},template:function(){return'<div class="ui-widget ui-component {{=data.layout}}" data-widget="component" id="{{=data.uuid}}" style="width: 400px; height: 80px;"><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.DateField.prototype,{describe:function(){return{draggable:this.elem,draghandle:"input",resizable:this._resizable,group:"input"}},design:function(){return Frames.ButtonInput.prototype.design.apply(this,arguments)},design_refresh:function(){this._call("refresh",!0),Frames.Item.prototype.design_refresh.apply(this,arguments)},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!0,format:!0,action:!1,caseRestriction:!1},data:{block:!0,member:!0,datatype:!1,value:!1},validation:{required:!0,maxlength:!1,minlength:!1,maxvalue:!1,minvalue:!1}}},template:function(){return'<div class="ui-widget ui-datefield ui-label-position-left" data-widget="datefield" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><input  ui-label-position-lefttype="text" class="ui-widget-content ui-corner-all" autocomplete="off" name="{{=data.uuid}}" style="width: 100px; height: 22px;"><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.Calculator.prototype,{describe:function(){return{draggable:this.elem,draghandle:"input",resizable:this._resizable,group:"input"}},design:function(){return Frames.ButtonInput.prototype.design.apply(this,arguments)},design_refresh:function(){this._call("refresh",!0),Frames.Item.prototype.design_refresh.apply(this,arguments)},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!0,format:!0,action:!1,caseRestriction:!1},data:{block:!0,member:!0,datatype:!1,value:!1},validation:{required:!0,maxlength:!1,minlength:!1,maxvalue:!1,minvalue:!1}}}}),jQuery.extend(Frames.EditInput.prototype,{}),jQuery.extend(Frames.FileInput.prototype,{}),jQuery.extend(Frames.FramePanel.prototype,{describe:function(){var e=Frames.Canvas.prototype.describe.apply(this,arguments);return this.elem&&(e.container=this.elem.children(".ui-framepanel-content"),e.droppable=e.container),e},template:function(){return'<fieldset class="ui-widget ui-framepanel {{=data.layout}}" data-widget="framepanel" id="{{=data.uuid}}" style="width: 480px; height: 180px;"><legend>{{=data.label}}</legend><div class="ui-framepanel-content {{=data.layout}}"></div></fieldset>'}}),jQuery.extend(Frames.Image.prototype,{describe:function(){return{draggable:this.elem,draghandle:"img",resizable:this.image(),group:"misc"}},designprops:function(e){var t=this,i=this.widgetcls();return e.custom={label:Frames.isUndef(i)?"Custom":i,properties:{src:{type:Frames.Designer.StringPropertyWidget,label:"Source",name:"src",get:function(){return t._call("value")},set:function(e){t._call("value",e)}}}},e},template:function(){return'<div class="ui-widget ui-label-position-left ui-image" data-widget="image" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><img class="ui-widget-content ui-corner-all" style="width: 210px; height: 210px;" /><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.ListBox.prototype,{}),jQuery.extend(Frames.LOVInput.prototype,{template:function(){return'<div class="ui-widget ui-label-position-left ui-lovinput" data-widget="lovinput" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><input type="text" class="ui-widget-content ui-corner-all" autocomplete="off" name="{{=data.uuid}}" style="width: 210px; height: 22px;"><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.Menu.prototype,{describe:function(){var e=Frames.Item.prototype.describe.apply(this);return e.group="_ignore_",e}}),jQuery.extend(Frames.Panel.prototype,{template:function(){return'<div class="ui-widget ui-panel ui-container {{=data.layout}}" data-widget="panel" id="{{=data.uuid}}" style="width: 360px; height: 160px;"></div>'}}),jQuery.extend(Frames.Progressbar.prototype,{}),jQuery.extend(Frames.RadioBox.prototype,{design:function(){},describe:function(){return{draggable:this.elem.find("div"),draghandle:"label",resizable:!1,group:"input",canChangeContainer:!1}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1},data:{block:!1,member:!1,datatype:!1,value:!0},validation:null}},designprops:function(e){var t=this;return delete e.general.properties.size,delete e.general.properties.font,e.label={label:"Label",properties:{"label:text":{type:Frames.Designer.StringPropertyWidget,label:"Text",name:"label",get:function(){return t.label()},set:function(e){t.label(e)}}}},e.group={label:"Group",properties:{group:{type:Frames.Designer.StringReadOnlyPropertyWidget,label:"Value",name:"group",get:function(){return t.group()},set:function(e){}}}},e},template:function(){return'<div id="{{=data.uuid}}_{{=data.uuid}}" data-widget="radiobox" data-name="{{=data.uuid}}" class="ui-widget ui-radiobox"><input type="radio" value="{{=data.value}}" name="{{=data.parent.data(\'name\')}}" id="#{{=data.parent.data(\'name\')}}_{{=data.uuid}}" /><label id="l:#{{=data.parent.data(\'name\')}}_{{=data.uuid}}" for="#{{=data.parent.data(\'name\')}}_{{=data.uuid}}">{{=data.label}}</label></div>'}}),function($){$.extend(Frames.RadioGroup.prototype,{design:function(){if(0===arguments.length)return Frames.Item.prototype.design.apply(this);var e=Frames.isTrue(arguments[0]);e?(this.enabled(!0),this._editable=this.editable,this.editable=$.noop,Frames.Item.prototype.design.apply(this,arguments)):(Frames.Item.prototype.design.apply(this,arguments),this.editable=this._editable,delete this._editable);var t=this.buttons();$.each(t,function(){this.design(e)})},design_deselect:function(e){var t=Frames.isUndef(e)?null:e.widgetcls();"radiogroup"==t||"radiobox"==t||Frames.isUndef(Frames.Designer.Dialog._dlg_radio_props)||(Frames.Designer.Dialog._dlg_radio_props.dialog("destroy"),Frames.Designer.Dialog._dlg_radio_props.remove(),Frames.Designer.Dialog._dlg_radio_props=null)},describe:function(){return{draggable:this.elem.find("div"),draghandle:"button",resizable:!1,group:"input",canChangeContainer:!1}},designRules:function(){return{behaviour:{enabled:!1,visible:!1,readonly:!1,format:!1,action:!0},data:{block:!0,member:!0,datatype:!1,value:!1},validation:null}},designprops:function(e){var l=this;return delete e.general.properties.size,e.radiogroup={label:"Radio Group",properties:{columns:{type:Frames.Designer.RadioButtonsDialogPropertyWidget,dialog:{name:this.widgetcls(),width:550,height:"auto",create:function(e){var i=$(e.target),t=i.find("button").button().removeClass("ui-ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only"),a=i.find(".pdialog-content"),o=i.find(".butlist");l._populateList(o),$(".radiobox-props",a).remove();var s=Frames.Designer._curr,r=Frames.Designer._selected;$.each($("option",o),function(){var e=l._CTX_.get($(this).index());Frames.Designer._curr=e;var t=$("<div />");t.data("idx",$(this).index()),t.addClass("radiobox-props"),t.hide(),a.append(t),Frames.Designer._select_properties($(this),Frames.Designer.Dialog.DefaultInspector,t),i.find('button[name="remove"]').button("disable")}),a.children().first().show(),Frames.Designer._curr=s,Frames.Designer._selected=r,o.off("change").on("change",function(){this.options[this.selectedIndex],l._CTX_.get(this.selectedIndex);var e=this.selectedIndex;a.children().each(function(){$(this).data("idx")==e?$(this).show():$(this).hide()}),i.find('button[name="remove"]').button(1<$("option",o).length?"enable":"disable")}),t.off("click").on("click",function(e){var t=e.currentTarget;if("add"==t.name){var i=Frames.Designer._curr;Frames.Designer._add_widget("radiobox",Frames.Application.task.view,null,l.elem);var a=l.elem.data("name");Frames.Designer.update(Frames.Designer.toXPath(Frames.Designer._curr.elem),"group",a),l.refresh(),l.design(!0),o.val($("option:last-child",o).val()).trigger("change"),Frames.Designer.select(i)}else if("remove"==t.name){var s=o.get(0).selectedIndex,r=l._CTX_.get(s),n=Frames.Designer.toXPath(r.elem);Frames.Designer.remove(n),r.elem.remove(),l.refresh(),Frames.Designer.select(Frames.Designer._curr)}})},close:function(){Frames.Log.debug("save data...")}},label:"Buttons",name:"buttons",get:function(){return[]},set:function(e){}}}},e},template:function(){return'<div data-widget="radiogroup" id="{{=data.uuid}}" data-name="{{=data.uuid}}"  data-block="{{=data.block}}" data-member="{{=data.item}}" class="ui-widget ui-radiogroup ui-layout-positional"><div id="radiobox1_radiobox1" data-widget="radiobox" data-name="radiobox1"class="ui-widget ui-radiobox"><input type="radio" value="" name="{{=data.uuid}}" id="#{{=data.uuid}}_radiobox1" /><label id="l:#{{=data.uuid}}_radiobox1" for="#{{=data.uuid}}_radiobox1">radiobox1</label></div></div>'}})}(jQuery),jQuery.extend(Frames.Repeater.prototype,{describe:function(){var e=Frames.Item.prototype.describe.apply(this);return e.group="container",e}}),jQuery.extend(Frames.Stepper.prototype,{}),function($){$.extend(Frames.TabPanel.prototype,{describe:function(){var e=this._call("wrapperObj");return{draggable:e,draghandle:"",resizable:e,group:"container",droppable:$(">\t.ui-tabs-panel",$(this.elem)),alsoResize:"#"+this.elem.attr("id")+"\t>\t.ui-tabs-panel"}},design_deselect:function(e){"tabpanel"==(null!==e?e.widgetcls():null)||Frames.isUndef(Frames.Designer.Dialog._dlg_tab_props)||(Frames.Designer.Dialog._dlg_tab_props.dialog("destroy"),Frames.Designer.Dialog._dlg_tab_props.remove(),Frames.Designer.Dialog._dlg_tab_props=null)},designprops:function(e){var u=this;return e.datagrid={label:"TabPanel",properties:{columns:{type:Frames.Designer.TabPagesDialogPropertyWidget,dialog:{name:this.widgetcls(),width:550,height:"auto",create:function(e){var i=$(e.target),t=i.find("button").button().removeClass("ui-ui-button\tui-widget\tui-state-default\tui-corner-all\tui-button-text-only"),a=i.find(".pdialog-content"),d=i.find(".collist");u._populateList(d),$(".column-props",a).remove();var s=Frames.Designer._curr,r=Frames.Designer._selected;$.each($("option",d),function(){var e=u._CTX_.get($(this).index());e.elem.data("name",e.elem[0].id),Frames.Designer._curr=e;var t=$("<div\t/>");t.data("idx",$(this).index()),t.addClass("column-props"),t.hide(),a.append(t),Frames.Designer._select_properties($(this),Frames.Designer.Dialog.DefaultInspector,t),i.find('button[name="remove"]').button("disable")}),a.children().first().show(),Frames.Designer._curr=s,Frames.Designer._selected=r,d.off("change").on("change",function(){this.options[this.selectedIndex],u._CTX_.get(this.selectedIndex);var e=this.selectedIndex;a.children().each(function(){$(this).data("idx")==e?$(this).show():$(this).hide()}),i.find("button[name='remove']").button(1<$("option",d).length?"enable":"disable")}),t.off("click").on("click",function(e){var t=e.currentTarget;if("add"==t.name){var i=Frames.Designer._curr,a=$(">\tdiv",$(u.elem)),s=0;a.each(function(e){var t=this.id.match(/^.*?(\d+)$/);t&&+t[1]>s&&(s=+t[1])}),s++;var r=u.elem.data("name")+"-tab"+s,n="Tab"+s;u.elem.tabs("add","#"+r,n);$(">\tdiv:last-child",$(u.elem));Frames.Designer.add({type:"tab",name:"tab"+s,label:n,labeloffset:null,labelposition:null,top:null,left:null,width:null,height:null,container:Frames.Designer.toXPath(u.elem),framesClass:null,ns:null,item:null}),u.design(!0),d.val($("option:last-child",d).val()).trigger("change"),Frames.Designer._selected=$([]),Frames.Designer.select(i)}else if("remove"==t.name){var o=d.get(0).selectedIndex,l=(u._CTX_.get(o),Frames.Designer.toXPath(u.elem)+"/xv:tab["+(o+1)+"]");u.elem.tabs("remove",o),Frames.Designer.remove(l),Frames.Designer._selected=$([]),Frames.Designer.select(Frames.Designer._curr)}})},close:function(){Frames.Log.debug("save\tdata...")}},label:"Tabs",name:"tabs",get:function(){return[]},set:function(e){}}}},e},_populateList:function(a){var s=this,e=$(">\tdiv",s.elem),r=$("> .ui-tabs-nav > li > a",s.elem);a.children().remove(),s._CTX_=new Frames.HashMap,$.each(e,function(e){var t=new Frames.TabPanel.TabItemContext(s,this),i=r.eq(e).text();s._CTX_.put("item"+a.get(0).options.length,t),s._newoption(a,i,this.id,this)})},_newoption:function(e,t,i,a){var s=new Option(Frames.isUndef(t)&&$.browser.mozilla?"":t,Frames.isUndef(i)&&$.browser.mozilla?"":i);if(e.get(0)){var r=e.get(0).options;r[r.length]=s,$(r[r.length]).data("props",a)}},design:function(){if(0===arguments.length)return Frames.Canvas.prototype.design.apply(this);if(Frames.isTrue(arguments[0])){var e=this._call("wrapperObj");!this._wrapper&&e&&(this._wrapper=e)}return Frames.Canvas.prototype.design.apply(this,arguments)},design_create_children:function(){var i=this,a=Frames.Designer.toXPath(i.elem);this.elem.children("div").each(function(){var e=$(this),t=void 0!==i._CTX_?i._CTX_.get(e.data("name")):void 0;Frames.isUndef(t)&&(t=new Frames.TabPanel.TabItemContext(i,this)),Frames.Designer.add({type:"tab",name:e.data("name"),label:t.label(),labeloffset:null,labelposition:null,top:null,left:null,width:null,height:null,container:a,framesClass:null,ns:null})})},template:function(){return'<div data-widget="tabpanel" id="{{=data.uuid}}" data-name="{{=data.uuid}}" class="ui-widget ui-tabpanel {{=data.layout}}" style="width: 360px; height: 160px;"><ul><li><a href="#{{=data.uuid}}-tab1">Tab1</a></li><li><a href="#{{=data.uuid}}-tab2">Tab2</a></li><li><a href="#{{=data.uuid}}-tab3">Tab3</a></li></ul><div id="{{=data.uuid}}-tab1" data-name="tab1" style="position:relative;" class="{{=data.layout}}"></div><div id="{{=data.uuid}}-tab2" data-name="tab2" style="position:relative;" class="{{=data.layout}}"></div><div id="{{=data.uuid}}-tab3" data-name="tab3" style="position:relative;" class="{{=data.layout}}"></div></div>'}})}(jQuery),jQuery.extend(Frames.Text.prototype,{describe:function(){return{draggable:this._wrapper,draghandle:"> div",resizable:this.elem,group:"misc"}},designRules:function(){return{behaviour:{enabled:!1,visible:!0,readonly:!1,format:!1,action:!1},data:null,validation:null}},design:function(){if(0===arguments.length)return Frames.Item.prototype.design.apply(this);var e=Frames.isTrue(arguments[0]);this.elem.position(),e?(void 0===arguments[1]||arguments[1],this._wrapper||(this.elem.wrap("<div class='ui-wrapper-text'></div>"),this._wrapper=this.elem.parent(),this._wrapper.css({top:"auto"!=this.elem.css("top")?this.elem.css("top"):"",left:"auto"!=this.elem.css("left")?this.elem.css("left"):""}),this.elem.css({top:"",left:""})),Frames.Item.prototype.design.apply(this,arguments)):(Frames.Item.prototype.design.apply(this,arguments),this.elem.css({top:"auto"!=this._wrapper.css("top")?this._wrapper.css("top"):"",left:"auto"!=this._wrapper.css("left")?this._wrapper.css("left"):""}),this.elem.unwrap(),delete this._wrapper)},template:function(){return'<div class="ui-widget ui-text ui-noborder" data-widget="text" id="{{=data.uuid}}">{{=data.label}}</div>'}}),jQuery.extend(Frames.TextArea.prototype,{describe:function(){return{draggable:this.elem,draghandle:"textarea",resizable:this.input(),group:"input",droppable:!1}},template:function(){return'<div class="ui-widget ui-label-position-left ui-textarea" data-widget="textarea" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><textarea style="width: 210px; height: 40px;" class="ui-widget-content ui-corner-all" name="{{=data.uuid}}"></textarea><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.TextField.prototype,{describe:function(){return{draggable:this.elem,draghandle:"span",resizable:this.input(),group:"input"}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1,caseRestriction:!1},data:{block:!0,member:!0,datatype:!1,value:!1},validation:null}},template:function(){return'<div class="ui-widget ui-label-position-right ui-checkbox" data-widget="checkbox" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"><input type="check" class="ui-widget-content ui-corner-all" autocomplete="off" name="{{=data.uuid}}" style="width: 210px; height: 22px;"><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.TextInput.prototype,{designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!0,format:!0,action:!1,caseRestriction:!0},data:{block:!0,member:!0,datatype:!0,value:!1},validation:{required:!0,maxlength:!0,minlength:!0,maxvalue:!0,minvalue:!0}}},design_draggable:function(){return this.input()},template:function(){return'<div class="ui-widget ui-label-position-left ui-textinput" data-widget="textinput" id="{{=data.uuid}}" data-block="{{=data.block}}" data-member="{{=data.item}}"> <input type="text" class="ui-widget-content ui-corner-all" autocomplete="off" name="{{=data.uuid}}" style="width: 210px; height: 22px;"><label for="#{{=data.uuid}}">{{=data.label}}</label></div>'}}),jQuery.extend(Frames.TextLink.prototype,{describe:function(){return{draggable:this.elem,draghandle:"a",resizable:this.input(),group:"misc"}},designRules:function(){return{behaviour:{enabled:!0,visible:!0,readonly:!1,format:!1,action:!1,caseRestriction:!1},data:{block:!0,member:!0,datatype:!1,value:!1},validation:null}}}),jQuery.extend(Frames.Tree.prototype,{describe:function(){return{draggable:this.elem,resizable:this.elem}},design:function(){if(!(0<arguments.length))return Frames.Item.prototype.design.apply(this);Frames.Item.prototype.design.apply(this,arguments),Frames.isTrue(arguments[0])?this._call("clear"):Frames.isUndef(this.block)||Frames.isUndef(this.block._last_model)||this.model(this.block._last_model)},template:function(){return'<div data-widget="tree" id="{{=data.uuid}}" data-name="{{=data.uuid}}" style="height:300px; width:200px;" data-block="{{=data.block}}" data-member="{{=data.item}}" class="ui-widget ui-tree"></div>'}}),Frames.Layout=$.inherit({template:function(){}},{_LAY_:{},register:function(e){Frames.Layout._LAY_[e.name]=e.value}}),Frames.Layout.register("base",Frames.Layout),Frames.LayoutGrid=$.inherit(Frames.Layout,{}),Frames.Layout.register("grid",Frames.LayoutGrid),Frames.LayoutGridFlow=$.inherit(Frames.Layout,{}),Frames.Layout.register("gridflow",Frames.LayoutGridFlow),Frames.LayoutPositional=$.inherit(Frames.Layout,{}),Frames.Layout.register("positional",Frames.LayoutPositional),Frames.LayoutResponsive=$.inherit(Frames.Layout,{}),Frames.Layout.register("responsive",Frames.LayoutResponsive),function($){Frames.DesignerInterop=$.inherit({}),Frames.DesignerInterop.FormItemService=$.inherit({init:function(){if(this.enabled()){var e=this._getFormInfo();if(!Frames.isUndef(e)){var t={};this.blocks=new Frames.HashMap;var i=$.parseJSON(e),a=this;$.each(i,function(){var e=this;a.blocks.put(this.Name,e),t[this.Name]={},e.itens=new Frames.HashMap,$.each(e.ItemList,function(){e.itens.put(this.Name,this)})}),Frames.Application.task.blocks(t)}}},enabled:function(){return Frames.Designer._external.formItemServiceEnabled()},initToolbox:function(e){var t=this;if(!Frames.isUndef(this.blocks)&&0<this.blocks.size()){var i=e.find('[data-group="form_itens"]');if(!Frames.isUndef(i)){var a=i.find("#blockList"),s=i.find("#itemList"),r=i.find("#widgetList");s.children().remove(),t.populateBlockList(a),a.on("change",function(){var e=this.options[this.selectedIndex].value;t._selectedBlock=t.findBlock(e),r.children().remove(),t.populateItemList(t._selectedBlock,s,r)}),s.on("change",function(){Frames.Designer.Dialog._dlg_props.dialog("destroy");var e=this.options[this.selectedIndex].value;t._selectedItem=t._selectedBlock.itens.get(e),t.populateWidgetList(t._selectedItem,r)}),i.show()}}},findBlock:function(e){return this.blocks.get(e)},populateBlockList:function(e){this._blockSelect=e,this._itemSelect&&this._itemSelect.children().remove(),this._widgetList&&this._widgetList.children().remove();for(e&&e.children().remove(),this._newoption(e,"",""),this.blocks.reset();this.blocks.hasNext();){var t=this.blocks.next();this._newoption(e,t.Name,t.Name)}},_newoption:function(e,t,i){var a=new Option(Frames.isUndef(t)&&$.browser.mozilla?"":t,Frames.isUndef(i)&&$.browser.mozilla?"":i);if(!Frames.isUndef(e)&&e.get(0)){var s=e.get(0).options;s[s.length]=a}},populateItemList:function(e,t,i){if(t.children().remove(),this.addMultRecordBlockWidget(),Frames.isUndef(e))return this._selectedItem=null,void(this._selectedBlock=null);i&&(this._widgetList=i),this._widgetList&&this._widgetList.children().remove(),this._itemSelect=t;for(this._newoption(t,"",""),e.itens.reset();e.itens.hasNext();){var a=e.itens.next();this._newoption(t,a.Name,a.Name)}},populateWidgetList:function(e,i){this._widgetList=i;var a=this;i.children().remove(),$.each(e.Widgets,function(){var e=a.getToolboxWidget(this);if(!Frames.isUndef(e)){var t=e.parent().clone(!1);$(i).append(t)}}),Frames.Designer.Dialog.initToolbarElements(i.parent(),this)},addMultRecordBlockWidget:function(){var e=Frames.Designer.Dialog._dlg_elems.find("#dynBlockGrid");if(e.children().remove(),!Frames.isUndef(this._selectedBlock)&&Frames.isTrue(this._selectedBlock.MultiRecord)&&0<this._selectedBlock.itens.size()){var t="dynamicGrid"+Frames._UUID_++,i=$('<li><a href="#" data-type="dynBlockGrid" title="GridView"><span class="gui-icon gui-table"></span><span class="gui-label">GridView</span></a></li>');$(e).append(i),this._selectedBlock.gridTemplate=t,e.parent().parent().show(),Frames.Designer.Dialog.initToolbarElements(e.parent(),this)}else e.parent().parent().hide()},getToolboxWidget:function(e){return Frames.Designer.Dialog._dlg_elems.find('[data-type="'+e+'"]')},itemRemoved:function(e){if(!Frames.isUndef(e.block)&&!Frames.isUndef(e.member)){var t=this.blocks.get(e.block.name);Frames.isUndef(t)&&((t={Name:e.block.name}).itens=new Frames.HashMap,this.blocks.put(t.Name,t));var i={Name:e.member,Widgets:[]};i.Widgets.push(e.widgetcls()),t.itens.put(i.Name,i),this.populateBlockList(this._blockSelect),this._itemRemoved(e.block.name,e.member)}},_add_widget:function(e,t,i,a){var s,r=this._selectedBlock.Name;if(this._selectedItem&&(s=this._selectedItem.Name),"dynBlockGrid"==e){e=this._selectedBlock.gridTemplate;var n='<div data-widget="datagrid"><div id="{{=data.uuid}}" data-name="{{=data.uuid}}" class="ui-widget ui-gridview" style="height:140px; width:400px;" data-widget="datagrid" data-block="{{=data.block}}"><script type="application/json">[\n',o="";for(this._selectedBlock.itens.reset();this._selectedBlock.itens.hasNext();){var l=this._selectedBlock.itens.next();o+='{ "title": "'+l.Name+'", "member": "'+l.Name+'", "width": "50"',"textinput"!=l.Widgets[0]&&(o+=', "editor": "'+l.Widgets[0]+'"'),o+="},\n",this._itemAdded(this._selectedBlock.Name,l.Name)}n+=o,n+="\n]<\/script></div></div>",Frames.Template.put(e,n),this._selectedBlock.itens.clear()}else this._selectedItem&&(this._itemAdded(this._selectedBlock.Name,this._selectedItem.Name),this._selectedBlock.itens.remove(this._selectedItem),this._selectedItem=null);Frames.Designer._add_widget(e,t,i,a,r,s),this.populateItemList(this._selectedBlock,this._itemSelect),ths._widgetList.children().remove()},_getFormInfo:function(){return Frames.Designer._external.getFormInfo()},_itemAdded:function(e,t){Frames.Designer._external.itemAdded(e,t)},_itemRemoved:function(e,t){Frames.Designer._external.itemRemoved(e,t)}}),Frames.DesignerInterop.FormItemServiceDummy=$.inherit(Frames.DesignerInterop.FormItemService,{enabled:function(){return!0},_getFormInfo:function(){return'[{"ItemList":[{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"TextItem","Name":"JOB","TabPage":null,"Widgets":["textinput","textarea"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"DisplayItem","Name":"COMM","TabPage":null,"Widgets":["textfield"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"CheckBox","Name":"SAL","TabPage":null,"Widgets":["checkbox"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"Image","Name":"ENAME","TabPage":null,"Widgets":["image"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"Button","Name":"TEMP1","TabPage":null,"Widgets":["button"]}],"MultiRecord":true,"Name":"BONUS"},{"ItemList":[{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"RadioGroup","Name":"JOB","TabPage":null,"Widgets":["radiogroup"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"List","Name":"COMM","TabPage":null,"Widgets":["combobox"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"List","Name":"COMM1","TabPage":null,"Widgets":["combobox"]},{"Canvas":null,"DataType":null,"HasLov":true,"ItemType":"TextItem","Name":"COMM1","TabPage":null,"Widgets":["textinput","textarea","lovbox"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"","Name":"SAL","TabPage":null,"Widgets":["textinput","textarea"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"Tree","Name":"ENAME","TabPage":null,"Widgets":["tree"]},{"Canvas":null,"DataType":null,"HasLov":false,"ItemType":"Button","Name":"TEMP1","TabPage":null,"Widgets":["button"]}],"MultiRecord":false,"Name":"B1"}]'}}),Frames.DesignerExternal=$.inherit({__constructor:function(){}}),Frames.DesignerExternalNoOp=$.inherit(Frames.DesignerExternal,{remove:function(e){},add:function(e,t,i,a,s,r,n,o,l,d,u,c,p,m){},update:function(e,t,i){},rename:function(e,t){},getVersion:function(){return"0.0.0"},formItemServiceEnabled:function(){return!1},getFormInfo:function(){return{}},itemAdded:function(e,t){},itemRemoved:function(e,t){},supportsOpenView:function(){return!1},openView:function(e){}}),Frames.DesignerExternalVS=$.inherit(Frames.DesignerExternal,{remove:function(e){window.external.Remove(e)},add:function(e,t,i,a,s,r,n,o,l,d,u,c,p,m){window.external.Add(e,t,i,a,s,r,n,o,l,d,u,c,p,m)},update:function(e,t,i){window.external.Update(e,t,i)},rename:function(e,t){window.external.Rename(e,t)},getVersion:function(){return window.external.GetVersion()},formItemServiceEnabled:function(){return window.external.FormItemServiceEnabled()},getFormInfo:function(){return window.external.GetFormInfo()},itemAdded:function(e,t){window.external.ItemAdded(e,t)},itemRemoved:function(e,t){window.external.ItemRemoved(e,t)},supportsOpenView:function(){return"OpenView"in window.external},openView:function(e){window.external.OpenView(e)}}),Frames.DesignerExternalEclipse=$.inherit(Frames.DesignerExternal,{remove:function(e){"function"==typeof window.__plugin__remove&&window.__plugin__remove(e)},add:function(e,t,i,a,s,r,n,o,l,d,u,c,p,m){"function"==typeof window.__plugin__add&&window.__plugin__add(e,t,i,a,s,r,n,o,l,d,u,c,p,m)},update:function(e,t,i){"function"==typeof window.__plugin__update&&window.__plugin__update(e,t,i)},rename:function(e,t){"function"==typeof window.__plugin__rename&&window.__plugin__rename(e,t)},getVersion:function(){if("function"==typeof window.__plugin__getVersion)return window.__plugin__getVersion()},formItemServiceEnabled:function(){if("function"==typeof window.__plugin__formItemServiceEnabled)return window.__plugin__formItemServiceEnabled()},getFormInfo:function(){if("function"==typeof window.__plugin__getFormInfo)return window.__plugin__getFormInfo()},itemAdded:function(e,t){"function"==typeof window.__plugin__itemAdded&&window.__plugin__itemAdded(e,t)},itemRemoved:function(e,t){"function"==typeof window.__plugin__itemRemoved&&window.__plugin__itemRemoved(e,t)},supportsOpenView:function(){return"function"==typeof window.__plugin__openView},openView:function(e){"function"==typeof window.__plugin__openView&&window.__plugin__openView(e)}}),Frames.DesignerExternalAuto=$.inherit(Frames.DesignerExternal,{__constructor:function(){window.__external.attached()?this._adaptee=new Frames.DesignerExternalVS:"function"==typeof window.__plugin__getVersion?this._adaptee=new Frames.DesignerExternalEclipse:this._adaptee=new Frames.DesignerExternalNoOp},remove:function(e){this._adaptee.remove(e)},add:function(e,t,i,a,s,r,n,o,l,d,u,c,p,m){this._adaptee.add(e,t,i,a,s,r,n,o,l,d,u,c,p,m)},update:function(e,t,i){this._adaptee.update(e,t,i)},rename:function(e,t){this._adaptee.rename(e,t)},getVersion:function(){return this._adaptee.getVersion()},formItemServiceEnabled:function(){return this._adaptee.formItemServiceEnabled()},getFormInfo:function(){return this._adaptee.getFormInfo()},itemAdded:function(e,t){this._adaptee.itemAdded(e,t)},itemRemoved:function(e,t){this._adaptee.itemRemoved(e,t)},supportsOpenView:function(){return this._adaptee.supportsOpenView()},openView:function(e){this._adaptee.openView(e)}})}(jQuery),function($){if(Frames.Designer=$.inherit({},{gridSize:8,version:function(){return Frames.version},load:function(e){Frames.Designer.close();var t=Frames.Application.task,i=t.view;t.closeView(i),i.initialized=!1,t._VIEWS_.put(e,i),Frames.Application._OPTS_.view=e,i.id=e,i.load(function(){Frames.Designer.init()})},toggle:function(){Frames.inDesignMode||Frames.Designer.init()},init:function(){var e=Frames.Config.getclass("DESIGNER_EXTERNAL_CLASS",Frames.DesignerExternalAuto);if(Frames.Designer._external=new e,Frames.Designer.initUUID(),$(document.body).addClass("ui-designer"),!Frames.isUndef(Frames.DesignerInterop))try{var t;(t=new Frames.DesignerInterop.FormItemService).enabled()&&(t.init(),Frames.Designer.formService=t)}catch(e){}var i=Frames.Application.task.view;if(Frames.isUndef(i)||Frames.Application.isWorkspaceView(i.id))Frames.Designer.blank();else{Frames.inDesignMode=!0,Frames.ToolBar.refresh();var a=i.window();a.addClass("ui-designer-board");var s,r=a.find("> .ui-panel");for(s in 0===r.length&&(r=a.find("> *:first")),a.css({height:Math.max(r.height(),$(document).outerHeight())}),a.on("mousedown.designer",function(e){this==e.target&&(Frames.isUndef(Frames.Designer._curr_el)||(Frames.Designer._curr_el.removeClass("ui-designer-selected"),Frames.Designer._curr_el.parents(".ui-state-active").removeClass("ui-state-active")),null!=Frames.Designer._curr&&Frames.Designer._curr.design_deselect(null),Frames.Designer.Dialog._dlg_props.children().remove(),Frames.Designer.Dialog._dlg_props.append('<p class="pdialog-note">no element selected</p>'),Frames.Designer._selected=$([]),Frames.Designer._curr=null,Frames.Designer._curr_el=null)}),Frames.Designer.positional=!(a.hasClass("ui-layout-vertical")||a.hasClass("ui-layout-horizontal")),Frames.Designer.toolbox(i),$(window).on("resize",function(){a.css({height:Math.max(r.height(),$(window).outerHeight())})}),i._OBJS_){var n=i._OBJS_[s];0===n.elem.parents(".ui-designer-include").length&&n.design&&n.design(!0)}i.window().find(".ui-designer-include").each(function(){var e=$(this),t=e.data("src");if(0<e.children().length){var i=e.children().first();if(!(0<i.width()&&0<i.height())){var a=e.parents(".ui-tabpanel");Frames.isUndef(a)||(i.width(a.width()),i.height(a.height()))}var s=t.replace(/(.*)\.[^.]+$/,"$1");i.block({message:"xvc:include("+(Frames.Designer._external.supportsOpenView()?'<a title="Open file" href="#" class="ui-designer-open-view" data-viewid="'+s+'">'+s+"</a>)":s+")<br/>Open file in Solution Explorer to edit"),centerY:0,css:{border:"3px solid #a00",width:"auto",top:"5px",left:"",right:"5px",textAlign:"right",cursor:""},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:""}})}}),$("a.ui-designer-open-view").on("click",function(e){e.preventDefault();var t=$(this).data("viewid");Frames.Designer._external.openView(t)}),$(document).on("keyup.designer",function(e){if(!Frames.isUndef(Frames.Designer._curr)&&!$(e.target).is(":input")){var t,i=Frames.Designer._curr,a=(i._wrapper||i.elem).position(),s=!0;switch(e.keyCode){case $.ui.keyCode.UP:a.top--,t="drag";break;case $.ui.keyCode.DOWN:a.top++,t="drag";break;case $.ui.keyCode.LEFT:a.left--,t="drag";break;case $.ui.keyCode.RIGHT:a.left++,t="drag";break;case $.ui.keyCode.DELETE:case $.ui.keyCode.BACKSPACE:var r=Frames.Designer.toXPath(i.elem);Frames.Designer._curr_el.removeClass("ui-designer-selected"),Frames.Designer._curr_el.parents(".ui-state-active").removeClass("ui-state-active"),Frames.Designer._curr_el=null,Frames.Designer._curr=null,Frames.Designer.Dialog._dlg_props.children().remove(),Frames.Designer.Dialog._dlg_props.append('<p class="pdialog-note">no element selected</p>'),i.design(!1),(i._wrapper||i.elem).empty().remove(),Frames.isUndef(Frames.Designer.formService)||i.destroy(),Frames.Designer.Dialog.close(),Frames.Designer.remove(r),s=!1;break;default:s=!1}s&&((i._wrapper||i.elem).css(a),Frames.Designer.refresh(t))}}),Frames.Designer._allowGridCellsDnD()}},close:function(){Frames.inDesignMode=!1,$(document).off("keyup.designer");var e,t=Frames.Application.task.view;for(e in t.window().removeClass("ui-designer-board").parent().removeClass("ui-designer-container"),t._OBJS_){var i=t._OBJS_[e];i.design&&i.design(!1)}t.window().droppable("destroy"),Frames.Designer.select(),Frames.Designer.Dialog.destroy(),Frames.focus()},toolbox:function(e){if(!Frames.Designer.Dialog.created){var i=this;$.get(Frames.Application._OPTS_.runtime+"/js/frames/designer/toolbox.tpl.html",function(e){var t=Frames.Template.transform(e,Frames.Locale.messages);(t.find("#General").html(Frames.Designer.generateElements),!Frames.isUndef(t)&&t.is(".ui-designer-toolbox"))&&(Frames.isUndef(Frames.Designer.Dialog._dlg_elems)||Frames.Designer.Dialog._dlg_elems.remove(),Frames.Designer.Dialog._dlg_elems=t,!Frames.isUndef(i.formService)&&!Frames.isUndef(i.formService.blocks)&&0<i.formService.blocks.size()&&i.formService.initToolbox(t),t.find(".pdialog-group-header").spinDown(),Frames.Designer.Dialog.initToolbarElements(),Frames.Designer.Dialog.show())});var t=Frames.gettypes();$.each(t,function(e,t){if(!Frames.isUndef(e)&&"function"==typeof t.prototype.template){var i=t.prototype.template();Frames.isEmpty(i)||Frames.Template.put(e,i)}})}Frames.Designer.Dialog.select(e.window(),null)},_loadComponentTemplates:function(e){$(e).children().each(function(){var e=$(this),t=e.data("widget");Frames.isUndef(t)||Frames.Template.put(t,e)})},_dropped:function(e,t,i){if(!Frames.isUndef(e)&&!Frames.isUndef(t)){var a=(t.is("[data-widget]")?t:t.find("[data-widget]").first()).attr("id");if(void 0!==a){var s=Frames.get(a),r={};if(e.hasClass("ui-layout-horizontal")||e.hasClass("ui-layout-vertical"))r={top:"",left:""};else{var n=e.offset(),o=i;r=Frames.Application._OPTS_.snaptogrid?{top:Math.round(Math.floor(o.top-n.top)/Frames.Designer.gridSize)*Frames.Designer.gridSize,left:Math.round(Math.floor(o.left-n.left)/Frames.Designer.gridSize)*Frames.Designer.gridSize}:{top:Math.floor(o.top-n.top),left:Math.floor(o.left-n.left)}}t.css(r);var l=e.find(".ui-container");0===l.length&&(l=e);var d=Frames.Designer.toXPath(t),u=Frames.Designer.toXPath(e,"parent"),c=$("> .ui-resizable-handle:first",e);c[0]?t.insertBefore(c):e.append(t),Frames.Designer._fix_layout(t,e),s.design(!0),Frames.Designer.update(d,"parent",u),s.design_refresh($.Event("drag"))}}},_fix_layout:function(e,t){if(!Frames.isUndef(t)){var i=e.is("[data-widget]")?e:e.find("[data-widget]").first();(t.hasClass("ui-layout-horizontal")||t.hasClass("ui-layout-vertical"))&&e.css({top:"",left:""}),t.data("x-design-layout-padding")&&i.css("padding",t.data("x-design-layout-padding")),i.data("x-design-padding")&&i.css("padding",i.data("x-design-padding"))}},_add_widget:function(e,t,i,a,s,r){var n=Frames.Template.getByName(e);if(!Frames.isEmpty(n)){Frames._UUID_++;var o=e+Frames._UUID_,l=0,d=0,u=a||t.window(),c="Item"+Frames._UUID_;if($.isPlainObject(i))l=i.top;else if(!Frames.isUndef(Frames.Designer._curr_el)){var p=Frames.Designer._curr_el.closest(".ui-widget"),m=Math.max(p.outerHeight(),p.find("input,textarea").outerHeight());l=parseInt(p.css("top"),10)+m+12,d=parseInt(p.css("left"),10)}Frames.isUndef(s)&&(s=""),Frames.isUndef(r)&&(r="");var h=Frames.Template.transform(n,{uuid:o,label:c,block:s,item:r,parent:u,layout:Frames.Designer.getViewLayout()||""}),f=$("> .ui-resizable-handle:first",u);f[0]?h.insertBefore(f):u.append(h);var g=Frames.get(h.attr("id"),t.task,t);if(!Frames.isUndef(g)){var _=g.describe();g.design(!0);var v=g._wrapper||g.elem,b="",F="";if(u.hasClass("ui-layout-horizontal")||u.hasClass("ui-layout-vertical")||(F=Frames.Application._OPTS_.snaptogrid?(b=Math.round(($.isPlainObject(i)?i.top:l)/Frames.Designer.gridSize)*Frames.Designer.gridSize+"px",Math.round(($.isPlainObject(i)?i.left:d)/Frames.Designer.gridSize)*Frames.Designer.gridSize+"px"):(b=($.isPlainObject(i)?i.top:l)+"px",($.isPlainObject(i)?i.left:d)+"px"),"radiogroup"!==e?v.css({top:b,left:F}):$(".ui-radiobox:first",v).css({top:b,left:F})),!1!==_.draggable){m=_.draggable&&_.draghandle?_.draggable.find(_.draghandle):_.draggable;Frames.Designer.select(g,m)}Frames.Designer._fix_layout(v,a);var y={type:Frames.Designer._fixwidget(g.widgetcls()),name:o,label:Frames.isUndef(g.labelObj())?null:c,labeloffset:Frames.isUndef(g.labelObj())?null:g.labelObj().data("offset"),labelposition:Frames.isUndef(g.labelObj())?null:g.labelObj().data("position"),top:v.prop("style").top,left:v.prop("style").left,container:Frames.Designer.toXPath(u,"parent"),framesClass:g.props("class"),ns:Frames.isUndef(_.namespace)?null:_.namespace,block:s,item:r};if(Frames.Designer.Dialog.DefaultInspector.properties(g).general&&Frames.Designer.Dialog.DefaultInspector.properties(g).general.properties.size){var w=Frames.Designer.Dialog.DefaultInspector.properties(g).general.properties.size.get();y.width=w.width,y.height=w.height}return"xtext"===g.widgetcls()&&(y.label=null,y.labeloffset=null,y.labelposition=null),Frames.Designer.add(y),"xtext"===g.widgetcls()&&Frames.Designer.update(Frames.Designer.toXPath(g.elem),"frames_node_content",c),$.isFunction(g.design_create_children)&&g.design_create_children(),g}}},refresh:function(e){Frames.isUndef(Frames.Designer._curr)||Frames.Designer.Dialog.select(Frames.Designer._curr_el,Frames.Designer.Dialog.DefaultInspector,e)},select:function(e,t){if(void 0===t){var i=e.describe();t=i.draggable&&i.draghandle?i.draggable.find(i.draghandle):i.draggable||e.elem}Frames.isUndef(Frames.Designer._curr_el)||(Frames.Designer._curr_el.removeClass("ui-designer-selected"),Frames.Designer._curr_el.parents(".ui-state-active").removeClass("ui-state-active")),null!=Frames.Designer._curr&&Frames.Designer._curr.design_deselect(e),Frames.Designer._curr=e,(Frames.Designer._curr_el=t)&&(t.addClass("ui-designer-selected"),Frames.Designer.refresh())},_UUID_:0,uuid:function(){return++Frames.Designer._UUID_},blank:function(){var e=Frames.Application.task,t="View"+Frames.Designer.uuid(),i=new Frames.Designer.View(t);i.isDesigner=!0,Frames.Application._container&&(e=new Frames.Task(t),Frames.Application.task=e,Frames.Application._TASKS_[t]=e),((e.view=i).task=e)._VIEWS_.put(t,i),e.callback=Frames.Application._viewPreReady,i.load(Frames.Designer.init)},_index:function(e){var t,i=e.parent(".ui-wrapper,.ui-wrapper-text,.ui-wrapper-button");if(0!==(i=i.is(".ui-wrapper")?i=i.parent(".ui-wrapper-text,.ui-wrapper-button"):i).length){var a=i.hasClass("ui-wrapper-button")?"ui-wrapper-button":"ui-wrapper-text";t=i.parent().children("."+a).map(function(){return $(".ui-widget",$(this)).get(0)})}else{var s=e.data("widget"),r="> [data-widget="+s+"]";"tabpanel"===s&&(r+=", > .ui-scrollable-tabs"+r);var n=e.parents(".ui-view-window,.ui-panel,.ui-framepanel,.ui-collapsiblepanel,.ui-layout-gridflow,.ui-layout-border").first();if(n.hasClass("ui-layout-gridflow"))t=n.find("> td "+r);else{var o=e.parent();o.is(".ui-scrollable-tabs")&&(o=o.parent()),t=o.find(r)}}var l=0;return t.each(function(){if(l++,this==e.get(0))return!1}),l},_fixwidget:function(e){return"textinput"==e?e="textbox":"datefield"==e?e="calendar":"lovinput"==e?e="lovbox":"tree"==e?e="treeview":"datagrid"==e?e="gridview":"xbutton"==e?e="button":"xtext"==e?e="text":"editinput"==e&&(e="editbox"),e},toXPath:function(e,t,i){var d="/";if(e.hasClass("ui-view-window"))d+="*[self::xv:window | self::xv:config]";else{if(!e.hasClass("ui-widget"))if(e.hasClass("ui-container")||e.hasClass("ui-framepanel-content")||e.hasClass("ui-collapsiblepanel-content"))e=e.parent(".ui-widget");else if(e.hasClass("slick-header-column")||e.hasClass("ui-tabs-panel")||e.hasClass("ui-layout-cell"));else{var a=e.find(".ui-widget").first();e=0<a.lengt?a:e}var s,r;if(e.parents('[data-widget],.ui-view-window, [class^="ui-border-"], .ui-framepanel-content, .ui-tabs-panel, .ui-layout-grid, .ui-layout-cell').reverse().each(function(){var e=$(this);if(e.hasClass("ui-view-window"))d+="*[self::xv:window | self::xv:config]/";else if(e.hasClass("ui-border-top"))d+="xv:area[@name='top']/";else if(e.hasClass("ui-border-bottom"))d+="xv:area[@name='bottom']/";else if(e.hasClass("ui-border-left"))d+="xv:area[@name='left']/";else if(e.hasClass("ui-border-right"))d+="xv:area[@name='right']/";else if(e.hasClass("ui-border-center"))d+="xv:area[@name='center']/";else if(e.hasClass("ui-tabs-panel"))d+="xv:tab["+($("> .ui-tabs-panel",e.parent()).index(e)+1)+"]/";else if(e.hasClass("ui-layout-grid"))d+="xv:gridlayout/";else if(e.hasClass("ui-framepanel-content"))"flow"==e.data("x-design-layout")&&(d+="xv:flowlayout[1]/");else if(e.hasClass("ui-layout-cell")){var t=$("> tbody > tr > .ui-layout-cell",e.parent().closest(".ui-layout-grid")).index(e)+1,i=e.closest("table");if("vertical"==i.parent().attr("data-x-design-layout-orientation")){var a=e.index(),s=e.closest("tbody").children().index(e.closest("tr"))+1,r=i.find("tr").length;i.parent().attr("data-x-design-layout-cols");t=s+(0<a?a*r:0)}d+="xv:gridcell["+t+"]/"}else{if(!e.hasClass("ui-widget"))return!0;var n=Frames.Designer._fixwidget(e.data("widget")),o=Frames.Designer._index(e);d+=Frames.Designer._getXpathNSPrefix(e)+n+"["+o+"]/";var l=e.data("x-design-layout");l&&(d+="xv:"+l+"layout/")}}),void 0!==e.data("widget"))s=Frames.Designer._getXpathNSPrefix(e)+Frames.Designer._fixwidget(e.data("widget")),r=Frames.Designer._index(e);else{var n=e.data("inspector");n&&$.isFunction(n.xpath)&&$.isFunction(n.pos)?(s=n.xpath(),r=n.pos(e)+1):e.hasClass("slick-header-column")?(s="xv:viewheader/xv:viewcolumn",r=e.parent().children().index(e)+1):e.hasClass("ui-tabs-panel")?(s="xv:tab",r=$("> .ui-tabs-panel",e.parent()).index(e)+1):e.hasClass("ui-layout-cell")&&(s="xv:gridcell",r=$("> tbody > tr > .ui-layout-cell",e.parent().closest(".ui-layout-grid")).index(e)+1)}d+=s+"["+r+"]","parent"!==t||e.hasClass("ui-view-window")||e.hasClass("ui-layout-cell")||!e.hasClass("ui-layout-horizontal")&&!e.hasClass("ui-layout-vertical")||(d+="/xv:flowlayout")}return d},_getXpathNSPrefix:function(e){var t;if($.isFunction(e.describe))t=e.describe();else{var i=Frames.get(e.attr("id"));if(!$.isFunction(i.describe))return"xv:";t=i.describe()}var a=Frames.isUndef(t)||Frames.isUndef(t.nsprefix)?"xv":t.nsprefix;return a+=":"},_select_properties:function(e,t,i){if($.isPlainObject(t)){var a=e.data("inspector");a||(a=t,e.data("inspector",a)),a.select(e),i.children().remove();var s,r=a.properties(Frames.Designer._curr);for(s in r){var n=_(r[s].label),o=r[s].properties,l=$('<div class="pdialog-group state-default corner-top">  <div class="pdialog-group-header state-active">    <span class="ui-icon ui-icon-triangle-1-e">Collapse</span>    <a href="#">'+n+'</a>  </div>  <div class="pdialog-group-content" style="display: none"></div></div>');i.append(l);var d,u=l.find(".pdialog-group-content");for(d in o){var c=o[d],p=$('<div class="pdialog-property" data-property="'+d+'"><label>'+_(c.label)+'</label><div class="pdialog-widget"></div></div>');u.append(p),p.find(".pdialog-widget").pproperty({name:d,property:c})}}var m=i.find(".pdialog-group-header");m.eq(0).removeClass("corner-all").addClass("corner-all").find(".ui-icon").addClass("ui-icon-triangle-1-s").end().parent().find(".pdialog-group-content").show(),m.spinDown()}},remove:function(e){Frames.Designer._external.remove(e)},add:function(e){Frames.Designer._external.add(e.ns,e.type,e.name,e.label,e.labelposition,e.labeloffset,e.top,e.left,e.width,e.height,e.container,e.framesClass,e.block,e.item)},update:function(e,t,i){var a;if($.isPlainObject(i))for(a in i)Frames.Designer.update(e,a,i[a]);else Frames.Designer._external.update(e,t,i)},rename:function(e,t){Frames.Designer._external.rename(e,t)},initUUID:function(){var i=0;$(".ui-widget").filter(function(){var e=$(this).data("name");if(!Frames.isEmpty(e)){var t=e.match(/^.*?(\d+)$/);t&&$.isNumeric(t[1])&&+t[1]>i&&(i=+t[1])}}),Frames._UUID_=i+1},getViewLayout:function(){var e=null,t=Frames.Application.task.view.window().attr("class").match(/(?:\s+|^)(ui-layout-\w+)(?:\s+|$)/);return t&&(e=t[1]),e},_allowGridCellsDnD:function(){var e=$(".ui-layout-gridflow, .ui-layout-grid").find("td");e.droppable({greedy:!0,hoverClass:"ui-drop-active",drop:function(e,t){if("TD"==t.helper[0].nodeName){var i=$(this),a=i.closest("table"),s=a.parent().attr("data-x-design-layout-cols"),r=i.parents("tr"),n=i.index(),o=r[0].rowIndex,l=$("#"+t.helper.attr("overId"));l.removeAttr("id");var d,u=l.index(),c=l.parents("tr")[0].rowIndex,p=c!=o,m=n+o*s;if(m=0<o?m+1:m,a.hasClass("ui-layout-grid")?d=Frames.Designer.toXPath(l):a.hasClass("ui-layout-gridflow")&&(d=Frames.Designer.toXPath(l.find(".ui-widget").first())),Frames.Designer.update(d,"position",m.toString()),!p&&n<u||o<c?$(this).before(l):$(this).after(l),p){var h=c<o?c:o;setTimeout(function(){Frames.Designer._redraw_table(a,s,h)},1)}}}}),e.draggable({cursor:"move",helper:"clone",grid:[1,1],opacity:.65,revertDuration:100,revert:function(e){return!e},start:function(e,t){var i=(new Date).getTime()%1e4;this.setAttribute("id",i),t.helper.attr("overId",i)},stop:function(e,t){}})},_redraw_table:function(e,a,t){t=t||0,e.find("tr:eq("+t+"),tr:gt("+t+")").each(function(e,t){if(t.childElementCount<a)$(t).append($(t.nextElementSibling).find(":eq(0)"));else{var i=t;$(t).find("td:eq("+a+"),td:gt("+a+")").each(function(e,t){$(i.nextElementSibling).prepend(t)})}})},generateElements:function(){var e=Frames.gettypes(),s="";return $.each(e,function(e,t){var i=e.charAt(0).toUpperCase()+e.slice(1);if("function"==typeof t.prototype.template){var a=t.prototype.template();if(!Frames.isEmpty(a))s+='<li><a href="#" data-type="'+e+'" title="'+i+'"><span class="gui-icon gui-'+e+'"></span><span class="gui-label">'+i+"</span></a></li>"}}),s}}),jQuery.fn.reverse=[].reverse,Frames.Designer.View=$.inherit(Frames.View,{load:function(e){this.task._container=Frames.Application._container?Frames.Application.createViewContainer(_(Frames.Locale.messages.LOADING),!1):$("body"),this.callback=e;var t="<html>\t<head><title>"+this.id+'</title></head>\t<body>\t\t<div class="ui-view-window ui-layout-positional" style="position: relative; height: 480px;">\t\t\t<form>\t\t\t</form>\t\t</div>   </body></html>';$(t).appendTo(this.task._container),this._loadComplete("success",t)},isBlank:!0,isDesigner:!0}),Frames.Designer.Dialog={created:!1,DefaultInspector:{select:function(e){Frames.Designer._selected=e},properties:function(a){var e,t={};if(t.general={label:"General",properties:{name:{type:Frames.Designer.StringPropertyWidget,label:"Name",get:function(){return"function"==typeof a.name?a.name():a.elem.data("name")},set:function(e){"function"==typeof a.name?a.name(e):a.elem.data("name",e)}},widget:{type:Frames.Designer.StringReadOnlyPropertyWidget,label:"Widget Type",get:function(){var e=Frames.Designer._fixwidget(a.widgetcls()),t=a.props("class");return Frames.isEmpty(t)||(e=e.concat(" ("+t+")")),e},set:function(e){}},position:{type:Frames.Designer.PositionPropertyWidget,label:"Position",get:function(){var e=a,t=e._wrapper||e.elem,i=Frames.css(t,!0);return{left:i.left,top:i.top,right:i.right,bottom:i.bottom}},set:function(e){var t=a,i=t._wrapper||t.elem;$.isPlainObject(e)&&(i.css(e),a._call("fixpositions"))}},size:{type:Frames.Designer.SizePropertyWidget,label:"Size",get:function(){var e=a.describe();if(Frames.isUndef(e.resizable)||!1===e.resizable)return{};var t=a._wrapper||a.elem,i=Frames.css(t,!0);return{width:i.left&&i.right?"":e.resizable.prop("style").width,height:i.top&&i.bottom?"":e.resizable.prop("style").height}},set:function(e){var t=a.describe();if($.isPlainObject(e)&&!Frames.isUndef(t.resizable)&&!1!==t.resizable){t.resizable.css(e);var i=a.elem.children(".ui-wrapper,.ui-resizable-wrapper");!i[0]&&a.elem.parent().is(".ui-wrapper")&&(i=a.elem.parent()),i[0]&&(e.hasOwnProperty("width")&&(""!==e.width?i.width(t.resizable.outerWidth()):i.css("width","")),e.hasOwnProperty("height")&&(""!==e.height?i.height(t.resizable.outerHeight()):i.css("height","")),t.resizable.is(".ui-resizable-wrapper")&&(t.resizable.trigger("designer.resize"),a._label_position(!0)))}}},style:{type:Frames.Designer.StringPropertyWidget,label:"Style Name",get:function(){return a.props("StyleClass")},set:function(e){a.props("StyleClass",e)}},menu:{type:Frames.Designer.StringPropertyWidget,label:"Popup Menu",get:function(){return a.elem.data("menu")},set:function(e){a.elem.data("menu",e)}}}},$.isFunction(a.designRules)&&(e=a.designRules()),Frames.Config.getbool("MERGED_CONTROL_INFO",!1)&&(e.behaviour.enabled=!1,e.behaviour.readonly=!1,e.behaviour.visible=!1,e.validation.required=!1,e.validation.maxlength=!1,e.validation.minlength=!1,e.validation.maxvalue=!1,e.validation.minvalue=!1),!Frames.isUndef(e.behaviour)){var i={};Frames.isTrue(e.behaviour.enabled)&&(i.enabled={type:Frames.Designer.BooleanPropertyWidget,label:"Enabled",get:function(){return a.enabled().toString()},set:function(e){a.enabled(Frames.isTrue(e))}}),Frames.isTrue(e.behaviour.visible)&&(i.visible={type:Frames.Designer.BooleanPropertyWidget,label:"Visible",get:function(){return a.visible().toString()},set:function(e){a.visible(Frames.isTrue(e))}}),Frames.isTrue(e.behaviour.readonly)&&(i.readonly={type:Frames.Designer.BooleanPropertyWidget,label:"Read Only",get:function(){return a.editable().toString()},set:function(e){a.editable(Frames.isTrue(e))}}),Frames.isTrue(e.behaviour.format)&&(i.format={type:Frames.Designer.StringPropertyWidget,label:"Format",get:function(){return a.format()},set:function(e){a.format(e)}}),Frames.isTrue(e.behaviour.caseRestriction)&&(i.case={type:Frames.Designer.CasePropertyWidget,label:"Case Restriction",get:function(){return a.props("InputTransform")},set:function(e){a.props("InputTransform",e)}}),Frames.isTrue(e.behaviour.action)&&(i.action={type:Frames.Designer.StringPropertyWidget,label:"Action",get:function(){return a.data("action")},set:function(e){a.data("action",e)}}),0!==Object.keys(i).length&&(t.behaviour={label:"Behaviour",properties:i})}if(Frames.isUndef(a.labelObj())||Frames.isUndef(a.input())||"xbutton"==a.widgetcls()?Frames.isUndef(a.labelObj())||(t.label={label:"xtext"==a.widgetcls()?"Text":"Label",properties:{"label:text":{type:Frames.Designer.StringPropertyWidget,label:"Text",name:"xtext"==a.widgetcls()?"frames_node_content":"label",get:function(){return a.label()},set:function(e){a.label(e)}}}}):t.label={label:"Label",properties:{"label:text":{type:Frames.Designer.StringPropertyWidget,label:"Text",name:"label",get:function(){return a.label()},set:function(e){a.label(e)}},"label:position":{type:Frames.Designer.AlignPropertyWidget,label:"Position",name:"labelposition",get:function(){return a.labelObj()?a.labelObj().data("position"):""},set:function(e){a.labelObj()&&(a.props("LabelPosition",e),a._call("fixpositions"))}},"label:align":{type:Frames.Designer.Align2PropertyWidget,label:"Align",name:"labelalign",get:function(){return a.labelObj()?a.labelObj().prop("style").textAlign:""},set:function(e){a.labelObj()&&a.props("LabelAlign",e)}},"label:offset":{type:Frames.Designer.StringPropertyWidget,label:"Offset",name:"labeloffset",get:function(){return a.labelObj()?a.labelObj().data("offset"):""},set:function(e){a.props("LabelOffset",e)}},"label:size":{type:Frames.Designer.SizePropertyWidget,label:"Size",prefix:"label",get:function(){return{width:a.labelObj()?a.labelObj().prop("style").width:""}},set:function(e){$.isPlainObject(e)&&a.labelObj()&&a.labelObj().css(e)}}}},$.isFunction(a.model)&&!Frames.isTrue(a.isCanvas)){if(!Frames.isUndef(e.validation)){var s={};Frames.isTrue(e.validation.required)&&(s.required={type:Frames.Designer.BooleanPropertyWidget,label:"Required",get:function(){return Frames.isUndef(a.props("required"))?"false":a.props("required")},set:function(e){a.props("required",e)}}),Frames.isTrue(e.validation.maxlength)&&(s.maxlength={type:Frames.Designer.StringPropertyWidget,label:"Max Length",get:function(){return a.props("maxlength")},set:function(e){a.props("maxlength",e)}}),Frames.isTrue(e.validation.minlength)&&(s.minlength={type:Frames.Designer.StringPropertyWidget,label:"Min Length",get:function(){return a.props("minlength")},set:function(e){a.props("minlength",e)}}),Frames.isTrue(e.validation.maxvalue)&&(s.maxvalue={type:Frames.Designer.StringPropertyWidget,label:"Max Value",get:function(){return a.props("maxvalue")},set:function(e){a.props("maxvalue",e)}}),Frames.isTrue(e.validation.minvalue)&&(s.minvalue={type:Frames.Designer.StringPropertyWidget,label:"Min Value",get:function(){return a.props("minvalue")},set:function(e){a.props("minvalue",e)}}),0!==Object.keys(s).length&&(t.validation={label:"Validation",properties:s})}if(!Frames.isUndef(e.data)){var r={};Frames.isTrue(e.data.block)&&(r["model:block"]={type:Frames.Designer.BlockPropertyWidget,label:"Provider",name:"block",get:function(){return a.block?a.block.name:""},set:function(e){a.block=Frames.Application.task.get(e)}}),Frames.isTrue(e.data.member)&&(r["model:member"]={type:Frames.Designer.StringPropertyWidget,label:"Member",name:"member",get:function(){return a.member},set:function(e){a.member=e}}),Frames.isTrue(e.data.datatype)&&(r.datatype={type:Frames.Designer.DataTypePropertyWidget,label:"Data Type",get:function(){return a.props("type")},set:function(e){a.props("type",e)}}),Frames.isTrue(e.data.value)&&(r.value={type:Frames.Designer.StringPropertyWidget,label:"Value",get:function(){return a.value()},set:function(e){a.value(e)}}),0!==Object.keys(r).length&&(t.model={label:"Data",properties:r})}}return $.isFunction(a.designprops)&&(t=a.designprops(t)),t}},OptionInspector:{select:function(e){Frames.Designer._selected=e},xpath:function(){return"xv:model[1]/xv:item"},pos:function(e){return $(e).parent().children().index(e)},properties:function(t){var e={};return e.option={label:"Option",properties:{label:{type:Frames.Designer.StringPropertyWidget,label:"Label",name:"label",get:function(){return t.elem.html()},set:function(e){t.elem.html(e)}},value:{type:Frames.Designer.StringPropertyWidget,label:"Value",name:"value",get:function(){return t.elem.val()},set:function(e){t.elem.val(e)}}}},e}},show:function(){var e=Frames.Designer.Dialog._container;Frames.Designer.Dialog.created||(e=Frames.Designer.Dialog._container=$('<div class="ui-designer-sidebar"></div>'),$(document.body).append(e),Frames.Designer.Dialog._dlg_props=$('<div title="Properties"><p class="pdialog-note">no element selected</p></div>'),Frames.Designer.Dialog._dlg_elems=$('<div title="Toolbox"></div>'),Frames.Designer.Dialog.created=!0);var t=Frames.Designer.Dialog._dlg_elems;t.addClass("pdialog dlg-elems"),t.appendTo(e),(t=Frames.Designer.Dialog._dlg_props).addClass("pdialog"),Frames.Designer.Dialog._dlg_props.appendTo(e)},initToolbarElements:function(e,o){var l=Frames.Application.task.view.window();Frames.isUndef(e)&&(e=Frames.Designer.Dialog._dlg_elems),Frames.isUndef(o)&&(o=Frames.Designer);var r=l;l.is(".ui-layout-horizontal,.ui-layout-vertical")&&((r=$(".ui-designer-dragholder"))[0]||(r=$('<div class="ui-layout-positional ui-designer-dragholder"/>'),l.prepend(r))),e.find(".pdialog-elements li > a").click(function(){var e,t=$(this).data("type");Frames.isUndef(t)||(Frames.isUndef(Frames.Designer._curr_el)||(e=Frames.Designer._curr_el.closest(".ui-droppable")),o._add_widget(t,Frames.Application.task.view,void 0,e))}).draggable({appendTo:r,cursorAt:{top:10,left:10},grid:[1,1],zIndex:1010,helper:function(){var e=$(this).data("type"),t=Frames.Template.getByName(e),i=Frames.Template.transform(t,{uuid:e+Frames._UUID_+1e3,label:"Item"+(Frames._UUID_+1),block:"",item:"",parent:r,layout:Frames.Designer.getViewLayout()||""});i.appendTo(r);var a=Frames.get(i.attr("id"),Frames.Application.task.view.task,Frames.Application.task.view),s=a.describe().draggable||a.elem;return s.data("designer.helper_elem",i),s},stop:function(e,t){var i=$(this).data("type");if(!Frames.isUndef(i)){var a=Frames.Designer._over;if(Frames.isUndef(a))a=l;else{var s=a.offset(),r=t.helper.offset();t.position.top=Math.floor(r.top-s.top),t.position.left=Math.floor(r.left-s.left)}var n=t.helper.data("designer.helper_elem");n.get(0)!==t.helper.get(0)&&n.empty().remove(),t.helper.empty().remove(),a.removeClass("ui-state-active"),Frames.Designer._over=null,o._add_widget(i,Frames.Application.task.view,t.position,a)}}})},close:function(){},destroy:function(){},select:function(e,t,i){if(Frames.Designer._selected==Frames.Designer._curr_el&&Frames.Designer.Dialog._dlg_props)if(Frames.Designer.Dialog.show(),"resize"==i||"drag"==i){var a="resize"==i?"size":"position";Frames.Designer.Dialog._dlg_props.find(".pdialog-property[data-property="+a+"]").find(".pdialog-widget").pproperty("refresh",!0),$(".custom-dialog.refreshable").find(".pdialog-property[data-property="+a+"]").find(".pdialog-widget").pproperty("refresh",!0)}else Frames.Designer.Dialog._dlg_props.find(".pdialog-widget").pproperty("refresh"),$(".custom-dialog.refreshable").find(".pdialog-property .pdialog-widget").pproperty("refresh");else Frames.Designer._selected&&Frames.Designer._selected.removeClass("ui-selected"),Frames.Designer.Dialog._selected=e,Frames.Designer.Dialog._selected.addClass("ui-selected"),Frames.Designer.Dialog.show(),Frames.Designer._select_properties(e,t,Frames.Designer.Dialog._dlg_props)}},$.fn.pproperty=function(m,i){function a(e,t,i){var a,s=t.get();if($.isPlainObject(s))for(a in e.children("input,select,span").hide(),s)e.find("input[name="+a+"],select[name="+a+"]").show().val(s[a]).prev("span").css("display",""),Frames.isTrue(i)&&e.find("input[name="+a+"],select[name="+a+"]").triggerHandler("change");else e.find("input,select").val(s),Frames.isTrue(i)&&e.find("input,select").triggerHandler("change")}return $.isPlainObject(m)&&(m=$.extend({},m)),this.each(function(){var e=$(this),p=e.data("pproperty");if(!p&&$.isPlainObject(m)){var t=new(p=m.property).type(m,Frames.Designer._curr);p.currElem=Frames.Designer._curr.elem,e.append(t.html()),e.data("pproperty",p)}$.isPlainObject(m)?(a(e,p),e.find("input, select").on("keydown",function(e){$.isFunction(p.keydown)&&p.keydown.apply(this,[e]),13===e.keyCode&&$(this).blur().focus()}).on("input",function(e){var t=$(e.target),i=t.val();if(t.hasClass("validate-length")){var a=/^([0-9]+)?(px|in|mm|em|cm|pc|pt|p|i|m|e|c|%)?(.*)$/gi.exec(i),s="";a[1]&&(s=a[1],a[2]&&(s+=a[2])),t.val(s)}}).on("change",function(e){var t=$(e.target),i=p.name||m.name,a=t.attr("name"),s=t.val();if(t.hasClass("numeric")){if(t.hasClass("validate-length")){var r=/^([0-9]+)?(px|in|mm|em|cm|pc|pt|%)?(.*)$/gi.exec(s),n="";r[1]&&(n=r[1],r[2]&&(n+=r[2])),t.val(n),s=t.val()}var o=t.data("suffix");if(o){t.val();!Frames.isEmpty(s)&&-1===s.indexOf(o)&&$.isNumeric(s)&&(s+=o,t.val(s))}}if(""!==a&&void 0!==a){var l={};l[a]=s,s=l}if(p.set(s,e),!e.isImmediatePropagationStopped()){if(s=p.get(),$.isPlainObject(s)){var d={};if(p.prefix){var u={};for(var c in s)s.hasOwnProperty(c)&&(u[p.prefix+c]=s[c]);s=u,a=p.prefix+a}d[a]=s[a],s=d}else p.prefix&&(i=p.prefix+i);0===p.currElem.parent().size()&&p.currElem.attr("id")&&(p.currElem=$("#"+p.currElem.attr("id"))),Frames.Designer.update(Frames.Designer.toXPath(p.currElem),i,s)}}).on("keyup",function(e){var t=$(e.target);if(t.hasClass("numeric")&&(e.keyCode==$.ui.keyCode.UP||e.keyCode==$.ui.keyCode.DOWN)){var i=t.data("suffix");void 0===i&&(i="");var a=parseInt(t.val(),10);$.isNumeric(a)||(a=0),e.keyCode==$.ui.keyCode.UP?t.val(a+1+i):e.keyCode==$.ui.keyCode.DOWN&&t.val(a-1+i),e.preventDefault(),e.stopPropagation(),t.triggerHandler("change")}})):"refresh"==m&&a(e,p,Frames.isTrue(i))})},$.fn.spinDown=function(){return this.click(function(){var e=$(this);return e.next().slideToggle(100),e.find(".ui-icon").toggleClass("ui-icon-triangle-1-s").end().toggleClass("state-active"),e.is(".corner-all")?e.removeClass("corner-all").addClass("corner-top"):e.is(".corner-top")&&e.removeClass("corner-top").addClass("corner-all"),!1})},window.__external=function(script){var obj=eval(script);return $.isFunction(obj)&&(obj=1<arguments.length?obj.apply(obj,Array.prototype.splice.call(arguments,1,arguments.length-1)):obj()),obj},window.__external.attached=function(){var e=!1;try{if(window.external&&"function"==typeof window.external.GetVersion){window.external.GetVersion();e=!0}}catch(e){}return e},window.__external.attached()){var console={log:function(){var txt=arguments[0],arr=Array.prototype.splice.call(arguments,1,arguments.length-1),s="window.external.Log(txt",i;for(i in arr)s+=", arr["+i+"]";s+=")",eval(s)}};console.error=console.log,console.info=console.log,console.debug=console.log,window.console=console,window.console.log("initialized")}}(jQuery),function($){Frames.Designer.DisplayPropertyWidget=$.inherit({_html:"",__constructor:function(e){},html:function(){return this._html},get:function(){},set:function(e){}}),Frames.Designer.DisplayPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<span class="full"></span>'}}),Frames.Designer.StringPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<input type="text" class="full" title="'+e.name+'" />'}}),Frames.Designer.InputLinkPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){var t="link"+(new Date).getTime()%1e4;this._html=$('<input type="text" class="full-button" title="'+e.name+'"/><a id="'+t+'" href="#" data-type="button" class="btn btn-default full-button" ><i class="fa fa-external-link"></i></a>'),this._html.click(function(){if(this.id===t){var e=$("input",$(this).parent()).val();Frames.Designer._external.supportsOpenView()&&Frames.Designer._external.openView(e)}})}}),Frames.Designer.StringReadOnlyPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<input type="text" class="full" title="'+e.name+'" readonly/>'}}),Frames.Designer.NumberPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<input type="text" class="numeric full" title="'+e.name+'" />'}}),Frames.Designer.BooleanPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<select class="half"><option value="true">true</option><option value="false">false</option></select>'}}),Frames.Designer.CasePropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<select class="half"><option value="String">upper</option><option value="Number">mixed</option></select>'}}),Frames.Designer.DataTypePropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<select class="half"><option value="String">String</option><option value="Integer">Integer</option><option value="Number">Number</option><option value="Date">Date</option></select>'}}),Frames.Designer.PositionPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<span class="label">Left</span><input type="text" name="left" class="half numeric validate-length" data-suffix="px" title="left" /><span class="label">Top</span><input type="text" name="top" class="half numeric validate-length" data-suffix="px" title="top" /><div style="margin-bottom: -9px"></div><br /><span class="label">Right</span><input type="text" name="right" class="half numeric validate-length" data-suffix="px" title="right" /><span class="label">Bottom</span><input type="text" name="bottom" class="half numeric validate-length" data-suffix="px" title="bottom" />'}}),Frames.Designer.SizePropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<span class="label">Width</span><input type="text" name="width" class="half numeric validate-length" data-suffix="px" title="width" /><span class="label">Height</span><input type="text" name="height" class="half numeric validate-length" data-suffix="px" title="height" />'}}),Frames.Designer.FontPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<span class="label">Family</span><select name="family" class="full-label" title="font family"><option></option><option>Arial</option><option>Verdana</option><option>Courier</option></select><span class="label">Size</span><input type="text" class="numeric half" name="size" data-suffix="pt" /><span class="label">Color</span>'+new Frames.Designer.ColorPropertyWidget({title:"font color"}).html()}}),Frames.Designer.ColorPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<input type="text" name="color" class="half" />'}}),Frames.Designer.AlignPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<select class="full"><option></option><option value="top">Top</option><option value="right">Right</option><option value="bottom">Bottom</option><option value="left">Left</option></select>'}}),Frames.Designer.Align2PropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<select class="full"><option></option><option value="start">Start</option><option value="end">End</option></select>'}}),Frames.Designer.BlockPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e){this._html='<select class="full"><option></option>';var t=Frames.Application.task._BLOCKS_;for(t.reset();t.hasNext();)blk=t.next(),this._html+='<option value="'+blk.name+'">'+blk.name+"</option>";this._html+="</select>"}}),Frames.Designer.DialogPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(t,e){var i=this;this._html=$('<button type="button" class="btn btn-mini btn-inverse">...</button>'),this._html.click(function(){Frames.isUndef(i._dlg)?$.get(Frames.Application._OPTS_.runtime+"/js/frames/designer/"+t.property.dialog.name+".tpl.html",function(e){i._dlg=$(e),i._dlg.dialog({classes:{"ui-dialog":"pdialog custom-dialog"},modal:!0,resizable:!1,height:t.property.dialog.height,width:t.property.dialog.width,buttons:[{text:"Close",click:function(){$(this).dialog("destroy"),delete i._dlg,t.property.dialog.close()}}],create:t.property.dialog.create})}):i._dlg.dialog()})}}),Frames.Designer.RadioButtonsDialogPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(t,e){if(this._html=$('<button type="button" class="btn btn-mini btn-inverse">...</button>'),Frames.isUndef(Frames.Designer.Dialog._dlg_radio_props))$.get(Frames.Application._OPTS_.runtime+"/js/frames/designer/"+t.property.dialog.name+".tpl.html",function(e){Frames.Designer.Dialog._dlg_radio_props=$(e),Frames.Designer.Dialog._dlg_radio_props.dialog({classes:{"ui-dialog":"pdialog custom-dialog refreshable"},resizable:!1,height:t.property.dialog.height,width:t.property.dialog.width,buttons:[{text:"Close",click:function(){$(this).dialog("close"),t.property.dialog.close()}}],create:t.property.dialog.create,autoOpen:!1})});else{var i=$.Event("dummy");i.target=Frames.Designer.Dialog._dlg_radio_props,t.property.dialog.create(i)}this._html.click(function(){Frames.Designer.Dialog._dlg_radio_props.dialog("open")})}}),Frames.Designer.GridColumnsDialogPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(t,e){if(this._html=$('<button type="button" class="btn btn-mini btn-inverse">...</button>'),Frames.isUndef(Frames.Designer.Dialog._dlg_column_props))$.get(Frames.Application._OPTS_.runtime+"/js/frames/designer/"+t.property.dialog.name+".tpl.html",function(e){Frames.Designer.Dialog._dlg_column_props=$(e),Frames.Designer.Dialog._dlg_column_props.dialog({classes:{"ui-dialog":"pdialog custom-dialog refreshable"},resizable:!1,height:t.property.dialog.height,width:t.property.dialog.width,buttons:[{text:"Close",click:function(){$(this).dialog("close"),t.property.dialog.close()}}],create:t.property.dialog.create,autoOpen:!1})});else{var i=$.Event("dummy");i.target=Frames.Designer.Dialog._dlg_column_props,t.property.dialog.create(i)}this._html.click(function(){Frames.Designer.Dialog._dlg_column_props.dialog("open")})}}),Frames.Designer.TabPagesDialogPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(t,e){if(this._html=$('<button type="button" class="btn btn-mini btn-inverse">...</button>'),Frames.isUndef(Frames.Designer.Dialog._dlg_tab_props))$.get(Frames.Application._OPTS_.runtime+"/js/frames/designer/"+t.property.dialog.name+".tpl.html",function(e){Frames.Designer.Dialog._dlg_tab_props=$(e),Frames.Designer.Dialog._dlg_tab_props.dialog({classes:{"ui-dialog":"pdialog custom-dialog refreshable"},resizable:!1,height:t.property.dialog.height,width:t.property.dialog.width,buttons:[{text:"Close",click:function(){$(this).dialog("close"),t.property.dialog.close()}}],create:t.property.dialog.create,autoOpen:!1})});else{var i=$.Event("dummy");i.target=Frames.Designer.Dialog._dlg_tab_props,t.property.dialog.create(i)}this._html.click(function(){Frames.Designer.Dialog._dlg_tab_props.dialog("open")})}}),Frames.Designer.ComboboxOptsDialogPropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(t,e){if(this._html=$('<button type="button" class="btn btn-mini btn-inverse">...</button>'),Frames.isUndef(Frames.Designer.Dialog._dlg_combo_props))$.get(Frames.Application._OPTS_.runtime+"/js/frames/designer/"+t.property.dialog.name+".tpl.html",function(e){Frames.Designer.Dialog._dlg_combo_props=$(e),Frames.Designer.Dialog._dlg_combo_props.dialog({classes:{"ui-dialog":"pdialog custom-dialog refreshable"},resizable:!1,height:t.property.dialog.height,width:t.property.dialog.width,buttons:[{text:"Close",click:function(){$(this).dialog("close"),t.property.dialog.close()}}],create:t.property.dialog.create,autoOpen:!1})});else{var i=$.Event("dummy");i.target=Frames.Designer.Dialog._dlg_combo_props,t.property.dialog.create(i)}this._html.click(function(){Frames.Designer.Dialog._dlg_combo_props.dialog("open")})}}),Frames.Designer.WidgetTypePropertyWidget=$.inherit(Frames.Designer.DisplayPropertyWidget,{__constructor:function(e,t){this._html='<select class="full"><option></option><option value="button">Button</option><option value="calculator">Calculator</option><option value="calendar">Calendar</option><option value="checkbox">Checkbox</option><option value="colorpicker">ColorPicker</option><option value="combobox">Combobox</option><option value="editbox">Editbox</option><option value="image">Image</option><option value="lovbox">Lovbox</option><option value="textfield">TextField</option><option value="textlink">Textlink</option></select>'}}),Frames.Designer.GridColumnInspector=$.extend({},Frames.Designer.Dialog.DefaultInspector,{properties:function(e){var t=Frames.Designer.Dialog.DefaultInspector.properties.apply(this,[e]);return t.general.properties.widget={type:Frames.Designer.WidgetTypePropertyWidget,label:"Widget Type",get:function(){return this.ref._col.editorIsDefault?"":this.ref._col.editorType},set:function(e){var t=this.ref._col.editorIsDefault,i=this.ref._col.editorType,a=Frames.Designer.toXPath(this.currElem);if(""==e){if(!t){this.ref._col.editorType="textinput",this.ref._col.editorIsDefault=!0;var s=a+"/xv:editor";Frames.Designer.remove(s)}}else if(t){this.ref._col.editorType=e,this.ref._col.editorIsDefault=!1;var r={type:"editor",container:a};Frames.Designer.add(r);var n={type:e,container:s=a+"/xv:editor"};Frames.Designer.add(n)}else{this.ref._col.editorType=e;var o=a+"/xv:editor/xv:"+i;Frames.Designer.rename(o,e)}},ref:e},t}})}(jQuery);
